{"version":3,"file":"index.cjs","sources":["../../../node_modules/.pnpm/nanoid@4.0.1/node_modules/nanoid/non-secure/index.js","../src/plugin/module-mapper.ts","../src/utils/is-module-tree.ts","../src/plugin/data.ts","../src/plugin/build-stats.ts","../src/plugin/compress.ts","../src/plugin/index.ts","../src/index.ts"],"sourcesContent":["let urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\nexport let customAlphabet = (alphabet, defaultSize = 21) => {\n  return (size = defaultSize) => {\n    let id = ''\n    let i = size\n    while (i--) {\n      id += alphabet[(Math.random() * alphabet.length) | 0]\n    }\n    return id\n  }\n}\nexport let nanoid = (size = 21) => {\n  let id = ''\n  let i = size\n  while (i--) {\n    id += urlAlphabet[(Math.random() * 64) | 0]\n  }\n  return id\n}\n","import { customAlphabet } from \"nanoid/non-secure\";\n\nimport type { ModuleImport, ModuleMeta, ModulePart, ModuleLengths, ModuleUID } from \"../types/types\";\n\nconst nanoid = customAlphabet(\"1234567890abcdef\", 4);\n\nconst UNIQUE_PREFIX = nanoid();\nlet COUNTER = 0;\n\nconst uniqueId = (): ModuleUID => `${UNIQUE_PREFIX}-${COUNTER++}`;\n\ntype ModuleIdStorage = {\n  uid: ModuleUID;\n  meta: Omit<ModuleMeta, \"imported\" | \"importedBy\"> & { imported: Set<string>; importedBy: Set<string> };\n};\n\nexport class ModuleMapper {\n  private nodeParts: Record<ModuleUID, ModulePart> = {};\n  private nodeMetas: Record<string, ModuleIdStorage> = {};\n\n  constructor(private projectRoot: string | RegExp) {}\n\n  trimProjectRootId(moduleId: string): string {\n    return moduleId.replace(this.projectRoot, \"\");\n  }\n\n  getModuleUid(moduleId: string): ModuleUID {\n    if (!(moduleId in this.nodeMetas)) {\n      this.nodeMetas[moduleId] = {\n        uid: uniqueId(),\n        meta: { id: this.trimProjectRootId(moduleId), moduleParts: {}, imported: new Set(), importedBy: new Set() },\n      };\n    }\n\n    return this.nodeMetas[moduleId].uid;\n  }\n\n  getBundleModuleUid(bundleId: string, moduleId: string): ModuleUID {\n    if (!(moduleId in this.nodeMetas)) {\n      this.nodeMetas[moduleId] = {\n        uid: uniqueId(),\n        meta: { id: this.trimProjectRootId(moduleId), moduleParts: {}, imported: new Set(), importedBy: new Set() },\n      };\n    }\n    if (!(bundleId in this.nodeMetas[moduleId].meta.moduleParts)) {\n      this.nodeMetas[moduleId].meta.moduleParts[bundleId] = uniqueId();\n    }\n\n    return this.nodeMetas[moduleId].meta.moduleParts[bundleId];\n  }\n\n  setNodePart(bundleId: string, moduleId: string, value: ModuleLengths): ModuleUID {\n    const uid = this.getBundleModuleUid(bundleId, moduleId);\n    if (uid in this.nodeParts) {\n      throw new Error(\n        `Override module: bundle id ${bundleId}, module id ${moduleId}, value ${JSON.stringify(\n          value\n        )}, existing value: ${JSON.stringify(this.nodeParts[uid])}`\n      );\n    }\n    this.nodeParts[uid] = { ...value, mainUid: this.getModuleUid(moduleId) };\n    return uid;\n  }\n\n  setNodeMeta(moduleId: string, value: { isEntry?: boolean; isExternal?: boolean }): void {\n    this.getModuleUid(moduleId);\n    this.nodeMetas[moduleId].meta.isEntry = value.isEntry;\n    this.nodeMetas[moduleId].meta.isExternal = value.isExternal;\n  }\n\n  hasNodePart(bundleId: string, moduleId: string): boolean {\n    if (!(moduleId in this.nodeMetas)) {\n      return false;\n    }\n    if (!(bundleId in this.nodeMetas[moduleId].meta.moduleParts)) {\n      return false;\n    }\n    if (!(this.nodeMetas[moduleId].meta.moduleParts[bundleId] in this.nodeParts)) {\n      return false;\n    }\n    return true;\n  }\n\n  getNodeParts(): ModuleMapper[\"nodeParts\"] {\n    return this.nodeParts;\n  }\n\n  getNodeMetas(): Record<ModuleUID, ModuleMeta> {\n    const nodeMetas: Record<ModuleUID, ModuleMeta> = {};\n    for (const { uid, meta } of Object.values(this.nodeMetas)) {\n      nodeMetas[uid] = {\n        ...meta,\n        imported: [...meta.imported].map((rawImport) => {\n          const [uid, dynamic] = rawImport.split(\",\");\n          const importData: ModuleImport = { uid };\n          if (dynamic === \"true\") {\n            importData.dynamic = true;\n          }\n          return importData;\n        }),\n        importedBy: [...meta.importedBy].map((rawImport) => {\n          const [uid, dynamic] = rawImport.split(\",\");\n          const importData: ModuleImport = { uid };\n          if (dynamic === \"true\") {\n            importData.dynamic = true;\n          }\n          return importData;\n        }),\n      };\n    }\n    return nodeMetas;\n  }\n\n  addImportedByLink(targetId: string, sourceId: string): void {\n    const sourceUid = this.getModuleUid(sourceId);\n    this.getModuleUid(targetId);\n    this.nodeMetas[targetId].meta.importedBy.add(sourceUid);\n  }\n\n  addImportedLink(sourceId: string, targetId: string, dynamic = false): void {\n    const targetUid = this.getModuleUid(targetId);\n    this.getModuleUid(sourceId);\n    this.nodeMetas[sourceId].meta.imported.add(String([targetUid, dynamic]));\n  }\n}","import type { ModuleTree, ModuleTreeLeaf } from \"../types/types\";\n\nexport const isModuleTree = (mod: ModuleTree | ModuleTreeLeaf): mod is ModuleTree => \"children\" in mod;","import type { GetModuleInfo } from \"../types/rollup\";\nimport type { ModuleLengths, ModuleTree, ModuleTreeLeaf } from \"../types/types\";\n\nimport { isModuleTree } from \"../utils/is-module-tree\";\nimport { ModuleMapper } from \"./module-mapper\";\n\ninterface MappedNode {\n  uid: string;\n}\n\nconst addToPath = (moduleId: string, tree: ModuleTree, modulePath: string[], node: MappedNode): void => {\n  if (modulePath.length === 0) {\n    throw new Error(`Error adding node to path ${moduleId}`);\n  }\n\n  const [head, ...rest] = modulePath;\n\n  if (rest.length === 0) {\n    tree.children.push({ ...node, name: head });\n    return;\n  } else {\n    let newTree = tree.children.find((folder): folder is ModuleTree => folder.name === head && isModuleTree(folder));\n\n    if (!newTree) {\n      newTree = { name: head, children: [] };\n      tree.children.push(newTree);\n    }\n    addToPath(moduleId, newTree, rest, node);\n    return;\n  }\n};\n\n// TODO try to make it without recursion, but still typesafe\nconst mergeSingleChildTrees = (tree: ModuleTree): ModuleTree | ModuleTreeLeaf => {\n  if (tree.children.length === 1) {\n    const child = tree.children[0];\n    const name = `${tree.name}/${child.name}`;\n    if (isModuleTree(child)) {\n      tree.name = name;\n      tree.children = child.children;\n      return mergeSingleChildTrees(tree);\n    } else {\n      return {\n        name,\n        uid: child.uid,\n      };\n    }\n  } else {\n    tree.children = tree.children.map((node) => {\n      if (isModuleTree(node)) {\n        return mergeSingleChildTrees(node);\n      } else {\n        return node;\n      }\n    });\n    return tree;\n  }\n};\n\nexport const buildTree = (\n  bundleId: string,\n  modules: Array<ModuleLengths & { id: string }>,\n  mapper: ModuleMapper\n): ModuleTree => {\n  const tree: ModuleTree = {\n    name: bundleId,\n    children: [],\n  };\n\n  for (const { id, renderedLength, gzipLength, brotliLength } of modules) {\n    const bundleModuleUid = mapper.setNodePart(bundleId, id, { renderedLength, gzipLength, brotliLength });\n\n    const trimmedModuleId = mapper.trimProjectRootId(id);\n\n    const pathParts = trimmedModuleId.split(/\\\\|\\//).filter((p) => p !== \"\");\n    addToPath(trimmedModuleId, tree, pathParts, { uid: bundleModuleUid });\n  }\n\n  tree.children = tree.children.map((node) => {\n    if (isModuleTree(node)) {\n      return mergeSingleChildTrees(node);\n    } else {\n      return node;\n    }\n  });\n\n  return tree;\n};\n\nexport const mergeTrees = (trees: Array<ModuleTree | ModuleTreeLeaf>): ModuleTree => {\n  const newTree = {\n    name: \"root\",\n    children: trees,\n    isRoot: true,\n  };\n\n  return newTree;\n};\n\nexport const addLinks = (startModuleId: string, getModuleInfo: GetModuleInfo, mapper: ModuleMapper): void => {\n  const processedNodes: Record<string, boolean> = {};\n\n  const moduleIds = [startModuleId];\n\n  while (moduleIds.length > 0) {\n    const moduleId = moduleIds.shift() as string;\n\n    if (processedNodes[moduleId]) {\n      continue;\n    } else {\n      processedNodes[moduleId] = true;\n    }\n\n    const moduleInfo = getModuleInfo(moduleId);\n\n    if (!moduleInfo) {\n      return;\n    }\n\n    if (moduleInfo.isEntry) {\n      mapper.setNodeMeta(moduleId, { isEntry: true });\n    }\n    if (moduleInfo.isExternal) {\n      mapper.setNodeMeta(moduleId, { isExternal: true });\n    }\n\n    for (const importedId of moduleInfo.importedIds) {\n      mapper.addImportedByLink(importedId, moduleId);\n      mapper.addImportedLink(moduleId, importedId);\n\n      moduleIds.push(importedId);\n    }\n    for (const importedId of moduleInfo.dynamicallyImportedIds) {\n      mapper.addImportedByLink(importedId, moduleId);\n      mapper.addImportedLink(moduleId, importedId, true);\n\n      moduleIds.push(importedId);\n    }\n  }\n};","import type { VisualizerData } from \"../types/types\";\nimport type { TemplateType } from \"../types/template-types\";\n\nconst htmlEscape = (str: string) =>\n  str\n    .replace(/&/g, \"&amp;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#39;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\");\n\ninterface BuildHtmlOptions {\n  title: string;\n  data: VisualizerData;\n  template: TemplateType;\n}\n\nexport async function buildHtml({ title, data, template }: BuildHtmlOptions): Promise<string> {\n  return `\n    <!DOCTYPE html>\n    <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n        <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\" />\n        <title>${htmlEscape(title)}</title>\n        <link rel='stylesheet' href='/js/${template}.min.css' />\n      </head>\n      <body>\n        <main></main>\n        <script type=\"module\" defer>\n          import * as drawChart from \"/js/${template}.min.js\";\n          const data = ${JSON.stringify(data)};\n          \n          const run = () => {\n            const width = window.innerWidth;\n            const height = window.innerHeight;\n            const chartNode = document.querySelector(\"main\");\n            drawChart.default(chartNode, data, width, height);\n          };\n      \n          window.addEventListener('resize', run);\n      \n          document.addEventListener('DOMContentLoaded', run);\n        </script>\n      </body>\n    </html>\n  `;\n}\n","// import { gzip, getWASM } from \"../../../deno/denoflate/mod\";\n// import { compress } from \"@bundlejs/core/src/deno/denoflate/mod\";\n\nexport type SizeGetter = (code: Uint8Array) => Promise<number>;\n\nexport const emptySizeGetter: SizeGetter = () => Promise.resolve(0);\nexport const gzipSizeGetter: SizeGetter = async (code: Uint8Array) => {\n    // @bundlejs/core/src/deno/denoflate/mod.ts\n    // ../../../core/src/deno/denoflate/mod\n    const { gzip, getWASM } = await import(\"@bundlejs/core/src/deno/denoflate/mod\");\n    await getWASM();\n\n    const data = await gzip(code, 9);\n    // const data = [];\n    return data.length;\n};\n\nexport const brotliSizeGetter: SizeGetter = async (code: Uint8Array) => {\n    // @bundlejs/core/deno/brotli/mod.ts\n    // ../../../core/src/deno/brotli/mod\n    const { compress } = await import(\"@bundlejs/core/src/deno/brotli/mod\");\n    const data = await compress(code, code.length, 11);\n    return data.length;\n};","import type { TemplateType } from \"../types/template-types\";\nimport type { ModuleLengths, ModuleTree, ModuleTreeLeaf, VisualizerData } from \"../types/types\";\nimport type { Metadata, MetadataOutput } from \"../types/metafile\";\nimport type { ModuleInfo } from \"../types/rollup\";\nimport type { OutputFile } from \"esbuild-wasm\";\n\nimport { ModuleMapper } from \"./module-mapper\";\nimport { addLinks, buildTree, mergeTrees } from \"./data\";\nimport { buildHtml } from \"./build-stats\";\n\nimport { gzipSizeGetter, brotliSizeGetter, emptySizeGetter } from \"./compress\";\n\n/**\n * Analyzer options\n */\nexport interface AnalyzerOptions {\n  title?: string;\n  template?: TemplateType | boolean;\n  gzipSize?: boolean;\n  brotliSize?: boolean;\n}\n\nexport const visualizer = async (metadata: Metadata, outputFiles: OutputFile[], opts: AnalyzerOptions = {}): Promise<string> => {\n  const title = opts.title ?? \"Esbuild Visualizer\";\n  const template = (opts.template == true ? \"treemap\" : opts.template as TemplateType) ?? \"treemap\";\n  const projectRoot = \"\";\n\n  let outputFilesMap = new Map<string, Uint8Array>();\n  outputFiles.forEach(({ path, contents }) => {\n    outputFilesMap.set(path, contents);\n  });\n  // console.log(metadata, outputFiles, Array.from(outputFilesMap.entries()));\n\n  const gzipSize = !!opts.gzipSize;\n  const brotliSize = !!opts.brotliSize;\n  const gzip = gzipSize ? gzipSizeGetter : emptySizeGetter;\n  const brotli = brotliSize ? brotliSizeGetter : emptySizeGetter;\n\n  const ModuleLengths = async ({\n    id,\n    mod\n  }: {\n    id: string;\n    mod: { bytesInOutput: number };\n  }): Promise<ModuleLengths & { id: string }> => {\n    const code = outputFilesMap.get(id);\n    let faultyCode = code == null || code == undefined || code?.length == 0;\n    let [gzipLength, brotliLength, renderedLength] = await Promise.all(faultyCode ? [0, 0, mod.bytesInOutput] : [gzip(code), brotli(code), code?.length])\n    const result = {\n      id,\n      gzipLength,\n      brotliLength,\n      renderedLength\n    };\n    return result;\n  };\n\n  const roots: Array<ModuleTree | ModuleTreeLeaf> = [];\n  const mapper = new ModuleMapper(projectRoot);\n\n  // collect trees\n  for (const [bundleId, bundle] of Object.entries(metadata.outputs)) {\n    const modules = await Promise.all(\n      Object\n        .entries(bundle.inputs)\n        .map(([id, mod]) => ModuleLengths({ id, mod }))\n    );\n    const tree = buildTree(bundleId, modules, mapper);\n\n    const code = outputFilesMap.get(bundleId);\n    if (tree.children.length === 0 && code) {\n      const bundleSizes = await ModuleLengths({\n        id: bundleId,\n        mod: { bytesInOutput: code?.length }\n      });\n\n      const facadeModuleId = `${bundleId}-unknown`;\n      const bundleUid = mapper.setNodePart(bundleId, facadeModuleId, bundleSizes);\n      mapper.setNodeMeta(facadeModuleId, { isEntry: true });\n      const leaf: ModuleTreeLeaf = { name: bundleId, uid: bundleUid };\n      roots.push(leaf);\n    } else {\n      roots.push(tree);\n    }\n  }\n\n  const getModuleInfo = (bundle: MetadataOutput) => (moduleId: string): ModuleInfo => {\n    const input = metadata.inputs?.[moduleId];\n\n    const imports = input?.imports.map((i) => i.path);\n\n    const code = outputFilesMap.get(moduleId);\n\n    return {\n      renderedLength: code?.length ?? bundle.inputs?.[moduleId]?.bytesInOutput ?? 0,\n      importedIds: imports ?? [],\n      dynamicallyImportedIds: [],\n      isEntry: bundle.entryPoint === moduleId,\n      isExternal: false,\n    };\n  };\n\n  for (const [bundleId, bundle] of Object.entries(metadata.outputs)) {\n    if (bundle.entryPoint == null) continue;\n\n    addLinks(bundleId, getModuleInfo(bundle), mapper);\n  }\n\n  const tree = mergeTrees(roots);\n\n  const data: VisualizerData = {\n    version: 3.0,\n    tree,\n    nodeParts: mapper.getNodeParts(),\n    nodeMetas: mapper.getNodeMetas(),\n    env: {},\n    options: {\n      gzip: gzipSize,\n      brotli: brotliSize\n    },\n  };\n\n  const fileContent: string = await buildHtml({\n    title,\n    data,\n    template,\n  });\n\n  return fileContent;\n};\n","// Based off of https://github.com/btd/esbuild-visualizer\nimport type { TemplateType } from \"./types/template-types\";\nimport type { ModuleMeta, ModulePart, ModuleTree, ModuleUID, VisualizerData } from \"./types/types\";\n\nimport type { Metadata } from \"./types/metafile\";\nimport type { OutputFile } from \"esbuild-wasm\";\nimport { AnalyzerOptions, visualizer } from \"./plugin/index\";\n\n\n/**\n * Generates interactive zoomable charts displaing the size of output files. \n * It's a great way to determine what causes the bundle size to be so large. \n */\n//  analysis?: TemplateType | boolean,\n//  metafile: Boolean(CONFIG.analysis),\nexport const analyze = async (metadata: Metadata, outputFiles: OutputFile[], opts: AnalyzerOptions = {}, logger = console.log) => {\n  try {\n    return await visualizer(metadata, outputFiles, {\n      title: \"Bundle Analysis\",\n      ...opts\n    });\n  } catch (err) {\n    let { stack } = (err as Error);\n    logger([`[Analyzer] ${err}`, stack], \"warning\");\n    console.warn(err, stack);\n  }\n};\n"],"names":["customAlphabet","alphabet","defaultSize","size","id","nanoid","UNIQUE_PREFIX","COUNTER","uniqueId","ModuleMapper","projectRoot","moduleId","bundleId","value","uid","nodeMetas","meta","rawImport","dynamic","importData","targetId","sourceId","sourceUid","targetUid","isModuleTree","mod","addToPath","tree","modulePath","node","head","rest","newTree","folder","mergeSingleChildTrees","child","name","buildTree","modules","mapper","renderedLength","gzipLength","brotliLength","bundleModuleUid","trimmedModuleId","pathParts","p","mergeTrees","trees","addLinks","startModuleId","getModuleInfo","processedNodes","moduleIds","moduleInfo","importedId","htmlEscape","str","buildHtml","title","data","template","emptySizeGetter","gzipSizeGetter","code","gzip","getWASM","brotliSizeGetter","compress","visualizer","metadata","outputFiles","opts","outputFilesMap","path","contents","gzipSize","brotliSize","brotli","ModuleLengths","faultyCode","roots","bundle","bundleSizes","facadeModuleId","bundleUid","leaf","imports","i","analyze","logger","err","stack"],"mappings":"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"}