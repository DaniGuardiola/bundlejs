{
  "version": 3,
  "sources": ["node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/common/marked/marked.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/basic-languages/_.contribution.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/basic-languages/typescript/typescript.contribution.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/iPadShowKeyboard/iPadShowKeyboard.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/platform/quickinput/browser/pickerQuickAccess.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/common/errorMessage.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/platform/quickinput/browser/commandsQuickAccess.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/commandsQuickAccess.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickAccess/standaloneCommandsQuickAccess.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/bracketMatching/bracketMatching.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/moveCaretCommand.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/caretOperations.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/clipboard/clipboard.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/common/lazy.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/types.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeAction.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/message/messageController.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionMenu.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/lightBulbWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionUi.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionCommands.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionContributions.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/comment/blockCommentCommand.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/comment/lineCommentCommand.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/comment/comment.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/contextmenu/contextmenu.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/cursorUndo/cursorUndo.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/dnd/dragAndDropCommand.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/dnd/dnd.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/findDecorations.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/replaceAllCommand.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/common/search.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/replacePattern.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/findModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/browser/ui/checkbox/checkbox.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/findInputCheckboxes.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/findOptionsWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/findState.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/findInput.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/browser/ui/findinput/replaceInput.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/platform/browser/contextScopedHistoryWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/findWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/find/findController.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/foldingRanges.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/foldingModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/foldingDecorations.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/hiddenRangeModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/indentRangeProvider.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/syntaxRangeProvider.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/intializingRangeProvider.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/folding/folding.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/fontZoom.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/format/formatActions.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/common/htmlContent.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/referencesModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/goToSymbol.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/browser/widget/embeddedCodeEditorWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/zoneWidget/zoneWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/browser/ui/dropdown/dropdown.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/browser/ui/dropdown/dropdownActionViewItem.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/platform/actions/browser/menuEntryActionViewItem.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/peekView/peekView.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/common/labels.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesTree.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/peek/referencesController.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/symbolNavigation.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/goToCommands.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/clickLinkGesture.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/goToDefinitionAtPosition.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/hoverOperation.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/browser/ui/hover/hoverWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/platform/severityIcon/common/severityIcon.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoErrorWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/markerNavigationService.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoError.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/markerHoverParticipant.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/browser/markdownRenderer.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/common/insane/insane.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/browser/core/markdownRenderer.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/getHover.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/markdownHoverParticipant.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/hoverTypes.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/ghostTextWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/ghostText.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/inlineCompletionsModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetParser.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/platform/workspaces/common/workspaces.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/base/common/uuid.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetVariables.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetSession.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggest.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetController2.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestMemory.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestAlternatives.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/completionModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/bracketSelections.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/wordDistance.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/symbolIcons/symbolIcons.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/resizable.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestWidgetDetails.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestWidgetStatus.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/platform/files/common/files.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/common/services/getIconClasses.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestWidgetRenderer.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/wordContextKey.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestCommitCharacters.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestOvertypingCapturer.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestController.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/suggestWidgetAdapterModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/utils.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/ghostTextModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/ghostTextController.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/inlineCompletionsHoverParticipant.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/color.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorDetector.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorPickerModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorPickerWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/colorHoverParticipant.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/modesContentHover.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/hoverWidgets.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/modesGlyphHover.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/hover/hover.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/indentation/indentUtils.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/indentation/indentation.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/inlayHintsController.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/common/commands/trimTrailingWhitespaceCommand.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/copyLinesCommand.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/moveLinesCommand.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/sortLinesCommand.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/linesOperations.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/links/getLinks.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/links/links.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/multicursor/multicursor.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/provideSignatureHelp.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHintsModel.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHintsWidget.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHints.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/rename/renameInputField.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/rename/rename.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/wordSelections.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/smartSelect.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/tokenization/tokenization.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/toggleTabFocusMode/toggleTabFocusMode.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/unusualLineTerminators/unusualLineTerminators.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/viewportSemanticTokens/viewportSemanticTokens.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/wordHighlighter.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/wordOperations/wordOperations.js", "node_modules/.pnpm/monaco-editor@0.27.0/node_modules/monaco-editor/esm/vs/editor/contrib/wordPartOperations/wordPartOperations.js", "src/ts/util/github-light.ts", "src/ts/util/github-dark.ts", "web-worker:../workers/typescript.ts", "web-worker:../workers/editor.ts", "src/ts/modules/monaco.ts"],
  "sourcesContent": ["/**\n * marked - a markdown parser\n * Copyright (c) 2011-2021, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * DO NOT EDIT THIS FILE\n * The code in this file is generated from files in ./src/\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.marked = factory());\n}(this, (function () { 'use strict';\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _unsupportedIterableToArray(o, minLen) {\n    if (!o) return;\n    if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n    var n = Object.prototype.toString.call(o).slice(8, -1);\n    if (n === \"Object\" && o.constructor) n = o.constructor.name;\n    if (n === \"Map\" || n === \"Set\") return Array.from(o);\n    if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n  }\n\n  function _arrayLikeToArray(arr, len) {\n    if (len == null || len > arr.length) len = arr.length;\n\n    for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n    return arr2;\n  }\n\n  function _createForOfIteratorHelperLoose(o, allowArrayLike) {\n    var it;\n\n    if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n      if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n        if (it) o = it;\n        var i = 0;\n        return function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        };\n      }\n\n      throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n    }\n\n    it = o[Symbol.iterator]();\n    return it.next.bind(it);\n  }\n\n  function createCommonjsModule(fn) {\n    var module = { exports: {} };\n  \treturn fn(module, module.exports), module.exports;\n  }\n\n  var defaults = createCommonjsModule(function (module) {\n    function getDefaults() {\n      return {\n        baseUrl: null,\n        breaks: false,\n        gfm: true,\n        headerIds: true,\n        headerPrefix: '',\n        highlight: null,\n        langPrefix: 'language-',\n        mangle: true,\n        pedantic: false,\n        renderer: null,\n        sanitize: false,\n        sanitizer: null,\n        silent: false,\n        smartLists: false,\n        smartypants: false,\n        tokenizer: null,\n        walkTokens: null,\n        xhtml: false\n      };\n    }\n\n    function changeDefaults(newDefaults) {\n      module.exports.defaults = newDefaults;\n    }\n\n    module.exports = {\n      defaults: getDefaults(),\n      getDefaults: getDefaults,\n      changeDefaults: changeDefaults\n    };\n  });\n\n  /**\n   * Helpers\n   */\n  var escapeTest = /[&<>\"']/;\n  var escapeReplace = /[&<>\"']/g;\n  var escapeTestNoEncode = /[<>\"']|&(?!#?\\w+;)/;\n  var escapeReplaceNoEncode = /[<>\"']|&(?!#?\\w+;)/g;\n  var escapeReplacements = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  };\n\n  var getEscapeReplacement = function getEscapeReplacement(ch) {\n    return escapeReplacements[ch];\n  };\n\n  function escape(html, encode) {\n    if (encode) {\n      if (escapeTest.test(html)) {\n        return html.replace(escapeReplace, getEscapeReplacement);\n      }\n    } else {\n      if (escapeTestNoEncode.test(html)) {\n        return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n      }\n    }\n\n    return html;\n  }\n\n  var unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\n\n  function unescape(html) {\n    // explicitly match decimal, hex, and named HTML entities\n    return html.replace(unescapeTest, function (_, n) {\n      n = n.toLowerCase();\n      if (n === 'colon') return ':';\n\n      if (n.charAt(0) === '#') {\n        return n.charAt(1) === 'x' ? String.fromCharCode(parseInt(n.substring(2), 16)) : String.fromCharCode(+n.substring(1));\n      }\n\n      return '';\n    });\n  }\n\n  var caret = /(^|[^\\[])\\^/g;\n\n  function edit(regex, opt) {\n    regex = regex.source || regex;\n    opt = opt || '';\n    var obj = {\n      replace: function replace(name, val) {\n        val = val.source || val;\n        val = val.replace(caret, '$1');\n        regex = regex.replace(name, val);\n        return obj;\n      },\n      getRegex: function getRegex() {\n        return new RegExp(regex, opt);\n      }\n    };\n    return obj;\n  }\n\n  var nonWordAndColonTest = /[^\\w:]/g;\n  var originIndependentUrl = /^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;\n\n  function cleanUrl(sanitize, base, href) {\n    if (sanitize) {\n      var prot;\n\n      try {\n        prot = decodeURIComponent(unescape(href)).replace(nonWordAndColonTest, '').toLowerCase();\n      } catch (e) {\n        return null;\n      }\n\n      if (prot.indexOf('javascript:') === 0 || prot.indexOf('vbscript:') === 0 || prot.indexOf('data:') === 0) {\n        return null;\n      }\n    }\n\n    if (base && !originIndependentUrl.test(href)) {\n      href = resolveUrl(base, href);\n    }\n\n    try {\n      href = encodeURI(href).replace(/%25/g, '%');\n    } catch (e) {\n      return null;\n    }\n\n    return href;\n  }\n\n  var baseUrls = {};\n  var justDomain = /^[^:]+:\\/*[^/]*$/;\n  var protocol = /^([^:]+:)[\\s\\S]*$/;\n  var domain = /^([^:]+:\\/*[^/]*)[\\s\\S]*$/;\n\n  function resolveUrl(base, href) {\n    if (!baseUrls[' ' + base]) {\n      // we can ignore everything in base after the last slash of its path component,\n      // but we might need to add _that_\n      // https://tools.ietf.org/html/rfc3986#section-3\n      if (justDomain.test(base)) {\n        baseUrls[' ' + base] = base + '/';\n      } else {\n        baseUrls[' ' + base] = rtrim(base, '/', true);\n      }\n    }\n\n    base = baseUrls[' ' + base];\n    var relativeBase = base.indexOf(':') === -1;\n\n    if (href.substring(0, 2) === '//') {\n      if (relativeBase) {\n        return href;\n      }\n\n      return base.replace(protocol, '$1') + href;\n    } else if (href.charAt(0) === '/') {\n      if (relativeBase) {\n        return href;\n      }\n\n      return base.replace(domain, '$1') + href;\n    } else {\n      return base + href;\n    }\n  }\n\n  var noopTest = {\n    exec: function noopTest() {}\n  };\n\n  function merge(obj) {\n    var i = 1,\n        target,\n        key;\n\n    for (; i < arguments.length; i++) {\n      target = arguments[i];\n\n      for (key in target) {\n        if (Object.prototype.hasOwnProperty.call(target, key)) {\n          obj[key] = target[key];\n        }\n      }\n    }\n\n    return obj;\n  }\n\n  function splitCells(tableRow, count) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    var row = tableRow.replace(/\\|/g, function (match, offset, str) {\n      var escaped = false,\n          curr = offset;\n\n      while (--curr >= 0 && str[curr] === '\\\\') {\n        escaped = !escaped;\n      }\n\n      if (escaped) {\n        // odd number of slashes means | is escaped\n        // so we leave it alone\n        return '|';\n      } else {\n        // add space before unescaped |\n        return ' |';\n      }\n    }),\n        cells = row.split(/ \\|/);\n    var i = 0;\n\n    if (cells.length > count) {\n      cells.splice(count);\n    } else {\n      while (cells.length < count) {\n        cells.push('');\n      }\n    }\n\n    for (; i < cells.length; i++) {\n      // leading or trailing whitespace is ignored per the gfm spec\n      cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n    }\n\n    return cells;\n  } // Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n  // /c*$/ is vulnerable to REDOS.\n  // invert: Remove suffix of non-c chars instead. Default falsey.\n\n\n  function rtrim(str, c, invert) {\n    var l = str.length;\n\n    if (l === 0) {\n      return '';\n    } // Length of suffix matching the invert condition.\n\n\n    var suffLen = 0; // Step left until we fail to match the invert condition.\n\n    while (suffLen < l) {\n      var currChar = str.charAt(l - suffLen - 1);\n\n      if (currChar === c && !invert) {\n        suffLen++;\n      } else if (currChar !== c && invert) {\n        suffLen++;\n      } else {\n        break;\n      }\n    }\n\n    return str.substr(0, l - suffLen);\n  }\n\n  function findClosingBracket(str, b) {\n    if (str.indexOf(b[1]) === -1) {\n      return -1;\n    }\n\n    var l = str.length;\n    var level = 0,\n        i = 0;\n\n    for (; i < l; i++) {\n      if (str[i] === '\\\\') {\n        i++;\n      } else if (str[i] === b[0]) {\n        level++;\n      } else if (str[i] === b[1]) {\n        level--;\n\n        if (level < 0) {\n          return i;\n        }\n      }\n    }\n\n    return -1;\n  }\n\n  function checkSanitizeDeprecation(opt) {\n    if (opt && opt.sanitize && !opt.silent) {\n      console.warn('marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options');\n    }\n  } // copied from https://stackoverflow.com/a/5450113/806777\n\n\n  function repeatString(pattern, count) {\n    if (count < 1) {\n      return '';\n    }\n\n    var result = '';\n\n    while (count > 1) {\n      if (count & 1) {\n        result += pattern;\n      }\n\n      count >>= 1;\n      pattern += pattern;\n    }\n\n    return result + pattern;\n  }\n\n  var helpers = {\n    escape: escape,\n    unescape: unescape,\n    edit: edit,\n    cleanUrl: cleanUrl,\n    resolveUrl: resolveUrl,\n    noopTest: noopTest,\n    merge: merge,\n    splitCells: splitCells,\n    rtrim: rtrim,\n    findClosingBracket: findClosingBracket,\n    checkSanitizeDeprecation: checkSanitizeDeprecation,\n    repeatString: repeatString\n  };\n\n  var defaults$1 = defaults.defaults;\n  var rtrim$1 = helpers.rtrim,\n      splitCells$1 = helpers.splitCells,\n      _escape = helpers.escape,\n      findClosingBracket$1 = helpers.findClosingBracket;\n\n  function outputLink(cap, link, raw) {\n    var href = link.href;\n    var title = link.title ? _escape(link.title) : null;\n    var text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n\n    if (cap[0].charAt(0) !== '!') {\n      return {\n        type: 'link',\n        raw: raw,\n        href: href,\n        title: title,\n        text: text\n      };\n    } else {\n      return {\n        type: 'image',\n        raw: raw,\n        href: href,\n        title: title,\n        text: _escape(text)\n      };\n    }\n  }\n\n  function indentCodeCompensation(raw, text) {\n    var matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n\n    if (matchIndentToCode === null) {\n      return text;\n    }\n\n    var indentToCode = matchIndentToCode[1];\n    return text.split('\\n').map(function (node) {\n      var matchIndentInNode = node.match(/^\\s+/);\n\n      if (matchIndentInNode === null) {\n        return node;\n      }\n\n      var indentInNode = matchIndentInNode[0];\n\n      if (indentInNode.length >= indentToCode.length) {\n        return node.slice(indentToCode.length);\n      }\n\n      return node;\n    }).join('\\n');\n  }\n  /**\n   * Tokenizer\n   */\n\n\n  var Tokenizer_1 = /*#__PURE__*/function () {\n    function Tokenizer(options) {\n      this.options = options || defaults$1;\n    }\n\n    var _proto = Tokenizer.prototype;\n\n    _proto.space = function space(src) {\n      var cap = this.rules.block.newline.exec(src);\n\n      if (cap) {\n        if (cap[0].length > 1) {\n          return {\n            type: 'space',\n            raw: cap[0]\n          };\n        }\n\n        return {\n          raw: '\\n'\n        };\n      }\n    };\n\n    _proto.code = function code(src) {\n      var cap = this.rules.block.code.exec(src);\n\n      if (cap) {\n        var text = cap[0].replace(/^ {1,4}/gm, '');\n        return {\n          type: 'code',\n          raw: cap[0],\n          codeBlockStyle: 'indented',\n          text: !this.options.pedantic ? rtrim$1(text, '\\n') : text\n        };\n      }\n    };\n\n    _proto.fences = function fences(src) {\n      var cap = this.rules.block.fences.exec(src);\n\n      if (cap) {\n        var raw = cap[0];\n        var text = indentCodeCompensation(raw, cap[3] || '');\n        return {\n          type: 'code',\n          raw: raw,\n          lang: cap[2] ? cap[2].trim() : cap[2],\n          text: text\n        };\n      }\n    };\n\n    _proto.heading = function heading(src) {\n      var cap = this.rules.block.heading.exec(src);\n\n      if (cap) {\n        var text = cap[2].trim(); // remove trailing #s\n\n        if (/#$/.test(text)) {\n          var trimmed = rtrim$1(text, '#');\n\n          if (this.options.pedantic) {\n            text = trimmed.trim();\n          } else if (!trimmed || / $/.test(trimmed)) {\n            // CommonMark requires space before trailing #s\n            text = trimmed.trim();\n          }\n        }\n\n        return {\n          type: 'heading',\n          raw: cap[0],\n          depth: cap[1].length,\n          text: text\n        };\n      }\n    };\n\n    _proto.nptable = function nptable(src) {\n      var cap = this.rules.block.nptable.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '').split('\\n') : [],\n          raw: cap[0]\n        };\n\n        if (item.header.length === item.align.length) {\n          var l = item.align.length;\n          var i;\n\n          for (i = 0; i < l; i++) {\n            if (/^ *-+: *$/.test(item.align[i])) {\n              item.align[i] = 'right';\n            } else if (/^ *:-+: *$/.test(item.align[i])) {\n              item.align[i] = 'center';\n            } else if (/^ *:-+ *$/.test(item.align[i])) {\n              item.align[i] = 'left';\n            } else {\n              item.align[i] = null;\n            }\n          }\n\n          l = item.cells.length;\n\n          for (i = 0; i < l; i++) {\n            item.cells[i] = splitCells$1(item.cells[i], item.header.length);\n          }\n\n          return item;\n        }\n      }\n    };\n\n    _proto.hr = function hr(src) {\n      var cap = this.rules.block.hr.exec(src);\n\n      if (cap) {\n        return {\n          type: 'hr',\n          raw: cap[0]\n        };\n      }\n    };\n\n    _proto.blockquote = function blockquote(src) {\n      var cap = this.rules.block.blockquote.exec(src);\n\n      if (cap) {\n        var text = cap[0].replace(/^ *> ?/gm, '');\n        return {\n          type: 'blockquote',\n          raw: cap[0],\n          text: text\n        };\n      }\n    };\n\n    _proto.list = function list(src) {\n      var cap = this.rules.block.list.exec(src);\n\n      if (cap) {\n        var raw = cap[0];\n        var bull = cap[2];\n        var isordered = bull.length > 1;\n        var list = {\n          type: 'list',\n          raw: raw,\n          ordered: isordered,\n          start: isordered ? +bull.slice(0, -1) : '',\n          loose: false,\n          items: []\n        }; // Get each top-level item.\n\n        var itemMatch = cap[0].match(this.rules.block.item);\n        var next = false,\n            item,\n            space,\n            bcurr,\n            bnext,\n            addBack,\n            loose,\n            istask,\n            ischecked;\n        var l = itemMatch.length;\n        bcurr = this.rules.block.listItemStart.exec(itemMatch[0]);\n\n        for (var i = 0; i < l; i++) {\n          item = itemMatch[i];\n          raw = item; // Determine whether the next list item belongs here.\n          // Backpedal if it does not belong in this list.\n\n          if (i !== l - 1) {\n            bnext = this.rules.block.listItemStart.exec(itemMatch[i + 1]);\n\n            if (!this.options.pedantic ? bnext[1].length > bcurr[0].length || bnext[1].length > 3 : bnext[1].length > bcurr[1].length) {\n              // nested list\n              itemMatch.splice(i, 2, itemMatch[i] + '\\n' + itemMatch[i + 1]);\n              i--;\n              l--;\n              continue;\n            } else {\n              if ( // different bullet style\n              !this.options.pedantic || this.options.smartLists ? bnext[2][bnext[2].length - 1] !== bull[bull.length - 1] : isordered === (bnext[2].length === 1)) {\n                addBack = itemMatch.slice(i + 1).join('\\n');\n                list.raw = list.raw.substring(0, list.raw.length - addBack.length);\n                i = l - 1;\n              }\n            }\n\n            bcurr = bnext;\n          } // Remove the list item's bullet\n          // so it is seen as the next token.\n\n\n          space = item.length;\n          item = item.replace(/^ *([*+-]|\\d+[.)]) ?/, ''); // Outdent whatever the\n          // list item contains. Hacky.\n\n          if (~item.indexOf('\\n ')) {\n            space -= item.length;\n            item = !this.options.pedantic ? item.replace(new RegExp('^ {1,' + space + '}', 'gm'), '') : item.replace(/^ {1,4}/gm, '');\n          } // Determine whether item is loose or not.\n          // Use: /(^|\\n)(?! )[^\\n]+\\n\\n(?!\\s*$)/\n          // for discount behavior.\n\n\n          loose = next || /\\n\\n(?!\\s*$)/.test(item);\n\n          if (i !== l - 1) {\n            next = item.charAt(item.length - 1) === '\\n';\n            if (!loose) loose = next;\n          }\n\n          if (loose) {\n            list.loose = true;\n          } // Check for task list items\n\n\n          if (this.options.gfm) {\n            istask = /^\\[[ xX]\\] /.test(item);\n            ischecked = undefined;\n\n            if (istask) {\n              ischecked = item[1] !== ' ';\n              item = item.replace(/^\\[[ xX]\\] +/, '');\n            }\n          }\n\n          list.items.push({\n            type: 'list_item',\n            raw: raw,\n            task: istask,\n            checked: ischecked,\n            loose: loose,\n            text: item\n          });\n        }\n\n        return list;\n      }\n    };\n\n    _proto.html = function html(src) {\n      var cap = this.rules.block.html.exec(src);\n\n      if (cap) {\n        return {\n          type: this.options.sanitize ? 'paragraph' : 'html',\n          raw: cap[0],\n          pre: !this.options.sanitizer && (cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style'),\n          text: this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : _escape(cap[0]) : cap[0]\n        };\n      }\n    };\n\n    _proto.def = function def(src) {\n      var cap = this.rules.block.def.exec(src);\n\n      if (cap) {\n        if (cap[3]) cap[3] = cap[3].substring(1, cap[3].length - 1);\n        var tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n        return {\n          tag: tag,\n          raw: cap[0],\n          href: cap[2],\n          title: cap[3]\n        };\n      }\n    };\n\n    _proto.table = function table(src) {\n      var cap = this.rules.block.table.exec(src);\n\n      if (cap) {\n        var item = {\n          type: 'table',\n          header: splitCells$1(cap[1].replace(/^ *| *\\| *$/g, '')),\n          align: cap[2].replace(/^ *|\\| *$/g, '').split(/ *\\| */),\n          cells: cap[3] ? cap[3].replace(/\\n$/, '').split('\\n') : []\n        };\n\n        if (item.header.length === item.align.length) {\n          item.raw = cap[0];\n          var l = item.align.length;\n          var i;\n\n          for (i = 0; i < l; i++) {\n            if (/^ *-+: *$/.test(item.align[i])) {\n              item.align[i] = 'right';\n            } else if (/^ *:-+: *$/.test(item.align[i])) {\n              item.align[i] = 'center';\n            } else if (/^ *:-+ *$/.test(item.align[i])) {\n              item.align[i] = 'left';\n            } else {\n              item.align[i] = null;\n            }\n          }\n\n          l = item.cells.length;\n\n          for (i = 0; i < l; i++) {\n            item.cells[i] = splitCells$1(item.cells[i].replace(/^ *\\| *| *\\| *$/g, ''), item.header.length);\n          }\n\n          return item;\n        }\n      }\n    };\n\n    _proto.lheading = function lheading(src) {\n      var cap = this.rules.block.lheading.exec(src);\n\n      if (cap) {\n        return {\n          type: 'heading',\n          raw: cap[0],\n          depth: cap[2].charAt(0) === '=' ? 1 : 2,\n          text: cap[1]\n        };\n      }\n    };\n\n    _proto.paragraph = function paragraph(src) {\n      var cap = this.rules.block.paragraph.exec(src);\n\n      if (cap) {\n        return {\n          type: 'paragraph',\n          raw: cap[0],\n          text: cap[1].charAt(cap[1].length - 1) === '\\n' ? cap[1].slice(0, -1) : cap[1]\n        };\n      }\n    };\n\n    _proto.text = function text(src) {\n      var cap = this.rules.block.text.exec(src);\n\n      if (cap) {\n        return {\n          type: 'text',\n          raw: cap[0],\n          text: cap[0]\n        };\n      }\n    };\n\n    _proto.escape = function escape(src) {\n      var cap = this.rules.inline.escape.exec(src);\n\n      if (cap) {\n        return {\n          type: 'escape',\n          raw: cap[0],\n          text: _escape(cap[1])\n        };\n      }\n    };\n\n    _proto.tag = function tag(src, inLink, inRawBlock) {\n      var cap = this.rules.inline.tag.exec(src);\n\n      if (cap) {\n        if (!inLink && /^<a /i.test(cap[0])) {\n          inLink = true;\n        } else if (inLink && /^<\\/a>/i.test(cap[0])) {\n          inLink = false;\n        }\n\n        if (!inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n          inRawBlock = true;\n        } else if (inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n          inRawBlock = false;\n        }\n\n        return {\n          type: this.options.sanitize ? 'text' : 'html',\n          raw: cap[0],\n          inLink: inLink,\n          inRawBlock: inRawBlock,\n          text: this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : _escape(cap[0]) : cap[0]\n        };\n      }\n    };\n\n    _proto.link = function link(src) {\n      var cap = this.rules.inline.link.exec(src);\n\n      if (cap) {\n        var trimmedUrl = cap[2].trim();\n\n        if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n          // commonmark requires matching angle brackets\n          if (!/>$/.test(trimmedUrl)) {\n            return;\n          } // ending angle bracket cannot be escaped\n\n\n          var rtrimSlash = rtrim$1(trimmedUrl.slice(0, -1), '\\\\');\n\n          if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n            return;\n          }\n        } else {\n          // find closing parenthesis\n          var lastParenIndex = findClosingBracket$1(cap[2], '()');\n\n          if (lastParenIndex > -1) {\n            var start = cap[0].indexOf('!') === 0 ? 5 : 4;\n            var linkLen = start + cap[1].length + lastParenIndex;\n            cap[2] = cap[2].substring(0, lastParenIndex);\n            cap[0] = cap[0].substring(0, linkLen).trim();\n            cap[3] = '';\n          }\n        }\n\n        var href = cap[2];\n        var title = '';\n\n        if (this.options.pedantic) {\n          // split pedantic href and title\n          var link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n\n          if (link) {\n            href = link[1];\n            title = link[3];\n          }\n        } else {\n          title = cap[3] ? cap[3].slice(1, -1) : '';\n        }\n\n        href = href.trim();\n\n        if (/^</.test(href)) {\n          if (this.options.pedantic && !/>$/.test(trimmedUrl)) {\n            // pedantic allows starting angle bracket without ending angle bracket\n            href = href.slice(1);\n          } else {\n            href = href.slice(1, -1);\n          }\n        }\n\n        return outputLink(cap, {\n          href: href ? href.replace(this.rules.inline._escapes, '$1') : href,\n          title: title ? title.replace(this.rules.inline._escapes, '$1') : title\n        }, cap[0]);\n      }\n    };\n\n    _proto.reflink = function reflink(src, links) {\n      var cap;\n\n      if ((cap = this.rules.inline.reflink.exec(src)) || (cap = this.rules.inline.nolink.exec(src))) {\n        var link = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n        link = links[link.toLowerCase()];\n\n        if (!link || !link.href) {\n          var text = cap[0].charAt(0);\n          return {\n            type: 'text',\n            raw: text,\n            text: text\n          };\n        }\n\n        return outputLink(cap, link, cap[0]);\n      }\n    };\n\n    _proto.emStrong = function emStrong(src, maskedSrc, prevChar) {\n      if (prevChar === void 0) {\n        prevChar = '';\n      }\n\n      var match = this.rules.inline.emStrong.lDelim.exec(src);\n      if (!match) return;\n      if (match[3] && prevChar.match(/(?:[0-9A-Za-z\\xAA\\xB2\\xB3\\xB5\\xB9\\xBA\\xBC-\\xBE\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0560-\\u0588\\u05D0-\\u05EA\\u05EF-\\u05F2\\u0620-\\u064A\\u0660-\\u0669\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07C0-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u0860-\\u086A\\u08A0-\\u08B4\\u08B6-\\u08C7\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0966-\\u096F\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09E6-\\u09F1\\u09F4-\\u09F9\\u09FC\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A6F\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0AE6-\\u0AEF\\u0AF9\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B66-\\u0B6F\\u0B71-\\u0B77\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0BE6-\\u0BF2\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58-\\u0C5A\\u0C60\\u0C61\\u0C66-\\u0C6F\\u0C78-\\u0C7E\\u0C80\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D04-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D54-\\u0D56\\u0D58-\\u0D61\\u0D66-\\u0D78\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DE6-\\u0DEF\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E86-\\u0E8A\\u0E8C-\\u0EA3\\u0EA5\\u0EA7-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F20-\\u0F33\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F-\\u1049\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u1090-\\u1099\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1369-\\u137C\\u1380-\\u138F\\u13A0-\\u13F5\\u13F8-\\u13FD\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u17E0-\\u17E9\\u17F0-\\u17F9\\u1810-\\u1819\\u1820-\\u1878\\u1880-\\u1884\\u1887-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19DA\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B50-\\u1B59\\u1B83-\\u1BA0\\u1BAE-\\u1BE5\\u1C00-\\u1C23\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1C80-\\u1C88\\u1C90-\\u1CBA\\u1CBD-\\u1CBF\\u1CE9-\\u1CEC\\u1CEE-\\u1CF3\\u1CF5\\u1CF6\\u1CFA\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2070\\u2071\\u2074-\\u2079\\u207F-\\u2089\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2150-\\u2189\\u2460-\\u249B\\u24EA-\\u24FF\\u2776-\\u2793\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2CFD\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312F\\u3131-\\u318E\\u3192-\\u3195\\u31A0-\\u31BF\\u31F0-\\u31FF\\u3220-\\u3229\\u3248-\\u324F\\u3251-\\u325F\\u3280-\\u3289\\u32B1-\\u32BF\\u3400-\\u4DBF\\u4E00-\\u9FFC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA7BF\\uA7C2-\\uA7CA\\uA7F5-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA830-\\uA835\\uA840-\\uA873\\uA882-\\uA8B3\\uA8D0-\\uA8D9\\uA8F2-\\uA8F7\\uA8FB\\uA8FD\\uA8FE\\uA900-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF-\\uA9D9\\uA9E0-\\uA9E4\\uA9E6-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB69\\uAB70-\\uABE2\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]|\\uD800[\\uDC00-\\uDC0B\\uDC0D-\\uDC26\\uDC28-\\uDC3A\\uDC3C\\uDC3D\\uDC3F-\\uDC4D\\uDC50-\\uDC5D\\uDC80-\\uDCFA\\uDD07-\\uDD33\\uDD40-\\uDD78\\uDD8A\\uDD8B\\uDE80-\\uDE9C\\uDEA0-\\uDED0\\uDEE1-\\uDEFB\\uDF00-\\uDF23\\uDF2D-\\uDF4A\\uDF50-\\uDF75\\uDF80-\\uDF9D\\uDFA0-\\uDFC3\\uDFC8-\\uDFCF\\uDFD1-\\uDFD5]|\\uD801[\\uDC00-\\uDC9D\\uDCA0-\\uDCA9\\uDCB0-\\uDCD3\\uDCD8-\\uDCFB\\uDD00-\\uDD27\\uDD30-\\uDD63\\uDE00-\\uDF36\\uDF40-\\uDF55\\uDF60-\\uDF67]|\\uD802[\\uDC00-\\uDC05\\uDC08\\uDC0A-\\uDC35\\uDC37\\uDC38\\uDC3C\\uDC3F-\\uDC55\\uDC58-\\uDC76\\uDC79-\\uDC9E\\uDCA7-\\uDCAF\\uDCE0-\\uDCF2\\uDCF4\\uDCF5\\uDCFB-\\uDD1B\\uDD20-\\uDD39\\uDD80-\\uDDB7\\uDDBC-\\uDDCF\\uDDD2-\\uDE00\\uDE10-\\uDE13\\uDE15-\\uDE17\\uDE19-\\uDE35\\uDE40-\\uDE48\\uDE60-\\uDE7E\\uDE80-\\uDE9F\\uDEC0-\\uDEC7\\uDEC9-\\uDEE4\\uDEEB-\\uDEEF\\uDF00-\\uDF35\\uDF40-\\uDF55\\uDF58-\\uDF72\\uDF78-\\uDF91\\uDFA9-\\uDFAF]|\\uD803[\\uDC00-\\uDC48\\uDC80-\\uDCB2\\uDCC0-\\uDCF2\\uDCFA-\\uDD23\\uDD30-\\uDD39\\uDE60-\\uDE7E\\uDE80-\\uDEA9\\uDEB0\\uDEB1\\uDF00-\\uDF27\\uDF30-\\uDF45\\uDF51-\\uDF54\\uDFB0-\\uDFCB\\uDFE0-\\uDFF6]|\\uD804[\\uDC03-\\uDC37\\uDC52-\\uDC6F\\uDC83-\\uDCAF\\uDCD0-\\uDCE8\\uDCF0-\\uDCF9\\uDD03-\\uDD26\\uDD36-\\uDD3F\\uDD44\\uDD47\\uDD50-\\uDD72\\uDD76\\uDD83-\\uDDB2\\uDDC1-\\uDDC4\\uDDD0-\\uDDDA\\uDDDC\\uDDE1-\\uDDF4\\uDE00-\\uDE11\\uDE13-\\uDE2B\\uDE80-\\uDE86\\uDE88\\uDE8A-\\uDE8D\\uDE8F-\\uDE9D\\uDE9F-\\uDEA8\\uDEB0-\\uDEDE\\uDEF0-\\uDEF9\\uDF05-\\uDF0C\\uDF0F\\uDF10\\uDF13-\\uDF28\\uDF2A-\\uDF30\\uDF32\\uDF33\\uDF35-\\uDF39\\uDF3D\\uDF50\\uDF5D-\\uDF61]|\\uD805[\\uDC00-\\uDC34\\uDC47-\\uDC4A\\uDC50-\\uDC59\\uDC5F-\\uDC61\\uDC80-\\uDCAF\\uDCC4\\uDCC5\\uDCC7\\uDCD0-\\uDCD9\\uDD80-\\uDDAE\\uDDD8-\\uDDDB\\uDE00-\\uDE2F\\uDE44\\uDE50-\\uDE59\\uDE80-\\uDEAA\\uDEB8\\uDEC0-\\uDEC9\\uDF00-\\uDF1A\\uDF30-\\uDF3B]|\\uD806[\\uDC00-\\uDC2B\\uDCA0-\\uDCF2\\uDCFF-\\uDD06\\uDD09\\uDD0C-\\uDD13\\uDD15\\uDD16\\uDD18-\\uDD2F\\uDD3F\\uDD41\\uDD50-\\uDD59\\uDDA0-\\uDDA7\\uDDAA-\\uDDD0\\uDDE1\\uDDE3\\uDE00\\uDE0B-\\uDE32\\uDE3A\\uDE50\\uDE5C-\\uDE89\\uDE9D\\uDEC0-\\uDEF8]|\\uD807[\\uDC00-\\uDC08\\uDC0A-\\uDC2E\\uDC40\\uDC50-\\uDC6C\\uDC72-\\uDC8F\\uDD00-\\uDD06\\uDD08\\uDD09\\uDD0B-\\uDD30\\uDD46\\uDD50-\\uDD59\\uDD60-\\uDD65\\uDD67\\uDD68\\uDD6A-\\uDD89\\uDD98\\uDDA0-\\uDDA9\\uDEE0-\\uDEF2\\uDFB0\\uDFC0-\\uDFD4]|\\uD808[\\uDC00-\\uDF99]|\\uD809[\\uDC00-\\uDC6E\\uDC80-\\uDD43]|[\\uD80C\\uD81C-\\uD820\\uD822\\uD840-\\uD868\\uD86A-\\uD86C\\uD86F-\\uD872\\uD874-\\uD879\\uD880-\\uD883][\\uDC00-\\uDFFF]|\\uD80D[\\uDC00-\\uDC2E]|\\uD811[\\uDC00-\\uDE46]|\\uD81A[\\uDC00-\\uDE38\\uDE40-\\uDE5E\\uDE60-\\uDE69\\uDED0-\\uDEED\\uDF00-\\uDF2F\\uDF40-\\uDF43\\uDF50-\\uDF59\\uDF5B-\\uDF61\\uDF63-\\uDF77\\uDF7D-\\uDF8F]|\\uD81B[\\uDE40-\\uDE96\\uDF00-\\uDF4A\\uDF50\\uDF93-\\uDF9F\\uDFE0\\uDFE1\\uDFE3]|\\uD821[\\uDC00-\\uDFF7]|\\uD823[\\uDC00-\\uDCD5\\uDD00-\\uDD08]|\\uD82C[\\uDC00-\\uDD1E\\uDD50-\\uDD52\\uDD64-\\uDD67\\uDD70-\\uDEFB]|\\uD82F[\\uDC00-\\uDC6A\\uDC70-\\uDC7C\\uDC80-\\uDC88\\uDC90-\\uDC99]|\\uD834[\\uDEE0-\\uDEF3\\uDF60-\\uDF78]|\\uD835[\\uDC00-\\uDC54\\uDC56-\\uDC9C\\uDC9E\\uDC9F\\uDCA2\\uDCA5\\uDCA6\\uDCA9-\\uDCAC\\uDCAE-\\uDCB9\\uDCBB\\uDCBD-\\uDCC3\\uDCC5-\\uDD05\\uDD07-\\uDD0A\\uDD0D-\\uDD14\\uDD16-\\uDD1C\\uDD1E-\\uDD39\\uDD3B-\\uDD3E\\uDD40-\\uDD44\\uDD46\\uDD4A-\\uDD50\\uDD52-\\uDEA5\\uDEA8-\\uDEC0\\uDEC2-\\uDEDA\\uDEDC-\\uDEFA\\uDEFC-\\uDF14\\uDF16-\\uDF34\\uDF36-\\uDF4E\\uDF50-\\uDF6E\\uDF70-\\uDF88\\uDF8A-\\uDFA8\\uDFAA-\\uDFC2\\uDFC4-\\uDFCB\\uDFCE-\\uDFFF]|\\uD838[\\uDD00-\\uDD2C\\uDD37-\\uDD3D\\uDD40-\\uDD49\\uDD4E\\uDEC0-\\uDEEB\\uDEF0-\\uDEF9]|\\uD83A[\\uDC00-\\uDCC4\\uDCC7-\\uDCCF\\uDD00-\\uDD43\\uDD4B\\uDD50-\\uDD59]|\\uD83B[\\uDC71-\\uDCAB\\uDCAD-\\uDCAF\\uDCB1-\\uDCB4\\uDD01-\\uDD2D\\uDD2F-\\uDD3D\\uDE00-\\uDE03\\uDE05-\\uDE1F\\uDE21\\uDE22\\uDE24\\uDE27\\uDE29-\\uDE32\\uDE34-\\uDE37\\uDE39\\uDE3B\\uDE42\\uDE47\\uDE49\\uDE4B\\uDE4D-\\uDE4F\\uDE51\\uDE52\\uDE54\\uDE57\\uDE59\\uDE5B\\uDE5D\\uDE5F\\uDE61\\uDE62\\uDE64\\uDE67-\\uDE6A\\uDE6C-\\uDE72\\uDE74-\\uDE77\\uDE79-\\uDE7C\\uDE7E\\uDE80-\\uDE89\\uDE8B-\\uDE9B\\uDEA1-\\uDEA3\\uDEA5-\\uDEA9\\uDEAB-\\uDEBB]|\\uD83C[\\uDD00-\\uDD0C]|\\uD83E[\\uDFF0-\\uDFF9]|\\uD869[\\uDC00-\\uDEDD\\uDF00-\\uDFFF]|\\uD86D[\\uDC00-\\uDF34\\uDF40-\\uDFFF]|\\uD86E[\\uDC00-\\uDC1D\\uDC20-\\uDFFF]|\\uD873[\\uDC00-\\uDEA1\\uDEB0-\\uDFFF]|\\uD87A[\\uDC00-\\uDFE0]|\\uD87E[\\uDC00-\\uDE1D]|\\uD884[\\uDC00-\\uDF4A])/)) return; // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n\n      var nextChar = match[1] || match[2] || '';\n\n      if (!nextChar || nextChar && (prevChar === '' || this.rules.inline.punctuation.exec(prevChar))) {\n        var lLength = match[0].length - 1;\n        var rDelim,\n            rLength,\n            delimTotal = lLength,\n            midDelimTotal = 0;\n        var endReg = match[0][0] === '*' ? this.rules.inline.emStrong.rDelimAst : this.rules.inline.emStrong.rDelimUnd;\n        endReg.lastIndex = 0;\n        maskedSrc = maskedSrc.slice(-1 * src.length + lLength); // Bump maskedSrc to same section of string as src (move to lexer?)\n\n        while ((match = endReg.exec(maskedSrc)) != null) {\n          rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n          if (!rDelim) continue; // matched the first alternative in rules.js (skip the * in __abc*abc__)\n\n          rLength = rDelim.length;\n\n          if (match[3] || match[4]) {\n            // found another Left Delim\n            delimTotal += rLength;\n            continue;\n          } else if (match[5] || match[6]) {\n            // either Left or Right Delim\n            if (lLength % 3 && !((lLength + rLength) % 3)) {\n              midDelimTotal += rLength;\n              continue; // CommonMark Emphasis Rules 9-10\n            }\n          }\n\n          delimTotal -= rLength;\n          if (delimTotal > 0) continue; // Haven't found enough closing delimiters\n          // If this is the last rDelimiter, remove extra characters. *a*** -> *a*\n\n          if (delimTotal + midDelimTotal - rLength <= 0 && !maskedSrc.slice(endReg.lastIndex).match(endReg)) {\n            rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\n          }\n\n          if (Math.min(lLength, rLength) % 2) {\n            return {\n              type: 'em',\n              raw: src.slice(0, lLength + match.index + rLength + 1),\n              text: src.slice(1, lLength + match.index + rLength)\n            };\n          }\n\n          if (Math.min(lLength, rLength) % 2 === 0) {\n            return {\n              type: 'strong',\n              raw: src.slice(0, lLength + match.index + rLength + 1),\n              text: src.slice(2, lLength + match.index + rLength - 1)\n            };\n          }\n        }\n      }\n    };\n\n    _proto.codespan = function codespan(src) {\n      var cap = this.rules.inline.code.exec(src);\n\n      if (cap) {\n        var text = cap[2].replace(/\\n/g, ' ');\n        var hasNonSpaceChars = /[^ ]/.test(text);\n        var hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n\n        if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n          text = text.substring(1, text.length - 1);\n        }\n\n        text = _escape(text, true);\n        return {\n          type: 'codespan',\n          raw: cap[0],\n          text: text\n        };\n      }\n    };\n\n    _proto.br = function br(src) {\n      var cap = this.rules.inline.br.exec(src);\n\n      if (cap) {\n        return {\n          type: 'br',\n          raw: cap[0]\n        };\n      }\n    };\n\n    _proto.del = function del(src) {\n      var cap = this.rules.inline.del.exec(src);\n\n      if (cap) {\n        return {\n          type: 'del',\n          raw: cap[0],\n          text: cap[2]\n        };\n      }\n    };\n\n    _proto.autolink = function autolink(src, mangle) {\n      var cap = this.rules.inline.autolink.exec(src);\n\n      if (cap) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[1]) : cap[1]);\n          href = 'mailto:' + text;\n        } else {\n          text = _escape(cap[1]);\n          href = text;\n        }\n\n        return {\n          type: 'link',\n          raw: cap[0],\n          text: text,\n          href: href,\n          tokens: [{\n            type: 'text',\n            raw: text,\n            text: text\n          }]\n        };\n      }\n    };\n\n    _proto.url = function url(src, mangle) {\n      var cap;\n\n      if (cap = this.rules.inline.url.exec(src)) {\n        var text, href;\n\n        if (cap[2] === '@') {\n          text = _escape(this.options.mangle ? mangle(cap[0]) : cap[0]);\n          href = 'mailto:' + text;\n        } else {\n          // do extended autolink path validation\n          var prevCapZero;\n\n          do {\n            prevCapZero = cap[0];\n            cap[0] = this.rules.inline._backpedal.exec(cap[0])[0];\n          } while (prevCapZero !== cap[0]);\n\n          text = _escape(cap[0]);\n\n          if (cap[1] === 'www.') {\n            href = 'http://' + text;\n          } else {\n            href = text;\n          }\n        }\n\n        return {\n          type: 'link',\n          raw: cap[0],\n          text: text,\n          href: href,\n          tokens: [{\n            type: 'text',\n            raw: text,\n            text: text\n          }]\n        };\n      }\n    };\n\n    _proto.inlineText = function inlineText(src, inRawBlock, smartypants) {\n      var cap = this.rules.inline.text.exec(src);\n\n      if (cap) {\n        var text;\n\n        if (inRawBlock) {\n          text = this.options.sanitize ? this.options.sanitizer ? this.options.sanitizer(cap[0]) : _escape(cap[0]) : cap[0];\n        } else {\n          text = _escape(this.options.smartypants ? smartypants(cap[0]) : cap[0]);\n        }\n\n        return {\n          type: 'text',\n          raw: cap[0],\n          text: text\n        };\n      }\n    };\n\n    return Tokenizer;\n  }();\n\n  var noopTest$1 = helpers.noopTest,\n      edit$1 = helpers.edit,\n      merge$1 = helpers.merge;\n  /**\n   * Block-Level Grammar\n   */\n\n  var block = {\n    newline: /^(?: *(?:\\n|$))+/,\n    code: /^( {4}[^\\n]+(?:\\n(?: *(?:\\n|$))*)?)+/,\n    fences: /^ {0,3}(`{3,}(?=[^`\\n]*\\n)|~{3,})([^\\n]*)\\n(?:|([\\s\\S]*?)\\n)(?: {0,3}\\1[~`]* *(?:\\n+|$)|$)/,\n    hr: /^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)/,\n    heading: /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/,\n    blockquote: /^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/,\n    list: /^( {0,3})(bull) [\\s\\S]+?(?:hr|def|\\n{2,}(?! )(?! {0,3}bull )\\n*|\\s*$)/,\n    html: '^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (6)\n    + '|<(?!script|pre|style)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (7) open tag\n    + '|</(?!script|pre|style)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:\\\\n{2,}|$)' // (7) closing tag\n    + ')',\n    def: /^ {0,3}\\[(label)\\]: *\\n? *<?([^\\s>]+)>?(?:(?: +\\n? *| *\\n *)(title))? *(?:\\n+|$)/,\n    nptable: noopTest$1,\n    table: noopTest$1,\n    lheading: /^([^\\n]+)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    // regex template, placeholders will be replaced according to different paragraph\n    // interruption rules of commonmark and the original markdown spec:\n    _paragraph: /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html| +\\n)[^\\n]+)*)/,\n    text: /^[^\\n]+/\n  };\n  block._label = /(?!\\s*\\])(?:\\\\[\\[\\]]|[^\\[\\]])+/;\n  block._title = /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/;\n  block.def = edit$1(block.def).replace('label', block._label).replace('title', block._title).getRegex();\n  block.bullet = /(?:[*+-]|\\d{1,9}[.)])/;\n  block.item = /^( *)(bull) ?[^\\n]*(?:\\n(?! *bull ?)[^\\n]*)*/;\n  block.item = edit$1(block.item, 'gm').replace(/bull/g, block.bullet).getRegex();\n  block.listItemStart = edit$1(/^( *)(bull)/).replace('bull', block.bullet).getRegex();\n  block.list = edit$1(block.list).replace(/bull/g, block.bullet).replace('hr', '\\\\n+(?=\\\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$))').replace('def', '\\\\n+(?=' + block.def.source + ')').getRegex();\n  block._tag = 'address|article|aside|base|basefont|blockquote|body|caption' + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption' + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe' + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option' + '|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr' + '|track|ul';\n  block._comment = /<!--(?!-?>)[\\s\\S]*?(?:-->|$)/;\n  block.html = edit$1(block.html, 'i').replace('comment', block._comment).replace('tag', block._tag).replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/).getRegex();\n  block.paragraph = edit$1(block._paragraph).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('|lheading', '') // setex headings don't interrupt commonmark paragraphs\n  .replace('blockquote', ' {0,3}>').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|!--)').replace('tag', block._tag) // pars can be interrupted by type (6) html blocks\n  .getRegex();\n  block.blockquote = edit$1(block.blockquote).replace('paragraph', block.paragraph).getRegex();\n  /**\n   * Normal Block Grammar\n   */\n\n  block.normal = merge$1({}, block);\n  /**\n   * GFM Block Grammar\n   */\n\n  block.gfm = merge$1({}, block.normal, {\n    nptable: '^ *([^|\\\\n ].*\\\\|.*)\\\\n' // Header\n    + ' {0,3}([-:]+ *\\\\|[-| :]*)' // Align\n    + '(?:\\\\n((?:(?!\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)',\n    // Cells\n    table: '^ *\\\\|(.+)\\\\n' // Header\n    + ' {0,3}\\\\|?( *[-:]+[-| :]*)' // Align\n    + '(?:\\\\n *((?:(?!\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)' // Cells\n\n  });\n  block.gfm.nptable = edit$1(block.gfm.nptable).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('blockquote', ' {0,3}>').replace('code', ' {4}[^\\\\n]').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|!--)').replace('tag', block._tag) // tables can be interrupted by type (6) html blocks\n  .getRegex();\n  block.gfm.table = edit$1(block.gfm.table).replace('hr', block.hr).replace('heading', ' {0,3}#{1,6} ').replace('blockquote', ' {0,3}>').replace('code', ' {4}[^\\\\n]').replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n').replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n  .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|!--)').replace('tag', block._tag) // tables can be interrupted by type (6) html blocks\n  .getRegex();\n  /**\n   * Pedantic grammar (original John Gruber's loose markdown specification)\n   */\n\n  block.pedantic = merge$1({}, block.normal, {\n    html: edit$1('^ *(?:comment *(?:\\\\n|\\\\s*$)' + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n    + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))').replace('comment', block._comment).replace(/tag/g, '(?!(?:' + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub' + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)' + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b').getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest$1,\n    // fences not supported\n    paragraph: edit$1(block.normal._paragraph).replace('hr', block.hr).replace('heading', ' *#{1,6} *[^\\n]').replace('lheading', block.lheading).replace('blockquote', ' {0,3}>').replace('|fences', '').replace('|list', '').replace('|html', '').getRegex()\n  });\n  /**\n   * Inline-Level Grammar\n   */\n\n  var inline = {\n    escape: /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/,\n    autolink: /^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/,\n    url: noopTest$1,\n    tag: '^comment' + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>',\n    // CDATA section\n    link: /^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/,\n    reflink: /^!?\\[(label)\\]\\[(?!\\s*\\])((?:\\\\[\\[\\]]?|[^\\[\\]\\\\])+)\\]/,\n    nolink: /^!?\\[(?!\\s*\\])((?:\\[[^\\[\\]]*\\]|\\\\[\\[\\]]|[^\\[\\]])*)\\](?:\\[\\])?/,\n    reflinkSearch: 'reflink|nolink(?!\\\\()',\n    emStrong: {\n      lDelim: /^(?:\\*+(?:([punct_])|[^\\s*]))|^_+(?:([punct*])|([^\\s_]))/,\n      //        (1) and (2) can only be a Right Delimiter. (3) and (4) can only be Left.  (5) and (6) can be either Left or Right.\n      //        () Skip other delimiter (1) #***                (2) a***#, a***                   (3) #***a, ***a                 (4) ***#              (5) #***#                 (6) a***a\n      rDelimAst: /\\_\\_[^_]*?\\*[^_]*?\\_\\_|[punct_](\\*+)(?=[\\s]|$)|[^punct*_\\s](\\*+)(?=[punct_\\s]|$)|[punct_\\s](\\*+)(?=[^punct*_\\s])|[\\s](\\*+)(?=[punct_])|[punct_](\\*+)(?=[punct_])|[^punct*_\\s](\\*+)(?=[^punct*_\\s])/,\n      rDelimUnd: /\\*\\*[^*]*?\\_[^*]*?\\*\\*|[punct*](\\_+)(?=[\\s]|$)|[^punct*_\\s](\\_+)(?=[punct*\\s]|$)|[punct*\\s](\\_+)(?=[^punct*_\\s])|[\\s](\\_+)(?=[punct*])|[punct*](\\_+)(?=[punct*])/ // ^- Not allowed for _\n\n    },\n    code: /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/,\n    br: /^( {2,}|\\\\)\\n(?!\\s*$)/,\n    del: noopTest$1,\n    text: /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/,\n    punctuation: /^([\\spunctuation])/\n  }; // list of punctuation marks from CommonMark spec\n  // without * and _ to handle the different emphasis markers * and _\n\n  inline._punctuation = '!\"#$%&\\'()+\\\\-.,/:;<=>?@\\\\[\\\\]`^{|}~';\n  inline.punctuation = edit$1(inline.punctuation).replace(/punctuation/g, inline._punctuation).getRegex(); // sequences em should skip over [title](link), `code`, <html>\n\n  inline.blockSkip = /\\[[^\\]]*?\\]\\([^\\)]*?\\)|`[^`]*?`|<[^>]*?>/g;\n  inline.escapedEmSt = /\\\\\\*|\\\\_/g;\n  inline._comment = edit$1(block._comment).replace('(?:-->|$)', '-->').getRegex();\n  inline.emStrong.lDelim = edit$1(inline.emStrong.lDelim).replace(/punct/g, inline._punctuation).getRegex();\n  inline.emStrong.rDelimAst = edit$1(inline.emStrong.rDelimAst, 'g').replace(/punct/g, inline._punctuation).getRegex();\n  inline.emStrong.rDelimUnd = edit$1(inline.emStrong.rDelimUnd, 'g').replace(/punct/g, inline._punctuation).getRegex();\n  inline._escapes = /\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/g;\n  inline._scheme = /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;\n  inline._email = /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;\n  inline.autolink = edit$1(inline.autolink).replace('scheme', inline._scheme).replace('email', inline._email).getRegex();\n  inline._attribute = /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/;\n  inline.tag = edit$1(inline.tag).replace('comment', inline._comment).replace('attribute', inline._attribute).getRegex();\n  inline._label = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\n  inline._href = /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/;\n  inline._title = /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/;\n  inline.link = edit$1(inline.link).replace('label', inline._label).replace('href', inline._href).replace('title', inline._title).getRegex();\n  inline.reflink = edit$1(inline.reflink).replace('label', inline._label).getRegex();\n  inline.reflinkSearch = edit$1(inline.reflinkSearch, 'g').replace('reflink', inline.reflink).replace('nolink', inline.nolink).getRegex();\n  /**\n   * Normal Inline Grammar\n   */\n\n  inline.normal = merge$1({}, inline);\n  /**\n   * Pedantic Inline Grammar\n   */\n\n  inline.pedantic = merge$1({}, inline.normal, {\n    strong: {\n      start: /^__|\\*\\*/,\n      middle: /^__(?=\\S)([\\s\\S]*?\\S)__(?!_)|^\\*\\*(?=\\S)([\\s\\S]*?\\S)\\*\\*(?!\\*)/,\n      endAst: /\\*\\*(?!\\*)/g,\n      endUnd: /__(?!_)/g\n    },\n    em: {\n      start: /^_|\\*/,\n      middle: /^()\\*(?=\\S)([\\s\\S]*?\\S)\\*(?!\\*)|^_(?=\\S)([\\s\\S]*?\\S)_(?!_)/,\n      endAst: /\\*(?!\\*)/g,\n      endUnd: /_(?!_)/g\n    },\n    link: edit$1(/^!?\\[(label)\\]\\((.*?)\\)/).replace('label', inline._label).getRegex(),\n    reflink: edit$1(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/).replace('label', inline._label).getRegex()\n  });\n  /**\n   * GFM Inline Grammar\n   */\n\n  inline.gfm = merge$1({}, inline.normal, {\n    escape: edit$1(inline.escape).replace('])', '~|])').getRegex(),\n    _extended_email: /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,\n    url: /^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/,\n    _backpedal: /(?:[^?!.,:;*_~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@))|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@))/\n  });\n  inline.gfm.url = edit$1(inline.gfm.url, 'i').replace('email', inline.gfm._extended_email).getRegex();\n  /**\n   * GFM + Line Breaks Inline Grammar\n   */\n\n  inline.breaks = merge$1({}, inline.gfm, {\n    br: edit$1(inline.br).replace('{2,}', '*').getRegex(),\n    text: edit$1(inline.gfm.text).replace('\\\\b_', '\\\\b_| {2,}\\\\n').replace(/\\{2,\\}/g, '*').getRegex()\n  });\n  var rules = {\n    block: block,\n    inline: inline\n  };\n\n  var defaults$2 = defaults.defaults;\n  var block$1 = rules.block,\n      inline$1 = rules.inline;\n  var repeatString$1 = helpers.repeatString;\n  /**\n   * smartypants text replacement\n   */\n\n  function smartypants(text) {\n    return text // em-dashes\n    .replace(/---/g, \"\\u2014\") // en-dashes\n    .replace(/--/g, \"\\u2013\") // opening singles\n    .replace(/(^|[-\\u2014/(\\[{\"\\s])'/g, \"$1\\u2018\") // closing singles & apostrophes\n    .replace(/'/g, \"\\u2019\") // opening doubles\n    .replace(/(^|[-\\u2014/(\\[{\\u2018\\s])\"/g, \"$1\\u201C\") // closing doubles\n    .replace(/\"/g, \"\\u201D\") // ellipses\n    .replace(/\\.{3}/g, \"\\u2026\");\n  }\n  /**\n   * mangle email addresses\n   */\n\n\n  function mangle(text) {\n    var out = '',\n        i,\n        ch;\n    var l = text.length;\n\n    for (i = 0; i < l; i++) {\n      ch = text.charCodeAt(i);\n\n      if (Math.random() > 0.5) {\n        ch = 'x' + ch.toString(16);\n      }\n\n      out += '&#' + ch + ';';\n    }\n\n    return out;\n  }\n  /**\n   * Block Lexer\n   */\n\n\n  var Lexer_1 = /*#__PURE__*/function () {\n    function Lexer(options) {\n      this.tokens = [];\n      this.tokens.links = Object.create(null);\n      this.options = options || defaults$2;\n      this.options.tokenizer = this.options.tokenizer || new Tokenizer_1();\n      this.tokenizer = this.options.tokenizer;\n      this.tokenizer.options = this.options;\n      var rules = {\n        block: block$1.normal,\n        inline: inline$1.normal\n      };\n\n      if (this.options.pedantic) {\n        rules.block = block$1.pedantic;\n        rules.inline = inline$1.pedantic;\n      } else if (this.options.gfm) {\n        rules.block = block$1.gfm;\n\n        if (this.options.breaks) {\n          rules.inline = inline$1.breaks;\n        } else {\n          rules.inline = inline$1.gfm;\n        }\n      }\n\n      this.tokenizer.rules = rules;\n    }\n    /**\n     * Expose Rules\n     */\n\n\n    /**\n     * Static Lex Method\n     */\n    Lexer.lex = function lex(src, options) {\n      var lexer = new Lexer(options);\n      return lexer.lex(src);\n    }\n    /**\n     * Static Lex Inline Method\n     */\n    ;\n\n    Lexer.lexInline = function lexInline(src, options) {\n      var lexer = new Lexer(options);\n      return lexer.inlineTokens(src);\n    }\n    /**\n     * Preprocessing\n     */\n    ;\n\n    var _proto = Lexer.prototype;\n\n    _proto.lex = function lex(src) {\n      src = src.replace(/\\r\\n|\\r/g, '\\n').replace(/\\t/g, '    ');\n      this.blockTokens(src, this.tokens, true);\n      this.inline(this.tokens);\n      return this.tokens;\n    }\n    /**\n     * Lexing\n     */\n    ;\n\n    _proto.blockTokens = function blockTokens(src, tokens, top) {\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (top === void 0) {\n        top = true;\n      }\n\n      if (this.options.pedantic) {\n        src = src.replace(/^ +$/gm, '');\n      }\n\n      var token, i, l, lastToken;\n\n      while (src) {\n        // newline\n        if (token = this.tokenizer.space(src)) {\n          src = src.substring(token.raw.length);\n\n          if (token.type) {\n            tokens.push(token);\n          }\n\n          continue;\n        } // code\n\n\n        if (token = this.tokenizer.code(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1]; // An indented code block cannot interrupt a paragraph.\n\n          if (lastToken && lastToken.type === 'paragraph') {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // fences\n\n\n        if (token = this.tokenizer.fences(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // heading\n\n\n        if (token = this.tokenizer.heading(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // table no leading pipe (gfm)\n\n\n        if (token = this.tokenizer.nptable(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // hr\n\n\n        if (token = this.tokenizer.hr(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // blockquote\n\n\n        if (token = this.tokenizer.blockquote(src)) {\n          src = src.substring(token.raw.length);\n          token.tokens = this.blockTokens(token.text, [], top);\n          tokens.push(token);\n          continue;\n        } // list\n\n\n        if (token = this.tokenizer.list(src)) {\n          src = src.substring(token.raw.length);\n          l = token.items.length;\n\n          for (i = 0; i < l; i++) {\n            token.items[i].tokens = this.blockTokens(token.items[i].text, [], false);\n          }\n\n          tokens.push(token);\n          continue;\n        } // html\n\n\n        if (token = this.tokenizer.html(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // def\n\n\n        if (top && (token = this.tokenizer.def(src))) {\n          src = src.substring(token.raw.length);\n\n          if (!this.tokens.links[token.tag]) {\n            this.tokens.links[token.tag] = {\n              href: token.href,\n              title: token.title\n            };\n          }\n\n          continue;\n        } // table (gfm)\n\n\n        if (token = this.tokenizer.table(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // lheading\n\n\n        if (token = this.tokenizer.lheading(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // top-level paragraph\n\n\n        if (top && (token = this.tokenizer.paragraph(src))) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // text\n\n\n        if (token = this.tokenizer.text(src)) {\n          src = src.substring(token.raw.length);\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && lastToken.type === 'text') {\n            lastToken.raw += '\\n' + token.raw;\n            lastToken.text += '\\n' + token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        }\n\n        if (src) {\n          var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n\n          if (this.options.silent) {\n            console.error(errMsg);\n            break;\n          } else {\n            throw new Error(errMsg);\n          }\n        }\n      }\n\n      return tokens;\n    };\n\n    _proto.inline = function inline(tokens) {\n      var i, j, k, l2, row, token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'paragraph':\n          case 'text':\n          case 'heading':\n            {\n              token.tokens = [];\n              this.inlineTokens(token.text, token.tokens);\n              break;\n            }\n\n          case 'table':\n            {\n              token.tokens = {\n                header: [],\n                cells: []\n              }; // header\n\n              l2 = token.header.length;\n\n              for (j = 0; j < l2; j++) {\n                token.tokens.header[j] = [];\n                this.inlineTokens(token.header[j], token.tokens.header[j]);\n              } // cells\n\n\n              l2 = token.cells.length;\n\n              for (j = 0; j < l2; j++) {\n                row = token.cells[j];\n                token.tokens.cells[j] = [];\n\n                for (k = 0; k < row.length; k++) {\n                  token.tokens.cells[j][k] = [];\n                  this.inlineTokens(row[k], token.tokens.cells[j][k]);\n                }\n              }\n\n              break;\n            }\n\n          case 'blockquote':\n            {\n              this.inline(token.tokens);\n              break;\n            }\n\n          case 'list':\n            {\n              l2 = token.items.length;\n\n              for (j = 0; j < l2; j++) {\n                this.inline(token.items[j].tokens);\n              }\n\n              break;\n            }\n        }\n      }\n\n      return tokens;\n    }\n    /**\n     * Lexing/Compiling\n     */\n    ;\n\n    _proto.inlineTokens = function inlineTokens(src, tokens, inLink, inRawBlock) {\n      if (tokens === void 0) {\n        tokens = [];\n      }\n\n      if (inLink === void 0) {\n        inLink = false;\n      }\n\n      if (inRawBlock === void 0) {\n        inRawBlock = false;\n      }\n\n      var token, lastToken; // String with links masked to avoid interference with em and strong\n\n      var maskedSrc = src;\n      var match;\n      var keepPrevChar, prevChar; // Mask out reflinks\n\n      if (this.tokens.links) {\n        var links = Object.keys(this.tokens.links);\n\n        if (links.length > 0) {\n          while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n            if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n              maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString$1('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n            }\n          }\n        }\n      } // Mask out other blocks\n\n\n      while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n        maskedSrc = maskedSrc.slice(0, match.index) + '[' + repeatString$1('a', match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n      } // Mask out escaped em & strong delimiters\n\n\n      while ((match = this.tokenizer.rules.inline.escapedEmSt.exec(maskedSrc)) != null) {\n        maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);\n      }\n\n      while (src) {\n        if (!keepPrevChar) {\n          prevChar = '';\n        }\n\n        keepPrevChar = false; // escape\n\n        if (token = this.tokenizer.escape(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // tag\n\n\n        if (token = this.tokenizer.tag(src, inLink, inRawBlock)) {\n          src = src.substring(token.raw.length);\n          inLink = token.inLink;\n          inRawBlock = token.inRawBlock;\n          var _lastToken = tokens[tokens.length - 1];\n\n          if (_lastToken && token.type === 'text' && _lastToken.type === 'text') {\n            _lastToken.raw += token.raw;\n            _lastToken.text += token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // link\n\n\n        if (token = this.tokenizer.link(src)) {\n          src = src.substring(token.raw.length);\n\n          if (token.type === 'link') {\n            token.tokens = this.inlineTokens(token.text, [], true, inRawBlock);\n          }\n\n          tokens.push(token);\n          continue;\n        } // reflink, nolink\n\n\n        if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n          src = src.substring(token.raw.length);\n          var _lastToken2 = tokens[tokens.length - 1];\n\n          if (token.type === 'link') {\n            token.tokens = this.inlineTokens(token.text, [], true, inRawBlock);\n            tokens.push(token);\n          } else if (_lastToken2 && token.type === 'text' && _lastToken2.type === 'text') {\n            _lastToken2.raw += token.raw;\n            _lastToken2.text += token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        } // em & strong\n\n\n        if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n          src = src.substring(token.raw.length);\n          token.tokens = this.inlineTokens(token.text, [], inLink, inRawBlock);\n          tokens.push(token);\n          continue;\n        } // code\n\n\n        if (token = this.tokenizer.codespan(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // br\n\n\n        if (token = this.tokenizer.br(src)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // del (gfm)\n\n\n        if (token = this.tokenizer.del(src)) {\n          src = src.substring(token.raw.length);\n          token.tokens = this.inlineTokens(token.text, [], inLink, inRawBlock);\n          tokens.push(token);\n          continue;\n        } // autolink\n\n\n        if (token = this.tokenizer.autolink(src, mangle)) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // url (gfm)\n\n\n        if (!inLink && (token = this.tokenizer.url(src, mangle))) {\n          src = src.substring(token.raw.length);\n          tokens.push(token);\n          continue;\n        } // text\n\n\n        if (token = this.tokenizer.inlineText(src, inRawBlock, smartypants)) {\n          src = src.substring(token.raw.length);\n\n          if (token.raw.slice(-1) !== '_') {\n            // Track prevChar before string of ____ started\n            prevChar = token.raw.slice(-1);\n          }\n\n          keepPrevChar = true;\n          lastToken = tokens[tokens.length - 1];\n\n          if (lastToken && lastToken.type === 'text') {\n            lastToken.raw += token.raw;\n            lastToken.text += token.text;\n          } else {\n            tokens.push(token);\n          }\n\n          continue;\n        }\n\n        if (src) {\n          var errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n\n          if (this.options.silent) {\n            console.error(errMsg);\n            break;\n          } else {\n            throw new Error(errMsg);\n          }\n        }\n      }\n\n      return tokens;\n    };\n\n    _createClass(Lexer, null, [{\n      key: \"rules\",\n      get: function get() {\n        return {\n          block: block$1,\n          inline: inline$1\n        };\n      }\n    }]);\n\n    return Lexer;\n  }();\n\n  var defaults$3 = defaults.defaults;\n  var cleanUrl$1 = helpers.cleanUrl,\n      escape$1 = helpers.escape;\n  /**\n   * Renderer\n   */\n\n  var Renderer_1 = /*#__PURE__*/function () {\n    function Renderer(options) {\n      this.options = options || defaults$3;\n    }\n\n    var _proto = Renderer.prototype;\n\n    _proto.code = function code(_code, infostring, escaped) {\n      var lang = (infostring || '').match(/\\S*/)[0];\n\n      if (this.options.highlight) {\n        var out = this.options.highlight(_code, lang);\n\n        if (out != null && out !== _code) {\n          escaped = true;\n          _code = out;\n        }\n      }\n\n      _code = _code.replace(/\\n$/, '') + '\\n';\n\n      if (!lang) {\n        return '<pre><code>' + (escaped ? _code : escape$1(_code, true)) + '</code></pre>\\n';\n      }\n\n      return '<pre><code class=\"' + this.options.langPrefix + escape$1(lang, true) + '\">' + (escaped ? _code : escape$1(_code, true)) + '</code></pre>\\n';\n    };\n\n    _proto.blockquote = function blockquote(quote) {\n      return '<blockquote>\\n' + quote + '</blockquote>\\n';\n    };\n\n    _proto.html = function html(_html) {\n      return _html;\n    };\n\n    _proto.heading = function heading(text, level, raw, slugger) {\n      if (this.options.headerIds) {\n        return '<h' + level + ' id=\"' + this.options.headerPrefix + slugger.slug(raw) + '\">' + text + '</h' + level + '>\\n';\n      } // ignore IDs\n\n\n      return '<h' + level + '>' + text + '</h' + level + '>\\n';\n    };\n\n    _proto.hr = function hr() {\n      return this.options.xhtml ? '<hr/>\\n' : '<hr>\\n';\n    };\n\n    _proto.list = function list(body, ordered, start) {\n      var type = ordered ? 'ol' : 'ul',\n          startatt = ordered && start !== 1 ? ' start=\"' + start + '\"' : '';\n      return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n    };\n\n    _proto.listitem = function listitem(text) {\n      return '<li>' + text + '</li>\\n';\n    };\n\n    _proto.checkbox = function checkbox(checked) {\n      return '<input ' + (checked ? 'checked=\"\" ' : '') + 'disabled=\"\" type=\"checkbox\"' + (this.options.xhtml ? ' /' : '') + '> ';\n    };\n\n    _proto.paragraph = function paragraph(text) {\n      return '<p>' + text + '</p>\\n';\n    };\n\n    _proto.table = function table(header, body) {\n      if (body) body = '<tbody>' + body + '</tbody>';\n      return '<table>\\n' + '<thead>\\n' + header + '</thead>\\n' + body + '</table>\\n';\n    };\n\n    _proto.tablerow = function tablerow(content) {\n      return '<tr>\\n' + content + '</tr>\\n';\n    };\n\n    _proto.tablecell = function tablecell(content, flags) {\n      var type = flags.header ? 'th' : 'td';\n      var tag = flags.align ? '<' + type + ' align=\"' + flags.align + '\">' : '<' + type + '>';\n      return tag + content + '</' + type + '>\\n';\n    } // span level renderer\n    ;\n\n    _proto.strong = function strong(text) {\n      return '<strong>' + text + '</strong>';\n    };\n\n    _proto.em = function em(text) {\n      return '<em>' + text + '</em>';\n    };\n\n    _proto.codespan = function codespan(text) {\n      return '<code>' + text + '</code>';\n    };\n\n    _proto.br = function br() {\n      return this.options.xhtml ? '<br/>' : '<br>';\n    };\n\n    _proto.del = function del(text) {\n      return '<del>' + text + '</del>';\n    };\n\n    _proto.link = function link(href, title, text) {\n      href = cleanUrl$1(this.options.sanitize, this.options.baseUrl, href);\n\n      if (href === null) {\n        return text;\n      }\n\n      var out = '<a href=\"' + escape$1(href) + '\"';\n\n      if (title) {\n        out += ' title=\"' + title + '\"';\n      }\n\n      out += '>' + text + '</a>';\n      return out;\n    };\n\n    _proto.image = function image(href, title, text) {\n      href = cleanUrl$1(this.options.sanitize, this.options.baseUrl, href);\n\n      if (href === null) {\n        return text;\n      }\n\n      var out = '<img src=\"' + href + '\" alt=\"' + text + '\"';\n\n      if (title) {\n        out += ' title=\"' + title + '\"';\n      }\n\n      out += this.options.xhtml ? '/>' : '>';\n      return out;\n    };\n\n    _proto.text = function text(_text) {\n      return _text;\n    };\n\n    return Renderer;\n  }();\n\n  /**\n   * TextRenderer\n   * returns only the textual part of the token\n   */\n  var TextRenderer_1 = /*#__PURE__*/function () {\n    function TextRenderer() {}\n\n    var _proto = TextRenderer.prototype;\n\n    // no need for block level renderers\n    _proto.strong = function strong(text) {\n      return text;\n    };\n\n    _proto.em = function em(text) {\n      return text;\n    };\n\n    _proto.codespan = function codespan(text) {\n      return text;\n    };\n\n    _proto.del = function del(text) {\n      return text;\n    };\n\n    _proto.html = function html(text) {\n      return text;\n    };\n\n    _proto.text = function text(_text) {\n      return _text;\n    };\n\n    _proto.link = function link(href, title, text) {\n      return '' + text;\n    };\n\n    _proto.image = function image(href, title, text) {\n      return '' + text;\n    };\n\n    _proto.br = function br() {\n      return '';\n    };\n\n    return TextRenderer;\n  }();\n\n  /**\n   * Slugger generates header id\n   */\n  var Slugger_1 = /*#__PURE__*/function () {\n    function Slugger() {\n      this.seen = {};\n    }\n\n    var _proto = Slugger.prototype;\n\n    _proto.serialize = function serialize(value) {\n      return value.toLowerCase().trim() // remove html tags\n      .replace(/<[!\\/a-z].*?>/ig, '') // remove unwanted chars\n      .replace(/[\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,./:;<=>?@[\\]^`{|}~]/g, '').replace(/\\s/g, '-');\n    }\n    /**\n     * Finds the next safe (unique) slug to use\n     */\n    ;\n\n    _proto.getNextSafeSlug = function getNextSafeSlug(originalSlug, isDryRun) {\n      var slug = originalSlug;\n      var occurenceAccumulator = 0;\n\n      if (this.seen.hasOwnProperty(slug)) {\n        occurenceAccumulator = this.seen[originalSlug];\n\n        do {\n          occurenceAccumulator++;\n          slug = originalSlug + '-' + occurenceAccumulator;\n        } while (this.seen.hasOwnProperty(slug));\n      }\n\n      if (!isDryRun) {\n        this.seen[originalSlug] = occurenceAccumulator;\n        this.seen[slug] = 0;\n      }\n\n      return slug;\n    }\n    /**\n     * Convert string to unique id\n     * @param {object} options\n     * @param {boolean} options.dryrun Generates the next unique slug without updating the internal accumulator.\n     */\n    ;\n\n    _proto.slug = function slug(value, options) {\n      if (options === void 0) {\n        options = {};\n      }\n\n      var slug = this.serialize(value);\n      return this.getNextSafeSlug(slug, options.dryrun);\n    };\n\n    return Slugger;\n  }();\n\n  var defaults$4 = defaults.defaults;\n  var unescape$1 = helpers.unescape;\n  /**\n   * Parsing & Compiling\n   */\n\n  var Parser_1 = /*#__PURE__*/function () {\n    function Parser(options) {\n      this.options = options || defaults$4;\n      this.options.renderer = this.options.renderer || new Renderer_1();\n      this.renderer = this.options.renderer;\n      this.renderer.options = this.options;\n      this.textRenderer = new TextRenderer_1();\n      this.slugger = new Slugger_1();\n    }\n    /**\n     * Static Parse Method\n     */\n\n\n    Parser.parse = function parse(tokens, options) {\n      var parser = new Parser(options);\n      return parser.parse(tokens);\n    }\n    /**\n     * Static Parse Inline Method\n     */\n    ;\n\n    Parser.parseInline = function parseInline(tokens, options) {\n      var parser = new Parser(options);\n      return parser.parseInline(tokens);\n    }\n    /**\n     * Parse Loop\n     */\n    ;\n\n    var _proto = Parser.prototype;\n\n    _proto.parse = function parse(tokens, top) {\n      if (top === void 0) {\n        top = true;\n      }\n\n      var out = '',\n          i,\n          j,\n          k,\n          l2,\n          l3,\n          row,\n          cell,\n          header,\n          body,\n          token,\n          ordered,\n          start,\n          loose,\n          itemBody,\n          item,\n          checked,\n          task,\n          checkbox;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'space':\n            {\n              continue;\n            }\n\n          case 'hr':\n            {\n              out += this.renderer.hr();\n              continue;\n            }\n\n          case 'heading':\n            {\n              out += this.renderer.heading(this.parseInline(token.tokens), token.depth, unescape$1(this.parseInline(token.tokens, this.textRenderer)), this.slugger);\n              continue;\n            }\n\n          case 'code':\n            {\n              out += this.renderer.code(token.text, token.lang, token.escaped);\n              continue;\n            }\n\n          case 'table':\n            {\n              header = ''; // header\n\n              cell = '';\n              l2 = token.header.length;\n\n              for (j = 0; j < l2; j++) {\n                cell += this.renderer.tablecell(this.parseInline(token.tokens.header[j]), {\n                  header: true,\n                  align: token.align[j]\n                });\n              }\n\n              header += this.renderer.tablerow(cell);\n              body = '';\n              l2 = token.cells.length;\n\n              for (j = 0; j < l2; j++) {\n                row = token.tokens.cells[j];\n                cell = '';\n                l3 = row.length;\n\n                for (k = 0; k < l3; k++) {\n                  cell += this.renderer.tablecell(this.parseInline(row[k]), {\n                    header: false,\n                    align: token.align[k]\n                  });\n                }\n\n                body += this.renderer.tablerow(cell);\n              }\n\n              out += this.renderer.table(header, body);\n              continue;\n            }\n\n          case 'blockquote':\n            {\n              body = this.parse(token.tokens);\n              out += this.renderer.blockquote(body);\n              continue;\n            }\n\n          case 'list':\n            {\n              ordered = token.ordered;\n              start = token.start;\n              loose = token.loose;\n              l2 = token.items.length;\n              body = '';\n\n              for (j = 0; j < l2; j++) {\n                item = token.items[j];\n                checked = item.checked;\n                task = item.task;\n                itemBody = '';\n\n                if (item.task) {\n                  checkbox = this.renderer.checkbox(checked);\n\n                  if (loose) {\n                    if (item.tokens.length > 0 && item.tokens[0].type === 'text') {\n                      item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n\n                      if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                      }\n                    } else {\n                      item.tokens.unshift({\n                        type: 'text',\n                        text: checkbox\n                      });\n                    }\n                  } else {\n                    itemBody += checkbox;\n                  }\n                }\n\n                itemBody += this.parse(item.tokens, loose);\n                body += this.renderer.listitem(itemBody, task, checked);\n              }\n\n              out += this.renderer.list(body, ordered, start);\n              continue;\n            }\n\n          case 'html':\n            {\n              // TODO parse inline content if parameter markdown=1\n              out += this.renderer.html(token.text);\n              continue;\n            }\n\n          case 'paragraph':\n            {\n              out += this.renderer.paragraph(this.parseInline(token.tokens));\n              continue;\n            }\n\n          case 'text':\n            {\n              body = token.tokens ? this.parseInline(token.tokens) : token.text;\n\n              while (i + 1 < l && tokens[i + 1].type === 'text') {\n                token = tokens[++i];\n                body += '\\n' + (token.tokens ? this.parseInline(token.tokens) : token.text);\n              }\n\n              out += top ? this.renderer.paragraph(body) : body;\n              continue;\n            }\n\n          default:\n            {\n              var errMsg = 'Token with \"' + token.type + '\" type was not found.';\n\n              if (this.options.silent) {\n                console.error(errMsg);\n                return;\n              } else {\n                throw new Error(errMsg);\n              }\n            }\n        }\n      }\n\n      return out;\n    }\n    /**\n     * Parse Inline Tokens\n     */\n    ;\n\n    _proto.parseInline = function parseInline(tokens, renderer) {\n      renderer = renderer || this.renderer;\n      var out = '',\n          i,\n          token;\n      var l = tokens.length;\n\n      for (i = 0; i < l; i++) {\n        token = tokens[i];\n\n        switch (token.type) {\n          case 'escape':\n            {\n              out += renderer.text(token.text);\n              break;\n            }\n\n          case 'html':\n            {\n              out += renderer.html(token.text);\n              break;\n            }\n\n          case 'link':\n            {\n              out += renderer.link(token.href, token.title, this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'image':\n            {\n              out += renderer.image(token.href, token.title, token.text);\n              break;\n            }\n\n          case 'strong':\n            {\n              out += renderer.strong(this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'em':\n            {\n              out += renderer.em(this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'codespan':\n            {\n              out += renderer.codespan(token.text);\n              break;\n            }\n\n          case 'br':\n            {\n              out += renderer.br();\n              break;\n            }\n\n          case 'del':\n            {\n              out += renderer.del(this.parseInline(token.tokens, renderer));\n              break;\n            }\n\n          case 'text':\n            {\n              out += renderer.text(token.text);\n              break;\n            }\n\n          default:\n            {\n              var errMsg = 'Token with \"' + token.type + '\" type was not found.';\n\n              if (this.options.silent) {\n                console.error(errMsg);\n                return;\n              } else {\n                throw new Error(errMsg);\n              }\n            }\n        }\n      }\n\n      return out;\n    };\n\n    return Parser;\n  }();\n\n  var merge$2 = helpers.merge,\n      checkSanitizeDeprecation$1 = helpers.checkSanitizeDeprecation,\n      escape$2 = helpers.escape;\n  var getDefaults = defaults.getDefaults,\n      changeDefaults = defaults.changeDefaults,\n      defaults$5 = defaults.defaults;\n  /**\n   * Marked\n   */\n\n  function marked(src, opt, callback) {\n    // throw error in case of non string input\n    if (typeof src === 'undefined' || src === null) {\n      throw new Error('marked(): input parameter is undefined or null');\n    }\n\n    if (typeof src !== 'string') {\n      throw new Error('marked(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');\n    }\n\n    if (typeof opt === 'function') {\n      callback = opt;\n      opt = null;\n    }\n\n    opt = merge$2({}, marked.defaults, opt || {});\n    checkSanitizeDeprecation$1(opt);\n\n    if (callback) {\n      var highlight = opt.highlight;\n      var tokens;\n\n      try {\n        tokens = Lexer_1.lex(src, opt);\n      } catch (e) {\n        return callback(e);\n      }\n\n      var done = function done(err) {\n        var out;\n\n        if (!err) {\n          try {\n            out = Parser_1.parse(tokens, opt);\n          } catch (e) {\n            err = e;\n          }\n        }\n\n        opt.highlight = highlight;\n        return err ? callback(err) : callback(null, out);\n      };\n\n      if (!highlight || highlight.length < 3) {\n        return done();\n      }\n\n      delete opt.highlight;\n      if (!tokens.length) return done();\n      var pending = 0;\n      marked.walkTokens(tokens, function (token) {\n        if (token.type === 'code') {\n          pending++;\n          setTimeout(function () {\n            highlight(token.text, token.lang, function (err, code) {\n              if (err) {\n                return done(err);\n              }\n\n              if (code != null && code !== token.text) {\n                token.text = code;\n                token.escaped = true;\n              }\n\n              pending--;\n\n              if (pending === 0) {\n                done();\n              }\n            });\n          }, 0);\n        }\n      });\n\n      if (pending === 0) {\n        done();\n      }\n\n      return;\n    }\n\n    try {\n      var _tokens = Lexer_1.lex(src, opt);\n\n      if (opt.walkTokens) {\n        marked.walkTokens(_tokens, opt.walkTokens);\n      }\n\n      return Parser_1.parse(_tokens, opt);\n    } catch (e) {\n      e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n\n      if (opt.silent) {\n        return '<p>An error occurred:</p><pre>' + escape$2(e.message + '', true) + '</pre>';\n      }\n\n      throw e;\n    }\n  }\n  /**\n   * Options\n   */\n\n\n  marked.options = marked.setOptions = function (opt) {\n    merge$2(marked.defaults, opt);\n    changeDefaults(marked.defaults);\n    return marked;\n  };\n\n  marked.getDefaults = getDefaults;\n  marked.defaults = defaults$5;\n  /**\n   * Use Extension\n   */\n\n  marked.use = function (extension) {\n    var opts = merge$2({}, extension);\n\n    if (extension.renderer) {\n      (function () {\n        var renderer = marked.defaults.renderer || new Renderer_1();\n\n        var _loop = function _loop(prop) {\n          var prevRenderer = renderer[prop];\n\n          renderer[prop] = function () {\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n              args[_key] = arguments[_key];\n            }\n\n            var ret = extension.renderer[prop].apply(renderer, args);\n\n            if (ret === false) {\n              ret = prevRenderer.apply(renderer, args);\n            }\n\n            return ret;\n          };\n        };\n\n        for (var prop in extension.renderer) {\n          _loop(prop);\n        }\n\n        opts.renderer = renderer;\n      })();\n    }\n\n    if (extension.tokenizer) {\n      (function () {\n        var tokenizer = marked.defaults.tokenizer || new Tokenizer_1();\n\n        var _loop2 = function _loop2(prop) {\n          var prevTokenizer = tokenizer[prop];\n\n          tokenizer[prop] = function () {\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              args[_key2] = arguments[_key2];\n            }\n\n            var ret = extension.tokenizer[prop].apply(tokenizer, args);\n\n            if (ret === false) {\n              ret = prevTokenizer.apply(tokenizer, args);\n            }\n\n            return ret;\n          };\n        };\n\n        for (var prop in extension.tokenizer) {\n          _loop2(prop);\n        }\n\n        opts.tokenizer = tokenizer;\n      })();\n    }\n\n    if (extension.walkTokens) {\n      var walkTokens = marked.defaults.walkTokens;\n\n      opts.walkTokens = function (token) {\n        extension.walkTokens(token);\n\n        if (walkTokens) {\n          walkTokens(token);\n        }\n      };\n    }\n\n    marked.setOptions(opts);\n  };\n  /**\n   * Run callback for every token\n   */\n\n\n  marked.walkTokens = function (tokens, callback) {\n    for (var _iterator = _createForOfIteratorHelperLoose(tokens), _step; !(_step = _iterator()).done;) {\n      var token = _step.value;\n      callback(token);\n\n      switch (token.type) {\n        case 'table':\n          {\n            for (var _iterator2 = _createForOfIteratorHelperLoose(token.tokens.header), _step2; !(_step2 = _iterator2()).done;) {\n              var cell = _step2.value;\n              marked.walkTokens(cell, callback);\n            }\n\n            for (var _iterator3 = _createForOfIteratorHelperLoose(token.tokens.cells), _step3; !(_step3 = _iterator3()).done;) {\n              var row = _step3.value;\n\n              for (var _iterator4 = _createForOfIteratorHelperLoose(row), _step4; !(_step4 = _iterator4()).done;) {\n                var _cell = _step4.value;\n                marked.walkTokens(_cell, callback);\n              }\n            }\n\n            break;\n          }\n\n        case 'list':\n          {\n            marked.walkTokens(token.items, callback);\n            break;\n          }\n\n        default:\n          {\n            if (token.tokens) {\n              marked.walkTokens(token.tokens, callback);\n            }\n          }\n      }\n    }\n  };\n  /**\n   * Parse Inline\n   */\n\n\n  marked.parseInline = function (src, opt) {\n    // throw error in case of non string input\n    if (typeof src === 'undefined' || src === null) {\n      throw new Error('marked.parseInline(): input parameter is undefined or null');\n    }\n\n    if (typeof src !== 'string') {\n      throw new Error('marked.parseInline(): input parameter is of type ' + Object.prototype.toString.call(src) + ', string expected');\n    }\n\n    opt = merge$2({}, marked.defaults, opt || {});\n    checkSanitizeDeprecation$1(opt);\n\n    try {\n      var tokens = Lexer_1.lexInline(src, opt);\n\n      if (opt.walkTokens) {\n        marked.walkTokens(tokens, opt.walkTokens);\n      }\n\n      return Parser_1.parseInline(tokens, opt);\n    } catch (e) {\n      e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n\n      if (opt.silent) {\n        return '<p>An error occurred:</p><pre>' + escape$2(e.message + '', true) + '</pre>';\n      }\n\n      throw e;\n    }\n  };\n  /**\n   * Expose\n   */\n\n\n  marked.Parser = Parser_1;\n  marked.parser = Parser_1.parse;\n  marked.Renderer = Renderer_1;\n  marked.TextRenderer = TextRenderer_1;\n  marked.Lexer = Lexer_1;\n  marked.lexer = Lexer_1.lex;\n  marked.Tokenizer = Tokenizer_1;\n  marked.Slugger = Slugger_1;\n  marked.parse = marked;\n  var marked_1 = marked;\n\n  return marked_1;\n\n})));\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { languages } from './fillers/monaco-editor-core.js';\r\nvar languageDefinitions = {};\r\nvar lazyLanguageLoaders = {};\r\nvar LazyLanguageLoader = /** @class */ (function () {\r\n    function LazyLanguageLoader(languageId) {\r\n        var _this = this;\r\n        this._languageId = languageId;\r\n        this._loadingTriggered = false;\r\n        this._lazyLoadPromise = new Promise(function (resolve, reject) {\r\n            _this._lazyLoadPromiseResolve = resolve;\r\n            _this._lazyLoadPromiseReject = reject;\r\n        });\r\n    }\r\n    LazyLanguageLoader.getOrCreate = function (languageId) {\r\n        if (!lazyLanguageLoaders[languageId]) {\r\n            lazyLanguageLoaders[languageId] = new LazyLanguageLoader(languageId);\r\n        }\r\n        return lazyLanguageLoaders[languageId];\r\n    };\r\n    LazyLanguageLoader.prototype.whenLoaded = function () {\r\n        return this._lazyLoadPromise;\r\n    };\r\n    LazyLanguageLoader.prototype.load = function () {\r\n        var _this = this;\r\n        if (!this._loadingTriggered) {\r\n            this._loadingTriggered = true;\r\n            languageDefinitions[this._languageId].loader().then(function (mod) { return _this._lazyLoadPromiseResolve(mod); }, function (err) { return _this._lazyLoadPromiseReject(err); });\r\n        }\r\n        return this._lazyLoadPromise;\r\n    };\r\n    return LazyLanguageLoader;\r\n}());\r\nexport function loadLanguage(languageId) {\r\n    return LazyLanguageLoader.getOrCreate(languageId).load();\r\n}\r\nexport function registerLanguage(def) {\r\n    var languageId = def.id;\r\n    languageDefinitions[languageId] = def;\r\n    languages.register(def);\r\n    var lazyLanguageLoader = LazyLanguageLoader.getOrCreate(languageId);\r\n    languages.setMonarchTokensProvider(languageId, lazyLanguageLoader.whenLoaded().then(function (mod) { return mod.language; }));\r\n    languages.onLanguage(languageId, function () {\r\n        lazyLanguageLoader.load().then(function (mod) {\r\n            languages.setLanguageConfiguration(languageId, mod.conf);\r\n        });\r\n    });\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { registerLanguage } from '../_.contribution.js';\r\nregisterLanguage({\r\n    id: 'typescript',\r\n    extensions: ['.ts', '.tsx'],\r\n    aliases: ['TypeScript', 'ts', 'typescript'],\r\n    mimetypes: ['text/typescript'],\r\n    loader: function () { return import('./typescript.js'); }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './iPadShowKeyboard.css';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { isIOS } from '../../../../base/common/platform.js';\r\nexport class IPadShowKeyboard extends Disposable {\r\n    constructor(editor) {\r\n        super();\r\n        this.editor = editor;\r\n        this.widget = null;\r\n        if (isIOS) {\r\n            this._register(editor.onDidChangeConfiguration(() => this.update()));\r\n            this.update();\r\n        }\r\n    }\r\n    update() {\r\n        const shouldHaveWidget = (!this.editor.getOption(79 /* readOnly */));\r\n        if (!this.widget && shouldHaveWidget) {\r\n            this.widget = new ShowKeyboardWidget(this.editor);\r\n        }\r\n        else if (this.widget && !shouldHaveWidget) {\r\n            this.widget.dispose();\r\n            this.widget = null;\r\n        }\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n        if (this.widget) {\r\n            this.widget.dispose();\r\n            this.widget = null;\r\n        }\r\n    }\r\n}\r\nIPadShowKeyboard.ID = 'editor.contrib.iPadShowKeyboard';\r\nclass ShowKeyboardWidget extends Disposable {\r\n    constructor(editor) {\r\n        super();\r\n        this.editor = editor;\r\n        this._domNode = document.createElement('textarea');\r\n        this._domNode.className = 'iPadShowKeyboard';\r\n        this._register(dom.addDisposableListener(this._domNode, 'touchstart', (e) => {\r\n            this.editor.focus();\r\n        }));\r\n        this._register(dom.addDisposableListener(this._domNode, 'focus', (e) => {\r\n            this.editor.focus();\r\n        }));\r\n        this.editor.addOverlayWidget(this);\r\n    }\r\n    dispose() {\r\n        this.editor.removeOverlayWidget(this);\r\n        super.dispose();\r\n    }\r\n    // ----- IOverlayWidget API\r\n    getId() {\r\n        return ShowKeyboardWidget.ID;\r\n    }\r\n    getDomNode() {\r\n        return this._domNode;\r\n    }\r\n    getPosition() {\r\n        return {\r\n            preference: 1 /* BOTTOM_RIGHT_CORNER */\r\n        };\r\n    }\r\n}\r\nShowKeyboardWidget.ID = 'editor.contrib.ShowKeyboardWidget';\r\nregisterEditorContribution(IPadShowKeyboard.ID, IPadShowKeyboard);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { DisposableStore, Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { timeout } from '../../../base/common/async.js';\r\nexport var TriggerAction;\r\n(function (TriggerAction) {\r\n    /**\r\n     * Do nothing after the button was clicked.\r\n     */\r\n    TriggerAction[TriggerAction[\"NO_ACTION\"] = 0] = \"NO_ACTION\";\r\n    /**\r\n     * Close the picker.\r\n     */\r\n    TriggerAction[TriggerAction[\"CLOSE_PICKER\"] = 1] = \"CLOSE_PICKER\";\r\n    /**\r\n     * Update the results of the picker.\r\n     */\r\n    TriggerAction[TriggerAction[\"REFRESH_PICKER\"] = 2] = \"REFRESH_PICKER\";\r\n    /**\r\n     * Remove the item from the picker.\r\n     */\r\n    TriggerAction[TriggerAction[\"REMOVE_ITEM\"] = 3] = \"REMOVE_ITEM\";\r\n})(TriggerAction || (TriggerAction = {}));\r\nfunction isPicksWithActive(obj) {\r\n    const candidate = obj;\r\n    return Array.isArray(candidate.items);\r\n}\r\nfunction isFastAndSlowPicks(obj) {\r\n    const candidate = obj;\r\n    return !!candidate.picks && candidate.additionalPicks instanceof Promise;\r\n}\r\nexport class PickerQuickAccessProvider extends Disposable {\r\n    constructor(prefix, options) {\r\n        super();\r\n        this.prefix = prefix;\r\n        this.options = options;\r\n    }\r\n    provide(picker, token) {\r\n        var _a;\r\n        const disposables = new DisposableStore();\r\n        // Apply options if any\r\n        picker.canAcceptInBackground = !!((_a = this.options) === null || _a === void 0 ? void 0 : _a.canAcceptInBackground);\r\n        // Disable filtering & sorting, we control the results\r\n        picker.matchOnLabel = picker.matchOnDescription = picker.matchOnDetail = picker.sortByLabel = false;\r\n        // Set initial picks and update on type\r\n        let picksCts = undefined;\r\n        const picksDisposable = disposables.add(new MutableDisposable());\r\n        const updatePickerItems = () => __awaiter(this, void 0, void 0, function* () {\r\n            const picksDisposables = picksDisposable.value = new DisposableStore();\r\n            // Cancel any previous ask for picks and busy\r\n            picksCts === null || picksCts === void 0 ? void 0 : picksCts.dispose(true);\r\n            picker.busy = false;\r\n            // Create new cancellation source for this run\r\n            picksCts = new CancellationTokenSource(token);\r\n            // Collect picks and support both long running and short or combined\r\n            const picksToken = picksCts.token;\r\n            const picksFilter = picker.value.substr(this.prefix.length).trim();\r\n            const providedPicks = this._getPicks(picksFilter, picksDisposables, picksToken);\r\n            const applyPicks = (picks, skipEmpty) => {\r\n                var _a;\r\n                let items;\r\n                let activeItem = undefined;\r\n                if (isPicksWithActive(picks)) {\r\n                    items = picks.items;\r\n                    activeItem = picks.active;\r\n                }\r\n                else {\r\n                    items = picks;\r\n                }\r\n                if (items.length === 0) {\r\n                    if (skipEmpty) {\r\n                        return false;\r\n                    }\r\n                    if (picksFilter.length > 0 && ((_a = this.options) === null || _a === void 0 ? void 0 : _a.noResultsPick)) {\r\n                        items = [this.options.noResultsPick];\r\n                    }\r\n                }\r\n                picker.items = items;\r\n                if (activeItem) {\r\n                    picker.activeItems = [activeItem];\r\n                }\r\n                return true;\r\n            };\r\n            // No Picks\r\n            if (providedPicks === null) {\r\n                // Ignore\r\n            }\r\n            // Fast and Slow Picks\r\n            else if (isFastAndSlowPicks(providedPicks)) {\r\n                let fastPicksApplied = false;\r\n                let slowPicksApplied = false;\r\n                yield Promise.all([\r\n                    // Fast Picks: to reduce amount of flicker, we race against\r\n                    // the slow picks over 500ms and then set the fast picks.\r\n                    // If the slow picks are faster, we reduce the flicker by\r\n                    // only setting the items once.\r\n                    (() => __awaiter(this, void 0, void 0, function* () {\r\n                        yield timeout(PickerQuickAccessProvider.FAST_PICKS_RACE_DELAY);\r\n                        if (picksToken.isCancellationRequested) {\r\n                            return;\r\n                        }\r\n                        if (!slowPicksApplied) {\r\n                            fastPicksApplied = applyPicks(providedPicks.picks, true /* skip over empty to reduce flicker */);\r\n                        }\r\n                    }))(),\r\n                    // Slow Picks: we await the slow picks and then set them at\r\n                    // once together with the fast picks, but only if we actually\r\n                    // have additional results.\r\n                    (() => __awaiter(this, void 0, void 0, function* () {\r\n                        picker.busy = true;\r\n                        try {\r\n                            const awaitedAdditionalPicks = yield providedPicks.additionalPicks;\r\n                            if (picksToken.isCancellationRequested) {\r\n                                return;\r\n                            }\r\n                            let picks;\r\n                            let activePick = undefined;\r\n                            if (isPicksWithActive(providedPicks.picks)) {\r\n                                picks = providedPicks.picks.items;\r\n                                activePick = providedPicks.picks.active;\r\n                            }\r\n                            else {\r\n                                picks = providedPicks.picks;\r\n                            }\r\n                            let additionalPicks;\r\n                            let additionalActivePick = undefined;\r\n                            if (isPicksWithActive(awaitedAdditionalPicks)) {\r\n                                additionalPicks = awaitedAdditionalPicks.items;\r\n                                additionalActivePick = awaitedAdditionalPicks.active;\r\n                            }\r\n                            else {\r\n                                additionalPicks = awaitedAdditionalPicks;\r\n                            }\r\n                            if (additionalPicks.length > 0 || !fastPicksApplied) {\r\n                                // If we do not have any activePick or additionalActivePick\r\n                                // we try to preserve the currently active pick from the\r\n                                // fast results. This fixes an issue where the user might\r\n                                // have made a pick active before the additional results\r\n                                // kick in.\r\n                                // See https://github.com/microsoft/vscode/issues/102480\r\n                                let fallbackActivePick = undefined;\r\n                                if (!activePick && !additionalActivePick) {\r\n                                    const fallbackActivePickCandidate = picker.activeItems[0];\r\n                                    if (fallbackActivePickCandidate && picks.indexOf(fallbackActivePickCandidate) !== -1) {\r\n                                        fallbackActivePick = fallbackActivePickCandidate;\r\n                                    }\r\n                                }\r\n                                applyPicks({\r\n                                    items: [...picks, ...additionalPicks],\r\n                                    active: activePick || additionalActivePick || fallbackActivePick\r\n                                });\r\n                            }\r\n                        }\r\n                        finally {\r\n                            if (!picksToken.isCancellationRequested) {\r\n                                picker.busy = false;\r\n                            }\r\n                            slowPicksApplied = true;\r\n                        }\r\n                    }))()\r\n                ]);\r\n            }\r\n            // Fast Picks\r\n            else if (!(providedPicks instanceof Promise)) {\r\n                applyPicks(providedPicks);\r\n            }\r\n            // Slow Picks\r\n            else {\r\n                picker.busy = true;\r\n                try {\r\n                    const awaitedPicks = yield providedPicks;\r\n                    if (picksToken.isCancellationRequested) {\r\n                        return;\r\n                    }\r\n                    applyPicks(awaitedPicks);\r\n                }\r\n                finally {\r\n                    if (!picksToken.isCancellationRequested) {\r\n                        picker.busy = false;\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        disposables.add(picker.onDidChangeValue(() => updatePickerItems()));\r\n        updatePickerItems();\r\n        // Accept the pick on accept and hide picker\r\n        disposables.add(picker.onDidAccept(event => {\r\n            const [item] = picker.selectedItems;\r\n            if (typeof (item === null || item === void 0 ? void 0 : item.accept) === 'function') {\r\n                if (!event.inBackground) {\r\n                    picker.hide(); // hide picker unless we accept in background\r\n                }\r\n                item.accept(picker.keyMods, event);\r\n            }\r\n        }));\r\n        // Trigger the pick with button index if button triggered\r\n        disposables.add(picker.onDidTriggerItemButton(({ button, item }) => __awaiter(this, void 0, void 0, function* () {\r\n            var _b, _c;\r\n            if (typeof item.trigger === 'function') {\r\n                const buttonIndex = (_c = (_b = item.buttons) === null || _b === void 0 ? void 0 : _b.indexOf(button)) !== null && _c !== void 0 ? _c : -1;\r\n                if (buttonIndex >= 0) {\r\n                    const result = item.trigger(buttonIndex, picker.keyMods);\r\n                    const action = (typeof result === 'number') ? result : yield result;\r\n                    if (token.isCancellationRequested) {\r\n                        return;\r\n                    }\r\n                    switch (action) {\r\n                        case TriggerAction.NO_ACTION:\r\n                            break;\r\n                        case TriggerAction.CLOSE_PICKER:\r\n                            picker.hide();\r\n                            break;\r\n                        case TriggerAction.REFRESH_PICKER:\r\n                            updatePickerItems();\r\n                            break;\r\n                        case TriggerAction.REMOVE_ITEM:\r\n                            const index = picker.items.indexOf(item);\r\n                            if (index !== -1) {\r\n                                const items = picker.items.slice();\r\n                                items.splice(index, 1);\r\n                                picker.items = items;\r\n                            }\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        })));\r\n        return disposables;\r\n    }\r\n}\r\nPickerQuickAccessProvider.FAST_PICKS_RACE_DELAY = 200; // timeout before we accept fast results before slow results are present\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../nls.js';\r\nimport * as types from './types.js';\r\nimport * as arrays from './arrays.js';\r\nfunction exceptionToErrorMessage(exception, verbose) {\r\n    if (verbose && (exception.stack || exception.stacktrace)) {\r\n        return nls.localize('stackTrace.format', \"{0}: {1}\", detectSystemErrorMessage(exception), stackToString(exception.stack) || stackToString(exception.stacktrace));\r\n    }\r\n    return detectSystemErrorMessage(exception);\r\n}\r\nfunction stackToString(stack) {\r\n    if (Array.isArray(stack)) {\r\n        return stack.join('\\n');\r\n    }\r\n    return stack;\r\n}\r\nfunction detectSystemErrorMessage(exception) {\r\n    // See https://nodejs.org/api/errors.html#errors_class_system_error\r\n    if (typeof exception.code === 'string' && typeof exception.errno === 'number' && typeof exception.syscall === 'string') {\r\n        return nls.localize('nodeExceptionMessage', \"A system error occurred ({0})\", exception.message);\r\n    }\r\n    return exception.message || nls.localize('error.defaultMessage', \"An unknown error occurred. Please consult the log for more details.\");\r\n}\r\n/**\r\n * Tries to generate a human readable error message out of the error. If the verbose parameter\r\n * is set to true, the error message will include stacktrace details if provided.\r\n *\r\n * @returns A string containing the error message.\r\n */\r\nexport function toErrorMessage(error = null, verbose = false) {\r\n    if (!error) {\r\n        return nls.localize('error.defaultMessage', \"An unknown error occurred. Please consult the log for more details.\");\r\n    }\r\n    if (Array.isArray(error)) {\r\n        const errors = arrays.coalesce(error);\r\n        const msg = toErrorMessage(errors[0], verbose);\r\n        if (errors.length > 1) {\r\n            return nls.localize('error.moreErrors', \"{0} ({1} errors in total)\", msg, errors.length);\r\n        }\r\n        return msg;\r\n    }\r\n    if (types.isString(error)) {\r\n        return error;\r\n    }\r\n    if (error.detail) {\r\n        const detail = error.detail;\r\n        if (detail.error) {\r\n            return exceptionToErrorMessage(detail.error, verbose);\r\n        }\r\n        if (detail.exception) {\r\n            return exceptionToErrorMessage(detail.exception, verbose);\r\n        }\r\n    }\r\n    if (error.stack) {\r\n        return exceptionToErrorMessage(error, verbose);\r\n    }\r\n    if (error.message) {\r\n        return error.message;\r\n    }\r\n    return nls.localize('error.defaultMessage', \"An unknown error occurred. Please consult the log for more details.\");\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { localize } from '../../../nls.js';\r\nimport { PickerQuickAccessProvider } from './pickerQuickAccess.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { or, matchesPrefix, matchesWords, matchesContiguousSubString } from '../../../base/common/filters.js';\r\nimport { withNullAsUndefined } from '../../../base/common/types.js';\r\nimport { LRUCache } from '../../../base/common/map.js';\r\nimport { IStorageService } from '../../storage/common/storage.js';\r\nimport { IConfigurationService } from '../../configuration/common/configuration.js';\r\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\r\nimport { ICommandService } from '../../commands/common/commands.js';\r\nimport { ITelemetryService } from '../../telemetry/common/telemetry.js';\r\nimport { isPromiseCanceledError } from '../../../base/common/errors.js';\r\nimport { IDialogService } from '../../dialogs/common/dialogs.js';\r\nimport Severity from '../../../base/common/severity.js';\r\nimport { toErrorMessage } from '../../../base/common/errorMessage.js';\r\nlet AbstractCommandsQuickAccessProvider = class AbstractCommandsQuickAccessProvider extends PickerQuickAccessProvider {\r\n    constructor(options, instantiationService, keybindingService, commandService, telemetryService, dialogService) {\r\n        super(AbstractCommandsQuickAccessProvider.PREFIX, options);\r\n        this.instantiationService = instantiationService;\r\n        this.keybindingService = keybindingService;\r\n        this.commandService = commandService;\r\n        this.telemetryService = telemetryService;\r\n        this.dialogService = dialogService;\r\n        this.commandsHistory = this._register(this.instantiationService.createInstance(CommandsHistory));\r\n        this.options = options;\r\n    }\r\n    _getPicks(filter, disposables, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            // Ask subclass for all command picks\r\n            const allCommandPicks = yield this.getCommandPicks(disposables, token);\r\n            if (token.isCancellationRequested) {\r\n                return [];\r\n            }\r\n            // Filter\r\n            const filteredCommandPicks = [];\r\n            for (const commandPick of allCommandPicks) {\r\n                const labelHighlights = withNullAsUndefined(AbstractCommandsQuickAccessProvider.WORD_FILTER(filter, commandPick.label));\r\n                const aliasHighlights = commandPick.commandAlias ? withNullAsUndefined(AbstractCommandsQuickAccessProvider.WORD_FILTER(filter, commandPick.commandAlias)) : undefined;\r\n                // Add if matching in label or alias\r\n                if (labelHighlights || aliasHighlights) {\r\n                    commandPick.highlights = {\r\n                        label: labelHighlights,\r\n                        detail: this.options.showAlias ? aliasHighlights : undefined\r\n                    };\r\n                    filteredCommandPicks.push(commandPick);\r\n                }\r\n                // Also add if we have a 100% command ID match\r\n                else if (filter === commandPick.commandId) {\r\n                    filteredCommandPicks.push(commandPick);\r\n                }\r\n            }\r\n            // Add description to commands that have duplicate labels\r\n            const mapLabelToCommand = new Map();\r\n            for (const commandPick of filteredCommandPicks) {\r\n                const existingCommandForLabel = mapLabelToCommand.get(commandPick.label);\r\n                if (existingCommandForLabel) {\r\n                    commandPick.description = commandPick.commandId;\r\n                    existingCommandForLabel.description = existingCommandForLabel.commandId;\r\n                }\r\n                else {\r\n                    mapLabelToCommand.set(commandPick.label, commandPick);\r\n                }\r\n            }\r\n            // Sort by MRU order and fallback to name otherwise\r\n            filteredCommandPicks.sort((commandPickA, commandPickB) => {\r\n                const commandACounter = this.commandsHistory.peek(commandPickA.commandId);\r\n                const commandBCounter = this.commandsHistory.peek(commandPickB.commandId);\r\n                if (commandACounter && commandBCounter) {\r\n                    return commandACounter > commandBCounter ? -1 : 1; // use more recently used command before older\r\n                }\r\n                if (commandACounter) {\r\n                    return -1; // first command was used, so it wins over the non used one\r\n                }\r\n                if (commandBCounter) {\r\n                    return 1; // other command was used so it wins over the command\r\n                }\r\n                // both commands were never used, so we sort by name\r\n                return commandPickA.label.localeCompare(commandPickB.label);\r\n            });\r\n            const commandPicks = [];\r\n            let addSeparator = false;\r\n            for (let i = 0; i < filteredCommandPicks.length; i++) {\r\n                const commandPick = filteredCommandPicks[i];\r\n                const keybinding = this.keybindingService.lookupKeybinding(commandPick.commandId);\r\n                const ariaLabel = keybinding ?\r\n                    localize('commandPickAriaLabelWithKeybinding', \"{0}, {1}\", commandPick.label, keybinding.getAriaLabel()) :\r\n                    commandPick.label;\r\n                // Separator: recently used\r\n                if (i === 0 && this.commandsHistory.peek(commandPick.commandId)) {\r\n                    commandPicks.push({ type: 'separator', label: localize('recentlyUsed', \"recently used\") });\r\n                    addSeparator = true;\r\n                }\r\n                // Separator: other commands\r\n                if (i !== 0 && addSeparator && !this.commandsHistory.peek(commandPick.commandId)) {\r\n                    commandPicks.push({ type: 'separator', label: localize('morecCommands', \"other commands\") });\r\n                    addSeparator = false; // only once\r\n                }\r\n                // Command\r\n                commandPicks.push(Object.assign(Object.assign({}, commandPick), { ariaLabel, detail: this.options.showAlias && commandPick.commandAlias !== commandPick.label ? commandPick.commandAlias : undefined, keybinding, accept: () => __awaiter(this, void 0, void 0, function* () {\r\n                        // Add to history\r\n                        this.commandsHistory.push(commandPick.commandId);\r\n                        // Telementry\r\n                        this.telemetryService.publicLog2('workbenchActionExecuted', {\r\n                            id: commandPick.commandId,\r\n                            from: 'quick open'\r\n                        });\r\n                        // Run\r\n                        try {\r\n                            yield this.commandService.executeCommand(commandPick.commandId);\r\n                        }\r\n                        catch (error) {\r\n                            if (!isPromiseCanceledError(error)) {\r\n                                this.dialogService.show(Severity.Error, localize('canNotRun', \"Command '{0}' resulted in an error ({1})\", commandPick.label, toErrorMessage(error)));\r\n                            }\r\n                        }\r\n                    }) }));\r\n            }\r\n            return commandPicks;\r\n        });\r\n    }\r\n};\r\nAbstractCommandsQuickAccessProvider.PREFIX = '>';\r\nAbstractCommandsQuickAccessProvider.WORD_FILTER = or(matchesPrefix, matchesWords, matchesContiguousSubString);\r\nAbstractCommandsQuickAccessProvider = __decorate([\r\n    __param(1, IInstantiationService),\r\n    __param(2, IKeybindingService),\r\n    __param(3, ICommandService),\r\n    __param(4, ITelemetryService),\r\n    __param(5, IDialogService)\r\n], AbstractCommandsQuickAccessProvider);\r\nexport { AbstractCommandsQuickAccessProvider };\r\nlet CommandsHistory = class CommandsHistory extends Disposable {\r\n    constructor(storageService, configurationService) {\r\n        super();\r\n        this.storageService = storageService;\r\n        this.configurationService = configurationService;\r\n        this.configuredCommandsHistoryLength = 0;\r\n        this.updateConfiguration();\r\n        this.load();\r\n        this.registerListeners();\r\n    }\r\n    registerListeners() {\r\n        this._register(this.configurationService.onDidChangeConfiguration(() => this.updateConfiguration()));\r\n    }\r\n    updateConfiguration() {\r\n        this.configuredCommandsHistoryLength = CommandsHistory.getConfiguredCommandHistoryLength(this.configurationService);\r\n        if (CommandsHistory.cache && CommandsHistory.cache.limit !== this.configuredCommandsHistoryLength) {\r\n            CommandsHistory.cache.limit = this.configuredCommandsHistoryLength;\r\n            CommandsHistory.saveState(this.storageService);\r\n        }\r\n    }\r\n    load() {\r\n        const raw = this.storageService.get(CommandsHistory.PREF_KEY_CACHE, 0 /* GLOBAL */);\r\n        let serializedCache;\r\n        if (raw) {\r\n            try {\r\n                serializedCache = JSON.parse(raw);\r\n            }\r\n            catch (error) {\r\n                // invalid data\r\n            }\r\n        }\r\n        const cache = CommandsHistory.cache = new LRUCache(this.configuredCommandsHistoryLength, 1);\r\n        if (serializedCache) {\r\n            let entries;\r\n            if (serializedCache.usesLRU) {\r\n                entries = serializedCache.entries;\r\n            }\r\n            else {\r\n                entries = serializedCache.entries.sort((a, b) => a.value - b.value);\r\n            }\r\n            entries.forEach(entry => cache.set(entry.key, entry.value));\r\n        }\r\n        CommandsHistory.counter = this.storageService.getNumber(CommandsHistory.PREF_KEY_COUNTER, 0 /* GLOBAL */, CommandsHistory.counter);\r\n    }\r\n    push(commandId) {\r\n        if (!CommandsHistory.cache) {\r\n            return;\r\n        }\r\n        CommandsHistory.cache.set(commandId, CommandsHistory.counter++); // set counter to command\r\n        CommandsHistory.saveState(this.storageService);\r\n    }\r\n    peek(commandId) {\r\n        var _a;\r\n        return (_a = CommandsHistory.cache) === null || _a === void 0 ? void 0 : _a.peek(commandId);\r\n    }\r\n    static saveState(storageService) {\r\n        if (!CommandsHistory.cache) {\r\n            return;\r\n        }\r\n        const serializedCache = { usesLRU: true, entries: [] };\r\n        CommandsHistory.cache.forEach((value, key) => serializedCache.entries.push({ key, value }));\r\n        storageService.store(CommandsHistory.PREF_KEY_CACHE, JSON.stringify(serializedCache), 0 /* GLOBAL */, 0 /* USER */);\r\n        storageService.store(CommandsHistory.PREF_KEY_COUNTER, CommandsHistory.counter, 0 /* GLOBAL */, 0 /* USER */);\r\n    }\r\n    static getConfiguredCommandHistoryLength(configurationService) {\r\n        var _a, _b;\r\n        const config = configurationService.getValue();\r\n        const configuredCommandHistoryLength = (_b = (_a = config.workbench) === null || _a === void 0 ? void 0 : _a.commandPalette) === null || _b === void 0 ? void 0 : _b.history;\r\n        if (typeof configuredCommandHistoryLength === 'number') {\r\n            return configuredCommandHistoryLength;\r\n        }\r\n        return CommandsHistory.DEFAULT_COMMANDS_HISTORY_LENGTH;\r\n    }\r\n};\r\nCommandsHistory.DEFAULT_COMMANDS_HISTORY_LENGTH = 50;\r\nCommandsHistory.PREF_KEY_CACHE = 'commandPalette.mru.cache';\r\nCommandsHistory.PREF_KEY_COUNTER = 'commandPalette.mru.counter';\r\nCommandsHistory.counter = 1;\r\nCommandsHistory = __decorate([\r\n    __param(0, IStorageService),\r\n    __param(1, IConfigurationService)\r\n], CommandsHistory);\r\nexport { CommandsHistory };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { AbstractCommandsQuickAccessProvider } from '../../../platform/quickinput/browser/commandsQuickAccess.js';\r\nimport { stripIcons } from '../../../base/common/iconLabels.js';\r\nexport class AbstractEditorCommandsQuickAccessProvider extends AbstractCommandsQuickAccessProvider {\r\n    constructor(options, instantiationService, keybindingService, commandService, telemetryService, dialogService) {\r\n        super(options, instantiationService, keybindingService, commandService, telemetryService, dialogService);\r\n    }\r\n    getCodeEditorCommandPicks() {\r\n        const activeTextEditorControl = this.activeTextEditorControl;\r\n        if (!activeTextEditorControl) {\r\n            return [];\r\n        }\r\n        const editorCommandPicks = [];\r\n        for (const editorAction of activeTextEditorControl.getSupportedActions()) {\r\n            editorCommandPicks.push({\r\n                commandId: editorAction.id,\r\n                commandAlias: editorAction.alias,\r\n                label: stripIcons(editorAction.label) || editorAction.id,\r\n            });\r\n        }\r\n        return editorCommandPicks;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { Registry } from '../../../../platform/registry/common/platform.js';\r\nimport { Extensions } from '../../../../platform/quickinput/common/quickAccess.js';\r\nimport { QuickCommandNLS } from '../../../common/standaloneStrings.js';\r\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\r\nimport { AbstractEditorCommandsQuickAccessProvider } from '../../../contrib/quickAccess/commandsQuickAccess.js';\r\nimport { withNullAsUndefined } from '../../../../base/common/types.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\r\nimport { ITelemetryService } from '../../../../platform/telemetry/common/telemetry.js';\r\nimport { IDialogService } from '../../../../platform/dialogs/common/dialogs.js';\r\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\r\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\r\nlet StandaloneCommandsQuickAccessProvider = class StandaloneCommandsQuickAccessProvider extends AbstractEditorCommandsQuickAccessProvider {\r\n    constructor(instantiationService, codeEditorService, keybindingService, commandService, telemetryService, dialogService) {\r\n        super({ showAlias: false }, instantiationService, keybindingService, commandService, telemetryService, dialogService);\r\n        this.codeEditorService = codeEditorService;\r\n    }\r\n    get activeTextEditorControl() { return withNullAsUndefined(this.codeEditorService.getFocusedCodeEditor()); }\r\n    getCommandPicks() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this.getCodeEditorCommandPicks();\r\n        });\r\n    }\r\n};\r\nStandaloneCommandsQuickAccessProvider = __decorate([\r\n    __param(0, IInstantiationService),\r\n    __param(1, ICodeEditorService),\r\n    __param(2, IKeybindingService),\r\n    __param(3, ICommandService),\r\n    __param(4, ITelemetryService),\r\n    __param(5, IDialogService)\r\n], StandaloneCommandsQuickAccessProvider);\r\nexport { StandaloneCommandsQuickAccessProvider };\r\nRegistry.as(Extensions.Quickaccess).registerQuickAccessProvider({\r\n    ctor: StandaloneCommandsQuickAccessProvider,\r\n    prefix: StandaloneCommandsQuickAccessProvider.PREFIX,\r\n    helpEntries: [{ description: QuickCommandNLS.quickCommandHelp, needsEditor: true }]\r\n});\r\nexport class GotoLineAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.quickCommand',\r\n            label: QuickCommandNLS.quickCommandActionLabel,\r\n            alias: 'Command Palette',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 59 /* F1 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: 'z_commands',\r\n                order: 1\r\n            }\r\n        });\r\n    }\r\n    run(accessor) {\r\n        accessor.get(IQuickInputService).quickAccess.show(StandaloneCommandsQuickAccessProvider.PREFIX);\r\n    }\r\n}\r\nregisterEditorAction(GotoLineAction);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './bracketMatching.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { editorBracketMatchBackground, editorBracketMatchBorder } from '../../common/view/editorColorRegistry.js';\r\nimport { registerColor } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant, themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nimport { MenuRegistry, MenuId } from '../../../platform/actions/common/actions.js';\r\nconst overviewRulerBracketMatchForeground = registerColor('editorOverviewRuler.bracketMatchForeground', { dark: '#A0A0A0', light: '#A0A0A0', hc: '#A0A0A0' }, nls.localize('overviewRulerBracketMatchForeground', 'Overview ruler marker color for matching brackets.'));\r\nclass JumpToBracketAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.jumpToBracket',\r\n            label: nls.localize('smartSelect.jumpBracket', \"Go to Bracket\"),\r\n            alias: 'Go to Bracket',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 88 /* US_BACKSLASH */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        let controller = BracketMatchingController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        controller.jumpToBracket();\r\n    }\r\n}\r\nclass SelectToBracketAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.selectToBracket',\r\n            label: nls.localize('smartSelect.selectToBracket', \"Select to Bracket\"),\r\n            alias: 'Select to Bracket',\r\n            precondition: undefined,\r\n            description: {\r\n                description: `Select to Bracket`,\r\n                args: [{\r\n                        name: 'args',\r\n                        schema: {\r\n                            type: 'object',\r\n                            properties: {\r\n                                'selectBrackets': {\r\n                                    type: 'boolean',\r\n                                    default: true\r\n                                }\r\n                            },\r\n                        }\r\n                    }]\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor, args) {\r\n        const controller = BracketMatchingController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        let selectBrackets = true;\r\n        if (args && args.selectBrackets === false) {\r\n            selectBrackets = false;\r\n        }\r\n        controller.selectToBracket(selectBrackets);\r\n    }\r\n}\r\nclass BracketsData {\r\n    constructor(position, brackets, options) {\r\n        this.position = position;\r\n        this.brackets = brackets;\r\n        this.options = options;\r\n    }\r\n}\r\nexport class BracketMatchingController extends Disposable {\r\n    constructor(editor) {\r\n        super();\r\n        this._editor = editor;\r\n        this._lastBracketsData = [];\r\n        this._lastVersionId = 0;\r\n        this._decorations = [];\r\n        this._updateBracketsSoon = this._register(new RunOnceScheduler(() => this._updateBrackets(), 50));\r\n        this._matchBrackets = this._editor.getOption(62 /* matchBrackets */);\r\n        this._updateBracketsSoon.schedule();\r\n        this._register(editor.onDidChangeCursorPosition((e) => {\r\n            if (this._matchBrackets === 'never') {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            this._updateBracketsSoon.schedule();\r\n        }));\r\n        this._register(editor.onDidChangeModelContent((e) => {\r\n            this._updateBracketsSoon.schedule();\r\n        }));\r\n        this._register(editor.onDidChangeModel((e) => {\r\n            this._lastBracketsData = [];\r\n            this._decorations = [];\r\n            this._updateBracketsSoon.schedule();\r\n        }));\r\n        this._register(editor.onDidChangeModelLanguageConfiguration((e) => {\r\n            this._lastBracketsData = [];\r\n            this._updateBracketsSoon.schedule();\r\n        }));\r\n        this._register(editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(62 /* matchBrackets */)) {\r\n                this._matchBrackets = this._editor.getOption(62 /* matchBrackets */);\r\n                this._decorations = this._editor.deltaDecorations(this._decorations, []);\r\n                this._lastBracketsData = [];\r\n                this._lastVersionId = 0;\r\n                this._updateBracketsSoon.schedule();\r\n            }\r\n        }));\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(BracketMatchingController.ID);\r\n    }\r\n    jumpToBracket() {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        const newSelections = this._editor.getSelections().map(selection => {\r\n            const position = selection.getStartPosition();\r\n            // find matching brackets if position is on a bracket\r\n            const brackets = model.matchBracket(position);\r\n            let newCursorPosition = null;\r\n            if (brackets) {\r\n                if (brackets[0].containsPosition(position)) {\r\n                    newCursorPosition = brackets[1].getStartPosition();\r\n                }\r\n                else if (brackets[1].containsPosition(position)) {\r\n                    newCursorPosition = brackets[0].getStartPosition();\r\n                }\r\n            }\r\n            else {\r\n                // find the enclosing brackets if the position isn't on a matching bracket\r\n                const enclosingBrackets = model.findEnclosingBrackets(position);\r\n                if (enclosingBrackets) {\r\n                    newCursorPosition = enclosingBrackets[0].getStartPosition();\r\n                }\r\n                else {\r\n                    // no enclosing brackets, try the very first next bracket\r\n                    const nextBracket = model.findNextBracket(position);\r\n                    if (nextBracket && nextBracket.range) {\r\n                        newCursorPosition = nextBracket.range.getStartPosition();\r\n                    }\r\n                }\r\n            }\r\n            if (newCursorPosition) {\r\n                return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\r\n            }\r\n            return new Selection(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        });\r\n        this._editor.setSelections(newSelections);\r\n        this._editor.revealRange(newSelections[0]);\r\n    }\r\n    selectToBracket(selectBrackets) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        const newSelections = [];\r\n        this._editor.getSelections().forEach(selection => {\r\n            const position = selection.getStartPosition();\r\n            let brackets = model.matchBracket(position);\r\n            if (!brackets) {\r\n                brackets = model.findEnclosingBrackets(position);\r\n                if (!brackets) {\r\n                    const nextBracket = model.findNextBracket(position);\r\n                    if (nextBracket && nextBracket.range) {\r\n                        brackets = model.matchBracket(nextBracket.range.getStartPosition());\r\n                    }\r\n                }\r\n            }\r\n            let selectFrom = null;\r\n            let selectTo = null;\r\n            if (brackets) {\r\n                brackets.sort(Range.compareRangesUsingStarts);\r\n                const [open, close] = brackets;\r\n                selectFrom = selectBrackets ? open.getStartPosition() : open.getEndPosition();\r\n                selectTo = selectBrackets ? close.getEndPosition() : close.getStartPosition();\r\n            }\r\n            if (selectFrom && selectTo) {\r\n                newSelections.push(new Selection(selectFrom.lineNumber, selectFrom.column, selectTo.lineNumber, selectTo.column));\r\n            }\r\n        });\r\n        if (newSelections.length > 0) {\r\n            this._editor.setSelections(newSelections);\r\n            this._editor.revealRange(newSelections[0]);\r\n        }\r\n    }\r\n    _updateBrackets() {\r\n        if (this._matchBrackets === 'never') {\r\n            return;\r\n        }\r\n        this._recomputeBrackets();\r\n        let newDecorations = [], newDecorationsLen = 0;\r\n        for (const bracketData of this._lastBracketsData) {\r\n            let brackets = bracketData.brackets;\r\n            if (brackets) {\r\n                newDecorations[newDecorationsLen++] = { range: brackets[0], options: bracketData.options };\r\n                newDecorations[newDecorationsLen++] = { range: brackets[1], options: bracketData.options };\r\n            }\r\n        }\r\n        this._decorations = this._editor.deltaDecorations(this._decorations, newDecorations);\r\n    }\r\n    _recomputeBrackets() {\r\n        if (!this._editor.hasModel()) {\r\n            // no model => no brackets!\r\n            this._lastBracketsData = [];\r\n            this._lastVersionId = 0;\r\n            return;\r\n        }\r\n        const selections = this._editor.getSelections();\r\n        if (selections.length > 100) {\r\n            // no bracket matching for high numbers of selections\r\n            this._lastBracketsData = [];\r\n            this._lastVersionId = 0;\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        const versionId = model.getVersionId();\r\n        let previousData = [];\r\n        if (this._lastVersionId === versionId) {\r\n            // use the previous data only if the model is at the same version id\r\n            previousData = this._lastBracketsData;\r\n        }\r\n        let positions = [], positionsLen = 0;\r\n        for (let i = 0, len = selections.length; i < len; i++) {\r\n            let selection = selections[i];\r\n            if (selection.isEmpty()) {\r\n                // will bracket match a cursor only if the selection is collapsed\r\n                positions[positionsLen++] = selection.getStartPosition();\r\n            }\r\n        }\r\n        // sort positions for `previousData` cache hits\r\n        if (positions.length > 1) {\r\n            positions.sort(Position.compare);\r\n        }\r\n        let newData = [], newDataLen = 0;\r\n        let previousIndex = 0, previousLen = previousData.length;\r\n        for (let i = 0, len = positions.length; i < len; i++) {\r\n            let position = positions[i];\r\n            while (previousIndex < previousLen && previousData[previousIndex].position.isBefore(position)) {\r\n                previousIndex++;\r\n            }\r\n            if (previousIndex < previousLen && previousData[previousIndex].position.equals(position)) {\r\n                newData[newDataLen++] = previousData[previousIndex];\r\n            }\r\n            else {\r\n                let brackets = model.matchBracket(position);\r\n                let options = BracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;\r\n                if (!brackets && this._matchBrackets === 'always') {\r\n                    brackets = model.findEnclosingBrackets(position, 20 /* give at most 20ms to compute */);\r\n                    options = BracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER;\r\n                }\r\n                newData[newDataLen++] = new BracketsData(position, brackets, options);\r\n            }\r\n        }\r\n        this._lastBracketsData = newData;\r\n        this._lastVersionId = versionId;\r\n    }\r\n}\r\nBracketMatchingController.ID = 'editor.contrib.bracketMatchingController';\r\nBracketMatchingController._DECORATION_OPTIONS_WITH_OVERVIEW_RULER = ModelDecorationOptions.register({\r\n    description: 'bracket-match-overview',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'bracket-match',\r\n    overviewRuler: {\r\n        color: themeColorFromId(overviewRulerBracketMatchForeground),\r\n        position: OverviewRulerLane.Center\r\n    }\r\n});\r\nBracketMatchingController._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER = ModelDecorationOptions.register({\r\n    description: 'bracket-match-no-overview',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'bracket-match'\r\n});\r\nregisterEditorContribution(BracketMatchingController.ID, BracketMatchingController);\r\nregisterEditorAction(SelectToBracketAction);\r\nregisterEditorAction(JumpToBracketAction);\r\nregisterThemingParticipant((theme, collector) => {\r\n    const bracketMatchBackground = theme.getColor(editorBracketMatchBackground);\r\n    if (bracketMatchBackground) {\r\n        collector.addRule(`.monaco-editor .bracket-match { background-color: ${bracketMatchBackground}; }`);\r\n    }\r\n    const bracketMatchBorder = theme.getColor(editorBracketMatchBorder);\r\n    if (bracketMatchBorder) {\r\n        collector.addRule(`.monaco-editor .bracket-match { border: 1px solid ${bracketMatchBorder}; }`);\r\n    }\r\n});\r\n// Go to menu\r\nMenuRegistry.appendMenuItem(MenuId.MenubarGoMenu, {\r\n    group: '5_infile_nav',\r\n    command: {\r\n        id: 'editor.action.jumpToBracket',\r\n        title: nls.localize({ key: 'miGoToBracket', comment: ['&& denotes a mnemonic'] }, \"Go to &&Bracket\")\r\n    },\r\n    order: 2\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nexport class MoveCaretCommand {\r\n    constructor(selection, isMovingLeft) {\r\n        this._selection = selection;\r\n        this._isMovingLeft = isMovingLeft;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        if (this._selection.startLineNumber !== this._selection.endLineNumber || this._selection.isEmpty()) {\r\n            return;\r\n        }\r\n        const lineNumber = this._selection.startLineNumber;\r\n        const startColumn = this._selection.startColumn;\r\n        const endColumn = this._selection.endColumn;\r\n        if (this._isMovingLeft && startColumn === 1) {\r\n            return;\r\n        }\r\n        if (!this._isMovingLeft && endColumn === model.getLineMaxColumn(lineNumber)) {\r\n            return;\r\n        }\r\n        if (this._isMovingLeft) {\r\n            const rangeBefore = new Range(lineNumber, startColumn - 1, lineNumber, startColumn);\r\n            const charBefore = model.getValueInRange(rangeBefore);\r\n            builder.addEditOperation(rangeBefore, null);\r\n            builder.addEditOperation(new Range(lineNumber, endColumn, lineNumber, endColumn), charBefore);\r\n        }\r\n        else {\r\n            const rangeAfter = new Range(lineNumber, endColumn, lineNumber, endColumn + 1);\r\n            const charAfter = model.getValueInRange(rangeAfter);\r\n            builder.addEditOperation(rangeAfter, null);\r\n            builder.addEditOperation(new Range(lineNumber, startColumn, lineNumber, startColumn), charAfter);\r\n        }\r\n    }\r\n    computeCursorState(model, helper) {\r\n        if (this._isMovingLeft) {\r\n            return new Selection(this._selection.startLineNumber, this._selection.startColumn - 1, this._selection.endLineNumber, this._selection.endColumn - 1);\r\n        }\r\n        else {\r\n            return new Selection(this._selection.startLineNumber, this._selection.startColumn + 1, this._selection.endLineNumber, this._selection.endColumn + 1);\r\n        }\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MoveCaretCommand } from './moveCaretCommand.js';\r\nclass MoveCaretAction extends EditorAction {\r\n    constructor(left, opts) {\r\n        super(opts);\r\n        this.left = left;\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        let commands = [];\r\n        let selections = editor.getSelections();\r\n        for (const selection of selections) {\r\n            commands.push(new MoveCaretCommand(selection, this.left));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nclass MoveCaretLeftAction extends MoveCaretAction {\r\n    constructor() {\r\n        super(true, {\r\n            id: 'editor.action.moveCarretLeftAction',\r\n            label: nls.localize('caret.moveLeft', \"Move Selected Text Left\"),\r\n            alias: 'Move Selected Text Left',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n}\r\nclass MoveCaretRightAction extends MoveCaretAction {\r\n    constructor() {\r\n        super(false, {\r\n            id: 'editor.action.moveCarretRightAction',\r\n            label: nls.localize('caret.moveRight', \"Move Selected Text Right\"),\r\n            alias: 'Move Selected Text Right',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n}\r\nregisterEditorAction(MoveCaretLeftAction);\r\nregisterEditorAction(MoveCaretRightAction);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as browser from '../../../base/browser/browser.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { CopyOptions, InMemoryClipboardMetadataManager } from '../../browser/controller/textAreaInput.js';\r\nimport { EditorAction, registerEditorAction, MultiCommand } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MenuRegistry, MenuId } from '../../../platform/actions/common/actions.js';\r\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\r\nconst CLIPBOARD_CONTEXT_MENU_GROUP = '9_cutcopypaste';\r\nconst supportsCut = (platform.isNative || document.queryCommandSupported('cut'));\r\nconst supportsCopy = (platform.isNative || document.queryCommandSupported('copy'));\r\n// Firefox only supports navigator.clipboard.readText() in browser extensions.\r\n// See https://developer.mozilla.org/en-US/docs/Web/API/Clipboard/readText#Browser_compatibility\r\n// When loading over http, navigator.clipboard can be undefined. See https://github.com/microsoft/monaco-editor/issues/2313\r\nconst supportsPaste = (typeof navigator.clipboard === 'undefined' || browser.isFirefox) ? document.queryCommandSupported('paste') : true;\r\nfunction registerCommand(command) {\r\n    command.register();\r\n    return command;\r\n}\r\nexport const CutAction = supportsCut ? registerCommand(new MultiCommand({\r\n    id: 'editor.action.clipboardCutAction',\r\n    precondition: undefined,\r\n    kbOpts: (\r\n    // Do not bind cut keybindings in the browser,\r\n    // since browsers do that for us and it avoids security prompts\r\n    platform.isNative ? {\r\n        primary: 2048 /* CtrlCmd */ | 54 /* KEY_X */,\r\n        win: { primary: 2048 /* CtrlCmd */ | 54 /* KEY_X */, secondary: [1024 /* Shift */ | 20 /* Delete */] },\r\n        weight: 100 /* EditorContrib */\r\n    } : undefined),\r\n    menuOpts: [{\r\n            menuId: MenuId.MenubarEditMenu,\r\n            group: '2_ccp',\r\n            title: nls.localize({ key: 'miCut', comment: ['&& denotes a mnemonic'] }, \"Cu&&t\"),\r\n            order: 1\r\n        }, {\r\n            menuId: MenuId.EditorContext,\r\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\r\n            when: EditorContextKeys.writable,\r\n            order: 1,\r\n        }, {\r\n            menuId: MenuId.CommandPalette,\r\n            group: '',\r\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\r\n            order: 1\r\n        }, {\r\n            menuId: MenuId.SimpleEditorContext,\r\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n            title: nls.localize('actions.clipboard.cutLabel', \"Cut\"),\r\n            when: EditorContextKeys.writable,\r\n            order: 1,\r\n        }]\r\n})) : undefined;\r\nexport const CopyAction = supportsCopy ? registerCommand(new MultiCommand({\r\n    id: 'editor.action.clipboardCopyAction',\r\n    precondition: undefined,\r\n    kbOpts: (\r\n    // Do not bind copy keybindings in the browser,\r\n    // since browsers do that for us and it avoids security prompts\r\n    platform.isNative ? {\r\n        primary: 2048 /* CtrlCmd */ | 33 /* KEY_C */,\r\n        win: { primary: 2048 /* CtrlCmd */ | 33 /* KEY_C */, secondary: [2048 /* CtrlCmd */ | 19 /* Insert */] },\r\n        weight: 100 /* EditorContrib */\r\n    } : undefined),\r\n    menuOpts: [{\r\n            menuId: MenuId.MenubarEditMenu,\r\n            group: '2_ccp',\r\n            title: nls.localize({ key: 'miCopy', comment: ['&& denotes a mnemonic'] }, \"&&Copy\"),\r\n            order: 2\r\n        }, {\r\n            menuId: MenuId.EditorContext,\r\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\r\n            order: 2,\r\n        }, {\r\n            menuId: MenuId.CommandPalette,\r\n            group: '',\r\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\r\n            order: 1\r\n        }, {\r\n            menuId: MenuId.SimpleEditorContext,\r\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n            title: nls.localize('actions.clipboard.copyLabel', \"Copy\"),\r\n            order: 2,\r\n        }]\r\n})) : undefined;\r\nMenuRegistry.appendMenuItem(MenuId.MenubarEditMenu, { submenu: MenuId.MenubarCopy, title: { value: nls.localize('copy as', \"Copy As\"), original: 'Copy As', }, group: '2_ccp', order: 3 });\r\nMenuRegistry.appendMenuItem(MenuId.EditorContext, { submenu: MenuId.EditorContextCopy, title: { value: nls.localize('copy as', \"Copy As\"), original: 'Copy As', }, group: CLIPBOARD_CONTEXT_MENU_GROUP, order: 3 });\r\nexport const PasteAction = supportsPaste ? registerCommand(new MultiCommand({\r\n    id: 'editor.action.clipboardPasteAction',\r\n    precondition: undefined,\r\n    kbOpts: (\r\n    // Do not bind paste keybindings in the browser,\r\n    // since browsers do that for us and it avoids security prompts\r\n    platform.isNative ? {\r\n        primary: 2048 /* CtrlCmd */ | 52 /* KEY_V */,\r\n        win: { primary: 2048 /* CtrlCmd */ | 52 /* KEY_V */, secondary: [1024 /* Shift */ | 19 /* Insert */] },\r\n        linux: { primary: 2048 /* CtrlCmd */ | 52 /* KEY_V */, secondary: [1024 /* Shift */ | 19 /* Insert */] },\r\n        weight: 100 /* EditorContrib */\r\n    } : undefined),\r\n    menuOpts: [{\r\n            menuId: MenuId.MenubarEditMenu,\r\n            group: '2_ccp',\r\n            title: nls.localize({ key: 'miPaste', comment: ['&& denotes a mnemonic'] }, \"&&Paste\"),\r\n            order: 4\r\n        }, {\r\n            menuId: MenuId.EditorContext,\r\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\r\n            when: EditorContextKeys.writable,\r\n            order: 4,\r\n        }, {\r\n            menuId: MenuId.CommandPalette,\r\n            group: '',\r\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\r\n            order: 1\r\n        }, {\r\n            menuId: MenuId.SimpleEditorContext,\r\n            group: CLIPBOARD_CONTEXT_MENU_GROUP,\r\n            title: nls.localize('actions.clipboard.pasteLabel', \"Paste\"),\r\n            when: EditorContextKeys.writable,\r\n            order: 4,\r\n        }]\r\n})) : undefined;\r\nclass ExecCommandCopyWithSyntaxHighlightingAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.clipboardCopyWithSyntaxHighlightingAction',\r\n            label: nls.localize('actions.clipboard.copyWithSyntaxHighlightingLabel', \"Copy With Syntax Highlighting\"),\r\n            alias: 'Copy With Syntax Highlighting',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const emptySelectionClipboard = editor.getOption(30 /* emptySelectionClipboard */);\r\n        if (!emptySelectionClipboard && editor.getSelection().isEmpty()) {\r\n            return;\r\n        }\r\n        CopyOptions.forceCopyWithSyntaxHighlighting = true;\r\n        editor.focus();\r\n        document.execCommand('copy');\r\n        CopyOptions.forceCopyWithSyntaxHighlighting = false;\r\n    }\r\n}\r\nfunction registerExecCommandImpl(target, browserCommand) {\r\n    if (!target) {\r\n        return;\r\n    }\r\n    // 1. handle case when focus is in editor.\r\n    target.addImplementation(10000, 'code-editor', (accessor, args) => {\r\n        // Only if editor text focus (i.e. not if editor has widget focus).\r\n        const focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\r\n            // Do not execute if there is no selection and empty selection clipboard is off\r\n            const emptySelectionClipboard = focusedEditor.getOption(30 /* emptySelectionClipboard */);\r\n            const selection = focusedEditor.getSelection();\r\n            if (selection && selection.isEmpty() && !emptySelectionClipboard) {\r\n                return true;\r\n            }\r\n            document.execCommand(browserCommand);\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n    // 2. (default) handle case when focus is somewhere else.\r\n    target.addImplementation(0, 'generic-dom', (accessor, args) => {\r\n        document.execCommand(browserCommand);\r\n        return true;\r\n    });\r\n}\r\nregisterExecCommandImpl(CutAction, 'cut');\r\nregisterExecCommandImpl(CopyAction, 'copy');\r\nif (PasteAction) {\r\n    // 1. Paste: handle case when focus is in editor.\r\n    PasteAction.addImplementation(10000, 'code-editor', (accessor, args) => {\r\n        const codeEditorService = accessor.get(ICodeEditorService);\r\n        const clipboardService = accessor.get(IClipboardService);\r\n        // Only if editor text focus (i.e. not if editor has widget focus).\r\n        const focusedEditor = codeEditorService.getFocusedCodeEditor();\r\n        if (focusedEditor && focusedEditor.hasTextFocus()) {\r\n            const result = document.execCommand('paste');\r\n            // Use the clipboard service if document.execCommand('paste') was not successful\r\n            if (!result && platform.isWeb) {\r\n                (() => __awaiter(void 0, void 0, void 0, function* () {\r\n                    const clipboardText = yield clipboardService.readText();\r\n                    if (clipboardText !== '') {\r\n                        const metadata = InMemoryClipboardMetadataManager.INSTANCE.get(clipboardText);\r\n                        let pasteOnNewLine = false;\r\n                        let multicursorText = null;\r\n                        let mode = null;\r\n                        if (metadata) {\r\n                            pasteOnNewLine = (focusedEditor.getOption(30 /* emptySelectionClipboard */) && !!metadata.isFromEmptySelection);\r\n                            multicursorText = (typeof metadata.multicursorText !== 'undefined' ? metadata.multicursorText : null);\r\n                            mode = metadata.mode;\r\n                        }\r\n                        focusedEditor.trigger('keyboard', \"paste\" /* Paste */, {\r\n                            text: clipboardText,\r\n                            pasteOnNewLine,\r\n                            multicursorText,\r\n                            mode\r\n                        });\r\n                    }\r\n                }))();\r\n                return true;\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n    // 2. Paste: (default) handle case when focus is somewhere else.\r\n    PasteAction.addImplementation(0, 'generic-dom', (accessor, args) => {\r\n        document.execCommand('paste');\r\n        return true;\r\n    });\r\n}\r\nif (supportsCopy) {\r\n    registerEditorAction(ExecCommandCopyWithSyntaxHighlightingAction);\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport class Lazy {\r\n    constructor(executor) {\r\n        this.executor = executor;\r\n        this._didRun = false;\r\n    }\r\n    /**\r\n     * Get the wrapped value.\r\n     *\r\n     * This will force evaluation of the lazy value if it has not been resolved yet. Lazy values are only\r\n     * resolved once. `getValue` will re-throw exceptions that are hit while resolving the value\r\n     */\r\n    getValue() {\r\n        if (!this._didRun) {\r\n            try {\r\n                this._value = this.executor();\r\n            }\r\n            catch (err) {\r\n                this._error = err;\r\n            }\r\n            finally {\r\n                this._didRun = true;\r\n            }\r\n        }\r\n        if (this._error) {\r\n            throw this._error;\r\n        }\r\n        return this._value;\r\n    }\r\n    /**\r\n     * Get the wrapped value without forcing evaluation.\r\n     */\r\n    get rawValue() { return this._value; }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport class CodeActionKind {\r\n    constructor(value) {\r\n        this.value = value;\r\n    }\r\n    equals(other) {\r\n        return this.value === other.value;\r\n    }\r\n    contains(other) {\r\n        return this.equals(other) || this.value === '' || other.value.startsWith(this.value + CodeActionKind.sep);\r\n    }\r\n    intersects(other) {\r\n        return this.contains(other) || other.contains(this);\r\n    }\r\n    append(part) {\r\n        return new CodeActionKind(this.value + CodeActionKind.sep + part);\r\n    }\r\n}\r\nCodeActionKind.sep = '.';\r\nCodeActionKind.None = new CodeActionKind('@@none@@'); // Special code action that contains nothing\r\nCodeActionKind.Empty = new CodeActionKind('');\r\nCodeActionKind.QuickFix = new CodeActionKind('quickfix');\r\nCodeActionKind.Refactor = new CodeActionKind('refactor');\r\nCodeActionKind.Source = new CodeActionKind('source');\r\nCodeActionKind.SourceOrganizeImports = CodeActionKind.Source.append('organizeImports');\r\nCodeActionKind.SourceFixAll = CodeActionKind.Source.append('fixAll');\r\nexport function mayIncludeActionsOfKind(filter, providedKind) {\r\n    // A provided kind may be a subset or superset of our filtered kind.\r\n    if (filter.include && !filter.include.intersects(providedKind)) {\r\n        return false;\r\n    }\r\n    if (filter.excludes) {\r\n        if (filter.excludes.some(exclude => excludesAction(providedKind, exclude, filter.include))) {\r\n            return false;\r\n        }\r\n    }\r\n    // Don't return source actions unless they are explicitly requested\r\n    if (!filter.includeSourceActions && CodeActionKind.Source.contains(providedKind)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nexport function filtersAction(filter, action) {\r\n    const actionKind = action.kind ? new CodeActionKind(action.kind) : undefined;\r\n    // Filter out actions by kind\r\n    if (filter.include) {\r\n        if (!actionKind || !filter.include.contains(actionKind)) {\r\n            return false;\r\n        }\r\n    }\r\n    if (filter.excludes) {\r\n        if (actionKind && filter.excludes.some(exclude => excludesAction(actionKind, exclude, filter.include))) {\r\n            return false;\r\n        }\r\n    }\r\n    // Don't return source actions unless they are explicitly requested\r\n    if (!filter.includeSourceActions) {\r\n        if (actionKind && CodeActionKind.Source.contains(actionKind)) {\r\n            return false;\r\n        }\r\n    }\r\n    if (filter.onlyIncludePreferredActions) {\r\n        if (!action.isPreferred) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction excludesAction(providedKind, exclude, include) {\r\n    if (!exclude.contains(providedKind)) {\r\n        return false;\r\n    }\r\n    if (include && exclude.contains(include)) {\r\n        // The include is more specific, don't filter out\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nexport class CodeActionCommandArgs {\r\n    constructor(kind, apply, preferred) {\r\n        this.kind = kind;\r\n        this.apply = apply;\r\n        this.preferred = preferred;\r\n    }\r\n    static fromUser(arg, defaults) {\r\n        if (!arg || typeof arg !== 'object') {\r\n            return new CodeActionCommandArgs(defaults.kind, defaults.apply, false);\r\n        }\r\n        return new CodeActionCommandArgs(CodeActionCommandArgs.getKindFromUser(arg, defaults.kind), CodeActionCommandArgs.getApplyFromUser(arg, defaults.apply), CodeActionCommandArgs.getPreferredUser(arg));\r\n    }\r\n    static getApplyFromUser(arg, defaultAutoApply) {\r\n        switch (typeof arg.apply === 'string' ? arg.apply.toLowerCase() : '') {\r\n            case 'first': return \"first\" /* First */;\r\n            case 'never': return \"never\" /* Never */;\r\n            case 'ifsingle': return \"ifSingle\" /* IfSingle */;\r\n            default: return defaultAutoApply;\r\n        }\r\n    }\r\n    static getKindFromUser(arg, defaultKind) {\r\n        return typeof arg.kind === 'string'\r\n            ? new CodeActionKind(arg.kind)\r\n            : defaultKind;\r\n    }\r\n    static getPreferredUser(arg) {\r\n        return typeof arg.preferred === 'boolean'\r\n            ? arg.preferred\r\n            : false;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { equals, flatten, isNonEmptyArray, coalesce } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument, isPromiseCanceledError, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { TextModelCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CodeActionKind, filtersAction, mayIncludeActionsOfKind } from './types.js';\r\nimport { Progress } from '../../../platform/progress/common/progress.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nexport const codeActionCommandId = 'editor.action.codeAction';\r\nexport const refactorCommandId = 'editor.action.refactor';\r\nexport const sourceActionCommandId = 'editor.action.sourceAction';\r\nexport const organizeImportsCommandId = 'editor.action.organizeImports';\r\nexport const fixAllCommandId = 'editor.action.fixAll';\r\nexport class CodeActionItem {\r\n    constructor(action, provider) {\r\n        this.action = action;\r\n        this.provider = provider;\r\n    }\r\n    resolve(token) {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (((_a = this.provider) === null || _a === void 0 ? void 0 : _a.resolveCodeAction) && !this.action.edit) {\r\n                let action;\r\n                try {\r\n                    action = yield this.provider.resolveCodeAction(this.action, token);\r\n                }\r\n                catch (err) {\r\n                    onUnexpectedExternalError(err);\r\n                }\r\n                if (action) {\r\n                    this.action.edit = action.edit;\r\n                }\r\n            }\r\n            return this;\r\n        });\r\n    }\r\n}\r\nclass ManagedCodeActionSet extends Disposable {\r\n    constructor(actions, documentation, disposables) {\r\n        super();\r\n        this.documentation = documentation;\r\n        this._register(disposables);\r\n        this.allActions = [...actions].sort(ManagedCodeActionSet.codeActionsComparator);\r\n        this.validActions = this.allActions.filter(({ action }) => !action.disabled);\r\n    }\r\n    static codeActionsComparator({ action: a }, { action: b }) {\r\n        if (a.isPreferred && !b.isPreferred) {\r\n            return -1;\r\n        }\r\n        else if (!a.isPreferred && b.isPreferred) {\r\n            return 1;\r\n        }\r\n        if (isNonEmptyArray(a.diagnostics)) {\r\n            if (isNonEmptyArray(b.diagnostics)) {\r\n                return a.diagnostics[0].message.localeCompare(b.diagnostics[0].message);\r\n            }\r\n            else {\r\n                return -1;\r\n            }\r\n        }\r\n        else if (isNonEmptyArray(b.diagnostics)) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return 0; // both have no diagnostics\r\n        }\r\n    }\r\n    get hasAutoFix() {\r\n        return this.validActions.some(({ action: fix }) => !!fix.kind && CodeActionKind.QuickFix.contains(new CodeActionKind(fix.kind)) && !!fix.isPreferred);\r\n    }\r\n}\r\nconst emptyCodeActionsResponse = { actions: [], documentation: undefined };\r\nexport function getCodeActions(model, rangeOrSelection, trigger, progress, token) {\r\n    var _a;\r\n    const filter = trigger.filter || {};\r\n    const codeActionContext = {\r\n        only: (_a = filter.include) === null || _a === void 0 ? void 0 : _a.value,\r\n        trigger: trigger.type,\r\n    };\r\n    const cts = new TextModelCancellationTokenSource(model, token);\r\n    const providers = getCodeActionProviders(model, filter);\r\n    const disposables = new DisposableStore();\r\n    const promises = providers.map((provider) => __awaiter(this, void 0, void 0, function* () {\r\n        try {\r\n            progress.report(provider);\r\n            const providedCodeActions = yield provider.provideCodeActions(model, rangeOrSelection, codeActionContext, cts.token);\r\n            if (providedCodeActions) {\r\n                disposables.add(providedCodeActions);\r\n            }\r\n            if (cts.token.isCancellationRequested) {\r\n                return emptyCodeActionsResponse;\r\n            }\r\n            const filteredActions = ((providedCodeActions === null || providedCodeActions === void 0 ? void 0 : providedCodeActions.actions) || []).filter(action => action && filtersAction(filter, action));\r\n            const documentation = getDocumentation(provider, filteredActions, filter.include);\r\n            return {\r\n                actions: filteredActions.map(action => new CodeActionItem(action, provider)),\r\n                documentation\r\n            };\r\n        }\r\n        catch (err) {\r\n            if (isPromiseCanceledError(err)) {\r\n                throw err;\r\n            }\r\n            onUnexpectedExternalError(err);\r\n            return emptyCodeActionsResponse;\r\n        }\r\n    }));\r\n    const listener = modes.CodeActionProviderRegistry.onDidChange(() => {\r\n        const newProviders = modes.CodeActionProviderRegistry.all(model);\r\n        if (!equals(newProviders, providers)) {\r\n            cts.cancel();\r\n        }\r\n    });\r\n    return Promise.all(promises).then(actions => {\r\n        const allActions = flatten(actions.map(x => x.actions));\r\n        const allDocumentation = coalesce(actions.map(x => x.documentation));\r\n        return new ManagedCodeActionSet(allActions, allDocumentation, disposables);\r\n    })\r\n        .finally(() => {\r\n        listener.dispose();\r\n        cts.dispose();\r\n    });\r\n}\r\nfunction getCodeActionProviders(model, filter) {\r\n    return modes.CodeActionProviderRegistry.all(model)\r\n        // Don't include providers that we know will not return code actions of interest\r\n        .filter(provider => {\r\n        if (!provider.providedCodeActionKinds) {\r\n            // We don't know what type of actions this provider will return.\r\n            return true;\r\n        }\r\n        return provider.providedCodeActionKinds.some(kind => mayIncludeActionsOfKind(filter, new CodeActionKind(kind)));\r\n    });\r\n}\r\nfunction getDocumentation(provider, providedCodeActions, only) {\r\n    if (!provider.documentation) {\r\n        return undefined;\r\n    }\r\n    const documentation = provider.documentation.map(entry => ({ kind: new CodeActionKind(entry.kind), command: entry.command }));\r\n    if (only) {\r\n        let currentBest;\r\n        for (const entry of documentation) {\r\n            if (entry.kind.contains(only)) {\r\n                if (!currentBest) {\r\n                    currentBest = entry;\r\n                }\r\n                else {\r\n                    // Take best match\r\n                    if (currentBest.kind.contains(entry.kind)) {\r\n                        currentBest = entry;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (currentBest) {\r\n            return currentBest === null || currentBest === void 0 ? void 0 : currentBest.command;\r\n        }\r\n    }\r\n    // Otherwise, check to see if any of the provided actions match.\r\n    for (const action of providedCodeActions) {\r\n        if (!action.kind) {\r\n            continue;\r\n        }\r\n        for (const entry of documentation) {\r\n            if (entry.kind.contains(new CodeActionKind(action.kind))) {\r\n                return entry.command;\r\n            }\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\nCommandsRegistry.registerCommand('_executeCodeActionProvider', function (accessor, resource, rangeOrSelection, kind, itemResolveCount) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        if (!(resource instanceof URI)) {\r\n            throw illegalArgument();\r\n        }\r\n        const model = accessor.get(IModelService).getModel(resource);\r\n        if (!model) {\r\n            throw illegalArgument();\r\n        }\r\n        const validatedRangeOrSelection = Selection.isISelection(rangeOrSelection)\r\n            ? Selection.liftSelection(rangeOrSelection)\r\n            : Range.isIRange(rangeOrSelection)\r\n                ? model.validateRange(rangeOrSelection)\r\n                : undefined;\r\n        if (!validatedRangeOrSelection) {\r\n            throw illegalArgument();\r\n        }\r\n        const include = typeof kind === 'string' ? new CodeActionKind(kind) : undefined;\r\n        const codeActionSet = yield getCodeActions(model, validatedRangeOrSelection, { type: 1 /* Invoke */, filter: { includeSourceActions: true, include } }, Progress.None, CancellationToken.None);\r\n        const resolving = [];\r\n        const resolveCount = Math.min(codeActionSet.validActions.length, typeof itemResolveCount === 'number' ? itemResolveCount : 0);\r\n        for (let i = 0; i < resolveCount; i++) {\r\n            resolving.push(codeActionSet.validActions[i].resolve(CancellationToken.None));\r\n        }\r\n        try {\r\n            yield Promise.all(resolving);\r\n            return codeActionSet.validActions.map(item => item.action);\r\n        }\r\n        finally {\r\n            setTimeout(() => codeActionSet.dispose(), 100);\r\n        }\r\n    });\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './messageController.css';\r\nimport * as nls from '../../../nls.js';\r\nimport { TimeoutTimer } from '../../../base/common/async.js';\r\nimport { DisposableStore, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorContribution, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { inputValidationInfoBorder, inputValidationInfoBackground, inputValidationInfoForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { ColorScheme } from '../../../platform/theme/common/theme.js';\r\nlet MessageController = class MessageController {\r\n    constructor(editor, contextKeyService) {\r\n        this._messageWidget = new MutableDisposable();\r\n        this._messageListeners = new DisposableStore();\r\n        this._editor = editor;\r\n        this._visible = MessageController.MESSAGE_VISIBLE.bindTo(contextKeyService);\r\n        this._editorListener = this._editor.onDidAttemptReadOnlyEdit(() => this._onDidAttemptReadOnlyEdit());\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(MessageController.ID);\r\n    }\r\n    dispose() {\r\n        this._editorListener.dispose();\r\n        this._messageListeners.dispose();\r\n        this._messageWidget.dispose();\r\n        this._visible.reset();\r\n    }\r\n    showMessage(message, position) {\r\n        alert(message);\r\n        this._visible.set(true);\r\n        this._messageWidget.clear();\r\n        this._messageListeners.clear();\r\n        this._messageWidget.value = new MessageWidget(this._editor, position, message);\r\n        // close on blur, cursor, model change, dispose\r\n        this._messageListeners.add(this._editor.onDidBlurEditorText(() => this.closeMessage()));\r\n        this._messageListeners.add(this._editor.onDidChangeCursorPosition(() => this.closeMessage()));\r\n        this._messageListeners.add(this._editor.onDidDispose(() => this.closeMessage()));\r\n        this._messageListeners.add(this._editor.onDidChangeModel(() => this.closeMessage()));\r\n        // 3sec\r\n        this._messageListeners.add(new TimeoutTimer(() => this.closeMessage(), 3000));\r\n        // close on mouse move\r\n        let bounds;\r\n        this._messageListeners.add(this._editor.onMouseMove(e => {\r\n            // outside the text area\r\n            if (!e.target.position) {\r\n                return;\r\n            }\r\n            if (!bounds) {\r\n                // define bounding box around position and first mouse occurance\r\n                bounds = new Range(position.lineNumber - 3, 1, e.target.position.lineNumber + 3, 1);\r\n            }\r\n            else if (!bounds.containsPosition(e.target.position)) {\r\n                // check if position is still in bounds\r\n                this.closeMessage();\r\n            }\r\n        }));\r\n    }\r\n    closeMessage() {\r\n        this._visible.reset();\r\n        this._messageListeners.clear();\r\n        if (this._messageWidget.value) {\r\n            this._messageListeners.add(MessageWidget.fadeOut(this._messageWidget.value));\r\n        }\r\n    }\r\n    _onDidAttemptReadOnlyEdit() {\r\n        if (this._editor.hasModel()) {\r\n            this.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this._editor.getPosition());\r\n        }\r\n    }\r\n};\r\nMessageController.ID = 'editor.contrib.messageController';\r\nMessageController.MESSAGE_VISIBLE = new RawContextKey('messageVisible', false, nls.localize('messageVisible', 'Whether the editor is currently showing an inline message'));\r\nMessageController = __decorate([\r\n    __param(1, IContextKeyService)\r\n], MessageController);\r\nexport { MessageController };\r\nconst MessageCommand = EditorCommand.bindToContribution(MessageController.get);\r\nregisterEditorCommand(new MessageCommand({\r\n    id: 'leaveEditorMessage',\r\n    precondition: MessageController.MESSAGE_VISIBLE,\r\n    handler: c => c.closeMessage(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        primary: 9 /* Escape */\r\n    }\r\n}));\r\nclass MessageWidget {\r\n    constructor(editor, { lineNumber, column }, text) {\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this.suppressMouseDown = false;\r\n        this._editor = editor;\r\n        this._editor.revealLinesInCenterIfOutsideViewport(lineNumber, lineNumber, 0 /* Smooth */);\r\n        this._position = { lineNumber, column: column - 1 };\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.classList.add('monaco-editor-overlaymessage');\r\n        const anchorTop = document.createElement('div');\r\n        anchorTop.classList.add('anchor', 'top');\r\n        this._domNode.appendChild(anchorTop);\r\n        const message = document.createElement('div');\r\n        message.classList.add('message');\r\n        message.textContent = text;\r\n        this._domNode.appendChild(message);\r\n        const anchorBottom = document.createElement('div');\r\n        anchorBottom.classList.add('anchor', 'below');\r\n        this._domNode.appendChild(anchorBottom);\r\n        this._editor.addContentWidget(this);\r\n        this._domNode.classList.add('fadeIn');\r\n    }\r\n    static fadeOut(messageWidget) {\r\n        let handle;\r\n        const dispose = () => {\r\n            messageWidget.dispose();\r\n            clearTimeout(handle);\r\n            messageWidget.getDomNode().removeEventListener('animationend', dispose);\r\n        };\r\n        handle = setTimeout(dispose, 110);\r\n        messageWidget.getDomNode().addEventListener('animationend', dispose);\r\n        messageWidget.getDomNode().classList.add('fadeOut');\r\n        return { dispose };\r\n    }\r\n    dispose() {\r\n        this._editor.removeContentWidget(this);\r\n    }\r\n    getId() {\r\n        return 'messageoverlay';\r\n    }\r\n    getDomNode() {\r\n        return this._domNode;\r\n    }\r\n    getPosition() {\r\n        return { position: this._position, preference: [1 /* ABOVE */, 2 /* BELOW */] };\r\n    }\r\n    afterRender(position) {\r\n        this._domNode.classList.toggle('below', position === 2 /* BELOW */);\r\n    }\r\n}\r\nregisterEditorContribution(MessageController.ID, MessageController);\r\nregisterThemingParticipant((theme, collector) => {\r\n    const border = theme.getColor(inputValidationInfoBorder);\r\n    if (border) {\r\n        let borderWidth = theme.type === ColorScheme.HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.below { border-top-color: ${border}; }`);\r\n        collector.addRule(`.monaco-editor .monaco-editor-overlaymessage .anchor.top { border-bottom-color: ${border}; }`);\r\n        collector.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { border: ${borderWidth}px solid ${border}; }`);\r\n    }\r\n    const background = theme.getColor(inputValidationInfoBackground);\r\n    if (background) {\r\n        collector.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { background-color: ${background}; }`);\r\n    }\r\n    const foreground = theme.getColor(inputValidationInfoForeground);\r\n    if (foreground) {\r\n        collector.addRule(`.monaco-editor .monaco-editor-overlaymessage .message { color: ${foreground}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { getDomNodePagePosition } from '../../../base/browser/dom.js';\r\nimport { Action, Separator } from '../../../base/common/actions.js';\r\nimport { canceled } from '../../../base/common/errors.js';\r\nimport { Lazy } from '../../../base/common/lazy.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { CodeActionProviderRegistry } from '../../common/modes.js';\r\nimport { codeActionCommandId, CodeActionItem, fixAllCommandId, organizeImportsCommandId, refactorCommandId, sourceActionCommandId } from './codeAction.js';\r\nimport { CodeActionCommandArgs, CodeActionKind } from './types.js';\r\nimport { IContextMenuService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nclass CodeActionAction extends Action {\r\n    constructor(action, callback) {\r\n        super(action.command ? action.command.id : action.title, stripNewlines(action.title), undefined, !action.disabled, callback);\r\n        this.action = action;\r\n    }\r\n}\r\nfunction stripNewlines(str) {\r\n    return str.replace(/\\r\\n|\\r|\\n/g, ' ');\r\n}\r\nlet CodeActionMenu = class CodeActionMenu extends Disposable {\r\n    constructor(_editor, _delegate, _contextMenuService, keybindingService) {\r\n        super();\r\n        this._editor = _editor;\r\n        this._delegate = _delegate;\r\n        this._contextMenuService = _contextMenuService;\r\n        this._visible = false;\r\n        this._showingActions = this._register(new MutableDisposable());\r\n        this._keybindingResolver = new CodeActionKeybindingResolver({\r\n            getKeybindings: () => keybindingService.getKeybindings()\r\n        });\r\n    }\r\n    get isVisible() {\r\n        return this._visible;\r\n    }\r\n    show(trigger, codeActions, at, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const actionsToShow = options.includeDisabledActions ? codeActions.allActions : codeActions.validActions;\r\n            if (!actionsToShow.length) {\r\n                this._visible = false;\r\n                return;\r\n            }\r\n            if (!this._editor.getDomNode()) {\r\n                // cancel when editor went off-dom\r\n                this._visible = false;\r\n                throw canceled();\r\n            }\r\n            this._visible = true;\r\n            this._showingActions.value = codeActions;\r\n            const menuActions = this.getMenuActions(trigger, actionsToShow, codeActions.documentation);\r\n            const anchor = Position.isIPosition(at) ? this._toCoords(at) : at || { x: 0, y: 0 };\r\n            const resolver = this._keybindingResolver.getResolver();\r\n            const useShadowDOM = this._editor.getOption(113 /* useShadowDOM */);\r\n            this._contextMenuService.showContextMenu({\r\n                domForShadowRoot: useShadowDOM ? this._editor.getDomNode() : undefined,\r\n                getAnchor: () => anchor,\r\n                getActions: () => menuActions,\r\n                onHide: () => {\r\n                    this._visible = false;\r\n                    this._editor.focus();\r\n                },\r\n                autoSelectFirstItem: true,\r\n                getKeyBinding: action => action instanceof CodeActionAction ? resolver(action.action) : undefined,\r\n            });\r\n        });\r\n    }\r\n    getMenuActions(trigger, actionsToShow, documentation) {\r\n        var _a, _b;\r\n        const toCodeActionAction = (item) => new CodeActionAction(item.action, () => this._delegate.onSelectCodeAction(item));\r\n        const result = actionsToShow\r\n            .map(toCodeActionAction);\r\n        const allDocumentation = [...documentation];\r\n        const model = this._editor.getModel();\r\n        if (model && result.length) {\r\n            for (const provider of CodeActionProviderRegistry.all(model)) {\r\n                if (provider._getAdditionalMenuItems) {\r\n                    allDocumentation.push(...provider._getAdditionalMenuItems({ trigger: trigger.type, only: (_b = (_a = trigger.filter) === null || _a === void 0 ? void 0 : _a.include) === null || _b === void 0 ? void 0 : _b.value }, actionsToShow.map(item => item.action)));\r\n                }\r\n            }\r\n        }\r\n        if (allDocumentation.length) {\r\n            result.push(new Separator(), ...allDocumentation.map(command => toCodeActionAction(new CodeActionItem({\r\n                title: command.title,\r\n                command: command,\r\n            }, undefined))));\r\n        }\r\n        return result;\r\n    }\r\n    _toCoords(position) {\r\n        if (!this._editor.hasModel()) {\r\n            return { x: 0, y: 0 };\r\n        }\r\n        this._editor.revealPosition(position, 1 /* Immediate */);\r\n        this._editor.render();\r\n        // Translate to absolute editor position\r\n        const cursorCoords = this._editor.getScrolledVisiblePosition(position);\r\n        const editorCoords = getDomNodePagePosition(this._editor.getDomNode());\r\n        const x = editorCoords.left + cursorCoords.left;\r\n        const y = editorCoords.top + cursorCoords.top + cursorCoords.height;\r\n        return { x, y };\r\n    }\r\n};\r\nCodeActionMenu = __decorate([\r\n    __param(2, IContextMenuService),\r\n    __param(3, IKeybindingService)\r\n], CodeActionMenu);\r\nexport { CodeActionMenu };\r\nexport class CodeActionKeybindingResolver {\r\n    constructor(_keybindingProvider) {\r\n        this._keybindingProvider = _keybindingProvider;\r\n    }\r\n    getResolver() {\r\n        // Lazy since we may not actually ever read the value\r\n        const allCodeActionBindings = new Lazy(() => this._keybindingProvider.getKeybindings()\r\n            .filter(item => CodeActionKeybindingResolver.codeActionCommands.indexOf(item.command) >= 0)\r\n            .filter(item => item.resolvedKeybinding)\r\n            .map((item) => {\r\n            // Special case these commands since they come built-in with VS Code and don't use 'commandArgs'\r\n            let commandArgs = item.commandArgs;\r\n            if (item.command === organizeImportsCommandId) {\r\n                commandArgs = { kind: CodeActionKind.SourceOrganizeImports.value };\r\n            }\r\n            else if (item.command === fixAllCommandId) {\r\n                commandArgs = { kind: CodeActionKind.SourceFixAll.value };\r\n            }\r\n            return Object.assign({ resolvedKeybinding: item.resolvedKeybinding }, CodeActionCommandArgs.fromUser(commandArgs, {\r\n                kind: CodeActionKind.None,\r\n                apply: \"never\" /* Never */\r\n            }));\r\n        }));\r\n        return (action) => {\r\n            if (action.kind) {\r\n                const binding = this.bestKeybindingForCodeAction(action, allCodeActionBindings.getValue());\r\n                return binding === null || binding === void 0 ? void 0 : binding.resolvedKeybinding;\r\n            }\r\n            return undefined;\r\n        };\r\n    }\r\n    bestKeybindingForCodeAction(action, candidates) {\r\n        if (!action.kind) {\r\n            return undefined;\r\n        }\r\n        const kind = new CodeActionKind(action.kind);\r\n        return candidates\r\n            .filter(candidate => candidate.kind.contains(kind))\r\n            .filter(candidate => {\r\n            if (candidate.preferred) {\r\n                // If the candidate keybinding only applies to preferred actions, the this action must also be preferred\r\n                return action.isPreferred;\r\n            }\r\n            return true;\r\n        })\r\n            .reduceRight((currentBest, candidate) => {\r\n            if (!currentBest) {\r\n                return candidate;\r\n            }\r\n            // Select the more specific binding\r\n            return currentBest.kind.contains(candidate.kind) ? candidate : currentBest;\r\n        }, undefined);\r\n    }\r\n}\r\nCodeActionKeybindingResolver.codeActionCommands = [\r\n    refactorCommandId,\r\n    codeActionCommandId,\r\n    sourceActionCommandId,\r\n    organizeImportsCommandId,\r\n    fixAllCommandId\r\n];\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../../base/browser/globalMouseMoveMonitor.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport './lightBulbWidget.css';\r\nimport { TextModel } from '../../common/model/textModel.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { editorLightBulbForeground, editorLightBulbAutoFixForeground, editorBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { Gesture } from '../../../base/browser/touch.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nvar LightBulbState;\r\n(function (LightBulbState) {\r\n    LightBulbState.Hidden = { type: 0 /* Hidden */ };\r\n    class Showing {\r\n        constructor(actions, trigger, editorPosition, widgetPosition) {\r\n            this.actions = actions;\r\n            this.trigger = trigger;\r\n            this.editorPosition = editorPosition;\r\n            this.widgetPosition = widgetPosition;\r\n            this.type = 1 /* Showing */;\r\n        }\r\n    }\r\n    LightBulbState.Showing = Showing;\r\n})(LightBulbState || (LightBulbState = {}));\r\nlet LightBulbWidget = class LightBulbWidget extends Disposable {\r\n    constructor(_editor, _quickFixActionId, _preferredFixActionId, _keybindingService) {\r\n        super();\r\n        this._editor = _editor;\r\n        this._quickFixActionId = _quickFixActionId;\r\n        this._preferredFixActionId = _preferredFixActionId;\r\n        this._keybindingService = _keybindingService;\r\n        this._onClick = this._register(new Emitter());\r\n        this.onClick = this._onClick.event;\r\n        this._state = LightBulbState.Hidden;\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.className = Codicon.lightBulb.classNames;\r\n        this._editor.addContentWidget(this);\r\n        this._register(this._editor.onDidChangeModelContent(_ => {\r\n            // cancel when the line in question has been removed\r\n            const editorModel = this._editor.getModel();\r\n            if (this.state.type !== 1 /* Showing */ || !editorModel || this.state.editorPosition.lineNumber >= editorModel.getLineCount()) {\r\n                this.hide();\r\n            }\r\n        }));\r\n        Gesture.ignoreTarget(this._domNode);\r\n        this._register(dom.addStandardDisposableGenericMouseDownListner(this._domNode, e => {\r\n            if (this.state.type !== 1 /* Showing */) {\r\n                return;\r\n            }\r\n            // Make sure that focus / cursor location is not lost when clicking widget icon\r\n            this._editor.focus();\r\n            e.preventDefault();\r\n            // a bit of extra work to make sure the menu\r\n            // doesn't cover the line-text\r\n            const { top, height } = dom.getDomNodePagePosition(this._domNode);\r\n            const lineHeight = this._editor.getOption(57 /* lineHeight */);\r\n            let pad = Math.floor(lineHeight / 3);\r\n            if (this.state.widgetPosition.position !== null && this.state.widgetPosition.position.lineNumber < this.state.editorPosition.lineNumber) {\r\n                pad += lineHeight;\r\n            }\r\n            this._onClick.fire({\r\n                x: e.posx,\r\n                y: top + height + pad,\r\n                actions: this.state.actions,\r\n                trigger: this.state.trigger,\r\n            });\r\n        }));\r\n        this._register(dom.addDisposableListener(this._domNode, 'mouseenter', (e) => {\r\n            if ((e.buttons & 1) !== 1) {\r\n                return;\r\n            }\r\n            // mouse enters lightbulb while the primary/left button\r\n            // is being pressed -> hide the lightbulb and block future\r\n            // showings until mouse is released\r\n            this.hide();\r\n            const monitor = new GlobalMouseMoveMonitor();\r\n            monitor.startMonitoring(e.target, e.buttons, standardMouseMoveMerger, () => { }, () => {\r\n                monitor.dispose();\r\n            });\r\n        }));\r\n        this._register(this._editor.onDidChangeConfiguration(e => {\r\n            // hide when told to do so\r\n            if (e.hasChanged(55 /* lightbulb */) && !this._editor.getOption(55 /* lightbulb */).enabled) {\r\n                this.hide();\r\n            }\r\n        }));\r\n        this._updateLightBulbTitleAndIcon();\r\n        this._register(this._keybindingService.onDidUpdateKeybindings(this._updateLightBulbTitleAndIcon, this));\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n        this._editor.removeContentWidget(this);\r\n    }\r\n    getId() {\r\n        return 'LightBulbWidget';\r\n    }\r\n    getDomNode() {\r\n        return this._domNode;\r\n    }\r\n    getPosition() {\r\n        return this._state.type === 1 /* Showing */ ? this._state.widgetPosition : null;\r\n    }\r\n    update(actions, trigger, atPosition) {\r\n        if (actions.validActions.length <= 0) {\r\n            return this.hide();\r\n        }\r\n        const options = this._editor.getOptions();\r\n        if (!options.get(55 /* lightbulb */).enabled) {\r\n            return this.hide();\r\n        }\r\n        const model = this._editor.getModel();\r\n        if (!model) {\r\n            return this.hide();\r\n        }\r\n        const { lineNumber, column } = model.validatePosition(atPosition);\r\n        const tabSize = model.getOptions().tabSize;\r\n        const fontInfo = options.get(41 /* fontInfo */);\r\n        const lineContent = model.getLineContent(lineNumber);\r\n        const indent = TextModel.computeIndentLevel(lineContent, tabSize);\r\n        const lineHasSpace = fontInfo.spaceWidth * indent > 22;\r\n        const isFolded = (lineNumber) => {\r\n            return lineNumber > 2 && this._editor.getTopForLineNumber(lineNumber) === this._editor.getTopForLineNumber(lineNumber - 1);\r\n        };\r\n        let effectiveLineNumber = lineNumber;\r\n        if (!lineHasSpace) {\r\n            if (lineNumber > 1 && !isFolded(lineNumber - 1)) {\r\n                effectiveLineNumber -= 1;\r\n            }\r\n            else if (!isFolded(lineNumber + 1)) {\r\n                effectiveLineNumber += 1;\r\n            }\r\n            else if (column * fontInfo.spaceWidth < 22) {\r\n                // cannot show lightbulb above/below and showing\r\n                // it inline would overlay the cursor...\r\n                return this.hide();\r\n            }\r\n        }\r\n        this.state = new LightBulbState.Showing(actions, trigger, atPosition, {\r\n            position: { lineNumber: effectiveLineNumber, column: 1 },\r\n            preference: LightBulbWidget._posPref\r\n        });\r\n        this._editor.layoutContentWidget(this);\r\n    }\r\n    hide() {\r\n        this.state = LightBulbState.Hidden;\r\n        this._editor.layoutContentWidget(this);\r\n    }\r\n    get state() { return this._state; }\r\n    set state(value) {\r\n        this._state = value;\r\n        this._updateLightBulbTitleAndIcon();\r\n    }\r\n    _updateLightBulbTitleAndIcon() {\r\n        if (this.state.type === 1 /* Showing */ && this.state.actions.hasAutoFix) {\r\n            // update icon\r\n            this._domNode.classList.remove(...Codicon.lightBulb.classNamesArray);\r\n            this._domNode.classList.add(...Codicon.lightbulbAutofix.classNamesArray);\r\n            const preferredKb = this._keybindingService.lookupKeybinding(this._preferredFixActionId);\r\n            if (preferredKb) {\r\n                this.title = nls.localize('prefferedQuickFixWithKb', \"Show Fixes. Preferred Fix Available ({0})\", preferredKb.getLabel());\r\n                return;\r\n            }\r\n        }\r\n        // update icon\r\n        this._domNode.classList.remove(...Codicon.lightbulbAutofix.classNamesArray);\r\n        this._domNode.classList.add(...Codicon.lightBulb.classNamesArray);\r\n        const kb = this._keybindingService.lookupKeybinding(this._quickFixActionId);\r\n        if (kb) {\r\n            this.title = nls.localize('quickFixWithKb', \"Show Fixes ({0})\", kb.getLabel());\r\n        }\r\n        else {\r\n            this.title = nls.localize('quickFix', \"Show Fixes\");\r\n        }\r\n    }\r\n    set title(value) {\r\n        this._domNode.title = value;\r\n    }\r\n};\r\nLightBulbWidget._posPref = [0 /* EXACT */];\r\nLightBulbWidget = __decorate([\r\n    __param(3, IKeybindingService)\r\n], LightBulbWidget);\r\nexport { LightBulbWidget };\r\nregisterThemingParticipant((theme, collector) => {\r\n    var _a;\r\n    const editorBackgroundColor = (_a = theme.getColor(editorBackground)) === null || _a === void 0 ? void 0 : _a.transparent(0.7);\r\n    // Lightbulb Icon\r\n    const editorLightBulbForegroundColor = theme.getColor(editorLightBulbForeground);\r\n    if (editorLightBulbForegroundColor) {\r\n        collector.addRule(`\n\t\t.monaco-editor .contentWidgets ${Codicon.lightBulb.cssSelector} {\n\t\t\tcolor: ${editorLightBulbForegroundColor};\n\t\t\tbackground-color: ${editorBackgroundColor};\n\t\t}`);\r\n    }\r\n    // Lightbulb Auto Fix Icon\r\n    const editorLightBulbAutoFixForegroundColor = theme.getColor(editorLightBulbAutoFixForeground);\r\n    if (editorLightBulbAutoFixForegroundColor) {\r\n        collector.addRule(`\n\t\t.monaco-editor .contentWidgets ${Codicon.lightbulbAutofix.cssSelector} {\n\t\t\tcolor: ${editorLightBulbAutoFixForegroundColor};\n\t\t\tbackground-color: ${editorBackgroundColor};\n\t\t}`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n};\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n};\r\nvar _CodeActionUi_disposed;\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Lazy } from '../../../base/common/lazy.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { CodeActionMenu } from './codeActionMenu.js';\r\nimport { LightBulbWidget } from './lightBulbWidget.js';\r\nlet CodeActionUi = class CodeActionUi extends Disposable {\r\n    constructor(_editor, quickFixActionId, preferredFixActionId, delegate, instantiationService) {\r\n        super();\r\n        this._editor = _editor;\r\n        this.delegate = delegate;\r\n        this._activeCodeActions = this._register(new MutableDisposable());\r\n        _CodeActionUi_disposed.set(this, false);\r\n        this._codeActionWidget = new Lazy(() => {\r\n            return this._register(instantiationService.createInstance(CodeActionMenu, this._editor, {\r\n                onSelectCodeAction: (action) => __awaiter(this, void 0, void 0, function* () {\r\n                    this.delegate.applyCodeAction(action, /* retrigger */ true);\r\n                })\r\n            }));\r\n        });\r\n        this._lightBulbWidget = new Lazy(() => {\r\n            const widget = this._register(instantiationService.createInstance(LightBulbWidget, this._editor, quickFixActionId, preferredFixActionId));\r\n            this._register(widget.onClick(e => this.showCodeActionList(e.trigger, e.actions, e, { includeDisabledActions: false })));\r\n            return widget;\r\n        });\r\n    }\r\n    dispose() {\r\n        __classPrivateFieldSet(this, _CodeActionUi_disposed, true, \"f\");\r\n        super.dispose();\r\n    }\r\n    update(newState) {\r\n        var _a, _b, _c;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (newState.type !== 1 /* Triggered */) {\r\n                (_a = this._lightBulbWidget.rawValue) === null || _a === void 0 ? void 0 : _a.hide();\r\n                return;\r\n            }\r\n            let actions;\r\n            try {\r\n                actions = yield newState.actions;\r\n            }\r\n            catch (e) {\r\n                onUnexpectedError(e);\r\n                return;\r\n            }\r\n            if (__classPrivateFieldGet(this, _CodeActionUi_disposed, \"f\")) {\r\n                return;\r\n            }\r\n            this._lightBulbWidget.getValue().update(actions, newState.trigger, newState.position);\r\n            if (newState.trigger.type === 1 /* Invoke */) {\r\n                if ((_b = newState.trigger.filter) === null || _b === void 0 ? void 0 : _b.include) { // Triggered for specific scope\r\n                    // Check to see if we want to auto apply.\r\n                    const validActionToApply = this.tryGetValidActionToApply(newState.trigger, actions);\r\n                    if (validActionToApply) {\r\n                        try {\r\n                            yield this.delegate.applyCodeAction(validActionToApply, false);\r\n                        }\r\n                        finally {\r\n                            actions.dispose();\r\n                        }\r\n                        return;\r\n                    }\r\n                    // Check to see if there is an action that we would have applied were it not invalid\r\n                    if (newState.trigger.context) {\r\n                        const invalidAction = this.getInvalidActionThatWouldHaveBeenApplied(newState.trigger, actions);\r\n                        if (invalidAction && invalidAction.action.disabled) {\r\n                            MessageController.get(this._editor).showMessage(invalidAction.action.disabled, newState.trigger.context.position);\r\n                            actions.dispose();\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n                const includeDisabledActions = !!((_c = newState.trigger.filter) === null || _c === void 0 ? void 0 : _c.include);\r\n                if (newState.trigger.context) {\r\n                    if (!actions.allActions.length || !includeDisabledActions && !actions.validActions.length) {\r\n                        MessageController.get(this._editor).showMessage(newState.trigger.context.notAvailableMessage, newState.trigger.context.position);\r\n                        this._activeCodeActions.value = actions;\r\n                        actions.dispose();\r\n                        return;\r\n                    }\r\n                }\r\n                this._activeCodeActions.value = actions;\r\n                this._codeActionWidget.getValue().show(newState.trigger, actions, newState.position, { includeDisabledActions });\r\n            }\r\n            else {\r\n                // auto magically triggered\r\n                if (this._codeActionWidget.getValue().isVisible) {\r\n                    // TODO: Figure out if we should update the showing menu?\r\n                    actions.dispose();\r\n                }\r\n                else {\r\n                    this._activeCodeActions.value = actions;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    getInvalidActionThatWouldHaveBeenApplied(trigger, actions) {\r\n        if (!actions.allActions.length) {\r\n            return undefined;\r\n        }\r\n        if ((trigger.autoApply === \"first\" /* First */ && actions.validActions.length === 0)\r\n            || (trigger.autoApply === \"ifSingle\" /* IfSingle */ && actions.allActions.length === 1)) {\r\n            return actions.allActions.find(({ action }) => action.disabled);\r\n        }\r\n        return undefined;\r\n    }\r\n    tryGetValidActionToApply(trigger, actions) {\r\n        if (!actions.validActions.length) {\r\n            return undefined;\r\n        }\r\n        if ((trigger.autoApply === \"first\" /* First */ && actions.validActions.length > 0)\r\n            || (trigger.autoApply === \"ifSingle\" /* IfSingle */ && actions.validActions.length === 1)) {\r\n            return actions.validActions[0];\r\n        }\r\n        return undefined;\r\n    }\r\n    showCodeActionList(trigger, actions, at, options) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this._codeActionWidget.getValue().show(trigger, actions, at, options);\r\n        });\r\n    }\r\n};\r\n_CodeActionUi_disposed = new WeakMap();\r\nCodeActionUi = __decorate([\r\n    __param(4, IInstantiationService)\r\n], CodeActionUi);\r\nexport { CodeActionUi };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n};\r\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n};\r\nvar _CodeActionModel_isDisposed;\r\nimport { createCancelablePromise, TimeoutTimer } from '../../../base/common/async.js';\r\nimport { isPromiseCanceledError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { CodeActionProviderRegistry } from '../../common/modes.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { Progress } from '../../../platform/progress/common/progress.js';\r\nimport { getCodeActions } from './codeAction.js';\r\nexport const SUPPORTED_CODE_ACTIONS = new RawContextKey('supportedCodeAction', '');\r\nclass CodeActionOracle extends Disposable {\r\n    constructor(_editor, _markerService, _signalChange, _delay = 250) {\r\n        super();\r\n        this._editor = _editor;\r\n        this._markerService = _markerService;\r\n        this._signalChange = _signalChange;\r\n        this._delay = _delay;\r\n        this._autoTriggerTimer = this._register(new TimeoutTimer());\r\n        this._register(this._markerService.onMarkerChanged(e => this._onMarkerChanges(e)));\r\n        this._register(this._editor.onDidChangeCursorPosition(() => this._onCursorChange()));\r\n    }\r\n    trigger(trigger) {\r\n        const selection = this._getRangeOfSelectionUnlessWhitespaceEnclosed(trigger);\r\n        return this._createEventAndSignalChange(trigger, selection);\r\n    }\r\n    _onMarkerChanges(resources) {\r\n        const model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        if (resources.some(resource => isEqual(resource, model.uri))) {\r\n            this._autoTriggerTimer.cancelAndSet(() => {\r\n                this.trigger({ type: 2 /* Auto */ });\r\n            }, this._delay);\r\n        }\r\n    }\r\n    _onCursorChange() {\r\n        this._autoTriggerTimer.cancelAndSet(() => {\r\n            this.trigger({ type: 2 /* Auto */ });\r\n        }, this._delay);\r\n    }\r\n    _getRangeOfMarker(selection) {\r\n        const model = this._editor.getModel();\r\n        if (!model) {\r\n            return undefined;\r\n        }\r\n        for (const marker of this._markerService.read({ resource: model.uri })) {\r\n            const markerRange = model.validateRange(marker);\r\n            if (Range.intersectRanges(markerRange, selection)) {\r\n                return Range.lift(markerRange);\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    _getRangeOfSelectionUnlessWhitespaceEnclosed(trigger) {\r\n        if (!this._editor.hasModel()) {\r\n            return undefined;\r\n        }\r\n        const model = this._editor.getModel();\r\n        const selection = this._editor.getSelection();\r\n        if (selection.isEmpty() && trigger.type === 2 /* Auto */) {\r\n            const { lineNumber, column } = selection.getPosition();\r\n            const line = model.getLineContent(lineNumber);\r\n            if (line.length === 0) {\r\n                // empty line\r\n                return undefined;\r\n            }\r\n            else if (column === 1) {\r\n                // look only right\r\n                if (/\\s/.test(line[0])) {\r\n                    return undefined;\r\n                }\r\n            }\r\n            else if (column === model.getLineMaxColumn(lineNumber)) {\r\n                // look only left\r\n                if (/\\s/.test(line[line.length - 1])) {\r\n                    return undefined;\r\n                }\r\n            }\r\n            else {\r\n                // look left and right\r\n                if (/\\s/.test(line[column - 2]) && /\\s/.test(line[column - 1])) {\r\n                    return undefined;\r\n                }\r\n            }\r\n        }\r\n        return selection;\r\n    }\r\n    _createEventAndSignalChange(trigger, selection) {\r\n        const model = this._editor.getModel();\r\n        if (!selection || !model) {\r\n            // cancel\r\n            this._signalChange(undefined);\r\n            return undefined;\r\n        }\r\n        const markerRange = this._getRangeOfMarker(selection);\r\n        const position = markerRange ? markerRange.getStartPosition() : selection.getStartPosition();\r\n        const e = {\r\n            trigger,\r\n            selection,\r\n            position\r\n        };\r\n        this._signalChange(e);\r\n        return e;\r\n    }\r\n}\r\nexport var CodeActionsState;\r\n(function (CodeActionsState) {\r\n    CodeActionsState.Empty = { type: 0 /* Empty */ };\r\n    class Triggered {\r\n        constructor(trigger, rangeOrSelection, position, _cancellablePromise) {\r\n            this.trigger = trigger;\r\n            this.rangeOrSelection = rangeOrSelection;\r\n            this.position = position;\r\n            this._cancellablePromise = _cancellablePromise;\r\n            this.type = 1 /* Triggered */;\r\n            this.actions = _cancellablePromise.catch((e) => {\r\n                if (isPromiseCanceledError(e)) {\r\n                    return emptyCodeActionSet;\r\n                }\r\n                throw e;\r\n            });\r\n        }\r\n        cancel() {\r\n            this._cancellablePromise.cancel();\r\n        }\r\n    }\r\n    CodeActionsState.Triggered = Triggered;\r\n})(CodeActionsState || (CodeActionsState = {}));\r\nconst emptyCodeActionSet = {\r\n    allActions: [],\r\n    validActions: [],\r\n    dispose: () => { },\r\n    documentation: [],\r\n    hasAutoFix: false\r\n};\r\nexport class CodeActionModel extends Disposable {\r\n    constructor(_editor, _markerService, contextKeyService, _progressService) {\r\n        super();\r\n        this._editor = _editor;\r\n        this._markerService = _markerService;\r\n        this._progressService = _progressService;\r\n        this._codeActionOracle = this._register(new MutableDisposable());\r\n        this._state = CodeActionsState.Empty;\r\n        this._onDidChangeState = this._register(new Emitter());\r\n        this.onDidChangeState = this._onDidChangeState.event;\r\n        _CodeActionModel_isDisposed.set(this, false);\r\n        this._supportedCodeActions = SUPPORTED_CODE_ACTIONS.bindTo(contextKeyService);\r\n        this._register(this._editor.onDidChangeModel(() => this._update()));\r\n        this._register(this._editor.onDidChangeModelLanguage(() => this._update()));\r\n        this._register(CodeActionProviderRegistry.onDidChange(() => this._update()));\r\n        this._update();\r\n    }\r\n    dispose() {\r\n        if (__classPrivateFieldGet(this, _CodeActionModel_isDisposed, \"f\")) {\r\n            return;\r\n        }\r\n        __classPrivateFieldSet(this, _CodeActionModel_isDisposed, true, \"f\");\r\n        super.dispose();\r\n        this.setState(CodeActionsState.Empty, true);\r\n    }\r\n    _update() {\r\n        if (__classPrivateFieldGet(this, _CodeActionModel_isDisposed, \"f\")) {\r\n            return;\r\n        }\r\n        this._codeActionOracle.value = undefined;\r\n        this.setState(CodeActionsState.Empty);\r\n        const model = this._editor.getModel();\r\n        if (model\r\n            && CodeActionProviderRegistry.has(model)\r\n            && !this._editor.getOption(79 /* readOnly */)) {\r\n            const supportedActions = [];\r\n            for (const provider of CodeActionProviderRegistry.all(model)) {\r\n                if (Array.isArray(provider.providedCodeActionKinds)) {\r\n                    supportedActions.push(...provider.providedCodeActionKinds);\r\n                }\r\n            }\r\n            this._supportedCodeActions.set(supportedActions.join(' '));\r\n            this._codeActionOracle.value = new CodeActionOracle(this._editor, this._markerService, trigger => {\r\n                var _a;\r\n                if (!trigger) {\r\n                    this.setState(CodeActionsState.Empty);\r\n                    return;\r\n                }\r\n                const actions = createCancelablePromise(token => getCodeActions(model, trigger.selection, trigger.trigger, Progress.None, token));\r\n                if (trigger.trigger.type === 1 /* Invoke */) {\r\n                    (_a = this._progressService) === null || _a === void 0 ? void 0 : _a.showWhile(actions, 250);\r\n                }\r\n                this.setState(new CodeActionsState.Triggered(trigger.trigger, trigger.selection, trigger.position, actions));\r\n            }, undefined);\r\n            this._codeActionOracle.value.trigger({ type: 2 /* Auto */ });\r\n        }\r\n        else {\r\n            this._supportedCodeActions.reset();\r\n        }\r\n    }\r\n    trigger(trigger) {\r\n        if (this._codeActionOracle.value) {\r\n            this._codeActionOracle.value.trigger(trigger);\r\n        }\r\n    }\r\n    setState(newState, skipNotify) {\r\n        if (newState === this._state) {\r\n            return;\r\n        }\r\n        // Cancel old request\r\n        if (this._state.type === 1 /* Triggered */) {\r\n            this._state.cancel();\r\n        }\r\n        this._state = newState;\r\n        if (!skipNotify && !__classPrivateFieldGet(this, _CodeActionModel_isDisposed, \"f\")) {\r\n            this._onDidChangeState.fire(newState);\r\n        }\r\n    }\r\n}\r\n_CodeActionModel_isDisposed = new WeakMap();\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { Lazy } from '../../../base/common/lazy.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { escapeRegExpCharacters } from '../../../base/common/strings.js';\r\nimport { EditorAction, EditorCommand } from '../../browser/editorExtensions.js';\r\nimport { IBulkEditService, ResourceEdit } from '../../browser/services/bulkEditService.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { codeActionCommandId, fixAllCommandId, organizeImportsCommandId, refactorCommandId, sourceActionCommandId } from './codeAction.js';\r\nimport { CodeActionUi } from './codeActionUi.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IMarkerService } from '../../../platform/markers/common/markers.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\r\nimport { CodeActionModel, SUPPORTED_CODE_ACTIONS } from './codeActionModel.js';\r\nimport { CodeActionCommandArgs, CodeActionKind } from './types.js';\r\nfunction contextKeyForSupportedActions(kind) {\r\n    return ContextKeyExpr.regex(SUPPORTED_CODE_ACTIONS.keys()[0], new RegExp('(\\\\s|^)' + escapeRegExpCharacters(kind.value) + '\\\\b'));\r\n}\r\nconst argsSchema = {\r\n    type: 'object',\r\n    defaultSnippets: [{ body: { kind: '' } }],\r\n    properties: {\r\n        'kind': {\r\n            type: 'string',\r\n            description: nls.localize('args.schema.kind', \"Kind of the code action to run.\"),\r\n        },\r\n        'apply': {\r\n            type: 'string',\r\n            description: nls.localize('args.schema.apply', \"Controls when the returned actions are applied.\"),\r\n            default: \"ifSingle\" /* IfSingle */,\r\n            enum: [\"first\" /* First */, \"ifSingle\" /* IfSingle */, \"never\" /* Never */],\r\n            enumDescriptions: [\r\n                nls.localize('args.schema.apply.first', \"Always apply the first returned code action.\"),\r\n                nls.localize('args.schema.apply.ifSingle', \"Apply the first returned code action if it is the only one.\"),\r\n                nls.localize('args.schema.apply.never', \"Do not apply the returned code actions.\"),\r\n            ]\r\n        },\r\n        'preferred': {\r\n            type: 'boolean',\r\n            default: false,\r\n            description: nls.localize('args.schema.preferred', \"Controls if only preferred code actions should be returned.\"),\r\n        }\r\n    }\r\n};\r\nlet QuickFixController = class QuickFixController extends Disposable {\r\n    constructor(editor, markerService, contextKeyService, progressService, _instantiationService) {\r\n        super();\r\n        this._instantiationService = _instantiationService;\r\n        this._editor = editor;\r\n        this._model = this._register(new CodeActionModel(this._editor, markerService, contextKeyService, progressService));\r\n        this._register(this._model.onDidChangeState(newState => this.update(newState)));\r\n        this._ui = new Lazy(() => this._register(new CodeActionUi(editor, QuickFixAction.Id, AutoFixAction.Id, {\r\n            applyCodeAction: (action, retrigger) => __awaiter(this, void 0, void 0, function* () {\r\n                try {\r\n                    yield this._applyCodeAction(action);\r\n                }\r\n                finally {\r\n                    if (retrigger) {\r\n                        this._trigger({ type: 2 /* Auto */, filter: {} });\r\n                    }\r\n                }\r\n            })\r\n        }, this._instantiationService)));\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(QuickFixController.ID);\r\n    }\r\n    update(newState) {\r\n        this._ui.getValue().update(newState);\r\n    }\r\n    showCodeActions(trigger, actions, at) {\r\n        return this._ui.getValue().showCodeActionList(trigger, actions, at, { includeDisabledActions: false });\r\n    }\r\n    manualTriggerAtCurrentPosition(notAvailableMessage, filter, autoApply) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        MessageController.get(this._editor).closeMessage();\r\n        const triggerPosition = this._editor.getPosition();\r\n        this._trigger({ type: 1 /* Invoke */, filter, autoApply, context: { notAvailableMessage, position: triggerPosition } });\r\n    }\r\n    _trigger(trigger) {\r\n        return this._model.trigger(trigger);\r\n    }\r\n    _applyCodeAction(action) {\r\n        return this._instantiationService.invokeFunction(applyCodeAction, action, this._editor);\r\n    }\r\n};\r\nQuickFixController.ID = 'editor.contrib.quickFixController';\r\nQuickFixController = __decorate([\r\n    __param(1, IMarkerService),\r\n    __param(2, IContextKeyService),\r\n    __param(3, IEditorProgressService),\r\n    __param(4, IInstantiationService)\r\n], QuickFixController);\r\nexport { QuickFixController };\r\nexport function applyCodeAction(accessor, item, editor) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const bulkEditService = accessor.get(IBulkEditService);\r\n        const commandService = accessor.get(ICommandService);\r\n        const telemetryService = accessor.get(ITelemetryService);\r\n        const notificationService = accessor.get(INotificationService);\r\n        telemetryService.publicLog2('codeAction.applyCodeAction', {\r\n            codeActionTitle: item.action.title,\r\n            codeActionKind: item.action.kind,\r\n            codeActionIsPreferred: !!item.action.isPreferred,\r\n        });\r\n        yield item.resolve(CancellationToken.None);\r\n        if (item.action.edit) {\r\n            yield bulkEditService.apply(ResourceEdit.convert(item.action.edit), { editor, label: item.action.title });\r\n        }\r\n        if (item.action.command) {\r\n            try {\r\n                yield commandService.executeCommand(item.action.command.id, ...(item.action.command.arguments || []));\r\n            }\r\n            catch (err) {\r\n                const message = asMessage(err);\r\n                notificationService.error(typeof message === 'string'\r\n                    ? message\r\n                    : nls.localize('applyCodeActionFailed', \"An unknown error occurred while applying the code action\"));\r\n            }\r\n        }\r\n    });\r\n}\r\nfunction asMessage(err) {\r\n    if (typeof err === 'string') {\r\n        return err;\r\n    }\r\n    else if (err instanceof Error && typeof err.message === 'string') {\r\n        return err.message;\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\nfunction triggerCodeActionsForEditorSelection(editor, notAvailableMessage, filter, autoApply) {\r\n    if (editor.hasModel()) {\r\n        const controller = QuickFixController.get(editor);\r\n        if (controller) {\r\n            controller.manualTriggerAtCurrentPosition(notAvailableMessage, filter, autoApply);\r\n        }\r\n    }\r\n}\r\nexport class QuickFixAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: QuickFixAction.Id,\r\n            label: nls.localize('quickfix.trigger.label', \"Quick Fix...\"),\r\n            alias: 'Quick Fix...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 84 /* US_DOT */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.quickFix.noneMessage', \"No code actions available\"), undefined, undefined);\r\n    }\r\n}\r\nQuickFixAction.Id = 'editor.action.quickFix';\r\nexport class CodeActionCommand extends EditorCommand {\r\n    constructor() {\r\n        super({\r\n            id: codeActionCommandId,\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            description: {\r\n                description: 'Trigger a code action',\r\n                args: [{ name: 'args', schema: argsSchema, }]\r\n            }\r\n        });\r\n    }\r\n    runEditorCommand(_accessor, editor, userArgs) {\r\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\r\n            kind: CodeActionKind.Empty,\r\n            apply: \"ifSingle\" /* IfSingle */,\r\n        });\r\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\r\n            ? args.preferred\r\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred.kind', \"No preferred code actions for '{0}' available\", userArgs.kind)\r\n                : nls.localize('editor.action.codeAction.noneMessage.kind', \"No code actions for '{0}' available\", userArgs.kind)\r\n            : args.preferred\r\n                ? nls.localize('editor.action.codeAction.noneMessage.preferred', \"No preferred code actions available\")\r\n                : nls.localize('editor.action.codeAction.noneMessage', \"No code actions available\"), {\r\n            include: args.kind,\r\n            includeSourceActions: true,\r\n            onlyIncludePreferredActions: args.preferred,\r\n        }, args.apply);\r\n    }\r\n}\r\nexport class RefactorAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: refactorCommandId,\r\n            label: nls.localize('refactor.label', \"Refactor...\"),\r\n            alias: 'Refactor...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 48 /* KEY_R */,\r\n                mac: {\r\n                    primary: 256 /* WinCtrl */ | 1024 /* Shift */ | 48 /* KEY_R */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 2,\r\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Refactor)),\r\n            },\r\n            description: {\r\n                description: 'Refactor...',\r\n                args: [{ name: 'args', schema: argsSchema }]\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor, userArgs) {\r\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\r\n            kind: CodeActionKind.Refactor,\r\n            apply: \"never\" /* Never */\r\n        });\r\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\r\n            ? args.preferred\r\n                ? nls.localize('editor.action.refactor.noneMessage.preferred.kind', \"No preferred refactorings for '{0}' available\", userArgs.kind)\r\n                : nls.localize('editor.action.refactor.noneMessage.kind', \"No refactorings for '{0}' available\", userArgs.kind)\r\n            : args.preferred\r\n                ? nls.localize('editor.action.refactor.noneMessage.preferred', \"No preferred refactorings available\")\r\n                : nls.localize('editor.action.refactor.noneMessage', \"No refactorings available\"), {\r\n            include: CodeActionKind.Refactor.contains(args.kind) ? args.kind : CodeActionKind.None,\r\n            onlyIncludePreferredActions: args.preferred,\r\n        }, args.apply);\r\n    }\r\n}\r\nexport class SourceAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: sourceActionCommandId,\r\n            label: nls.localize('source.label', \"Source Action...\"),\r\n            alias: 'Source Action...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCodeActionsProvider),\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 2.1,\r\n                when: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.Source)),\r\n            },\r\n            description: {\r\n                description: 'Source Action...',\r\n                args: [{ name: 'args', schema: argsSchema }]\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor, userArgs) {\r\n        const args = CodeActionCommandArgs.fromUser(userArgs, {\r\n            kind: CodeActionKind.Source,\r\n            apply: \"never\" /* Never */\r\n        });\r\n        return triggerCodeActionsForEditorSelection(editor, typeof (userArgs === null || userArgs === void 0 ? void 0 : userArgs.kind) === 'string'\r\n            ? args.preferred\r\n                ? nls.localize('editor.action.source.noneMessage.preferred.kind', \"No preferred source actions for '{0}' available\", userArgs.kind)\r\n                : nls.localize('editor.action.source.noneMessage.kind', \"No source actions for '{0}' available\", userArgs.kind)\r\n            : args.preferred\r\n                ? nls.localize('editor.action.source.noneMessage.preferred', \"No preferred source actions available\")\r\n                : nls.localize('editor.action.source.noneMessage', \"No source actions available\"), {\r\n            include: CodeActionKind.Source.contains(args.kind) ? args.kind : CodeActionKind.None,\r\n            includeSourceActions: true,\r\n            onlyIncludePreferredActions: args.preferred,\r\n        }, args.apply);\r\n    }\r\n}\r\nexport class OrganizeImportsAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: organizeImportsCommandId,\r\n            label: nls.localize('organizeImports.label', \"Organize Imports\"),\r\n            alias: 'Organize Imports',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceOrganizeImports)),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 45 /* KEY_O */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.organize.noneMessage', \"No organize imports action available\"), { include: CodeActionKind.SourceOrganizeImports, includeSourceActions: true }, \"ifSingle\" /* IfSingle */);\r\n    }\r\n}\r\nexport class FixAllAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: fixAllCommandId,\r\n            label: nls.localize('fixAll.label', \"Fix All\"),\r\n            alias: 'Fix All',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.SourceFixAll))\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('fixAll.noneMessage', \"No fix all action available\"), { include: CodeActionKind.SourceFixAll, includeSourceActions: true }, \"ifSingle\" /* IfSingle */);\r\n    }\r\n}\r\nexport class AutoFixAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: AutoFixAction.Id,\r\n            label: nls.localize('autoFix.label', \"Auto Fix...\"),\r\n            alias: 'Auto Fix...',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, contextKeyForSupportedActions(CodeActionKind.QuickFix)),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 84 /* US_DOT */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 84 /* US_DOT */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        return triggerCodeActionsForEditorSelection(editor, nls.localize('editor.action.autoFix.noneMessage', \"No auto fixes available\"), {\r\n            include: CodeActionKind.QuickFix,\r\n            onlyIncludePreferredActions: true\r\n        }, \"ifSingle\" /* IfSingle */);\r\n    }\r\n}\r\nAutoFixAction.Id = 'editor.action.autoFix';\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { CodeActionCommand, OrganizeImportsAction, QuickFixAction, QuickFixController, RefactorAction, SourceAction, AutoFixAction, FixAllAction } from './codeActionCommands.js';\r\nregisterEditorContribution(QuickFixController.ID, QuickFixController);\r\nregisterEditorAction(QuickFixAction);\r\nregisterEditorAction(RefactorAction);\r\nregisterEditorAction(SourceAction);\r\nregisterEditorAction(OrganizeImportsAction);\r\nregisterEditorAction(AutoFixAction);\r\nregisterEditorAction(FixAllAction);\r\nregisterEditorCommand(new CodeActionCommand());\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nexport class BlockCommentCommand {\r\n    constructor(selection, insertSpace) {\r\n        this._selection = selection;\r\n        this._insertSpace = insertSpace;\r\n        this._usedEndToken = null;\r\n    }\r\n    static _haystackHasNeedleAtOffset(haystack, needle, offset) {\r\n        if (offset < 0) {\r\n            return false;\r\n        }\r\n        const needleLength = needle.length;\r\n        const haystackLength = haystack.length;\r\n        if (offset + needleLength > haystackLength) {\r\n            return false;\r\n        }\r\n        for (let i = 0; i < needleLength; i++) {\r\n            const codeA = haystack.charCodeAt(offset + i);\r\n            const codeB = needle.charCodeAt(i);\r\n            if (codeA === codeB) {\r\n                continue;\r\n            }\r\n            if (codeA >= 65 /* A */ && codeA <= 90 /* Z */ && codeA + 32 === codeB) {\r\n                // codeA is upper-case variant of codeB\r\n                continue;\r\n            }\r\n            if (codeB >= 65 /* A */ && codeB <= 90 /* Z */ && codeB + 32 === codeA) {\r\n                // codeB is upper-case variant of codeA\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    _createOperationsForBlockComment(selection, startToken, endToken, insertSpace, model, builder) {\r\n        const startLineNumber = selection.startLineNumber;\r\n        const startColumn = selection.startColumn;\r\n        const endLineNumber = selection.endLineNumber;\r\n        const endColumn = selection.endColumn;\r\n        const startLineText = model.getLineContent(startLineNumber);\r\n        const endLineText = model.getLineContent(endLineNumber);\r\n        let startTokenIndex = startLineText.lastIndexOf(startToken, startColumn - 1 + startToken.length);\r\n        let endTokenIndex = endLineText.indexOf(endToken, endColumn - 1 - endToken.length);\r\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\r\n            if (startLineNumber === endLineNumber) {\r\n                const lineBetweenTokens = startLineText.substring(startTokenIndex + startToken.length, endTokenIndex);\r\n                if (lineBetweenTokens.indexOf(endToken) >= 0) {\r\n                    // force to add a block comment\r\n                    startTokenIndex = -1;\r\n                    endTokenIndex = -1;\r\n                }\r\n            }\r\n            else {\r\n                const startLineAfterStartToken = startLineText.substring(startTokenIndex + startToken.length);\r\n                const endLineBeforeEndToken = endLineText.substring(0, endTokenIndex);\r\n                if (startLineAfterStartToken.indexOf(endToken) >= 0 || endLineBeforeEndToken.indexOf(endToken) >= 0) {\r\n                    // force to add a block comment\r\n                    startTokenIndex = -1;\r\n                    endTokenIndex = -1;\r\n                }\r\n            }\r\n        }\r\n        let ops;\r\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\r\n            // Consider spaces as part of the comment tokens\r\n            if (insertSpace && startTokenIndex + startToken.length < startLineText.length && startLineText.charCodeAt(startTokenIndex + startToken.length) === 32 /* Space */) {\r\n                // Pretend the start token contains a trailing space\r\n                startToken = startToken + ' ';\r\n            }\r\n            if (insertSpace && endTokenIndex > 0 && endLineText.charCodeAt(endTokenIndex - 1) === 32 /* Space */) {\r\n                // Pretend the end token contains a leading space\r\n                endToken = ' ' + endToken;\r\n                endTokenIndex -= 1;\r\n            }\r\n            ops = BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\r\n        }\r\n        else {\r\n            ops = BlockCommentCommand._createAddBlockCommentOperations(selection, startToken, endToken, this._insertSpace);\r\n            this._usedEndToken = ops.length === 1 ? endToken : null;\r\n        }\r\n        for (const op of ops) {\r\n            builder.addTrackedEditOperation(op.range, op.text);\r\n        }\r\n    }\r\n    static _createRemoveBlockCommentOperations(r, startToken, endToken) {\r\n        let res = [];\r\n        if (!Range.isEmpty(r)) {\r\n            // Remove block comment start\r\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.startLineNumber, r.startColumn)));\r\n            // Remove block comment end\r\n            res.push(EditOperation.delete(new Range(r.endLineNumber, r.endColumn, r.endLineNumber, r.endColumn + endToken.length)));\r\n        }\r\n        else {\r\n            // Remove both continuously\r\n            res.push(EditOperation.delete(new Range(r.startLineNumber, r.startColumn - startToken.length, r.endLineNumber, r.endColumn + endToken.length)));\r\n        }\r\n        return res;\r\n    }\r\n    static _createAddBlockCommentOperations(r, startToken, endToken, insertSpace) {\r\n        let res = [];\r\n        if (!Range.isEmpty(r)) {\r\n            // Insert block comment start\r\n            res.push(EditOperation.insert(new Position(r.startLineNumber, r.startColumn), startToken + (insertSpace ? ' ' : '')));\r\n            // Insert block comment end\r\n            res.push(EditOperation.insert(new Position(r.endLineNumber, r.endColumn), (insertSpace ? ' ' : '') + endToken));\r\n        }\r\n        else {\r\n            // Insert both continuously\r\n            res.push(EditOperation.replace(new Range(r.startLineNumber, r.startColumn, r.endLineNumber, r.endColumn), startToken + '  ' + endToken));\r\n        }\r\n        return res;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        const startLineNumber = this._selection.startLineNumber;\r\n        const startColumn = this._selection.startColumn;\r\n        model.tokenizeIfCheap(startLineNumber);\r\n        const languageId = model.getLanguageIdAtPosition(startLineNumber, startColumn);\r\n        const config = LanguageConfigurationRegistry.getComments(languageId);\r\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\r\n            // Mode does not support block comments\r\n            return;\r\n        }\r\n        this._createOperationsForBlockComment(this._selection, config.blockCommentStartToken, config.blockCommentEndToken, this._insertSpace, model, builder);\r\n    }\r\n    computeCursorState(model, helper) {\r\n        const inverseEditOperations = helper.getInverseEditOperations();\r\n        if (inverseEditOperations.length === 2) {\r\n            const startTokenEditOperation = inverseEditOperations[0];\r\n            const endTokenEditOperation = inverseEditOperations[1];\r\n            return new Selection(startTokenEditOperation.range.endLineNumber, startTokenEditOperation.range.endColumn, endTokenEditOperation.range.startLineNumber, endTokenEditOperation.range.startColumn);\r\n        }\r\n        else {\r\n            const srcRange = inverseEditOperations[0].range;\r\n            const deltaColumn = this._usedEndToken ? -this._usedEndToken.length - 1 : 0; // minus 1 space before endToken\r\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn + deltaColumn, srcRange.endLineNumber, srcRange.endColumn + deltaColumn);\r\n        }\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { BlockCommentCommand } from './blockCommentCommand.js';\r\nexport class LineCommentCommand {\r\n    constructor(selection, tabSize, type, insertSpace, ignoreEmptyLines, ignoreFirstLine) {\r\n        this._selection = selection;\r\n        this._tabSize = tabSize;\r\n        this._type = type;\r\n        this._insertSpace = insertSpace;\r\n        this._selectionId = null;\r\n        this._deltaColumn = 0;\r\n        this._moveEndPositionDown = false;\r\n        this._ignoreEmptyLines = ignoreEmptyLines;\r\n        this._ignoreFirstLine = ignoreFirstLine || false;\r\n    }\r\n    /**\r\n     * Do an initial pass over the lines and gather info about the line comment string.\r\n     * Returns null if any of the lines doesn't support a line comment string.\r\n     */\r\n    static _gatherPreflightCommentStrings(model, startLineNumber, endLineNumber) {\r\n        model.tokenizeIfCheap(startLineNumber);\r\n        const languageId = model.getLanguageIdAtPosition(startLineNumber, 1);\r\n        const config = LanguageConfigurationRegistry.getComments(languageId);\r\n        const commentStr = (config ? config.lineCommentToken : null);\r\n        if (!commentStr) {\r\n            // Mode does not support line comments\r\n            return null;\r\n        }\r\n        let lines = [];\r\n        for (let i = 0, lineCount = endLineNumber - startLineNumber + 1; i < lineCount; i++) {\r\n            lines[i] = {\r\n                ignore: false,\r\n                commentStr: commentStr,\r\n                commentStrOffset: 0,\r\n                commentStrLength: commentStr.length\r\n            };\r\n        }\r\n        return lines;\r\n    }\r\n    /**\r\n     * Analyze lines and decide which lines are relevant and what the toggle should do.\r\n     * Also, build up several offsets and lengths useful in the generation of editor operations.\r\n     */\r\n    static _analyzeLines(type, insertSpace, model, lines, startLineNumber, ignoreEmptyLines, ignoreFirstLine) {\r\n        let onlyWhitespaceLines = true;\r\n        let shouldRemoveComments;\r\n        if (type === 0 /* Toggle */) {\r\n            shouldRemoveComments = true;\r\n        }\r\n        else if (type === 1 /* ForceAdd */) {\r\n            shouldRemoveComments = false;\r\n        }\r\n        else {\r\n            shouldRemoveComments = true;\r\n        }\r\n        for (let i = 0, lineCount = lines.length; i < lineCount; i++) {\r\n            const lineData = lines[i];\r\n            const lineNumber = startLineNumber + i;\r\n            if (lineNumber === startLineNumber && ignoreFirstLine) {\r\n                // first line ignored\r\n                lineData.ignore = true;\r\n                continue;\r\n            }\r\n            const lineContent = model.getLineContent(lineNumber);\r\n            const lineContentStartOffset = strings.firstNonWhitespaceIndex(lineContent);\r\n            if (lineContentStartOffset === -1) {\r\n                // Empty or whitespace only line\r\n                lineData.ignore = ignoreEmptyLines;\r\n                lineData.commentStrOffset = lineContent.length;\r\n                continue;\r\n            }\r\n            onlyWhitespaceLines = false;\r\n            lineData.ignore = false;\r\n            lineData.commentStrOffset = lineContentStartOffset;\r\n            if (shouldRemoveComments && !BlockCommentCommand._haystackHasNeedleAtOffset(lineContent, lineData.commentStr, lineContentStartOffset)) {\r\n                if (type === 0 /* Toggle */) {\r\n                    // Every line so far has been a line comment, but this one is not\r\n                    shouldRemoveComments = false;\r\n                }\r\n                else if (type === 1 /* ForceAdd */) {\r\n                    // Will not happen\r\n                }\r\n                else {\r\n                    lineData.ignore = true;\r\n                }\r\n            }\r\n            if (shouldRemoveComments && insertSpace) {\r\n                // Remove a following space if present\r\n                const commentStrEndOffset = lineContentStartOffset + lineData.commentStrLength;\r\n                if (commentStrEndOffset < lineContent.length && lineContent.charCodeAt(commentStrEndOffset) === 32 /* Space */) {\r\n                    lineData.commentStrLength += 1;\r\n                }\r\n            }\r\n        }\r\n        if (type === 0 /* Toggle */ && onlyWhitespaceLines) {\r\n            // For only whitespace lines, we insert comments\r\n            shouldRemoveComments = false;\r\n            // Also, no longer ignore them\r\n            for (let i = 0, lineCount = lines.length; i < lineCount; i++) {\r\n                lines[i].ignore = false;\r\n            }\r\n        }\r\n        return {\r\n            supported: true,\r\n            shouldRemoveComments: shouldRemoveComments,\r\n            lines: lines\r\n        };\r\n    }\r\n    /**\r\n     * Analyze all lines and decide exactly what to do => not supported | insert line comments | remove line comments\r\n     */\r\n    static _gatherPreflightData(type, insertSpace, model, startLineNumber, endLineNumber, ignoreEmptyLines, ignoreFirstLine) {\r\n        const lines = LineCommentCommand._gatherPreflightCommentStrings(model, startLineNumber, endLineNumber);\r\n        if (lines === null) {\r\n            return {\r\n                supported: false\r\n            };\r\n        }\r\n        return LineCommentCommand._analyzeLines(type, insertSpace, model, lines, startLineNumber, ignoreEmptyLines, ignoreFirstLine);\r\n    }\r\n    /**\r\n     * Given a successful analysis, execute either insert line comments, either remove line comments\r\n     */\r\n    _executeLineComments(model, builder, data, s) {\r\n        let ops;\r\n        if (data.shouldRemoveComments) {\r\n            ops = LineCommentCommand._createRemoveLineCommentsOperations(data.lines, s.startLineNumber);\r\n        }\r\n        else {\r\n            LineCommentCommand._normalizeInsertionPoint(model, data.lines, s.startLineNumber, this._tabSize);\r\n            ops = this._createAddLineCommentsOperations(data.lines, s.startLineNumber);\r\n        }\r\n        const cursorPosition = new Position(s.positionLineNumber, s.positionColumn);\r\n        for (let i = 0, len = ops.length; i < len; i++) {\r\n            builder.addEditOperation(ops[i].range, ops[i].text);\r\n            if (Range.isEmpty(ops[i].range) && Range.getStartPosition(ops[i].range).equals(cursorPosition)) {\r\n                const lineContent = model.getLineContent(cursorPosition.lineNumber);\r\n                if (lineContent.length + 1 === cursorPosition.column) {\r\n                    this._deltaColumn = (ops[i].text || '').length;\r\n                }\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n    }\r\n    _attemptRemoveBlockComment(model, s, startToken, endToken) {\r\n        let startLineNumber = s.startLineNumber;\r\n        let endLineNumber = s.endLineNumber;\r\n        let startTokenAllowedBeforeColumn = endToken.length + Math.max(model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.startColumn);\r\n        let startTokenIndex = model.getLineContent(startLineNumber).lastIndexOf(startToken, startTokenAllowedBeforeColumn - 1);\r\n        let endTokenIndex = model.getLineContent(endLineNumber).indexOf(endToken, s.endColumn - 1 - startToken.length);\r\n        if (startTokenIndex !== -1 && endTokenIndex === -1) {\r\n            endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\r\n            endLineNumber = startLineNumber;\r\n        }\r\n        if (startTokenIndex === -1 && endTokenIndex !== -1) {\r\n            startTokenIndex = model.getLineContent(endLineNumber).lastIndexOf(startToken, endTokenIndex);\r\n            startLineNumber = endLineNumber;\r\n        }\r\n        if (s.isEmpty() && (startTokenIndex === -1 || endTokenIndex === -1)) {\r\n            startTokenIndex = model.getLineContent(startLineNumber).indexOf(startToken);\r\n            if (startTokenIndex !== -1) {\r\n                endTokenIndex = model.getLineContent(startLineNumber).indexOf(endToken, startTokenIndex + startToken.length);\r\n            }\r\n        }\r\n        // We have to adjust to possible inner white space.\r\n        // For Space after startToken, add Space to startToken - range math will work out.\r\n        if (startTokenIndex !== -1 && model.getLineContent(startLineNumber).charCodeAt(startTokenIndex + startToken.length) === 32 /* Space */) {\r\n            startToken += ' ';\r\n        }\r\n        // For Space before endToken, add Space before endToken and shift index one left.\r\n        if (endTokenIndex !== -1 && model.getLineContent(endLineNumber).charCodeAt(endTokenIndex - 1) === 32 /* Space */) {\r\n            endToken = ' ' + endToken;\r\n            endTokenIndex -= 1;\r\n        }\r\n        if (startTokenIndex !== -1 && endTokenIndex !== -1) {\r\n            return BlockCommentCommand._createRemoveBlockCommentOperations(new Range(startLineNumber, startTokenIndex + startToken.length + 1, endLineNumber, endTokenIndex + 1), startToken, endToken);\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Given an unsuccessful analysis, delegate to the block comment command\r\n     */\r\n    _executeBlockComment(model, builder, s) {\r\n        model.tokenizeIfCheap(s.startLineNumber);\r\n        let languageId = model.getLanguageIdAtPosition(s.startLineNumber, 1);\r\n        let config = LanguageConfigurationRegistry.getComments(languageId);\r\n        if (!config || !config.blockCommentStartToken || !config.blockCommentEndToken) {\r\n            // Mode does not support block comments\r\n            return;\r\n        }\r\n        const startToken = config.blockCommentStartToken;\r\n        const endToken = config.blockCommentEndToken;\r\n        let ops = this._attemptRemoveBlockComment(model, s, startToken, endToken);\r\n        if (!ops) {\r\n            if (s.isEmpty()) {\r\n                const lineContent = model.getLineContent(s.startLineNumber);\r\n                let firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\r\n                if (firstNonWhitespaceIndex === -1) {\r\n                    // Line is empty or contains only whitespace\r\n                    firstNonWhitespaceIndex = lineContent.length;\r\n                }\r\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, firstNonWhitespaceIndex + 1, s.startLineNumber, lineContent.length + 1), startToken, endToken, this._insertSpace);\r\n            }\r\n            else {\r\n                ops = BlockCommentCommand._createAddBlockCommentOperations(new Range(s.startLineNumber, model.getLineFirstNonWhitespaceColumn(s.startLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), startToken, endToken, this._insertSpace);\r\n            }\r\n            if (ops.length === 1) {\r\n                // Leave cursor after token and Space\r\n                this._deltaColumn = startToken.length + 1;\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n        for (const op of ops) {\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n    }\r\n    getEditOperations(model, builder) {\r\n        let s = this._selection;\r\n        this._moveEndPositionDown = false;\r\n        if (s.startLineNumber === s.endLineNumber && this._ignoreFirstLine) {\r\n            builder.addEditOperation(new Range(s.startLineNumber, model.getLineMaxColumn(s.startLineNumber), s.startLineNumber + 1, 1), s.startLineNumber === model.getLineCount() ? '' : '\\n');\r\n            this._selectionId = builder.trackSelection(s);\r\n            return;\r\n        }\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._moveEndPositionDown = true;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        const data = LineCommentCommand._gatherPreflightData(this._type, this._insertSpace, model, s.startLineNumber, s.endLineNumber, this._ignoreEmptyLines, this._ignoreFirstLine);\r\n        if (data.supported) {\r\n            return this._executeLineComments(model, builder, data, s);\r\n        }\r\n        return this._executeBlockComment(model, builder, s);\r\n    }\r\n    computeCursorState(model, helper) {\r\n        let result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._moveEndPositionDown) {\r\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\r\n        }\r\n        return new Selection(result.selectionStartLineNumber, result.selectionStartColumn + this._deltaColumn, result.positionLineNumber, result.positionColumn + this._deltaColumn);\r\n    }\r\n    /**\r\n     * Generate edit operations in the remove line comment case\r\n     */\r\n    static _createRemoveLineCommentsOperations(lines, startLineNumber) {\r\n        let res = [];\r\n        for (let i = 0, len = lines.length; i < len; i++) {\r\n            const lineData = lines[i];\r\n            if (lineData.ignore) {\r\n                continue;\r\n            }\r\n            res.push(EditOperation.delete(new Range(startLineNumber + i, lineData.commentStrOffset + 1, startLineNumber + i, lineData.commentStrOffset + lineData.commentStrLength + 1)));\r\n        }\r\n        return res;\r\n    }\r\n    /**\r\n     * Generate edit operations in the add line comment case\r\n     */\r\n    _createAddLineCommentsOperations(lines, startLineNumber) {\r\n        let res = [];\r\n        const afterCommentStr = this._insertSpace ? ' ' : '';\r\n        for (let i = 0, len = lines.length; i < len; i++) {\r\n            const lineData = lines[i];\r\n            if (lineData.ignore) {\r\n                continue;\r\n            }\r\n            res.push(EditOperation.insert(new Position(startLineNumber + i, lineData.commentStrOffset + 1), lineData.commentStr + afterCommentStr));\r\n        }\r\n        return res;\r\n    }\r\n    static nextVisibleColumn(currentVisibleColumn, tabSize, isTab, columnSize) {\r\n        if (isTab) {\r\n            return currentVisibleColumn + (tabSize - (currentVisibleColumn % tabSize));\r\n        }\r\n        return currentVisibleColumn + columnSize;\r\n    }\r\n    /**\r\n     * Adjust insertion points to have them vertically aligned in the add line comment case\r\n     */\r\n    static _normalizeInsertionPoint(model, lines, startLineNumber, tabSize) {\r\n        let minVisibleColumn = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n        let j;\r\n        let lenJ;\r\n        for (let i = 0, len = lines.length; i < len; i++) {\r\n            if (lines[i].ignore) {\r\n                continue;\r\n            }\r\n            const lineContent = model.getLineContent(startLineNumber + i);\r\n            let currentVisibleColumn = 0;\r\n            for (let j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\r\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j) === 9 /* Tab */, 1);\r\n            }\r\n            if (currentVisibleColumn < minVisibleColumn) {\r\n                minVisibleColumn = currentVisibleColumn;\r\n            }\r\n        }\r\n        minVisibleColumn = Math.floor(minVisibleColumn / tabSize) * tabSize;\r\n        for (let i = 0, len = lines.length; i < len; i++) {\r\n            if (lines[i].ignore) {\r\n                continue;\r\n            }\r\n            const lineContent = model.getLineContent(startLineNumber + i);\r\n            let currentVisibleColumn = 0;\r\n            for (j = 0, lenJ = lines[i].commentStrOffset; currentVisibleColumn < minVisibleColumn && j < lenJ; j++) {\r\n                currentVisibleColumn = LineCommentCommand.nextVisibleColumn(currentVisibleColumn, tabSize, lineContent.charCodeAt(j) === 9 /* Tab */, 1);\r\n            }\r\n            if (currentVisibleColumn > minVisibleColumn) {\r\n                lines[i].commentStrOffset = j - 1;\r\n            }\r\n            else {\r\n                lines[i].commentStrOffset = j;\r\n            }\r\n        }\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { BlockCommentCommand } from './blockCommentCommand.js';\r\nimport { LineCommentCommand } from './lineCommentCommand.js';\r\nimport { MenuId } from '../../../platform/actions/common/actions.js';\r\nclass CommentLineAction extends EditorAction {\r\n    constructor(type, opts) {\r\n        super(opts);\r\n        this._type = type;\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = editor.getModel();\r\n        const commands = [];\r\n        const modelOptions = model.getOptions();\r\n        const commentsOptions = editor.getOption(17 /* comments */);\r\n        const selections = editor.getSelections().map((selection, index) => ({ selection, index, ignoreFirstLine: false }));\r\n        selections.sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\r\n        // Remove selections that would result in copying the same line\r\n        let prev = selections[0];\r\n        for (let i = 1; i < selections.length; i++) {\r\n            const curr = selections[i];\r\n            if (prev.selection.endLineNumber === curr.selection.startLineNumber) {\r\n                // these two selections would copy the same line\r\n                if (prev.index < curr.index) {\r\n                    // prev wins\r\n                    curr.ignoreFirstLine = true;\r\n                }\r\n                else {\r\n                    // curr wins\r\n                    prev.ignoreFirstLine = true;\r\n                    prev = curr;\r\n                }\r\n            }\r\n        }\r\n        for (const selection of selections) {\r\n            commands.push(new LineCommentCommand(selection.selection, modelOptions.tabSize, this._type, commentsOptions.insertSpace, commentsOptions.ignoreEmptyLines, selection.ignoreFirstLine));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nclass ToggleCommentLineAction extends CommentLineAction {\r\n    constructor() {\r\n        super(0 /* Toggle */, {\r\n            id: 'editor.action.commentLine',\r\n            label: nls.localize('comment.line', \"Toggle Line Comment\"),\r\n            alias: 'Toggle Line Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 85 /* US_SLASH */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarEditMenu,\r\n                group: '5_insert',\r\n                title: nls.localize({ key: 'miToggleLineComment', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Line Comment\"),\r\n                order: 1\r\n            }\r\n        });\r\n    }\r\n}\r\nclass AddLineCommentAction extends CommentLineAction {\r\n    constructor() {\r\n        super(1 /* ForceAdd */, {\r\n            id: 'editor.action.addCommentLine',\r\n            label: nls.localize('comment.line.add', \"Add Line Comment\"),\r\n            alias: 'Add Line Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 33 /* KEY_C */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nclass RemoveLineCommentAction extends CommentLineAction {\r\n    constructor() {\r\n        super(2 /* ForceRemove */, {\r\n            id: 'editor.action.removeCommentLine',\r\n            label: nls.localize('comment.line.remove', \"Remove Line Comment\"),\r\n            alias: 'Remove Line Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 51 /* KEY_U */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nclass BlockCommentAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.blockComment',\r\n            label: nls.localize('comment.block', \"Toggle Block Comment\"),\r\n            alias: 'Toggle Block Comment',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 31 /* KEY_A */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 31 /* KEY_A */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarEditMenu,\r\n                group: '5_insert',\r\n                title: nls.localize({ key: 'miToggleBlockComment', comment: ['&& denotes a mnemonic'] }, \"Toggle &&Block Comment\"),\r\n                order: 2\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const commentsOptions = editor.getOption(17 /* comments */);\r\n        const commands = [];\r\n        const selections = editor.getSelections();\r\n        for (const selection of selections) {\r\n            commands.push(new BlockCommentCommand(selection, commentsOptions.insertSpace));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nregisterEditorAction(ToggleCommentLineAction);\r\nregisterEditorAction(AddLineCommentAction);\r\nregisterEditorAction(RemoveLineCommentAction);\r\nregisterEditorAction(BlockCommentAction);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { Separator, SubmenuAction } from '../../../base/common/actions.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { IMenuService, MenuId, SubmenuItemAction } from '../../../platform/actions/common/actions.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextMenuService, IContextViewService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { ActionViewItem } from '../../../base/browser/ui/actionbar/actionViewItems.js';\r\nimport { isIOS } from '../../../base/common/platform.js';\r\nlet ContextMenuController = class ContextMenuController {\r\n    constructor(editor, _contextMenuService, _contextViewService, _contextKeyService, _keybindingService, _menuService) {\r\n        this._contextMenuService = _contextMenuService;\r\n        this._contextViewService = _contextViewService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._keybindingService = _keybindingService;\r\n        this._menuService = _menuService;\r\n        this._toDispose = new DisposableStore();\r\n        this._contextMenuIsBeingShownCount = 0;\r\n        this._editor = editor;\r\n        this._toDispose.add(this._editor.onContextMenu((e) => this._onContextMenu(e)));\r\n        this._toDispose.add(this._editor.onMouseWheel((e) => {\r\n            if (this._contextMenuIsBeingShownCount > 0) {\r\n                const view = this._contextViewService.getContextViewElement();\r\n                const target = e.srcElement;\r\n                // Event triggers on shadow root host first\r\n                // Check if the context view is under this host before hiding it #103169\r\n                if (!(target.shadowRoot && dom.getShadowRoot(view) === target.shadowRoot)) {\r\n                    this._contextViewService.hideContextView();\r\n                }\r\n            }\r\n        }));\r\n        this._toDispose.add(this._editor.onKeyDown((e) => {\r\n            if (e.keyCode === 58 /* ContextMenu */) {\r\n                // Chrome is funny like that\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                this.showContextMenu();\r\n            }\r\n        }));\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(ContextMenuController.ID);\r\n    }\r\n    _onContextMenu(e) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._editor.getOption(18 /* contextmenu */)) {\r\n            this._editor.focus();\r\n            // Ensure the cursor is at the position of the mouse click\r\n            if (e.target.position && !this._editor.getSelection().containsPosition(e.target.position)) {\r\n                this._editor.setPosition(e.target.position);\r\n            }\r\n            return; // Context menu is turned off through configuration\r\n        }\r\n        if (e.target.type === 12 /* OVERLAY_WIDGET */) {\r\n            return; // allow native menu on widgets to support right click on input field for example in find\r\n        }\r\n        e.event.preventDefault();\r\n        if (e.target.type !== 6 /* CONTENT_TEXT */ && e.target.type !== 7 /* CONTENT_EMPTY */ && e.target.type !== 1 /* TEXTAREA */) {\r\n            return; // only support mouse click into text or native context menu key for now\r\n        }\r\n        // Ensure the editor gets focus if it hasn't, so the right events are being sent to other contributions\r\n        this._editor.focus();\r\n        // Ensure the cursor is at the position of the mouse click\r\n        if (e.target.position) {\r\n            let hasSelectionAtPosition = false;\r\n            for (const selection of this._editor.getSelections()) {\r\n                if (selection.containsPosition(e.target.position)) {\r\n                    hasSelectionAtPosition = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!hasSelectionAtPosition) {\r\n                this._editor.setPosition(e.target.position);\r\n            }\r\n        }\r\n        // Unless the user triggerd the context menu through Shift+F10, use the mouse position as menu position\r\n        let anchor = null;\r\n        if (e.target.type !== 1 /* TEXTAREA */) {\r\n            anchor = { x: e.event.posx - 1, width: 2, y: e.event.posy - 1, height: 2 };\r\n        }\r\n        // Show the context menu\r\n        this.showContextMenu(anchor);\r\n    }\r\n    showContextMenu(anchor) {\r\n        if (!this._editor.getOption(18 /* contextmenu */)) {\r\n            return; // Context menu is turned off through configuration\r\n        }\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._contextMenuService) {\r\n            this._editor.focus();\r\n            return; // We need the context menu service to function\r\n        }\r\n        // Find actions available for menu\r\n        const menuActions = this._getMenuActions(this._editor.getModel(), this._editor.isSimpleWidget ? MenuId.SimpleEditorContext : MenuId.EditorContext);\r\n        // Show menu if we have actions to show\r\n        if (menuActions.length > 0) {\r\n            this._doShowContextMenu(menuActions, anchor);\r\n        }\r\n    }\r\n    _getMenuActions(model, menuId) {\r\n        const result = [];\r\n        // get menu groups\r\n        const menu = this._menuService.createMenu(menuId, this._contextKeyService);\r\n        const groups = menu.getActions({ arg: model.uri });\r\n        menu.dispose();\r\n        // translate them into other actions\r\n        for (let group of groups) {\r\n            const [, actions] = group;\r\n            let addedItems = 0;\r\n            for (const action of actions) {\r\n                if (action instanceof SubmenuItemAction) {\r\n                    const subActions = this._getMenuActions(model, action.item.submenu);\r\n                    if (subActions.length > 0) {\r\n                        result.push(new SubmenuAction(action.id, action.label, subActions));\r\n                        addedItems++;\r\n                    }\r\n                }\r\n                else {\r\n                    result.push(action);\r\n                    addedItems++;\r\n                }\r\n            }\r\n            if (addedItems) {\r\n                result.push(new Separator());\r\n            }\r\n        }\r\n        if (result.length) {\r\n            result.pop(); // remove last separator\r\n        }\r\n        return result;\r\n    }\r\n    _doShowContextMenu(actions, anchor = null) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        // Disable hover\r\n        const oldHoverSetting = this._editor.getOption(51 /* hover */);\r\n        this._editor.updateOptions({\r\n            hover: {\r\n                enabled: false\r\n            }\r\n        });\r\n        if (!anchor) {\r\n            // Ensure selection is visible\r\n            this._editor.revealPosition(this._editor.getPosition(), 1 /* Immediate */);\r\n            this._editor.render();\r\n            const cursorCoords = this._editor.getScrolledVisiblePosition(this._editor.getPosition());\r\n            // Translate to absolute editor position\r\n            const editorCoords = dom.getDomNodePagePosition(this._editor.getDomNode());\r\n            const posx = editorCoords.left + cursorCoords.left;\r\n            const posy = editorCoords.top + cursorCoords.top + cursorCoords.height;\r\n            anchor = { x: posx, y: posy };\r\n        }\r\n        const useShadowDOM = this._editor.getOption(113 /* useShadowDOM */) && !isIOS; // Do not use shadow dom on IOS #122035\r\n        // Show menu\r\n        this._contextMenuIsBeingShownCount++;\r\n        this._contextMenuService.showContextMenu({\r\n            domForShadowRoot: useShadowDOM ? this._editor.getDomNode() : undefined,\r\n            getAnchor: () => anchor,\r\n            getActions: () => actions,\r\n            getActionViewItem: (action) => {\r\n                const keybinding = this._keybindingFor(action);\r\n                if (keybinding) {\r\n                    return new ActionViewItem(action, action, { label: true, keybinding: keybinding.getLabel(), isMenu: true });\r\n                }\r\n                const customActionViewItem = action;\r\n                if (typeof customActionViewItem.getActionViewItem === 'function') {\r\n                    return customActionViewItem.getActionViewItem();\r\n                }\r\n                return new ActionViewItem(action, action, { icon: true, label: true, isMenu: true });\r\n            },\r\n            getKeyBinding: (action) => {\r\n                return this._keybindingFor(action);\r\n            },\r\n            onHide: (wasCancelled) => {\r\n                this._contextMenuIsBeingShownCount--;\r\n                this._editor.focus();\r\n                this._editor.updateOptions({\r\n                    hover: oldHoverSetting\r\n                });\r\n            }\r\n        });\r\n    }\r\n    _keybindingFor(action) {\r\n        return this._keybindingService.lookupKeybinding(action.id);\r\n    }\r\n    dispose() {\r\n        if (this._contextMenuIsBeingShownCount > 0) {\r\n            this._contextViewService.hideContextView();\r\n        }\r\n        this._toDispose.dispose();\r\n    }\r\n};\r\nContextMenuController.ID = 'editor.contrib.contextmenu';\r\nContextMenuController = __decorate([\r\n    __param(1, IContextMenuService),\r\n    __param(2, IContextViewService),\r\n    __param(3, IContextKeyService),\r\n    __param(4, IKeybindingService),\r\n    __param(5, IMenuService)\r\n], ContextMenuController);\r\nexport { ContextMenuController };\r\nclass ShowContextMenu extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.showContextMenu',\r\n            label: nls.localize('action.showContextMenu.label', \"Show Editor Context Menu\"),\r\n            alias: 'Show Editor Context Menu',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 1024 /* Shift */ | 68 /* F10 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        let contribution = ContextMenuController.get(editor);\r\n        contribution.showContextMenu();\r\n    }\r\n}\r\nregisterEditorContribution(ContextMenuController.ID, ContextMenuController);\r\nregisterEditorAction(ShowContextMenu);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nclass CursorState {\r\n    constructor(selections) {\r\n        this.selections = selections;\r\n    }\r\n    equals(other) {\r\n        const thisLen = this.selections.length;\r\n        const otherLen = other.selections.length;\r\n        if (thisLen !== otherLen) {\r\n            return false;\r\n        }\r\n        for (let i = 0; i < thisLen; i++) {\r\n            if (!this.selections[i].equalsSelection(other.selections[i])) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\nclass StackElement {\r\n    constructor(cursorState, scrollTop, scrollLeft) {\r\n        this.cursorState = cursorState;\r\n        this.scrollTop = scrollTop;\r\n        this.scrollLeft = scrollLeft;\r\n    }\r\n}\r\nexport class CursorUndoRedoController extends Disposable {\r\n    constructor(editor) {\r\n        super();\r\n        this._editor = editor;\r\n        this._isCursorUndoRedo = false;\r\n        this._undoStack = [];\r\n        this._redoStack = [];\r\n        this._register(editor.onDidChangeModel((e) => {\r\n            this._undoStack = [];\r\n            this._redoStack = [];\r\n        }));\r\n        this._register(editor.onDidChangeModelContent((e) => {\r\n            this._undoStack = [];\r\n            this._redoStack = [];\r\n        }));\r\n        this._register(editor.onDidChangeCursorSelection((e) => {\r\n            if (this._isCursorUndoRedo) {\r\n                return;\r\n            }\r\n            if (!e.oldSelections) {\r\n                return;\r\n            }\r\n            if (e.oldModelVersionId !== e.modelVersionId) {\r\n                return;\r\n            }\r\n            const prevState = new CursorState(e.oldSelections);\r\n            const isEqualToLastUndoStack = (this._undoStack.length > 0 && this._undoStack[this._undoStack.length - 1].cursorState.equals(prevState));\r\n            if (!isEqualToLastUndoStack) {\r\n                this._undoStack.push(new StackElement(prevState, editor.getScrollTop(), editor.getScrollLeft()));\r\n                this._redoStack = [];\r\n                if (this._undoStack.length > 50) {\r\n                    // keep the cursor undo stack bounded\r\n                    this._undoStack.shift();\r\n                }\r\n            }\r\n        }));\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(CursorUndoRedoController.ID);\r\n    }\r\n    cursorUndo() {\r\n        if (!this._editor.hasModel() || this._undoStack.length === 0) {\r\n            return;\r\n        }\r\n        this._redoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\r\n        this._applyState(this._undoStack.pop());\r\n    }\r\n    cursorRedo() {\r\n        if (!this._editor.hasModel() || this._redoStack.length === 0) {\r\n            return;\r\n        }\r\n        this._undoStack.push(new StackElement(new CursorState(this._editor.getSelections()), this._editor.getScrollTop(), this._editor.getScrollLeft()));\r\n        this._applyState(this._redoStack.pop());\r\n    }\r\n    _applyState(stackElement) {\r\n        this._isCursorUndoRedo = true;\r\n        this._editor.setSelections(stackElement.cursorState.selections);\r\n        this._editor.setScrollPosition({\r\n            scrollTop: stackElement.scrollTop,\r\n            scrollLeft: stackElement.scrollLeft\r\n        });\r\n        this._isCursorUndoRedo = false;\r\n    }\r\n}\r\nCursorUndoRedoController.ID = 'editor.contrib.cursorUndoRedoController';\r\nexport class CursorUndo extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'cursorUndo',\r\n            label: nls.localize('cursor.undo', \"Cursor Undo\"),\r\n            alias: 'Cursor Undo',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 51 /* KEY_U */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor, args) {\r\n        CursorUndoRedoController.get(editor).cursorUndo();\r\n    }\r\n}\r\nexport class CursorRedo extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'cursorRedo',\r\n            label: nls.localize('cursor.redo', \"Cursor Redo\"),\r\n            alias: 'Cursor Redo',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor, args) {\r\n        CursorUndoRedoController.get(editor).cursorRedo();\r\n    }\r\n}\r\nregisterEditorContribution(CursorUndoRedoController.ID, CursorUndoRedoController);\r\nregisterEditorAction(CursorUndo);\r\nregisterEditorAction(CursorRedo);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { Range } from '../../common/core/range.js';\r\nexport class DragAndDropCommand {\r\n    constructor(selection, targetPosition, copy) {\r\n        this.selection = selection;\r\n        this.targetPosition = targetPosition;\r\n        this.copy = copy;\r\n        this.targetSelection = null;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        let text = model.getValueInRange(this.selection);\r\n        if (!this.copy) {\r\n            builder.addEditOperation(this.selection, null);\r\n        }\r\n        builder.addEditOperation(new Range(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column), text);\r\n        if (this.selection.containsPosition(this.targetPosition) && !(this.copy && (this.selection.getEndPosition().equals(this.targetPosition) || this.selection.getStartPosition().equals(this.targetPosition)) // we allow users to paste content beside the selection\r\n        )) {\r\n            this.targetSelection = this.selection;\r\n            return;\r\n        }\r\n        if (this.copy) {\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.selection.endLineNumber - this.selection.startLineNumber + this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\r\n                this.selection.endColumn);\r\n            return;\r\n        }\r\n        if (this.targetPosition.lineNumber > this.selection.endLineNumber) {\r\n            // Drag the selection downwards\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\r\n                this.selection.endColumn);\r\n            return;\r\n        }\r\n        if (this.targetPosition.lineNumber < this.selection.endLineNumber) {\r\n            // Drag the selection upwards\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber, this.targetPosition.column, this.targetPosition.lineNumber + this.selection.endLineNumber - this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column + this.selection.endColumn - this.selection.startColumn :\r\n                this.selection.endColumn);\r\n            return;\r\n        }\r\n        // The target position is at the same line as the selection's end position.\r\n        if (this.selection.endColumn <= this.targetPosition.column) {\r\n            // The target position is after the selection's end position\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn :\r\n                this.targetPosition.column - this.selection.endColumn + this.selection.startColumn, this.targetPosition.lineNumber, this.selection.startLineNumber === this.selection.endLineNumber ?\r\n                this.targetPosition.column :\r\n                this.selection.endColumn);\r\n        }\r\n        else {\r\n            // The target position is before the selection's end position. Since the selection doesn't contain the target position, the selection is one-line and target position is before this selection.\r\n            this.targetSelection = new Selection(this.targetPosition.lineNumber - this.selection.endLineNumber + this.selection.startLineNumber, this.targetPosition.column, this.targetPosition.lineNumber, this.targetPosition.column + this.selection.endColumn - this.selection.startColumn);\r\n        }\r\n    }\r\n    computeCursorState(model, helper) {\r\n        return this.targetSelection;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './dnd.css';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { isMacintosh } from '../../../base/common/platform.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { DragAndDropCommand } from './dragAndDropCommand.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nfunction hasTriggerModifier(e) {\r\n    if (isMacintosh) {\r\n        return e.altKey;\r\n    }\r\n    else {\r\n        return e.ctrlKey;\r\n    }\r\n}\r\nexport class DragAndDropController extends Disposable {\r\n    constructor(editor) {\r\n        super();\r\n        this._editor = editor;\r\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\r\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(e)));\r\n        this._register(this._editor.onMouseDrag((e) => this._onEditorMouseDrag(e)));\r\n        this._register(this._editor.onMouseDrop((e) => this._onEditorMouseDrop(e)));\r\n        this._register(this._editor.onMouseDropCanceled(() => this._onEditorMouseDropCanceled()));\r\n        this._register(this._editor.onKeyDown((e) => this.onEditorKeyDown(e)));\r\n        this._register(this._editor.onKeyUp((e) => this.onEditorKeyUp(e)));\r\n        this._register(this._editor.onDidBlurEditorWidget(() => this.onEditorBlur()));\r\n        this._register(this._editor.onDidBlurEditorText(() => this.onEditorBlur()));\r\n        this._dndDecorationIds = [];\r\n        this._mouseDown = false;\r\n        this._modifierPressed = false;\r\n        this._dragSelection = null;\r\n    }\r\n    onEditorBlur() {\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n        this._modifierPressed = false;\r\n    }\r\n    onEditorKeyDown(e) {\r\n        if (!this._editor.getOption(29 /* dragAndDrop */) || this._editor.getOption(16 /* columnSelection */)) {\r\n            return;\r\n        }\r\n        if (hasTriggerModifier(e)) {\r\n            this._modifierPressed = true;\r\n        }\r\n        if (this._mouseDown && hasTriggerModifier(e)) {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'copy'\r\n            });\r\n        }\r\n    }\r\n    onEditorKeyUp(e) {\r\n        if (!this._editor.getOption(29 /* dragAndDrop */) || this._editor.getOption(16 /* columnSelection */)) {\r\n            return;\r\n        }\r\n        if (hasTriggerModifier(e)) {\r\n            this._modifierPressed = false;\r\n        }\r\n        if (this._mouseDown && e.keyCode === DragAndDropController.TRIGGER_KEY_VALUE) {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'default'\r\n            });\r\n        }\r\n    }\r\n    _onEditorMouseDown(mouseEvent) {\r\n        this._mouseDown = true;\r\n    }\r\n    _onEditorMouseUp(mouseEvent) {\r\n        this._mouseDown = false;\r\n        // Whenever users release the mouse, the drag and drop operation should finish and the cursor should revert to text.\r\n        this._editor.updateOptions({\r\n            mouseStyle: 'text'\r\n        });\r\n    }\r\n    _onEditorMouseDrag(mouseEvent) {\r\n        let target = mouseEvent.target;\r\n        if (this._dragSelection === null) {\r\n            const selections = this._editor.getSelections() || [];\r\n            let possibleSelections = selections.filter(selection => target.position && selection.containsPosition(target.position));\r\n            if (possibleSelections.length === 1) {\r\n                this._dragSelection = possibleSelections[0];\r\n            }\r\n            else {\r\n                return;\r\n            }\r\n        }\r\n        if (hasTriggerModifier(mouseEvent.event)) {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'copy'\r\n            });\r\n        }\r\n        else {\r\n            this._editor.updateOptions({\r\n                mouseStyle: 'default'\r\n            });\r\n        }\r\n        if (target.position) {\r\n            if (this._dragSelection.containsPosition(target.position)) {\r\n                this._removeDecoration();\r\n            }\r\n            else {\r\n                this.showAt(target.position);\r\n            }\r\n        }\r\n    }\r\n    _onEditorMouseDropCanceled() {\r\n        this._editor.updateOptions({\r\n            mouseStyle: 'text'\r\n        });\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n    }\r\n    _onEditorMouseDrop(mouseEvent) {\r\n        if (mouseEvent.target && (this._hitContent(mouseEvent.target) || this._hitMargin(mouseEvent.target)) && mouseEvent.target.position) {\r\n            let newCursorPosition = new Position(mouseEvent.target.position.lineNumber, mouseEvent.target.position.column);\r\n            if (this._dragSelection === null) {\r\n                let newSelections = null;\r\n                if (mouseEvent.event.shiftKey) {\r\n                    let primarySelection = this._editor.getSelection();\r\n                    if (primarySelection) {\r\n                        const { selectionStartLineNumber, selectionStartColumn } = primarySelection;\r\n                        newSelections = [new Selection(selectionStartLineNumber, selectionStartColumn, newCursorPosition.lineNumber, newCursorPosition.column)];\r\n                    }\r\n                }\r\n                else {\r\n                    newSelections = (this._editor.getSelections() || []).map(selection => {\r\n                        if (selection.containsPosition(newCursorPosition)) {\r\n                            return new Selection(newCursorPosition.lineNumber, newCursorPosition.column, newCursorPosition.lineNumber, newCursorPosition.column);\r\n                        }\r\n                        else {\r\n                            return selection;\r\n                        }\r\n                    });\r\n                }\r\n                // Use `mouse` as the source instead of `api` and setting the reason to explicit (to behave like any other mouse operation).\r\n                this._editor.setSelections(newSelections || [], 'mouse', 3 /* Explicit */);\r\n            }\r\n            else if (!this._dragSelection.containsPosition(newCursorPosition) ||\r\n                ((hasTriggerModifier(mouseEvent.event) ||\r\n                    this._modifierPressed) && (this._dragSelection.getEndPosition().equals(newCursorPosition) || this._dragSelection.getStartPosition().equals(newCursorPosition)) // we allow users to paste content beside the selection\r\n                )) {\r\n                this._editor.pushUndoStop();\r\n                this._editor.executeCommand(DragAndDropController.ID, new DragAndDropCommand(this._dragSelection, newCursorPosition, hasTriggerModifier(mouseEvent.event) || this._modifierPressed));\r\n                this._editor.pushUndoStop();\r\n            }\r\n        }\r\n        this._editor.updateOptions({\r\n            mouseStyle: 'text'\r\n        });\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n    }\r\n    showAt(position) {\r\n        let newDecorations = [{\r\n                range: new Range(position.lineNumber, position.column, position.lineNumber, position.column),\r\n                options: DragAndDropController._DECORATION_OPTIONS\r\n            }];\r\n        this._dndDecorationIds = this._editor.deltaDecorations(this._dndDecorationIds, newDecorations);\r\n        this._editor.revealPosition(position, 1 /* Immediate */);\r\n    }\r\n    _removeDecoration() {\r\n        this._dndDecorationIds = this._editor.deltaDecorations(this._dndDecorationIds, []);\r\n    }\r\n    _hitContent(target) {\r\n        return target.type === 6 /* CONTENT_TEXT */ ||\r\n            target.type === 7 /* CONTENT_EMPTY */;\r\n    }\r\n    _hitMargin(target) {\r\n        return target.type === 2 /* GUTTER_GLYPH_MARGIN */ ||\r\n            target.type === 3 /* GUTTER_LINE_NUMBERS */ ||\r\n            target.type === 4 /* GUTTER_LINE_DECORATIONS */;\r\n    }\r\n    dispose() {\r\n        this._removeDecoration();\r\n        this._dragSelection = null;\r\n        this._mouseDown = false;\r\n        this._modifierPressed = false;\r\n        super.dispose();\r\n    }\r\n}\r\nDragAndDropController.ID = 'editor.contrib.dragAndDrop';\r\nDragAndDropController.TRIGGER_KEY_VALUE = isMacintosh ? 6 /* Alt */ : 5 /* Ctrl */;\r\nDragAndDropController._DECORATION_OPTIONS = ModelDecorationOptions.register({\r\n    description: 'dnd-target',\r\n    className: 'dnd-target'\r\n});\r\nregisterEditorContribution(DragAndDropController.ID, DragAndDropController);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { OverviewRulerLane, MinimapPosition } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { overviewRulerFindMatchForeground, minimapFindMatch } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nexport class FindDecorations {\r\n    constructor(editor) {\r\n        this._editor = editor;\r\n        this._decorations = [];\r\n        this._overviewRulerApproximateDecorations = [];\r\n        this._findScopeDecorationIds = [];\r\n        this._rangeHighlightDecorationId = null;\r\n        this._highlightedDecorationId = null;\r\n        this._startPosition = this._editor.getPosition();\r\n    }\r\n    dispose() {\r\n        this._editor.deltaDecorations(this._allDecorations(), []);\r\n        this._decorations = [];\r\n        this._overviewRulerApproximateDecorations = [];\r\n        this._findScopeDecorationIds = [];\r\n        this._rangeHighlightDecorationId = null;\r\n        this._highlightedDecorationId = null;\r\n    }\r\n    reset() {\r\n        this._decorations = [];\r\n        this._overviewRulerApproximateDecorations = [];\r\n        this._findScopeDecorationIds = [];\r\n        this._rangeHighlightDecorationId = null;\r\n        this._highlightedDecorationId = null;\r\n    }\r\n    getCount() {\r\n        return this._decorations.length;\r\n    }\r\n    /** @deprecated use getFindScopes to support multiple selections */\r\n    getFindScope() {\r\n        if (this._findScopeDecorationIds[0]) {\r\n            return this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]);\r\n        }\r\n        return null;\r\n    }\r\n    getFindScopes() {\r\n        if (this._findScopeDecorationIds.length) {\r\n            const scopes = this._findScopeDecorationIds.map(findScopeDecorationId => this._editor.getModel().getDecorationRange(findScopeDecorationId)).filter(element => !!element);\r\n            if (scopes.length) {\r\n                return scopes;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    getStartPosition() {\r\n        return this._startPosition;\r\n    }\r\n    setStartPosition(newStartPosition) {\r\n        this._startPosition = newStartPosition;\r\n        this.setCurrentFindMatch(null);\r\n    }\r\n    _getDecorationIndex(decorationId) {\r\n        const index = this._decorations.indexOf(decorationId);\r\n        if (index >= 0) {\r\n            return index + 1;\r\n        }\r\n        return 1;\r\n    }\r\n    getCurrentMatchesPosition(desiredRange) {\r\n        let candidates = this._editor.getModel().getDecorationsInRange(desiredRange);\r\n        for (const candidate of candidates) {\r\n            const candidateOpts = candidate.options;\r\n            if (candidateOpts === FindDecorations._FIND_MATCH_DECORATION || candidateOpts === FindDecorations._CURRENT_FIND_MATCH_DECORATION) {\r\n                return this._getDecorationIndex(candidate.id);\r\n            }\r\n        }\r\n        // We don't know the current match position, so returns zero to show '?' in find widget\r\n        return 0;\r\n    }\r\n    setCurrentFindMatch(nextMatch) {\r\n        let newCurrentDecorationId = null;\r\n        let matchPosition = 0;\r\n        if (nextMatch) {\r\n            for (let i = 0, len = this._decorations.length; i < len; i++) {\r\n                let range = this._editor.getModel().getDecorationRange(this._decorations[i]);\r\n                if (nextMatch.equalsRange(range)) {\r\n                    newCurrentDecorationId = this._decorations[i];\r\n                    matchPosition = (i + 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (this._highlightedDecorationId !== null || newCurrentDecorationId !== null) {\r\n            this._editor.changeDecorations((changeAccessor) => {\r\n                if (this._highlightedDecorationId !== null) {\r\n                    changeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._FIND_MATCH_DECORATION);\r\n                    this._highlightedDecorationId = null;\r\n                }\r\n                if (newCurrentDecorationId !== null) {\r\n                    this._highlightedDecorationId = newCurrentDecorationId;\r\n                    changeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._CURRENT_FIND_MATCH_DECORATION);\r\n                }\r\n                if (this._rangeHighlightDecorationId !== null) {\r\n                    changeAccessor.removeDecoration(this._rangeHighlightDecorationId);\r\n                    this._rangeHighlightDecorationId = null;\r\n                }\r\n                if (newCurrentDecorationId !== null) {\r\n                    let rng = this._editor.getModel().getDecorationRange(newCurrentDecorationId);\r\n                    if (rng.startLineNumber !== rng.endLineNumber && rng.endColumn === 1) {\r\n                        let lineBeforeEnd = rng.endLineNumber - 1;\r\n                        let lineBeforeEndMaxColumn = this._editor.getModel().getLineMaxColumn(lineBeforeEnd);\r\n                        rng = new Range(rng.startLineNumber, rng.startColumn, lineBeforeEnd, lineBeforeEndMaxColumn);\r\n                    }\r\n                    this._rangeHighlightDecorationId = changeAccessor.addDecoration(rng, FindDecorations._RANGE_HIGHLIGHT_DECORATION);\r\n                }\r\n            });\r\n        }\r\n        return matchPosition;\r\n    }\r\n    set(findMatches, findScopes) {\r\n        this._editor.changeDecorations((accessor) => {\r\n            let findMatchesOptions = FindDecorations._FIND_MATCH_DECORATION;\r\n            let newOverviewRulerApproximateDecorations = [];\r\n            if (findMatches.length > 1000) {\r\n                // we go into a mode where the overview ruler gets \"approximate\" decorations\r\n                // the reason is that the overview ruler paints all the decorations in the file and we don't want to cause freezes\r\n                findMatchesOptions = FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;\r\n                // approximate a distance in lines where matches should be merged\r\n                const lineCount = this._editor.getModel().getLineCount();\r\n                const height = this._editor.getLayoutInfo().height;\r\n                const approxPixelsPerLine = height / lineCount;\r\n                const mergeLinesDelta = Math.max(2, Math.ceil(3 / approxPixelsPerLine));\r\n                // merge decorations as much as possible\r\n                let prevStartLineNumber = findMatches[0].range.startLineNumber;\r\n                let prevEndLineNumber = findMatches[0].range.endLineNumber;\r\n                for (let i = 1, len = findMatches.length; i < len; i++) {\r\n                    const range = findMatches[i].range;\r\n                    if (prevEndLineNumber + mergeLinesDelta >= range.startLineNumber) {\r\n                        if (range.endLineNumber > prevEndLineNumber) {\r\n                            prevEndLineNumber = range.endLineNumber;\r\n                        }\r\n                    }\r\n                    else {\r\n                        newOverviewRulerApproximateDecorations.push({\r\n                            range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\r\n                            options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\r\n                        });\r\n                        prevStartLineNumber = range.startLineNumber;\r\n                        prevEndLineNumber = range.endLineNumber;\r\n                    }\r\n                }\r\n                newOverviewRulerApproximateDecorations.push({\r\n                    range: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\r\n                    options: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\r\n                });\r\n            }\r\n            // Find matches\r\n            let newFindMatchesDecorations = new Array(findMatches.length);\r\n            for (let i = 0, len = findMatches.length; i < len; i++) {\r\n                newFindMatchesDecorations[i] = {\r\n                    range: findMatches[i].range,\r\n                    options: findMatchesOptions\r\n                };\r\n            }\r\n            this._decorations = accessor.deltaDecorations(this._decorations, newFindMatchesDecorations);\r\n            // Overview ruler approximate decorations\r\n            this._overviewRulerApproximateDecorations = accessor.deltaDecorations(this._overviewRulerApproximateDecorations, newOverviewRulerApproximateDecorations);\r\n            // Range highlight\r\n            if (this._rangeHighlightDecorationId) {\r\n                accessor.removeDecoration(this._rangeHighlightDecorationId);\r\n                this._rangeHighlightDecorationId = null;\r\n            }\r\n            // Find scope\r\n            if (this._findScopeDecorationIds.length) {\r\n                this._findScopeDecorationIds.forEach(findScopeDecorationId => accessor.removeDecoration(findScopeDecorationId));\r\n                this._findScopeDecorationIds = [];\r\n            }\r\n            if (findScopes === null || findScopes === void 0 ? void 0 : findScopes.length) {\r\n                this._findScopeDecorationIds = findScopes.map(findScope => accessor.addDecoration(findScope, FindDecorations._FIND_SCOPE_DECORATION));\r\n            }\r\n        });\r\n    }\r\n    matchBeforePosition(position) {\r\n        if (this._decorations.length === 0) {\r\n            return null;\r\n        }\r\n        for (let i = this._decorations.length - 1; i >= 0; i--) {\r\n            let decorationId = this._decorations[i];\r\n            let r = this._editor.getModel().getDecorationRange(decorationId);\r\n            if (!r || r.endLineNumber > position.lineNumber) {\r\n                continue;\r\n            }\r\n            if (r.endLineNumber < position.lineNumber) {\r\n                return r;\r\n            }\r\n            if (r.endColumn > position.column) {\r\n                continue;\r\n            }\r\n            return r;\r\n        }\r\n        return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length - 1]);\r\n    }\r\n    matchAfterPosition(position) {\r\n        if (this._decorations.length === 0) {\r\n            return null;\r\n        }\r\n        for (let i = 0, len = this._decorations.length; i < len; i++) {\r\n            let decorationId = this._decorations[i];\r\n            let r = this._editor.getModel().getDecorationRange(decorationId);\r\n            if (!r || r.startLineNumber < position.lineNumber) {\r\n                continue;\r\n            }\r\n            if (r.startLineNumber > position.lineNumber) {\r\n                return r;\r\n            }\r\n            if (r.startColumn < position.column) {\r\n                continue;\r\n            }\r\n            return r;\r\n        }\r\n        return this._editor.getModel().getDecorationRange(this._decorations[0]);\r\n    }\r\n    _allDecorations() {\r\n        let result = [];\r\n        result = result.concat(this._decorations);\r\n        result = result.concat(this._overviewRulerApproximateDecorations);\r\n        if (this._findScopeDecorationIds.length) {\r\n            result.push(...this._findScopeDecorationIds);\r\n        }\r\n        if (this._rangeHighlightDecorationId) {\r\n            result.push(this._rangeHighlightDecorationId);\r\n        }\r\n        return result;\r\n    }\r\n}\r\nFindDecorations._CURRENT_FIND_MATCH_DECORATION = ModelDecorationOptions.register({\r\n    description: 'current-find-match',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    zIndex: 13,\r\n    className: 'currentFindMatch',\r\n    showIfCollapsed: true,\r\n    overviewRuler: {\r\n        color: themeColorFromId(overviewRulerFindMatchForeground),\r\n        position: OverviewRulerLane.Center\r\n    },\r\n    minimap: {\r\n        color: themeColorFromId(minimapFindMatch),\r\n        position: MinimapPosition.Inline\r\n    }\r\n});\r\nFindDecorations._FIND_MATCH_DECORATION = ModelDecorationOptions.register({\r\n    description: 'find-match',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'findMatch',\r\n    showIfCollapsed: true,\r\n    overviewRuler: {\r\n        color: themeColorFromId(overviewRulerFindMatchForeground),\r\n        position: OverviewRulerLane.Center\r\n    },\r\n    minimap: {\r\n        color: themeColorFromId(minimapFindMatch),\r\n        position: MinimapPosition.Inline\r\n    }\r\n});\r\nFindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION = ModelDecorationOptions.register({\r\n    description: 'find-match-no-overview',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'findMatch',\r\n    showIfCollapsed: true\r\n});\r\nFindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION = ModelDecorationOptions.register({\r\n    description: 'find-match-only-overview',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    overviewRuler: {\r\n        color: themeColorFromId(overviewRulerFindMatchForeground),\r\n        position: OverviewRulerLane.Center\r\n    }\r\n});\r\nFindDecorations._RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\r\n    description: 'find-range-highlight',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'rangeHighlight',\r\n    isWholeLine: true\r\n});\r\nFindDecorations._FIND_SCOPE_DECORATION = ModelDecorationOptions.register({\r\n    description: 'find-scope',\r\n    className: 'findScope',\r\n    isWholeLine: true\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nexport class ReplaceAllCommand {\r\n    constructor(editorSelection, ranges, replaceStrings) {\r\n        this._editorSelection = editorSelection;\r\n        this._ranges = ranges;\r\n        this._replaceStrings = replaceStrings;\r\n        this._trackedEditorSelectionId = null;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        if (this._ranges.length > 0) {\r\n            // Collect all edit operations\r\n            let ops = [];\r\n            for (let i = 0; i < this._ranges.length; i++) {\r\n                ops.push({\r\n                    range: this._ranges[i],\r\n                    text: this._replaceStrings[i]\r\n                });\r\n            }\r\n            // Sort them in ascending order by range starts\r\n            ops.sort((o1, o2) => {\r\n                return Range.compareRangesUsingStarts(o1.range, o2.range);\r\n            });\r\n            // Merge operations that touch each other\r\n            let resultOps = [];\r\n            let previousOp = ops[0];\r\n            for (let i = 1; i < ops.length; i++) {\r\n                if (previousOp.range.endLineNumber === ops[i].range.startLineNumber && previousOp.range.endColumn === ops[i].range.startColumn) {\r\n                    // These operations are one after another and can be merged\r\n                    previousOp.range = previousOp.range.plusRange(ops[i].range);\r\n                    previousOp.text = previousOp.text + ops[i].text;\r\n                }\r\n                else {\r\n                    resultOps.push(previousOp);\r\n                    previousOp = ops[i];\r\n                }\r\n            }\r\n            resultOps.push(previousOp);\r\n            for (const op of resultOps) {\r\n                builder.addEditOperation(op.range, op.text);\r\n            }\r\n        }\r\n        this._trackedEditorSelectionId = builder.trackSelection(this._editorSelection);\r\n    }\r\n    computeCursorState(model, helper) {\r\n        return helper.getTrackedSelection(this._trackedEditorSelectionId);\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from './strings.js';\r\nexport function buildReplaceStringWithCasePreserved(matches, pattern) {\r\n    if (matches && (matches[0] !== '')) {\r\n        const containsHyphens = validateSpecificSpecialCharacter(matches, pattern, '-');\r\n        const containsUnderscores = validateSpecificSpecialCharacter(matches, pattern, '_');\r\n        if (containsHyphens && !containsUnderscores) {\r\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '-');\r\n        }\r\n        else if (!containsHyphens && containsUnderscores) {\r\n            return buildReplaceStringForSpecificSpecialCharacter(matches, pattern, '_');\r\n        }\r\n        if (matches[0].toUpperCase() === matches[0]) {\r\n            return pattern.toUpperCase();\r\n        }\r\n        else if (matches[0].toLowerCase() === matches[0]) {\r\n            return pattern.toLowerCase();\r\n        }\r\n        else if (strings.containsUppercaseCharacter(matches[0][0]) && pattern.length > 0) {\r\n            return pattern[0].toUpperCase() + pattern.substr(1);\r\n        }\r\n        else if (matches[0][0].toUpperCase() !== matches[0][0] && pattern.length > 0) {\r\n            return pattern[0].toLowerCase() + pattern.substr(1);\r\n        }\r\n        else {\r\n            // we don't understand its pattern yet.\r\n            return pattern;\r\n        }\r\n    }\r\n    else {\r\n        return pattern;\r\n    }\r\n}\r\nfunction validateSpecificSpecialCharacter(matches, pattern, specialCharacter) {\r\n    const doesContainSpecialCharacter = matches[0].indexOf(specialCharacter) !== -1 && pattern.indexOf(specialCharacter) !== -1;\r\n    return doesContainSpecialCharacter && matches[0].split(specialCharacter).length === pattern.split(specialCharacter).length;\r\n}\r\nfunction buildReplaceStringForSpecificSpecialCharacter(matches, pattern, specialCharacter) {\r\n    const splitPatternAtSpecialCharacter = pattern.split(specialCharacter);\r\n    const splitMatchAtSpecialCharacter = matches[0].split(specialCharacter);\r\n    let replaceString = '';\r\n    splitPatternAtSpecialCharacter.forEach((splitValue, index) => {\r\n        replaceString += buildReplaceStringWithCasePreserved([splitMatchAtSpecialCharacter[index]], splitValue) + specialCharacter;\r\n    });\r\n    return replaceString.slice(0, -1);\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { buildReplaceStringWithCasePreserved } from '../../../base/common/search.js';\r\n/**\r\n * Assigned when the replace pattern is entirely static.\r\n */\r\nclass StaticValueReplacePattern {\r\n    constructor(staticValue) {\r\n        this.staticValue = staticValue;\r\n        this.kind = 0 /* StaticValue */;\r\n    }\r\n}\r\n/**\r\n * Assigned when the replace pattern has replacement patterns.\r\n */\r\nclass DynamicPiecesReplacePattern {\r\n    constructor(pieces) {\r\n        this.pieces = pieces;\r\n        this.kind = 1 /* DynamicPieces */;\r\n    }\r\n}\r\nexport class ReplacePattern {\r\n    constructor(pieces) {\r\n        if (!pieces || pieces.length === 0) {\r\n            this._state = new StaticValueReplacePattern('');\r\n        }\r\n        else if (pieces.length === 1 && pieces[0].staticValue !== null) {\r\n            this._state = new StaticValueReplacePattern(pieces[0].staticValue);\r\n        }\r\n        else {\r\n            this._state = new DynamicPiecesReplacePattern(pieces);\r\n        }\r\n    }\r\n    static fromStaticValue(value) {\r\n        return new ReplacePattern([ReplacePiece.staticValue(value)]);\r\n    }\r\n    get hasReplacementPatterns() {\r\n        return (this._state.kind === 1 /* DynamicPieces */);\r\n    }\r\n    buildReplaceString(matches, preserveCase) {\r\n        if (this._state.kind === 0 /* StaticValue */) {\r\n            if (preserveCase) {\r\n                return buildReplaceStringWithCasePreserved(matches, this._state.staticValue);\r\n            }\r\n            else {\r\n                return this._state.staticValue;\r\n            }\r\n        }\r\n        let result = '';\r\n        for (let i = 0, len = this._state.pieces.length; i < len; i++) {\r\n            let piece = this._state.pieces[i];\r\n            if (piece.staticValue !== null) {\r\n                // static value ReplacePiece\r\n                result += piece.staticValue;\r\n                continue;\r\n            }\r\n            // match index ReplacePiece\r\n            let match = ReplacePattern._substitute(piece.matchIndex, matches);\r\n            if (piece.caseOps !== null && piece.caseOps.length > 0) {\r\n                let repl = [];\r\n                let lenOps = piece.caseOps.length;\r\n                let opIdx = 0;\r\n                for (let idx = 0, len = match.length; idx < len; idx++) {\r\n                    if (opIdx >= lenOps) {\r\n                        repl.push(match.slice(idx));\r\n                        break;\r\n                    }\r\n                    switch (piece.caseOps[opIdx]) {\r\n                        case 'U':\r\n                            repl.push(match[idx].toUpperCase());\r\n                            break;\r\n                        case 'u':\r\n                            repl.push(match[idx].toUpperCase());\r\n                            opIdx++;\r\n                            break;\r\n                        case 'L':\r\n                            repl.push(match[idx].toLowerCase());\r\n                            break;\r\n                        case 'l':\r\n                            repl.push(match[idx].toLowerCase());\r\n                            opIdx++;\r\n                            break;\r\n                        default:\r\n                            repl.push(match[idx]);\r\n                    }\r\n                }\r\n                match = repl.join('');\r\n            }\r\n            result += match;\r\n        }\r\n        return result;\r\n    }\r\n    static _substitute(matchIndex, matches) {\r\n        if (matches === null) {\r\n            return '';\r\n        }\r\n        if (matchIndex === 0) {\r\n            return matches[0];\r\n        }\r\n        let remainder = '';\r\n        while (matchIndex > 0) {\r\n            if (matchIndex < matches.length) {\r\n                // A match can be undefined\r\n                let match = (matches[matchIndex] || '');\r\n                return match + remainder;\r\n            }\r\n            remainder = String(matchIndex % 10) + remainder;\r\n            matchIndex = Math.floor(matchIndex / 10);\r\n        }\r\n        return '$' + remainder;\r\n    }\r\n}\r\n/**\r\n * A replace piece can either be a static string or an index to a specific match.\r\n */\r\nexport class ReplacePiece {\r\n    constructor(staticValue, matchIndex, caseOps) {\r\n        this.staticValue = staticValue;\r\n        this.matchIndex = matchIndex;\r\n        if (!caseOps || caseOps.length === 0) {\r\n            this.caseOps = null;\r\n        }\r\n        else {\r\n            this.caseOps = caseOps.slice(0);\r\n        }\r\n    }\r\n    static staticValue(value) {\r\n        return new ReplacePiece(value, -1, null);\r\n    }\r\n    static caseOps(index, caseOps) {\r\n        return new ReplacePiece(null, index, caseOps);\r\n    }\r\n}\r\nclass ReplacePieceBuilder {\r\n    constructor(source) {\r\n        this._source = source;\r\n        this._lastCharIndex = 0;\r\n        this._result = [];\r\n        this._resultLen = 0;\r\n        this._currentStaticPiece = '';\r\n    }\r\n    emitUnchanged(toCharIndex) {\r\n        this._emitStatic(this._source.substring(this._lastCharIndex, toCharIndex));\r\n        this._lastCharIndex = toCharIndex;\r\n    }\r\n    emitStatic(value, toCharIndex) {\r\n        this._emitStatic(value);\r\n        this._lastCharIndex = toCharIndex;\r\n    }\r\n    _emitStatic(value) {\r\n        if (value.length === 0) {\r\n            return;\r\n        }\r\n        this._currentStaticPiece += value;\r\n    }\r\n    emitMatchIndex(index, toCharIndex, caseOps) {\r\n        if (this._currentStaticPiece.length !== 0) {\r\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\r\n            this._currentStaticPiece = '';\r\n        }\r\n        this._result[this._resultLen++] = ReplacePiece.caseOps(index, caseOps);\r\n        this._lastCharIndex = toCharIndex;\r\n    }\r\n    finalize() {\r\n        this.emitUnchanged(this._source.length);\r\n        if (this._currentStaticPiece.length !== 0) {\r\n            this._result[this._resultLen++] = ReplacePiece.staticValue(this._currentStaticPiece);\r\n            this._currentStaticPiece = '';\r\n        }\r\n        return new ReplacePattern(this._result);\r\n    }\r\n}\r\n/**\r\n * \\n\t\t\t=> inserts a LF\r\n * \\t\t\t\t=> inserts a TAB\r\n * \\\\\t\t\t=> inserts a \"\\\".\r\n * \\u\t\t\t=> upper-cases one character in a match.\r\n * \\U\t\t\t=> upper-cases ALL remaining characters in a match.\r\n * \\l\t\t\t=> lower-cases one character in a match.\r\n * \\L\t\t\t=> lower-cases ALL remaining characters in a match.\r\n * $$\t\t\t=> inserts a \"$\".\r\n * $& and $0\t=> inserts the matched substring.\r\n * $n\t\t\t=> Where n is a non-negative integer lesser than 100, inserts the nth parenthesized submatch string\r\n * everything else stays untouched\r\n *\r\n * Also see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace#Specifying_a_string_as_a_parameter\r\n */\r\nexport function parseReplaceString(replaceString) {\r\n    if (!replaceString || replaceString.length === 0) {\r\n        return new ReplacePattern(null);\r\n    }\r\n    let caseOps = [];\r\n    let result = new ReplacePieceBuilder(replaceString);\r\n    for (let i = 0, len = replaceString.length; i < len; i++) {\r\n        let chCode = replaceString.charCodeAt(i);\r\n        if (chCode === 92 /* Backslash */) {\r\n            // move to next char\r\n            i++;\r\n            if (i >= len) {\r\n                // string ends with a \\\r\n                break;\r\n            }\r\n            let nextChCode = replaceString.charCodeAt(i);\r\n            // let replaceWithCharacter: string | null = null;\r\n            switch (nextChCode) {\r\n                case 92 /* Backslash */:\r\n                    // \\\\ => inserts a \"\\\"\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('\\\\', i + 1);\r\n                    break;\r\n                case 110 /* n */:\r\n                    // \\n => inserts a LF\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('\\n', i + 1);\r\n                    break;\r\n                case 116 /* t */:\r\n                    // \\t => inserts a TAB\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('\\t', i + 1);\r\n                    break;\r\n                // Case modification of string replacements, patterned after Boost, but only applied\r\n                // to the replacement text, not subsequent content.\r\n                case 117 /* u */:\r\n                // \\u => upper-cases one character.\r\n                case 85 /* U */:\r\n                // \\U => upper-cases ALL following characters.\r\n                case 108 /* l */:\r\n                // \\l => lower-cases one character.\r\n                case 76 /* L */:\r\n                    // \\L => lower-cases ALL following characters.\r\n                    result.emitUnchanged(i - 1);\r\n                    result.emitStatic('', i + 1);\r\n                    caseOps.push(String.fromCharCode(nextChCode));\r\n                    break;\r\n            }\r\n            continue;\r\n        }\r\n        if (chCode === 36 /* DollarSign */) {\r\n            // move to next char\r\n            i++;\r\n            if (i >= len) {\r\n                // string ends with a $\r\n                break;\r\n            }\r\n            let nextChCode = replaceString.charCodeAt(i);\r\n            if (nextChCode === 36 /* DollarSign */) {\r\n                // $$ => inserts a \"$\"\r\n                result.emitUnchanged(i - 1);\r\n                result.emitStatic('$', i + 1);\r\n                continue;\r\n            }\r\n            if (nextChCode === 48 /* Digit0 */ || nextChCode === 38 /* Ampersand */) {\r\n                // $& and $0 => inserts the matched substring.\r\n                result.emitUnchanged(i - 1);\r\n                result.emitMatchIndex(0, i + 1, caseOps);\r\n                caseOps.length = 0;\r\n                continue;\r\n            }\r\n            if (49 /* Digit1 */ <= nextChCode && nextChCode <= 57 /* Digit9 */) {\r\n                // $n\r\n                let matchIndex = nextChCode - 48 /* Digit0 */;\r\n                // peek next char to probe for $nn\r\n                if (i + 1 < len) {\r\n                    let nextNextChCode = replaceString.charCodeAt(i + 1);\r\n                    if (48 /* Digit0 */ <= nextNextChCode && nextNextChCode <= 57 /* Digit9 */) {\r\n                        // $nn\r\n                        // move to next char\r\n                        i++;\r\n                        matchIndex = matchIndex * 10 + (nextNextChCode - 48 /* Digit0 */);\r\n                        result.emitUnchanged(i - 2);\r\n                        result.emitMatchIndex(matchIndex, i + 1, caseOps);\r\n                        caseOps.length = 0;\r\n                        continue;\r\n                    }\r\n                }\r\n                result.emitUnchanged(i - 1);\r\n                result.emitMatchIndex(matchIndex, i + 1, caseOps);\r\n                caseOps.length = 0;\r\n                continue;\r\n            }\r\n        }\r\n    }\r\n    return result.finalize();\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { RunOnceScheduler, TimeoutTimer } from '../../../base/common/async.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection } from '../../common/commands/replaceCommand.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { SearchParams } from '../../common/model/textModelSearch.js';\r\nimport { FindDecorations } from './findDecorations.js';\r\nimport { ReplaceAllCommand } from './replaceAllCommand.js';\r\nimport { ReplacePattern, parseReplaceString } from './replacePattern.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { findFirstInSorted } from '../../../base/common/arrays.js';\r\nexport const CONTEXT_FIND_WIDGET_VISIBLE = new RawContextKey('findWidgetVisible', false);\r\n// Keep ContextKey use of 'Focussed' to not break when clauses\r\nexport const CONTEXT_FIND_INPUT_FOCUSED = new RawContextKey('findInputFocussed', false);\r\nexport const CONTEXT_REPLACE_INPUT_FOCUSED = new RawContextKey('replaceInputFocussed', false);\r\nexport const ToggleCaseSensitiveKeybinding = {\r\n    primary: 512 /* Alt */ | 33 /* KEY_C */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 33 /* KEY_C */ }\r\n};\r\nexport const ToggleWholeWordKeybinding = {\r\n    primary: 512 /* Alt */ | 53 /* KEY_W */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 53 /* KEY_W */ }\r\n};\r\nexport const ToggleRegexKeybinding = {\r\n    primary: 512 /* Alt */ | 48 /* KEY_R */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 48 /* KEY_R */ }\r\n};\r\nexport const ToggleSearchScopeKeybinding = {\r\n    primary: 512 /* Alt */ | 42 /* KEY_L */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 42 /* KEY_L */ }\r\n};\r\nexport const TogglePreserveCaseKeybinding = {\r\n    primary: 512 /* Alt */ | 46 /* KEY_P */,\r\n    mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 46 /* KEY_P */ }\r\n};\r\nexport const FIND_IDS = {\r\n    StartFindAction: 'actions.find',\r\n    StartFindWithSelection: 'actions.findWithSelection',\r\n    NextMatchFindAction: 'editor.action.nextMatchFindAction',\r\n    PreviousMatchFindAction: 'editor.action.previousMatchFindAction',\r\n    NextSelectionMatchFindAction: 'editor.action.nextSelectionMatchFindAction',\r\n    PreviousSelectionMatchFindAction: 'editor.action.previousSelectionMatchFindAction',\r\n    StartFindReplaceAction: 'editor.action.startFindReplaceAction',\r\n    CloseFindWidgetCommand: 'closeFindWidget',\r\n    ToggleCaseSensitiveCommand: 'toggleFindCaseSensitive',\r\n    ToggleWholeWordCommand: 'toggleFindWholeWord',\r\n    ToggleRegexCommand: 'toggleFindRegex',\r\n    ToggleSearchScopeCommand: 'toggleFindInSelection',\r\n    TogglePreserveCaseCommand: 'togglePreserveCase',\r\n    ReplaceOneAction: 'editor.action.replaceOne',\r\n    ReplaceAllAction: 'editor.action.replaceAll',\r\n    SelectAllMatchesAction: 'editor.action.selectAllMatches'\r\n};\r\nexport const MATCHES_LIMIT = 19999;\r\nconst RESEARCH_DELAY = 240;\r\nexport class FindModelBoundToEditorModel {\r\n    constructor(editor, state) {\r\n        this._toDispose = new DisposableStore();\r\n        this._editor = editor;\r\n        this._state = state;\r\n        this._isDisposed = false;\r\n        this._startSearchingTimer = new TimeoutTimer();\r\n        this._decorations = new FindDecorations(editor);\r\n        this._toDispose.add(this._decorations);\r\n        this._updateDecorationsScheduler = new RunOnceScheduler(() => this.research(false), 100);\r\n        this._toDispose.add(this._updateDecorationsScheduler);\r\n        this._toDispose.add(this._editor.onDidChangeCursorPosition((e) => {\r\n            if (e.reason === 3 /* Explicit */\r\n                || e.reason === 5 /* Undo */\r\n                || e.reason === 6 /* Redo */) {\r\n                this._decorations.setStartPosition(this._editor.getPosition());\r\n            }\r\n        }));\r\n        this._ignoreModelContentChanged = false;\r\n        this._toDispose.add(this._editor.onDidChangeModelContent((e) => {\r\n            if (this._ignoreModelContentChanged) {\r\n                return;\r\n            }\r\n            if (e.isFlush) {\r\n                // a model.setValue() was called\r\n                this._decorations.reset();\r\n            }\r\n            this._decorations.setStartPosition(this._editor.getPosition());\r\n            this._updateDecorationsScheduler.schedule();\r\n        }));\r\n        this._toDispose.add(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\r\n        this.research(false, this._state.searchScope);\r\n    }\r\n    dispose() {\r\n        this._isDisposed = true;\r\n        dispose(this._startSearchingTimer);\r\n        this._toDispose.dispose();\r\n    }\r\n    _onStateChanged(e) {\r\n        if (this._isDisposed) {\r\n            // The find model is disposed during a find state changed event\r\n            return;\r\n        }\r\n        if (!this._editor.hasModel()) {\r\n            // The find model will be disposed momentarily\r\n            return;\r\n        }\r\n        if (e.searchString || e.isReplaceRevealed || e.isRegex || e.wholeWord || e.matchCase || e.searchScope) {\r\n            let model = this._editor.getModel();\r\n            if (model.isTooLargeForSyncing()) {\r\n                this._startSearchingTimer.cancel();\r\n                this._startSearchingTimer.setIfNotSet(() => {\r\n                    if (e.searchScope) {\r\n                        this.research(e.moveCursor, this._state.searchScope);\r\n                    }\r\n                    else {\r\n                        this.research(e.moveCursor);\r\n                    }\r\n                }, RESEARCH_DELAY);\r\n            }\r\n            else {\r\n                if (e.searchScope) {\r\n                    this.research(e.moveCursor, this._state.searchScope);\r\n                }\r\n                else {\r\n                    this.research(e.moveCursor);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    static _getSearchRange(model, findScope) {\r\n        // If we have set now or before a find scope, use it for computing the search range\r\n        if (findScope) {\r\n            return findScope;\r\n        }\r\n        return model.getFullModelRange();\r\n    }\r\n    research(moveCursor, newFindScope) {\r\n        let findScopes = null;\r\n        if (typeof newFindScope !== 'undefined') {\r\n            if (newFindScope !== null) {\r\n                if (!Array.isArray(newFindScope)) {\r\n                    findScopes = [newFindScope];\r\n                }\r\n                else {\r\n                    findScopes = newFindScope;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            findScopes = this._decorations.getFindScopes();\r\n        }\r\n        if (findScopes !== null) {\r\n            findScopes = findScopes.map(findScope => {\r\n                if (findScope.startLineNumber !== findScope.endLineNumber) {\r\n                    let endLineNumber = findScope.endLineNumber;\r\n                    if (findScope.endColumn === 1) {\r\n                        endLineNumber = endLineNumber - 1;\r\n                    }\r\n                    return new Range(findScope.startLineNumber, 1, endLineNumber, this._editor.getModel().getLineMaxColumn(endLineNumber));\r\n                }\r\n                return findScope;\r\n            });\r\n        }\r\n        let findMatches = this._findMatches(findScopes, false, MATCHES_LIMIT);\r\n        this._decorations.set(findMatches, findScopes);\r\n        const editorSelection = this._editor.getSelection();\r\n        let currentMatchesPosition = this._decorations.getCurrentMatchesPosition(editorSelection);\r\n        if (currentMatchesPosition === 0 && findMatches.length > 0) {\r\n            // current selection is not on top of a match\r\n            // try to find its nearest result from the top of the document\r\n            const matchAfterSelection = findFirstInSorted(findMatches.map(match => match.range), range => Range.compareRangesUsingStarts(range, editorSelection) >= 0);\r\n            currentMatchesPosition = matchAfterSelection > 0 ? matchAfterSelection - 1 + 1 /** match position is one based */ : currentMatchesPosition;\r\n        }\r\n        this._state.changeMatchInfo(currentMatchesPosition, this._decorations.getCount(), undefined);\r\n        if (moveCursor && this._editor.getOption(33 /* find */).cursorMoveOnType) {\r\n            this._moveToNextMatch(this._decorations.getStartPosition());\r\n        }\r\n    }\r\n    _hasMatches() {\r\n        return (this._state.matchesCount > 0);\r\n    }\r\n    _cannotFind() {\r\n        if (!this._hasMatches()) {\r\n            let findScope = this._decorations.getFindScope();\r\n            if (findScope) {\r\n                // Reveal the selection so user is reminded that 'selection find' is on.\r\n                this._editor.revealRangeInCenterIfOutsideViewport(findScope, 0 /* Smooth */);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    _setCurrentFindMatch(match) {\r\n        let matchesPosition = this._decorations.setCurrentFindMatch(match);\r\n        this._state.changeMatchInfo(matchesPosition, this._decorations.getCount(), match);\r\n        this._editor.setSelection(match);\r\n        this._editor.revealRangeInCenterIfOutsideViewport(match, 0 /* Smooth */);\r\n    }\r\n    _prevSearchPosition(before) {\r\n        let isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\r\n            || this._state.searchString.indexOf('$') >= 0);\r\n        let { lineNumber, column } = before;\r\n        let model = this._editor.getModel();\r\n        if (isUsingLineStops || column === 1) {\r\n            if (lineNumber === 1) {\r\n                lineNumber = model.getLineCount();\r\n            }\r\n            else {\r\n                lineNumber--;\r\n            }\r\n            column = model.getLineMaxColumn(lineNumber);\r\n        }\r\n        else {\r\n            column--;\r\n        }\r\n        return new Position(lineNumber, column);\r\n    }\r\n    _moveToPrevMatch(before, isRecursed = false) {\r\n        if (!this._state.canNavigateBack()) {\r\n            // we are beyond the first matched find result\r\n            // instead of doing nothing, we should refocus the first item\r\n            const nextMatchRange = this._decorations.matchAfterPosition(before);\r\n            if (nextMatchRange) {\r\n                this._setCurrentFindMatch(nextMatchRange);\r\n            }\r\n            return;\r\n        }\r\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\r\n            let prevMatchRange = this._decorations.matchBeforePosition(before);\r\n            if (prevMatchRange && prevMatchRange.isEmpty() && prevMatchRange.getStartPosition().equals(before)) {\r\n                before = this._prevSearchPosition(before);\r\n                prevMatchRange = this._decorations.matchBeforePosition(before);\r\n            }\r\n            if (prevMatchRange) {\r\n                this._setCurrentFindMatch(prevMatchRange);\r\n            }\r\n            return;\r\n        }\r\n        if (this._cannotFind()) {\r\n            return;\r\n        }\r\n        let findScope = this._decorations.getFindScope();\r\n        let searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\r\n        // ...(----)...|...\r\n        if (searchRange.getEndPosition().isBefore(before)) {\r\n            before = searchRange.getEndPosition();\r\n        }\r\n        // ...|...(----)...\r\n        if (before.isBefore(searchRange.getStartPosition())) {\r\n            before = searchRange.getEndPosition();\r\n        }\r\n        let { lineNumber, column } = before;\r\n        let model = this._editor.getModel();\r\n        let position = new Position(lineNumber, column);\r\n        let prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null, false);\r\n        if (prevMatch && prevMatch.range.isEmpty() && prevMatch.range.getStartPosition().equals(position)) {\r\n            // Looks like we're stuck at this position, unacceptable!\r\n            position = this._prevSearchPosition(position);\r\n            prevMatch = model.findPreviousMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null, false);\r\n        }\r\n        if (!prevMatch) {\r\n            // there is precisely one match and selection is on top of it\r\n            return;\r\n        }\r\n        if (!isRecursed && !searchRange.containsRange(prevMatch.range)) {\r\n            return this._moveToPrevMatch(prevMatch.range.getStartPosition(), true);\r\n        }\r\n        this._setCurrentFindMatch(prevMatch.range);\r\n    }\r\n    moveToPrevMatch() {\r\n        this._moveToPrevMatch(this._editor.getSelection().getStartPosition());\r\n    }\r\n    _nextSearchPosition(after) {\r\n        let isUsingLineStops = this._state.isRegex && (this._state.searchString.indexOf('^') >= 0\r\n            || this._state.searchString.indexOf('$') >= 0);\r\n        let { lineNumber, column } = after;\r\n        let model = this._editor.getModel();\r\n        if (isUsingLineStops || column === model.getLineMaxColumn(lineNumber)) {\r\n            if (lineNumber === model.getLineCount()) {\r\n                lineNumber = 1;\r\n            }\r\n            else {\r\n                lineNumber++;\r\n            }\r\n            column = 1;\r\n        }\r\n        else {\r\n            column++;\r\n        }\r\n        return new Position(lineNumber, column);\r\n    }\r\n    _moveToNextMatch(after) {\r\n        if (!this._state.canNavigateForward()) {\r\n            // we are beyond the last matched find result\r\n            // instead of doing nothing, we should refocus the last item\r\n            const prevMatchRange = this._decorations.matchBeforePosition(after);\r\n            if (prevMatchRange) {\r\n                this._setCurrentFindMatch(prevMatchRange);\r\n            }\r\n            return;\r\n        }\r\n        if (this._decorations.getCount() < MATCHES_LIMIT) {\r\n            let nextMatchRange = this._decorations.matchAfterPosition(after);\r\n            if (nextMatchRange && nextMatchRange.isEmpty() && nextMatchRange.getStartPosition().equals(after)) {\r\n                // Looks like we're stuck at this position, unacceptable!\r\n                after = this._nextSearchPosition(after);\r\n                nextMatchRange = this._decorations.matchAfterPosition(after);\r\n            }\r\n            if (nextMatchRange) {\r\n                this._setCurrentFindMatch(nextMatchRange);\r\n            }\r\n            return;\r\n        }\r\n        let nextMatch = this._getNextMatch(after, false, true);\r\n        if (nextMatch) {\r\n            this._setCurrentFindMatch(nextMatch.range);\r\n        }\r\n    }\r\n    _getNextMatch(after, captureMatches, forceMove, isRecursed = false) {\r\n        if (this._cannotFind()) {\r\n            return null;\r\n        }\r\n        let findScope = this._decorations.getFindScope();\r\n        let searchRange = FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), findScope);\r\n        // ...(----)...|...\r\n        if (searchRange.getEndPosition().isBefore(after)) {\r\n            after = searchRange.getStartPosition();\r\n        }\r\n        // ...|...(----)...\r\n        if (after.isBefore(searchRange.getStartPosition())) {\r\n            after = searchRange.getStartPosition();\r\n        }\r\n        let { lineNumber, column } = after;\r\n        let model = this._editor.getModel();\r\n        let position = new Position(lineNumber, column);\r\n        let nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null, captureMatches);\r\n        if (forceMove && nextMatch && nextMatch.range.isEmpty() && nextMatch.range.getStartPosition().equals(position)) {\r\n            // Looks like we're stuck at this position, unacceptable!\r\n            position = this._nextSearchPosition(position);\r\n            nextMatch = model.findNextMatch(this._state.searchString, position, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null, captureMatches);\r\n        }\r\n        if (!nextMatch) {\r\n            // there is precisely one match and selection is on top of it\r\n            return null;\r\n        }\r\n        if (!isRecursed && !searchRange.containsRange(nextMatch.range)) {\r\n            return this._getNextMatch(nextMatch.range.getEndPosition(), captureMatches, forceMove, true);\r\n        }\r\n        return nextMatch;\r\n    }\r\n    moveToNextMatch() {\r\n        this._moveToNextMatch(this._editor.getSelection().getEndPosition());\r\n    }\r\n    _getReplacePattern() {\r\n        if (this._state.isRegex) {\r\n            return parseReplaceString(this._state.replaceString);\r\n        }\r\n        return ReplacePattern.fromStaticValue(this._state.replaceString);\r\n    }\r\n    replace() {\r\n        if (!this._hasMatches()) {\r\n            return;\r\n        }\r\n        let replacePattern = this._getReplacePattern();\r\n        let selection = this._editor.getSelection();\r\n        let nextMatch = this._getNextMatch(selection.getStartPosition(), true, false);\r\n        if (nextMatch) {\r\n            if (selection.equalsRange(nextMatch.range)) {\r\n                // selection sits on a find match => replace it!\r\n                let replaceString = replacePattern.buildReplaceString(nextMatch.matches, this._state.preserveCase);\r\n                let command = new ReplaceCommand(selection, replaceString);\r\n                this._executeEditorCommand('replace', command);\r\n                this._decorations.setStartPosition(new Position(selection.startLineNumber, selection.startColumn + replaceString.length));\r\n                this.research(true);\r\n            }\r\n            else {\r\n                this._decorations.setStartPosition(this._editor.getPosition());\r\n                this._setCurrentFindMatch(nextMatch.range);\r\n            }\r\n        }\r\n    }\r\n    _findMatches(findScopes, captureMatches, limitResultCount) {\r\n        const searchRanges = (findScopes || [null]).map((scope) => FindModelBoundToEditorModel._getSearchRange(this._editor.getModel(), scope));\r\n        return this._editor.getModel().findMatches(this._state.searchString, searchRanges, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null, captureMatches, limitResultCount);\r\n    }\r\n    replaceAll() {\r\n        if (!this._hasMatches()) {\r\n            return;\r\n        }\r\n        const findScopes = this._decorations.getFindScopes();\r\n        if (findScopes === null && this._state.matchesCount >= MATCHES_LIMIT) {\r\n            // Doing a replace on the entire file that is over ${MATCHES_LIMIT} matches\r\n            this._largeReplaceAll();\r\n        }\r\n        else {\r\n            this._regularReplaceAll(findScopes);\r\n        }\r\n        this.research(false);\r\n    }\r\n    _largeReplaceAll() {\r\n        const searchParams = new SearchParams(this._state.searchString, this._state.isRegex, this._state.matchCase, this._state.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null);\r\n        const searchData = searchParams.parseSearchRequest();\r\n        if (!searchData) {\r\n            return;\r\n        }\r\n        let searchRegex = searchData.regex;\r\n        if (!searchRegex.multiline) {\r\n            let mod = 'mu';\r\n            if (searchRegex.ignoreCase) {\r\n                mod += 'i';\r\n            }\r\n            if (searchRegex.global) {\r\n                mod += 'g';\r\n            }\r\n            searchRegex = new RegExp(searchRegex.source, mod);\r\n        }\r\n        const model = this._editor.getModel();\r\n        const modelText = model.getValue(1 /* LF */);\r\n        const fullModelRange = model.getFullModelRange();\r\n        const replacePattern = this._getReplacePattern();\r\n        let resultText;\r\n        const preserveCase = this._state.preserveCase;\r\n        if (replacePattern.hasReplacementPatterns || preserveCase) {\r\n            resultText = modelText.replace(searchRegex, function () {\r\n                return replacePattern.buildReplaceString(arguments, preserveCase);\r\n            });\r\n        }\r\n        else {\r\n            resultText = modelText.replace(searchRegex, replacePattern.buildReplaceString(null, preserveCase));\r\n        }\r\n        let command = new ReplaceCommandThatPreservesSelection(fullModelRange, resultText, this._editor.getSelection());\r\n        this._executeEditorCommand('replaceAll', command);\r\n    }\r\n    _regularReplaceAll(findScopes) {\r\n        const replacePattern = this._getReplacePattern();\r\n        // Get all the ranges (even more than the highlighted ones)\r\n        let matches = this._findMatches(findScopes, replacePattern.hasReplacementPatterns || this._state.preserveCase, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        let replaceStrings = [];\r\n        for (let i = 0, len = matches.length; i < len; i++) {\r\n            replaceStrings[i] = replacePattern.buildReplaceString(matches[i].matches, this._state.preserveCase);\r\n        }\r\n        let command = new ReplaceAllCommand(this._editor.getSelection(), matches.map(m => m.range), replaceStrings);\r\n        this._executeEditorCommand('replaceAll', command);\r\n    }\r\n    selectAllMatches() {\r\n        if (!this._hasMatches()) {\r\n            return;\r\n        }\r\n        let findScopes = this._decorations.getFindScopes();\r\n        // Get all the ranges (even more than the highlighted ones)\r\n        let matches = this._findMatches(findScopes, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        let selections = matches.map(m => new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn));\r\n        // If one of the ranges is the editor selection, then maintain it as primary\r\n        let editorSelection = this._editor.getSelection();\r\n        for (let i = 0, len = selections.length; i < len; i++) {\r\n            let sel = selections[i];\r\n            if (sel.equalsRange(editorSelection)) {\r\n                selections = [editorSelection].concat(selections.slice(0, i)).concat(selections.slice(i + 1));\r\n                break;\r\n            }\r\n        }\r\n        this._editor.setSelections(selections);\r\n    }\r\n    _executeEditorCommand(source, command) {\r\n        try {\r\n            this._ignoreModelContentChanged = true;\r\n            this._editor.pushUndoStop();\r\n            this._editor.executeCommand(source, command);\r\n            this._editor.pushUndoStop();\r\n        }\r\n        finally {\r\n            this._ignoreModelContentChanged = false;\r\n        }\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './checkbox.css';\r\nimport { Widget } from '../widget.js';\r\nimport { Color } from '../../../common/color.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { CSSIcon } from '../../../common/codicons.js';\r\nconst defaultOpts = {\r\n    inputActiveOptionBorder: Color.fromHex('#007ACC00'),\r\n    inputActiveOptionForeground: Color.fromHex('#FFFFFF'),\r\n    inputActiveOptionBackground: Color.fromHex('#0E639C50')\r\n};\r\nexport class Checkbox extends Widget {\r\n    constructor(opts) {\r\n        super();\r\n        this._onChange = this._register(new Emitter());\r\n        this.onChange = this._onChange.event;\r\n        this._onKeyDown = this._register(new Emitter());\r\n        this.onKeyDown = this._onKeyDown.event;\r\n        this._opts = Object.assign(Object.assign({}, defaultOpts), opts);\r\n        this._checked = this._opts.isChecked;\r\n        const classes = ['monaco-custom-checkbox'];\r\n        if (this._opts.icon) {\r\n            classes.push(...CSSIcon.asClassNameArray(this._opts.icon));\r\n        }\r\n        if (this._opts.actionClassName) {\r\n            classes.push(...this._opts.actionClassName.split(' '));\r\n        }\r\n        if (this._checked) {\r\n            classes.push('checked');\r\n        }\r\n        this.domNode = document.createElement('div');\r\n        this.domNode.title = this._opts.title;\r\n        this.domNode.classList.add(...classes);\r\n        if (!this._opts.notFocusable) {\r\n            this.domNode.tabIndex = 0;\r\n        }\r\n        this.domNode.setAttribute('role', 'checkbox');\r\n        this.domNode.setAttribute('aria-checked', String(this._checked));\r\n        this.domNode.setAttribute('aria-label', this._opts.title);\r\n        this.applyStyles();\r\n        this.onclick(this.domNode, (ev) => {\r\n            this.checked = !this._checked;\r\n            this._onChange.fire(false);\r\n            ev.preventDefault();\r\n        });\r\n        this.ignoreGesture(this.domNode);\r\n        this.onkeydown(this.domNode, (keyboardEvent) => {\r\n            if (keyboardEvent.keyCode === 10 /* Space */ || keyboardEvent.keyCode === 3 /* Enter */) {\r\n                this.checked = !this._checked;\r\n                this._onChange.fire(true);\r\n                keyboardEvent.preventDefault();\r\n                return;\r\n            }\r\n            this._onKeyDown.fire(keyboardEvent);\r\n        });\r\n    }\r\n    get enabled() {\r\n        return this.domNode.getAttribute('aria-disabled') !== 'true';\r\n    }\r\n    focus() {\r\n        this.domNode.focus();\r\n    }\r\n    get checked() {\r\n        return this._checked;\r\n    }\r\n    set checked(newIsChecked) {\r\n        this._checked = newIsChecked;\r\n        this.domNode.setAttribute('aria-checked', String(this._checked));\r\n        this.domNode.classList.toggle('checked', this._checked);\r\n        this.applyStyles();\r\n    }\r\n    width() {\r\n        return 2 /*marginleft*/ + 2 /*border*/ + 2 /*padding*/ + 16 /* icon width */;\r\n    }\r\n    style(styles) {\r\n        if (styles.inputActiveOptionBorder) {\r\n            this._opts.inputActiveOptionBorder = styles.inputActiveOptionBorder;\r\n        }\r\n        if (styles.inputActiveOptionForeground) {\r\n            this._opts.inputActiveOptionForeground = styles.inputActiveOptionForeground;\r\n        }\r\n        if (styles.inputActiveOptionBackground) {\r\n            this._opts.inputActiveOptionBackground = styles.inputActiveOptionBackground;\r\n        }\r\n        this.applyStyles();\r\n    }\r\n    applyStyles() {\r\n        if (this.domNode) {\r\n            this.domNode.style.borderColor = this._checked && this._opts.inputActiveOptionBorder ? this._opts.inputActiveOptionBorder.toString() : 'transparent';\r\n            this.domNode.style.color = this._checked && this._opts.inputActiveOptionForeground ? this._opts.inputActiveOptionForeground.toString() : 'inherit';\r\n            this.domNode.style.backgroundColor = this._checked && this._opts.inputActiveOptionBackground ? this._opts.inputActiveOptionBackground.toString() : 'transparent';\r\n        }\r\n    }\r\n    enable() {\r\n        this.domNode.setAttribute('aria-disabled', String(false));\r\n    }\r\n    disable() {\r\n        this.domNode.setAttribute('aria-disabled', String(true));\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Checkbox } from '../checkbox/checkbox.js';\r\nimport * as nls from '../../../../nls.js';\r\nimport { Codicon } from '../../../common/codicons.js';\r\nconst NLS_CASE_SENSITIVE_CHECKBOX_LABEL = nls.localize('caseDescription', \"Match Case\");\r\nconst NLS_WHOLE_WORD_CHECKBOX_LABEL = nls.localize('wordsDescription', \"Match Whole Word\");\r\nconst NLS_REGEX_CHECKBOX_LABEL = nls.localize('regexDescription', \"Use Regular Expression\");\r\nexport class CaseSensitiveCheckbox extends Checkbox {\r\n    constructor(opts) {\r\n        super({\r\n            icon: Codicon.caseSensitive,\r\n            title: NLS_CASE_SENSITIVE_CHECKBOX_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionForeground: opts.inputActiveOptionForeground,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        });\r\n    }\r\n}\r\nexport class WholeWordsCheckbox extends Checkbox {\r\n    constructor(opts) {\r\n        super({\r\n            icon: Codicon.wholeWord,\r\n            title: NLS_WHOLE_WORD_CHECKBOX_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionForeground: opts.inputActiveOptionForeground,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        });\r\n    }\r\n}\r\nexport class RegexCheckbox extends Checkbox {\r\n    constructor(opts) {\r\n        super({\r\n            icon: Codicon.regex,\r\n            title: NLS_REGEX_CHECKBOX_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionForeground: opts.inputActiveOptionForeground,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        });\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { CaseSensitiveCheckbox, RegexCheckbox, WholeWordsCheckbox } from '../../../base/browser/ui/findinput/findInputCheckboxes.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { FIND_IDS } from './findModel.js';\r\nimport { contrastBorder, editorWidgetBackground, inputActiveOptionBorder, inputActiveOptionBackground, widgetShadow, editorWidgetForeground, inputActiveOptionForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nexport class FindOptionsWidget extends Widget {\r\n    constructor(editor, state, keybindingService, themeService) {\r\n        super();\r\n        this._hideSoon = this._register(new RunOnceScheduler(() => this._hide(), 2000));\r\n        this._isVisible = false;\r\n        this._editor = editor;\r\n        this._state = state;\r\n        this._keybindingService = keybindingService;\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.className = 'findOptionsWidget';\r\n        this._domNode.style.display = 'none';\r\n        this._domNode.style.top = '10px';\r\n        this._domNode.setAttribute('role', 'presentation');\r\n        this._domNode.setAttribute('aria-hidden', 'true');\r\n        const inputActiveOptionBorderColor = themeService.getColorTheme().getColor(inputActiveOptionBorder);\r\n        const inputActiveOptionForegroundColor = themeService.getColorTheme().getColor(inputActiveOptionForeground);\r\n        const inputActiveOptionBackgroundColor = themeService.getColorTheme().getColor(inputActiveOptionBackground);\r\n        this.caseSensitive = this._register(new CaseSensitiveCheckbox({\r\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\r\n            isChecked: this._state.matchCase,\r\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\r\n            inputActiveOptionForeground: inputActiveOptionForegroundColor,\r\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\r\n        }));\r\n        this._domNode.appendChild(this.caseSensitive.domNode);\r\n        this._register(this.caseSensitive.onChange(() => {\r\n            this._state.change({\r\n                matchCase: this.caseSensitive.checked\r\n            }, false);\r\n        }));\r\n        this.wholeWords = this._register(new WholeWordsCheckbox({\r\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\r\n            isChecked: this._state.wholeWord,\r\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\r\n            inputActiveOptionForeground: inputActiveOptionForegroundColor,\r\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\r\n        }));\r\n        this._domNode.appendChild(this.wholeWords.domNode);\r\n        this._register(this.wholeWords.onChange(() => {\r\n            this._state.change({\r\n                wholeWord: this.wholeWords.checked\r\n            }, false);\r\n        }));\r\n        this.regex = this._register(new RegexCheckbox({\r\n            appendTitle: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\r\n            isChecked: this._state.isRegex,\r\n            inputActiveOptionBorder: inputActiveOptionBorderColor,\r\n            inputActiveOptionForeground: inputActiveOptionForegroundColor,\r\n            inputActiveOptionBackground: inputActiveOptionBackgroundColor\r\n        }));\r\n        this._domNode.appendChild(this.regex.domNode);\r\n        this._register(this.regex.onChange(() => {\r\n            this._state.change({\r\n                isRegex: this.regex.checked\r\n            }, false);\r\n        }));\r\n        this._editor.addOverlayWidget(this);\r\n        this._register(this._state.onFindReplaceStateChange((e) => {\r\n            let somethingChanged = false;\r\n            if (e.isRegex) {\r\n                this.regex.checked = this._state.isRegex;\r\n                somethingChanged = true;\r\n            }\r\n            if (e.wholeWord) {\r\n                this.wholeWords.checked = this._state.wholeWord;\r\n                somethingChanged = true;\r\n            }\r\n            if (e.matchCase) {\r\n                this.caseSensitive.checked = this._state.matchCase;\r\n                somethingChanged = true;\r\n            }\r\n            if (!this._state.isRevealed && somethingChanged) {\r\n                this._revealTemporarily();\r\n            }\r\n        }));\r\n        this._register(dom.addDisposableNonBubblingMouseOutListener(this._domNode, (e) => this._onMouseOut()));\r\n        this._register(dom.addDisposableListener(this._domNode, 'mouseover', (e) => this._onMouseOver()));\r\n        this._applyTheme(themeService.getColorTheme());\r\n        this._register(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\r\n    }\r\n    _keybindingLabelFor(actionId) {\r\n        let kb = this._keybindingService.lookupKeybinding(actionId);\r\n        if (!kb) {\r\n            return '';\r\n        }\r\n        return ` (${kb.getLabel()})`;\r\n    }\r\n    dispose() {\r\n        this._editor.removeOverlayWidget(this);\r\n        super.dispose();\r\n    }\r\n    // ----- IOverlayWidget API\r\n    getId() {\r\n        return FindOptionsWidget.ID;\r\n    }\r\n    getDomNode() {\r\n        return this._domNode;\r\n    }\r\n    getPosition() {\r\n        return {\r\n            preference: 0 /* TOP_RIGHT_CORNER */\r\n        };\r\n    }\r\n    highlightFindOptions() {\r\n        this._revealTemporarily();\r\n    }\r\n    _revealTemporarily() {\r\n        this._show();\r\n        this._hideSoon.schedule();\r\n    }\r\n    _onMouseOut() {\r\n        this._hideSoon.schedule();\r\n    }\r\n    _onMouseOver() {\r\n        this._hideSoon.cancel();\r\n    }\r\n    _show() {\r\n        if (this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = true;\r\n        this._domNode.style.display = 'block';\r\n    }\r\n    _hide() {\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        this._isVisible = false;\r\n        this._domNode.style.display = 'none';\r\n    }\r\n    _applyTheme(theme) {\r\n        let inputStyles = {\r\n            inputActiveOptionBorder: theme.getColor(inputActiveOptionBorder),\r\n            inputActiveOptionForeground: theme.getColor(inputActiveOptionForeground),\r\n            inputActiveOptionBackground: theme.getColor(inputActiveOptionBackground)\r\n        };\r\n        this.caseSensitive.style(inputStyles);\r\n        this.wholeWords.style(inputStyles);\r\n        this.regex.style(inputStyles);\r\n    }\r\n}\r\nFindOptionsWidget.ID = 'editor.contrib.findOptionsWidget';\r\nregisterThemingParticipant((theme, collector) => {\r\n    const widgetBackground = theme.getColor(editorWidgetBackground);\r\n    if (widgetBackground) {\r\n        collector.addRule(`.monaco-editor .findOptionsWidget { background-color: ${widgetBackground}; }`);\r\n    }\r\n    const widgetForeground = theme.getColor(editorWidgetForeground);\r\n    if (widgetForeground) {\r\n        collector.addRule(`.monaco-editor .findOptionsWidget { color: ${widgetForeground}; }`);\r\n    }\r\n    const widgetShadowColor = theme.getColor(widgetShadow);\r\n    if (widgetShadowColor) {\r\n        collector.addRule(`.monaco-editor .findOptionsWidget { box-shadow: 0 0 8px 2px ${widgetShadowColor}; }`);\r\n    }\r\n    const hcBorder = theme.getColor(contrastBorder);\r\n    if (hcBorder) {\r\n        collector.addRule(`.monaco-editor .findOptionsWidget { border: 2px solid ${hcBorder}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { MATCHES_LIMIT } from './findModel.js';\r\nfunction effectiveOptionValue(override, value) {\r\n    if (override === 1 /* True */) {\r\n        return true;\r\n    }\r\n    if (override === 2 /* False */) {\r\n        return false;\r\n    }\r\n    return value;\r\n}\r\nexport class FindReplaceState extends Disposable {\r\n    constructor() {\r\n        super();\r\n        this._onFindReplaceStateChange = this._register(new Emitter());\r\n        this.onFindReplaceStateChange = this._onFindReplaceStateChange.event;\r\n        this._searchString = '';\r\n        this._replaceString = '';\r\n        this._isRevealed = false;\r\n        this._isReplaceRevealed = false;\r\n        this._isRegex = false;\r\n        this._isRegexOverride = 0 /* NotSet */;\r\n        this._wholeWord = false;\r\n        this._wholeWordOverride = 0 /* NotSet */;\r\n        this._matchCase = false;\r\n        this._matchCaseOverride = 0 /* NotSet */;\r\n        this._preserveCase = false;\r\n        this._preserveCaseOverride = 0 /* NotSet */;\r\n        this._searchScope = null;\r\n        this._matchesPosition = 0;\r\n        this._matchesCount = 0;\r\n        this._currentMatch = null;\r\n        this._loop = true;\r\n    }\r\n    get searchString() { return this._searchString; }\r\n    get replaceString() { return this._replaceString; }\r\n    get isRevealed() { return this._isRevealed; }\r\n    get isReplaceRevealed() { return this._isReplaceRevealed; }\r\n    get isRegex() { return effectiveOptionValue(this._isRegexOverride, this._isRegex); }\r\n    get wholeWord() { return effectiveOptionValue(this._wholeWordOverride, this._wholeWord); }\r\n    get matchCase() { return effectiveOptionValue(this._matchCaseOverride, this._matchCase); }\r\n    get preserveCase() { return effectiveOptionValue(this._preserveCaseOverride, this._preserveCase); }\r\n    get actualIsRegex() { return this._isRegex; }\r\n    get actualWholeWord() { return this._wholeWord; }\r\n    get actualMatchCase() { return this._matchCase; }\r\n    get actualPreserveCase() { return this._preserveCase; }\r\n    get searchScope() { return this._searchScope; }\r\n    get matchesPosition() { return this._matchesPosition; }\r\n    get matchesCount() { return this._matchesCount; }\r\n    get currentMatch() { return this._currentMatch; }\r\n    changeMatchInfo(matchesPosition, matchesCount, currentMatch) {\r\n        let changeEvent = {\r\n            moveCursor: false,\r\n            updateHistory: false,\r\n            searchString: false,\r\n            replaceString: false,\r\n            isRevealed: false,\r\n            isReplaceRevealed: false,\r\n            isRegex: false,\r\n            wholeWord: false,\r\n            matchCase: false,\r\n            preserveCase: false,\r\n            searchScope: false,\r\n            matchesPosition: false,\r\n            matchesCount: false,\r\n            currentMatch: false,\r\n            loop: false\r\n        };\r\n        let somethingChanged = false;\r\n        if (matchesCount === 0) {\r\n            matchesPosition = 0;\r\n        }\r\n        if (matchesPosition > matchesCount) {\r\n            matchesPosition = matchesCount;\r\n        }\r\n        if (this._matchesPosition !== matchesPosition) {\r\n            this._matchesPosition = matchesPosition;\r\n            changeEvent.matchesPosition = true;\r\n            somethingChanged = true;\r\n        }\r\n        if (this._matchesCount !== matchesCount) {\r\n            this._matchesCount = matchesCount;\r\n            changeEvent.matchesCount = true;\r\n            somethingChanged = true;\r\n        }\r\n        if (typeof currentMatch !== 'undefined') {\r\n            if (!Range.equalsRange(this._currentMatch, currentMatch)) {\r\n                this._currentMatch = currentMatch;\r\n                changeEvent.currentMatch = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (somethingChanged) {\r\n            this._onFindReplaceStateChange.fire(changeEvent);\r\n        }\r\n    }\r\n    change(newState, moveCursor, updateHistory = true) {\r\n        var _a;\r\n        let changeEvent = {\r\n            moveCursor: moveCursor,\r\n            updateHistory: updateHistory,\r\n            searchString: false,\r\n            replaceString: false,\r\n            isRevealed: false,\r\n            isReplaceRevealed: false,\r\n            isRegex: false,\r\n            wholeWord: false,\r\n            matchCase: false,\r\n            preserveCase: false,\r\n            searchScope: false,\r\n            matchesPosition: false,\r\n            matchesCount: false,\r\n            currentMatch: false,\r\n            loop: false\r\n        };\r\n        let somethingChanged = false;\r\n        const oldEffectiveIsRegex = this.isRegex;\r\n        const oldEffectiveWholeWords = this.wholeWord;\r\n        const oldEffectiveMatchCase = this.matchCase;\r\n        const oldEffectivePreserveCase = this.preserveCase;\r\n        if (typeof newState.searchString !== 'undefined') {\r\n            if (this._searchString !== newState.searchString) {\r\n                this._searchString = newState.searchString;\r\n                changeEvent.searchString = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.replaceString !== 'undefined') {\r\n            if (this._replaceString !== newState.replaceString) {\r\n                this._replaceString = newState.replaceString;\r\n                changeEvent.replaceString = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.isRevealed !== 'undefined') {\r\n            if (this._isRevealed !== newState.isRevealed) {\r\n                this._isRevealed = newState.isRevealed;\r\n                changeEvent.isRevealed = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.isReplaceRevealed !== 'undefined') {\r\n            if (this._isReplaceRevealed !== newState.isReplaceRevealed) {\r\n                this._isReplaceRevealed = newState.isReplaceRevealed;\r\n                changeEvent.isReplaceRevealed = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.isRegex !== 'undefined') {\r\n            this._isRegex = newState.isRegex;\r\n        }\r\n        if (typeof newState.wholeWord !== 'undefined') {\r\n            this._wholeWord = newState.wholeWord;\r\n        }\r\n        if (typeof newState.matchCase !== 'undefined') {\r\n            this._matchCase = newState.matchCase;\r\n        }\r\n        if (typeof newState.preserveCase !== 'undefined') {\r\n            this._preserveCase = newState.preserveCase;\r\n        }\r\n        if (typeof newState.searchScope !== 'undefined') {\r\n            if (!((_a = newState.searchScope) === null || _a === void 0 ? void 0 : _a.every((newSearchScope) => {\r\n                var _a;\r\n                return (_a = this._searchScope) === null || _a === void 0 ? void 0 : _a.some(existingSearchScope => {\r\n                    return !Range.equalsRange(existingSearchScope, newSearchScope);\r\n                });\r\n            }))) {\r\n                this._searchScope = newState.searchScope;\r\n                changeEvent.searchScope = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        if (typeof newState.loop !== 'undefined') {\r\n            if (this._loop !== newState.loop) {\r\n                this._loop = newState.loop;\r\n                changeEvent.loop = true;\r\n                somethingChanged = true;\r\n            }\r\n        }\r\n        // Overrides get set when they explicitly come in and get reset anytime something else changes\r\n        this._isRegexOverride = (typeof newState.isRegexOverride !== 'undefined' ? newState.isRegexOverride : 0 /* NotSet */);\r\n        this._wholeWordOverride = (typeof newState.wholeWordOverride !== 'undefined' ? newState.wholeWordOverride : 0 /* NotSet */);\r\n        this._matchCaseOverride = (typeof newState.matchCaseOverride !== 'undefined' ? newState.matchCaseOverride : 0 /* NotSet */);\r\n        this._preserveCaseOverride = (typeof newState.preserveCaseOverride !== 'undefined' ? newState.preserveCaseOverride : 0 /* NotSet */);\r\n        if (oldEffectiveIsRegex !== this.isRegex) {\r\n            somethingChanged = true;\r\n            changeEvent.isRegex = true;\r\n        }\r\n        if (oldEffectiveWholeWords !== this.wholeWord) {\r\n            somethingChanged = true;\r\n            changeEvent.wholeWord = true;\r\n        }\r\n        if (oldEffectiveMatchCase !== this.matchCase) {\r\n            somethingChanged = true;\r\n            changeEvent.matchCase = true;\r\n        }\r\n        if (oldEffectivePreserveCase !== this.preserveCase) {\r\n            somethingChanged = true;\r\n            changeEvent.preserveCase = true;\r\n        }\r\n        if (somethingChanged) {\r\n            this._onFindReplaceStateChange.fire(changeEvent);\r\n        }\r\n    }\r\n    canNavigateBack() {\r\n        return this.canNavigateInLoop() || (this.matchesPosition !== 1);\r\n    }\r\n    canNavigateForward() {\r\n        return this.canNavigateInLoop() || (this.matchesPosition < this.matchesCount);\r\n    }\r\n    canNavigateInLoop() {\r\n        return this._loop || (this.matchesCount >= MATCHES_LIMIT);\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './findInput.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as dom from '../../dom.js';\r\nimport { HistoryInputBox } from '../inputbox/inputBox.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { CaseSensitiveCheckbox, WholeWordsCheckbox, RegexCheckbox } from './findInputCheckboxes.js';\r\nconst NLS_DEFAULT_LABEL = nls.localize('defaultLabel', \"input\");\r\nexport class FindInput extends Widget {\r\n    constructor(parent, contextViewProvider, _showOptionButtons, options) {\r\n        super();\r\n        this._showOptionButtons = _showOptionButtons;\r\n        this.fixFocusOnOptionClickEnabled = true;\r\n        this.imeSessionInProgress = false;\r\n        this._onDidOptionChange = this._register(new Emitter());\r\n        this.onDidOptionChange = this._onDidOptionChange.event;\r\n        this._onKeyDown = this._register(new Emitter());\r\n        this.onKeyDown = this._onKeyDown.event;\r\n        this._onMouseDown = this._register(new Emitter());\r\n        this.onMouseDown = this._onMouseDown.event;\r\n        this._onInput = this._register(new Emitter());\r\n        this._onKeyUp = this._register(new Emitter());\r\n        this._onCaseSensitiveKeyDown = this._register(new Emitter());\r\n        this.onCaseSensitiveKeyDown = this._onCaseSensitiveKeyDown.event;\r\n        this._onRegexKeyDown = this._register(new Emitter());\r\n        this.onRegexKeyDown = this._onRegexKeyDown.event;\r\n        this._lastHighlightFindOptions = 0;\r\n        this.contextViewProvider = contextViewProvider;\r\n        this.placeholder = options.placeholder || '';\r\n        this.validation = options.validation;\r\n        this.label = options.label || NLS_DEFAULT_LABEL;\r\n        this.inputActiveOptionBorder = options.inputActiveOptionBorder;\r\n        this.inputActiveOptionForeground = options.inputActiveOptionForeground;\r\n        this.inputActiveOptionBackground = options.inputActiveOptionBackground;\r\n        this.inputBackground = options.inputBackground;\r\n        this.inputForeground = options.inputForeground;\r\n        this.inputBorder = options.inputBorder;\r\n        this.inputValidationInfoBorder = options.inputValidationInfoBorder;\r\n        this.inputValidationInfoBackground = options.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = options.inputValidationInfoForeground;\r\n        this.inputValidationWarningBorder = options.inputValidationWarningBorder;\r\n        this.inputValidationWarningBackground = options.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = options.inputValidationWarningForeground;\r\n        this.inputValidationErrorBorder = options.inputValidationErrorBorder;\r\n        this.inputValidationErrorBackground = options.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = options.inputValidationErrorForeground;\r\n        const appendCaseSensitiveLabel = options.appendCaseSensitiveLabel || '';\r\n        const appendWholeWordsLabel = options.appendWholeWordsLabel || '';\r\n        const appendRegexLabel = options.appendRegexLabel || '';\r\n        const history = options.history || [];\r\n        const flexibleHeight = !!options.flexibleHeight;\r\n        const flexibleWidth = !!options.flexibleWidth;\r\n        const flexibleMaxHeight = options.flexibleMaxHeight;\r\n        this.domNode = document.createElement('div');\r\n        this.domNode.classList.add('monaco-findInput');\r\n        this.inputBox = this._register(new HistoryInputBox(this.domNode, this.contextViewProvider, {\r\n            placeholder: this.placeholder || '',\r\n            ariaLabel: this.label || '',\r\n            validationOptions: {\r\n                validation: this.validation\r\n            },\r\n            inputBackground: this.inputBackground,\r\n            inputForeground: this.inputForeground,\r\n            inputBorder: this.inputBorder,\r\n            inputValidationInfoBackground: this.inputValidationInfoBackground,\r\n            inputValidationInfoForeground: this.inputValidationInfoForeground,\r\n            inputValidationInfoBorder: this.inputValidationInfoBorder,\r\n            inputValidationWarningBackground: this.inputValidationWarningBackground,\r\n            inputValidationWarningForeground: this.inputValidationWarningForeground,\r\n            inputValidationWarningBorder: this.inputValidationWarningBorder,\r\n            inputValidationErrorBackground: this.inputValidationErrorBackground,\r\n            inputValidationErrorForeground: this.inputValidationErrorForeground,\r\n            inputValidationErrorBorder: this.inputValidationErrorBorder,\r\n            history,\r\n            flexibleHeight,\r\n            flexibleWidth,\r\n            flexibleMaxHeight\r\n        }));\r\n        this.regex = this._register(new RegexCheckbox({\r\n            appendTitle: appendRegexLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n            inputActiveOptionForeground: this.inputActiveOptionForeground,\r\n            inputActiveOptionBackground: this.inputActiveOptionBackground\r\n        }));\r\n        this._register(this.regex.onChange(viaKeyboard => {\r\n            this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && this.fixFocusOnOptionClickEnabled) {\r\n                this.inputBox.focus();\r\n            }\r\n            this.validate();\r\n        }));\r\n        this._register(this.regex.onKeyDown(e => {\r\n            this._onRegexKeyDown.fire(e);\r\n        }));\r\n        this.wholeWords = this._register(new WholeWordsCheckbox({\r\n            appendTitle: appendWholeWordsLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n            inputActiveOptionForeground: this.inputActiveOptionForeground,\r\n            inputActiveOptionBackground: this.inputActiveOptionBackground\r\n        }));\r\n        this._register(this.wholeWords.onChange(viaKeyboard => {\r\n            this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && this.fixFocusOnOptionClickEnabled) {\r\n                this.inputBox.focus();\r\n            }\r\n            this.validate();\r\n        }));\r\n        this.caseSensitive = this._register(new CaseSensitiveCheckbox({\r\n            appendTitle: appendCaseSensitiveLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n            inputActiveOptionForeground: this.inputActiveOptionForeground,\r\n            inputActiveOptionBackground: this.inputActiveOptionBackground\r\n        }));\r\n        this._register(this.caseSensitive.onChange(viaKeyboard => {\r\n            this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && this.fixFocusOnOptionClickEnabled) {\r\n                this.inputBox.focus();\r\n            }\r\n            this.validate();\r\n        }));\r\n        this._register(this.caseSensitive.onKeyDown(e => {\r\n            this._onCaseSensitiveKeyDown.fire(e);\r\n        }));\r\n        if (this._showOptionButtons) {\r\n            this.inputBox.paddingRight = this.caseSensitive.width() + this.wholeWords.width() + this.regex.width();\r\n        }\r\n        // Arrow-Key support to navigate between options\r\n        let indexes = [this.caseSensitive.domNode, this.wholeWords.domNode, this.regex.domNode];\r\n        this.onkeydown(this.domNode, (event) => {\r\n            if (event.equals(15 /* LeftArrow */) || event.equals(17 /* RightArrow */) || event.equals(9 /* Escape */)) {\r\n                let index = indexes.indexOf(document.activeElement);\r\n                if (index >= 0) {\r\n                    let newIndex = -1;\r\n                    if (event.equals(17 /* RightArrow */)) {\r\n                        newIndex = (index + 1) % indexes.length;\r\n                    }\r\n                    else if (event.equals(15 /* LeftArrow */)) {\r\n                        if (index === 0) {\r\n                            newIndex = indexes.length - 1;\r\n                        }\r\n                        else {\r\n                            newIndex = index - 1;\r\n                        }\r\n                    }\r\n                    if (event.equals(9 /* Escape */)) {\r\n                        indexes[index].blur();\r\n                        this.inputBox.focus();\r\n                    }\r\n                    else if (newIndex >= 0) {\r\n                        indexes[newIndex].focus();\r\n                    }\r\n                    dom.EventHelper.stop(event, true);\r\n                }\r\n            }\r\n        });\r\n        let controls = document.createElement('div');\r\n        controls.className = 'controls';\r\n        controls.style.display = this._showOptionButtons ? 'block' : 'none';\r\n        controls.appendChild(this.caseSensitive.domNode);\r\n        controls.appendChild(this.wholeWords.domNode);\r\n        controls.appendChild(this.regex.domNode);\r\n        this.domNode.appendChild(controls);\r\n        if (parent) {\r\n            parent.appendChild(this.domNode);\r\n        }\r\n        this._register(dom.addDisposableListener(this.inputBox.inputElement, 'compositionstart', (e) => {\r\n            this.imeSessionInProgress = true;\r\n        }));\r\n        this._register(dom.addDisposableListener(this.inputBox.inputElement, 'compositionend', (e) => {\r\n            this.imeSessionInProgress = false;\r\n            this._onInput.fire();\r\n        }));\r\n        this.onkeydown(this.inputBox.inputElement, (e) => this._onKeyDown.fire(e));\r\n        this.onkeyup(this.inputBox.inputElement, (e) => this._onKeyUp.fire(e));\r\n        this.oninput(this.inputBox.inputElement, (e) => this._onInput.fire());\r\n        this.onmousedown(this.inputBox.inputElement, (e) => this._onMouseDown.fire(e));\r\n    }\r\n    enable() {\r\n        this.domNode.classList.remove('disabled');\r\n        this.inputBox.enable();\r\n        this.regex.enable();\r\n        this.wholeWords.enable();\r\n        this.caseSensitive.enable();\r\n    }\r\n    disable() {\r\n        this.domNode.classList.add('disabled');\r\n        this.inputBox.disable();\r\n        this.regex.disable();\r\n        this.wholeWords.disable();\r\n        this.caseSensitive.disable();\r\n    }\r\n    setFocusInputOnOptionClick(value) {\r\n        this.fixFocusOnOptionClickEnabled = value;\r\n    }\r\n    setEnabled(enabled) {\r\n        if (enabled) {\r\n            this.enable();\r\n        }\r\n        else {\r\n            this.disable();\r\n        }\r\n    }\r\n    getValue() {\r\n        return this.inputBox.value;\r\n    }\r\n    setValue(value) {\r\n        if (this.inputBox.value !== value) {\r\n            this.inputBox.value = value;\r\n        }\r\n    }\r\n    style(styles) {\r\n        this.inputActiveOptionBorder = styles.inputActiveOptionBorder;\r\n        this.inputActiveOptionForeground = styles.inputActiveOptionForeground;\r\n        this.inputActiveOptionBackground = styles.inputActiveOptionBackground;\r\n        this.inputBackground = styles.inputBackground;\r\n        this.inputForeground = styles.inputForeground;\r\n        this.inputBorder = styles.inputBorder;\r\n        this.inputValidationInfoBackground = styles.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = styles.inputValidationInfoForeground;\r\n        this.inputValidationInfoBorder = styles.inputValidationInfoBorder;\r\n        this.inputValidationWarningBackground = styles.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = styles.inputValidationWarningForeground;\r\n        this.inputValidationWarningBorder = styles.inputValidationWarningBorder;\r\n        this.inputValidationErrorBackground = styles.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = styles.inputValidationErrorForeground;\r\n        this.inputValidationErrorBorder = styles.inputValidationErrorBorder;\r\n        this.applyStyles();\r\n    }\r\n    applyStyles() {\r\n        if (this.domNode) {\r\n            const checkBoxStyles = {\r\n                inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n                inputActiveOptionForeground: this.inputActiveOptionForeground,\r\n                inputActiveOptionBackground: this.inputActiveOptionBackground,\r\n            };\r\n            this.regex.style(checkBoxStyles);\r\n            this.wholeWords.style(checkBoxStyles);\r\n            this.caseSensitive.style(checkBoxStyles);\r\n            const inputBoxStyles = {\r\n                inputBackground: this.inputBackground,\r\n                inputForeground: this.inputForeground,\r\n                inputBorder: this.inputBorder,\r\n                inputValidationInfoBackground: this.inputValidationInfoBackground,\r\n                inputValidationInfoForeground: this.inputValidationInfoForeground,\r\n                inputValidationInfoBorder: this.inputValidationInfoBorder,\r\n                inputValidationWarningBackground: this.inputValidationWarningBackground,\r\n                inputValidationWarningForeground: this.inputValidationWarningForeground,\r\n                inputValidationWarningBorder: this.inputValidationWarningBorder,\r\n                inputValidationErrorBackground: this.inputValidationErrorBackground,\r\n                inputValidationErrorForeground: this.inputValidationErrorForeground,\r\n                inputValidationErrorBorder: this.inputValidationErrorBorder\r\n            };\r\n            this.inputBox.style(inputBoxStyles);\r\n        }\r\n    }\r\n    select() {\r\n        this.inputBox.select();\r\n    }\r\n    focus() {\r\n        this.inputBox.focus();\r\n    }\r\n    getCaseSensitive() {\r\n        return this.caseSensitive.checked;\r\n    }\r\n    setCaseSensitive(value) {\r\n        this.caseSensitive.checked = value;\r\n    }\r\n    getWholeWords() {\r\n        return this.wholeWords.checked;\r\n    }\r\n    setWholeWords(value) {\r\n        this.wholeWords.checked = value;\r\n    }\r\n    getRegex() {\r\n        return this.regex.checked;\r\n    }\r\n    setRegex(value) {\r\n        this.regex.checked = value;\r\n        this.validate();\r\n    }\r\n    focusOnCaseSensitive() {\r\n        this.caseSensitive.focus();\r\n    }\r\n    highlightFindOptions() {\r\n        this.domNode.classList.remove('highlight-' + (this._lastHighlightFindOptions));\r\n        this._lastHighlightFindOptions = 1 - this._lastHighlightFindOptions;\r\n        this.domNode.classList.add('highlight-' + (this._lastHighlightFindOptions));\r\n    }\r\n    validate() {\r\n        this.inputBox.validate();\r\n    }\r\n    clearMessage() {\r\n        this.inputBox.hideMessage();\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './findInput.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport * as dom from '../../dom.js';\r\nimport { HistoryInputBox } from '../inputbox/inputBox.js';\r\nimport { Widget } from '../widget.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { Checkbox } from '../checkbox/checkbox.js';\r\nimport { Codicon } from '../../../common/codicons.js';\r\nconst NLS_DEFAULT_LABEL = nls.localize('defaultLabel', \"input\");\r\nconst NLS_PRESERVE_CASE_LABEL = nls.localize('label.preserveCaseCheckbox', \"Preserve Case\");\r\nexport class PreserveCaseCheckbox extends Checkbox {\r\n    constructor(opts) {\r\n        super({\r\n            // TODO: does this need its own icon?\r\n            icon: Codicon.preserveCase,\r\n            title: NLS_PRESERVE_CASE_LABEL + opts.appendTitle,\r\n            isChecked: opts.isChecked,\r\n            inputActiveOptionBorder: opts.inputActiveOptionBorder,\r\n            inputActiveOptionForeground: opts.inputActiveOptionForeground,\r\n            inputActiveOptionBackground: opts.inputActiveOptionBackground\r\n        });\r\n    }\r\n}\r\nexport class ReplaceInput extends Widget {\r\n    constructor(parent, contextViewProvider, _showOptionButtons, options) {\r\n        super();\r\n        this._showOptionButtons = _showOptionButtons;\r\n        this.fixFocusOnOptionClickEnabled = true;\r\n        this.cachedOptionsWidth = 0;\r\n        this._onDidOptionChange = this._register(new Emitter());\r\n        this.onDidOptionChange = this._onDidOptionChange.event;\r\n        this._onKeyDown = this._register(new Emitter());\r\n        this.onKeyDown = this._onKeyDown.event;\r\n        this._onMouseDown = this._register(new Emitter());\r\n        this._onInput = this._register(new Emitter());\r\n        this._onKeyUp = this._register(new Emitter());\r\n        this._onPreserveCaseKeyDown = this._register(new Emitter());\r\n        this.onPreserveCaseKeyDown = this._onPreserveCaseKeyDown.event;\r\n        this.contextViewProvider = contextViewProvider;\r\n        this.placeholder = options.placeholder || '';\r\n        this.validation = options.validation;\r\n        this.label = options.label || NLS_DEFAULT_LABEL;\r\n        this.inputActiveOptionBorder = options.inputActiveOptionBorder;\r\n        this.inputActiveOptionForeground = options.inputActiveOptionForeground;\r\n        this.inputActiveOptionBackground = options.inputActiveOptionBackground;\r\n        this.inputBackground = options.inputBackground;\r\n        this.inputForeground = options.inputForeground;\r\n        this.inputBorder = options.inputBorder;\r\n        this.inputValidationInfoBorder = options.inputValidationInfoBorder;\r\n        this.inputValidationInfoBackground = options.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = options.inputValidationInfoForeground;\r\n        this.inputValidationWarningBorder = options.inputValidationWarningBorder;\r\n        this.inputValidationWarningBackground = options.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = options.inputValidationWarningForeground;\r\n        this.inputValidationErrorBorder = options.inputValidationErrorBorder;\r\n        this.inputValidationErrorBackground = options.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = options.inputValidationErrorForeground;\r\n        const appendPreserveCaseLabel = options.appendPreserveCaseLabel || '';\r\n        const history = options.history || [];\r\n        const flexibleHeight = !!options.flexibleHeight;\r\n        const flexibleWidth = !!options.flexibleWidth;\r\n        const flexibleMaxHeight = options.flexibleMaxHeight;\r\n        this.domNode = document.createElement('div');\r\n        this.domNode.classList.add('monaco-findInput');\r\n        this.inputBox = this._register(new HistoryInputBox(this.domNode, this.contextViewProvider, {\r\n            ariaLabel: this.label || '',\r\n            placeholder: this.placeholder || '',\r\n            validationOptions: {\r\n                validation: this.validation\r\n            },\r\n            inputBackground: this.inputBackground,\r\n            inputForeground: this.inputForeground,\r\n            inputBorder: this.inputBorder,\r\n            inputValidationInfoBackground: this.inputValidationInfoBackground,\r\n            inputValidationInfoForeground: this.inputValidationInfoForeground,\r\n            inputValidationInfoBorder: this.inputValidationInfoBorder,\r\n            inputValidationWarningBackground: this.inputValidationWarningBackground,\r\n            inputValidationWarningForeground: this.inputValidationWarningForeground,\r\n            inputValidationWarningBorder: this.inputValidationWarningBorder,\r\n            inputValidationErrorBackground: this.inputValidationErrorBackground,\r\n            inputValidationErrorForeground: this.inputValidationErrorForeground,\r\n            inputValidationErrorBorder: this.inputValidationErrorBorder,\r\n            history,\r\n            flexibleHeight,\r\n            flexibleWidth,\r\n            flexibleMaxHeight\r\n        }));\r\n        this.preserveCase = this._register(new PreserveCaseCheckbox({\r\n            appendTitle: appendPreserveCaseLabel,\r\n            isChecked: false,\r\n            inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n            inputActiveOptionForeground: this.inputActiveOptionForeground,\r\n            inputActiveOptionBackground: this.inputActiveOptionBackground,\r\n        }));\r\n        this._register(this.preserveCase.onChange(viaKeyboard => {\r\n            this._onDidOptionChange.fire(viaKeyboard);\r\n            if (!viaKeyboard && this.fixFocusOnOptionClickEnabled) {\r\n                this.inputBox.focus();\r\n            }\r\n            this.validate();\r\n        }));\r\n        this._register(this.preserveCase.onKeyDown(e => {\r\n            this._onPreserveCaseKeyDown.fire(e);\r\n        }));\r\n        if (this._showOptionButtons) {\r\n            this.cachedOptionsWidth = this.preserveCase.width();\r\n        }\r\n        else {\r\n            this.cachedOptionsWidth = 0;\r\n        }\r\n        // Arrow-Key support to navigate between options\r\n        let indexes = [this.preserveCase.domNode];\r\n        this.onkeydown(this.domNode, (event) => {\r\n            if (event.equals(15 /* LeftArrow */) || event.equals(17 /* RightArrow */) || event.equals(9 /* Escape */)) {\r\n                let index = indexes.indexOf(document.activeElement);\r\n                if (index >= 0) {\r\n                    let newIndex = -1;\r\n                    if (event.equals(17 /* RightArrow */)) {\r\n                        newIndex = (index + 1) % indexes.length;\r\n                    }\r\n                    else if (event.equals(15 /* LeftArrow */)) {\r\n                        if (index === 0) {\r\n                            newIndex = indexes.length - 1;\r\n                        }\r\n                        else {\r\n                            newIndex = index - 1;\r\n                        }\r\n                    }\r\n                    if (event.equals(9 /* Escape */)) {\r\n                        indexes[index].blur();\r\n                        this.inputBox.focus();\r\n                    }\r\n                    else if (newIndex >= 0) {\r\n                        indexes[newIndex].focus();\r\n                    }\r\n                    dom.EventHelper.stop(event, true);\r\n                }\r\n            }\r\n        });\r\n        let controls = document.createElement('div');\r\n        controls.className = 'controls';\r\n        controls.style.display = this._showOptionButtons ? 'block' : 'none';\r\n        controls.appendChild(this.preserveCase.domNode);\r\n        this.domNode.appendChild(controls);\r\n        if (parent) {\r\n            parent.appendChild(this.domNode);\r\n        }\r\n        this.onkeydown(this.inputBox.inputElement, (e) => this._onKeyDown.fire(e));\r\n        this.onkeyup(this.inputBox.inputElement, (e) => this._onKeyUp.fire(e));\r\n        this.oninput(this.inputBox.inputElement, (e) => this._onInput.fire());\r\n        this.onmousedown(this.inputBox.inputElement, (e) => this._onMouseDown.fire(e));\r\n    }\r\n    enable() {\r\n        this.domNode.classList.remove('disabled');\r\n        this.inputBox.enable();\r\n        this.preserveCase.enable();\r\n    }\r\n    disable() {\r\n        this.domNode.classList.add('disabled');\r\n        this.inputBox.disable();\r\n        this.preserveCase.disable();\r\n    }\r\n    setEnabled(enabled) {\r\n        if (enabled) {\r\n            this.enable();\r\n        }\r\n        else {\r\n            this.disable();\r\n        }\r\n    }\r\n    style(styles) {\r\n        this.inputActiveOptionBorder = styles.inputActiveOptionBorder;\r\n        this.inputActiveOptionForeground = styles.inputActiveOptionForeground;\r\n        this.inputActiveOptionBackground = styles.inputActiveOptionBackground;\r\n        this.inputBackground = styles.inputBackground;\r\n        this.inputForeground = styles.inputForeground;\r\n        this.inputBorder = styles.inputBorder;\r\n        this.inputValidationInfoBackground = styles.inputValidationInfoBackground;\r\n        this.inputValidationInfoForeground = styles.inputValidationInfoForeground;\r\n        this.inputValidationInfoBorder = styles.inputValidationInfoBorder;\r\n        this.inputValidationWarningBackground = styles.inputValidationWarningBackground;\r\n        this.inputValidationWarningForeground = styles.inputValidationWarningForeground;\r\n        this.inputValidationWarningBorder = styles.inputValidationWarningBorder;\r\n        this.inputValidationErrorBackground = styles.inputValidationErrorBackground;\r\n        this.inputValidationErrorForeground = styles.inputValidationErrorForeground;\r\n        this.inputValidationErrorBorder = styles.inputValidationErrorBorder;\r\n        this.applyStyles();\r\n    }\r\n    applyStyles() {\r\n        if (this.domNode) {\r\n            const checkBoxStyles = {\r\n                inputActiveOptionBorder: this.inputActiveOptionBorder,\r\n                inputActiveOptionForeground: this.inputActiveOptionForeground,\r\n                inputActiveOptionBackground: this.inputActiveOptionBackground,\r\n            };\r\n            this.preserveCase.style(checkBoxStyles);\r\n            const inputBoxStyles = {\r\n                inputBackground: this.inputBackground,\r\n                inputForeground: this.inputForeground,\r\n                inputBorder: this.inputBorder,\r\n                inputValidationInfoBackground: this.inputValidationInfoBackground,\r\n                inputValidationInfoForeground: this.inputValidationInfoForeground,\r\n                inputValidationInfoBorder: this.inputValidationInfoBorder,\r\n                inputValidationWarningBackground: this.inputValidationWarningBackground,\r\n                inputValidationWarningForeground: this.inputValidationWarningForeground,\r\n                inputValidationWarningBorder: this.inputValidationWarningBorder,\r\n                inputValidationErrorBackground: this.inputValidationErrorBackground,\r\n                inputValidationErrorForeground: this.inputValidationErrorForeground,\r\n                inputValidationErrorBorder: this.inputValidationErrorBorder\r\n            };\r\n            this.inputBox.style(inputBoxStyles);\r\n        }\r\n    }\r\n    select() {\r\n        this.inputBox.select();\r\n    }\r\n    focus() {\r\n        this.inputBox.focus();\r\n    }\r\n    getPreserveCase() {\r\n        return this.preserveCase.checked;\r\n    }\r\n    setPreserveCase(value) {\r\n        this.preserveCase.checked = value;\r\n    }\r\n    focusOnPreserve() {\r\n        this.preserveCase.focus();\r\n    }\r\n    validate() {\r\n        if (this.inputBox) {\r\n            this.inputBox.validate();\r\n        }\r\n    }\r\n    set width(newWidth) {\r\n        this.inputBox.paddingRight = this.cachedOptionsWidth;\r\n        this.inputBox.width = newWidth;\r\n        this.domNode.style.width = newWidth + 'px';\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { IContextKeyService, ContextKeyExpr, RawContextKey } from '../contextkey/common/contextkey.js';\r\nimport { FindInput } from '../../base/browser/ui/findinput/findInput.js';\r\nimport { KeybindingsRegistry } from '../keybinding/common/keybindingsRegistry.js';\r\nimport { ReplaceInput } from '../../base/browser/ui/findinput/replaceInput.js';\r\nexport const HistoryNavigationWidgetContext = 'historyNavigationWidget';\r\nexport const HistoryNavigationEnablementContext = 'historyNavigationEnabled';\r\nfunction bindContextScopedWidget(contextKeyService, widget, contextKey) {\r\n    new RawContextKey(contextKey, widget).bindTo(contextKeyService);\r\n}\r\nfunction createWidgetScopedContextKeyService(contextKeyService, widget) {\r\n    return contextKeyService.createScoped(widget.target);\r\n}\r\nfunction getContextScopedWidget(contextKeyService, contextKey) {\r\n    return contextKeyService.getContext(document.activeElement).getValue(contextKey);\r\n}\r\nexport function createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService, widget) {\r\n    const scopedContextKeyService = createWidgetScopedContextKeyService(contextKeyService, widget);\r\n    bindContextScopedWidget(scopedContextKeyService, widget, HistoryNavigationWidgetContext);\r\n    const historyNavigationEnablement = new RawContextKey(HistoryNavigationEnablementContext, true).bindTo(scopedContextKeyService);\r\n    return { scopedContextKeyService, historyNavigationEnablement };\r\n}\r\nlet ContextScopedFindInput = class ContextScopedFindInput extends FindInput {\r\n    constructor(container, contextViewProvider, options, contextKeyService, showFindOptions = false) {\r\n        super(container, contextViewProvider, showFindOptions, options);\r\n        this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService, { target: this.inputBox.element, historyNavigator: this.inputBox }).scopedContextKeyService);\r\n    }\r\n};\r\nContextScopedFindInput = __decorate([\r\n    __param(3, IContextKeyService)\r\n], ContextScopedFindInput);\r\nexport { ContextScopedFindInput };\r\nlet ContextScopedReplaceInput = class ContextScopedReplaceInput extends ReplaceInput {\r\n    constructor(container, contextViewProvider, options, contextKeyService, showReplaceOptions = false) {\r\n        super(container, contextViewProvider, showReplaceOptions, options);\r\n        this._register(createAndBindHistoryNavigationWidgetScopedContextKeyService(contextKeyService, { target: this.inputBox.element, historyNavigator: this.inputBox }).scopedContextKeyService);\r\n    }\r\n};\r\nContextScopedReplaceInput = __decorate([\r\n    __param(3, IContextKeyService)\r\n], ContextScopedReplaceInput);\r\nexport { ContextScopedReplaceInput };\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'history.showPrevious',\r\n    weight: 200 /* WorkbenchContrib */,\r\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetContext), ContextKeyExpr.equals(HistoryNavigationEnablementContext, true)),\r\n    primary: 16 /* UpArrow */,\r\n    secondary: [512 /* Alt */ | 16 /* UpArrow */],\r\n    handler: (accessor, arg2) => {\r\n        const widget = getContextScopedWidget(accessor.get(IContextKeyService), HistoryNavigationWidgetContext);\r\n        if (widget) {\r\n            const historyInputBox = widget.historyNavigator;\r\n            historyInputBox.showPreviousValue();\r\n        }\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'history.showNext',\r\n    weight: 200 /* WorkbenchContrib */,\r\n    when: ContextKeyExpr.and(ContextKeyExpr.has(HistoryNavigationWidgetContext), ContextKeyExpr.equals(HistoryNavigationEnablementContext, true)),\r\n    primary: 18 /* DownArrow */,\r\n    secondary: [512 /* Alt */ | 18 /* DownArrow */],\r\n    handler: (accessor, arg2) => {\r\n        const widget = getContextScopedWidget(accessor.get(IContextKeyService), HistoryNavigationWidgetContext);\r\n        if (widget) {\r\n            const historyInputBox = widget.historyNavigator;\r\n            historyInputBox.showNextValue();\r\n        }\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport './findWidget.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { alert as alertFn } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Checkbox } from '../../../base/browser/ui/checkbox/checkbox.js';\r\nimport { Sash } from '../../../base/browser/ui/sash/sash.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { Delayer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_REPLACE_INPUT_FOCUSED, FIND_IDS, MATCHES_LIMIT } from './findModel.js';\r\nimport { contrastBorder, editorFindMatch, editorFindMatchBorder, editorFindMatchHighlight, editorFindMatchHighlightBorder, editorFindRangeHighlight, editorFindRangeHighlightBorder, editorWidgetBackground, editorWidgetBorder, editorWidgetResizeBorder, errorForeground, inputActiveOptionBorder, inputActiveOptionBackground, inputActiveOptionForeground, inputBackground, inputBorder, inputForeground, inputValidationErrorBackground, inputValidationErrorBorder, inputValidationErrorForeground, inputValidationInfoBackground, inputValidationInfoBorder, inputValidationInfoForeground, inputValidationWarningBackground, inputValidationWarningBorder, inputValidationWarningForeground, widgetShadow, editorWidgetForeground, focusBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant, ThemeIcon } from '../../../platform/theme/common/themeService.js';\r\nimport { ContextScopedFindInput, ContextScopedReplaceInput } from '../../../platform/browser/contextScopedHistoryWidget.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nimport { registerIcon, widgetClose } from '../../../platform/theme/common/iconRegistry.js';\r\nconst findSelectionIcon = registerIcon('find-selection', Codicon.selection, nls.localize('findSelectionIcon', 'Icon for \\'Find in Selection\\' in the editor find widget.'));\r\nconst findCollapsedIcon = registerIcon('find-collapsed', Codicon.chevronRight, nls.localize('findCollapsedIcon', 'Icon to indicate that the editor find widget is collapsed.'));\r\nconst findExpandedIcon = registerIcon('find-expanded', Codicon.chevronDown, nls.localize('findExpandedIcon', 'Icon to indicate that the editor find widget is expanded.'));\r\nexport const findReplaceIcon = registerIcon('find-replace', Codicon.replace, nls.localize('findReplaceIcon', 'Icon for \\'Replace\\' in the editor find widget.'));\r\nexport const findReplaceAllIcon = registerIcon('find-replace-all', Codicon.replaceAll, nls.localize('findReplaceAllIcon', 'Icon for \\'Replace All\\' in the editor find widget.'));\r\nexport const findPreviousMatchIcon = registerIcon('find-previous-match', Codicon.arrowUp, nls.localize('findPreviousMatchIcon', 'Icon for \\'Find Previous\\' in the editor find widget.'));\r\nexport const findNextMatchIcon = registerIcon('find-next-match', Codicon.arrowDown, nls.localize('findNextMatchIcon', 'Icon for \\'Find Next\\' in the editor find widget.'));\r\nconst NLS_FIND_INPUT_LABEL = nls.localize('label.find', \"Find\");\r\nconst NLS_FIND_INPUT_PLACEHOLDER = nls.localize('placeholder.find', \"Find\");\r\nconst NLS_PREVIOUS_MATCH_BTN_LABEL = nls.localize('label.previousMatchButton', \"Previous Match\");\r\nconst NLS_NEXT_MATCH_BTN_LABEL = nls.localize('label.nextMatchButton', \"Next Match\");\r\nconst NLS_TOGGLE_SELECTION_FIND_TITLE = nls.localize('label.toggleSelectionFind', \"Find in Selection\");\r\nconst NLS_CLOSE_BTN_LABEL = nls.localize('label.closeButton', \"Close\");\r\nconst NLS_REPLACE_INPUT_LABEL = nls.localize('label.replace', \"Replace\");\r\nconst NLS_REPLACE_INPUT_PLACEHOLDER = nls.localize('placeholder.replace', \"Replace\");\r\nconst NLS_REPLACE_BTN_LABEL = nls.localize('label.replaceButton', \"Replace\");\r\nconst NLS_REPLACE_ALL_BTN_LABEL = nls.localize('label.replaceAllButton', \"Replace All\");\r\nconst NLS_TOGGLE_REPLACE_MODE_BTN_LABEL = nls.localize('label.toggleReplaceButton', \"Toggle Replace\");\r\nconst NLS_MATCHES_COUNT_LIMIT_TITLE = nls.localize('title.matchesCountLimit', \"Only the first {0} results are highlighted, but all find operations work on the entire text.\", MATCHES_LIMIT);\r\nexport const NLS_MATCHES_LOCATION = nls.localize('label.matchesLocation', \"{0} of {1}\");\r\nexport const NLS_NO_RESULTS = nls.localize('label.noResults', \"No results\");\r\nconst FIND_WIDGET_INITIAL_WIDTH = 419;\r\nconst PART_WIDTH = 275;\r\nconst FIND_INPUT_AREA_WIDTH = PART_WIDTH - 54;\r\nlet MAX_MATCHES_COUNT_WIDTH = 69;\r\n// let FIND_ALL_CONTROLS_WIDTH = 17/** Find Input margin-left */ + (MAX_MATCHES_COUNT_WIDTH + 3 + 1) /** Match Results */ + 23 /** Button */ * 4 + 2/** sash */;\r\nconst FIND_INPUT_AREA_HEIGHT = 33; // The height of Find Widget when Replace Input is not visible.\r\nconst ctrlEnterReplaceAllWarningPromptedKey = 'ctrlEnterReplaceAll.windows.donotask';\r\nconst ctrlKeyMod = (platform.isMacintosh ? 256 /* WinCtrl */ : 2048 /* CtrlCmd */);\r\nexport class FindWidgetViewZone {\r\n    constructor(afterLineNumber) {\r\n        this.afterLineNumber = afterLineNumber;\r\n        this.heightInPx = FIND_INPUT_AREA_HEIGHT;\r\n        this.suppressMouseDown = false;\r\n        this.domNode = document.createElement('div');\r\n        this.domNode.className = 'dock-find-viewzone';\r\n    }\r\n}\r\nfunction stopPropagationForMultiLineUpwards(event, value, textarea) {\r\n    const isMultiline = !!value.match(/\\n/);\r\n    if (textarea && isMultiline && textarea.selectionStart > 0) {\r\n        event.stopPropagation();\r\n        return;\r\n    }\r\n}\r\nfunction stopPropagationForMultiLineDownwards(event, value, textarea) {\r\n    const isMultiline = !!value.match(/\\n/);\r\n    if (textarea && isMultiline && textarea.selectionEnd < textarea.value.length) {\r\n        event.stopPropagation();\r\n        return;\r\n    }\r\n}\r\nexport class FindWidget extends Widget {\r\n    constructor(codeEditor, controller, state, contextViewProvider, keybindingService, contextKeyService, themeService, storageService, notificationService) {\r\n        super();\r\n        this._cachedHeight = null;\r\n        this._revealTimeouts = [];\r\n        this._codeEditor = codeEditor;\r\n        this._controller = controller;\r\n        this._state = state;\r\n        this._contextViewProvider = contextViewProvider;\r\n        this._keybindingService = keybindingService;\r\n        this._contextKeyService = contextKeyService;\r\n        this._storageService = storageService;\r\n        this._notificationService = notificationService;\r\n        this._ctrlEnterReplaceAllWarningPrompted = !!storageService.getBoolean(ctrlEnterReplaceAllWarningPromptedKey, 0 /* GLOBAL */);\r\n        this._isVisible = false;\r\n        this._isReplaceVisible = false;\r\n        this._ignoreChangeEvent = false;\r\n        this._updateHistoryDelayer = new Delayer(500);\r\n        this._register(toDisposable(() => this._updateHistoryDelayer.cancel()));\r\n        this._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\r\n        this._buildDomNode();\r\n        this._updateButtons();\r\n        this._tryUpdateWidgetWidth();\r\n        this._findInput.inputBox.layout();\r\n        this._register(this._codeEditor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(79 /* readOnly */)) {\r\n                if (this._codeEditor.getOption(79 /* readOnly */)) {\r\n                    // Hide replace part if editor becomes read only\r\n                    this._state.change({ isReplaceRevealed: false }, false);\r\n                }\r\n                this._updateButtons();\r\n            }\r\n            if (e.hasChanged(129 /* layoutInfo */)) {\r\n                this._tryUpdateWidgetWidth();\r\n            }\r\n            if (e.hasChanged(2 /* accessibilitySupport */)) {\r\n                this.updateAccessibilitySupport();\r\n            }\r\n            if (e.hasChanged(33 /* find */)) {\r\n                const addExtraSpaceOnTop = this._codeEditor.getOption(33 /* find */).addExtraSpaceOnTop;\r\n                if (addExtraSpaceOnTop && !this._viewZone) {\r\n                    this._viewZone = new FindWidgetViewZone(0);\r\n                    this._showViewZone();\r\n                }\r\n                if (!addExtraSpaceOnTop && this._viewZone) {\r\n                    this._removeViewZone();\r\n                }\r\n            }\r\n        }));\r\n        this.updateAccessibilitySupport();\r\n        this._register(this._codeEditor.onDidChangeCursorSelection(() => {\r\n            if (this._isVisible) {\r\n                this._updateToggleSelectionFindButton();\r\n            }\r\n        }));\r\n        this._register(this._codeEditor.onDidFocusEditorWidget(() => __awaiter(this, void 0, void 0, function* () {\r\n            if (this._isVisible) {\r\n                let globalBufferTerm = yield this._controller.getGlobalBufferTerm();\r\n                if (globalBufferTerm && globalBufferTerm !== this._state.searchString) {\r\n                    this._state.change({ searchString: globalBufferTerm }, false);\r\n                    this._findInput.select();\r\n                }\r\n            }\r\n        })));\r\n        this._findInputFocused = CONTEXT_FIND_INPUT_FOCUSED.bindTo(contextKeyService);\r\n        this._findFocusTracker = this._register(dom.trackFocus(this._findInput.inputBox.inputElement));\r\n        this._register(this._findFocusTracker.onDidFocus(() => {\r\n            this._findInputFocused.set(true);\r\n            this._updateSearchScope();\r\n        }));\r\n        this._register(this._findFocusTracker.onDidBlur(() => {\r\n            this._findInputFocused.set(false);\r\n        }));\r\n        this._replaceInputFocused = CONTEXT_REPLACE_INPUT_FOCUSED.bindTo(contextKeyService);\r\n        this._replaceFocusTracker = this._register(dom.trackFocus(this._replaceInput.inputBox.inputElement));\r\n        this._register(this._replaceFocusTracker.onDidFocus(() => {\r\n            this._replaceInputFocused.set(true);\r\n            this._updateSearchScope();\r\n        }));\r\n        this._register(this._replaceFocusTracker.onDidBlur(() => {\r\n            this._replaceInputFocused.set(false);\r\n        }));\r\n        this._codeEditor.addOverlayWidget(this);\r\n        if (this._codeEditor.getOption(33 /* find */).addExtraSpaceOnTop) {\r\n            this._viewZone = new FindWidgetViewZone(0); // Put it before the first line then users can scroll beyond the first line.\r\n        }\r\n        this._applyTheme(themeService.getColorTheme());\r\n        this._register(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\r\n        this._register(this._codeEditor.onDidChangeModel(() => {\r\n            if (!this._isVisible) {\r\n                return;\r\n            }\r\n            this._viewZoneId = undefined;\r\n        }));\r\n        this._register(this._codeEditor.onDidScrollChange((e) => {\r\n            if (e.scrollTopChanged) {\r\n                this._layoutViewZone();\r\n                return;\r\n            }\r\n            // for other scroll changes, layout the viewzone in next tick to avoid ruining current rendering.\r\n            setTimeout(() => {\r\n                this._layoutViewZone();\r\n            }, 0);\r\n        }));\r\n    }\r\n    // ----- IOverlayWidget API\r\n    getId() {\r\n        return FindWidget.ID;\r\n    }\r\n    getDomNode() {\r\n        return this._domNode;\r\n    }\r\n    getPosition() {\r\n        if (this._isVisible) {\r\n            return {\r\n                preference: 0 /* TOP_RIGHT_CORNER */\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    // ----- React to state changes\r\n    _onStateChanged(e) {\r\n        if (e.searchString) {\r\n            try {\r\n                this._ignoreChangeEvent = true;\r\n                this._findInput.setValue(this._state.searchString);\r\n            }\r\n            finally {\r\n                this._ignoreChangeEvent = false;\r\n            }\r\n            this._updateButtons();\r\n        }\r\n        if (e.replaceString) {\r\n            this._replaceInput.inputBox.value = this._state.replaceString;\r\n        }\r\n        if (e.isRevealed) {\r\n            if (this._state.isRevealed) {\r\n                this._reveal();\r\n            }\r\n            else {\r\n                this._hide(true);\r\n            }\r\n        }\r\n        if (e.isReplaceRevealed) {\r\n            if (this._state.isReplaceRevealed) {\r\n                if (!this._codeEditor.getOption(79 /* readOnly */) && !this._isReplaceVisible) {\r\n                    this._isReplaceVisible = true;\r\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n                    this._updateButtons();\r\n                    this._replaceInput.inputBox.layout();\r\n                }\r\n            }\r\n            else {\r\n                if (this._isReplaceVisible) {\r\n                    this._isReplaceVisible = false;\r\n                    this._updateButtons();\r\n                }\r\n            }\r\n        }\r\n        if ((e.isRevealed || e.isReplaceRevealed) && (this._state.isRevealed || this._state.isReplaceRevealed)) {\r\n            if (this._tryUpdateHeight()) {\r\n                this._showViewZone();\r\n            }\r\n        }\r\n        if (e.isRegex) {\r\n            this._findInput.setRegex(this._state.isRegex);\r\n        }\r\n        if (e.wholeWord) {\r\n            this._findInput.setWholeWords(this._state.wholeWord);\r\n        }\r\n        if (e.matchCase) {\r\n            this._findInput.setCaseSensitive(this._state.matchCase);\r\n        }\r\n        if (e.preserveCase) {\r\n            this._replaceInput.setPreserveCase(this._state.preserveCase);\r\n        }\r\n        if (e.searchScope) {\r\n            if (this._state.searchScope) {\r\n                this._toggleSelectionFind.checked = true;\r\n            }\r\n            else {\r\n                this._toggleSelectionFind.checked = false;\r\n            }\r\n            this._updateToggleSelectionFindButton();\r\n        }\r\n        if (e.searchString || e.matchesCount || e.matchesPosition) {\r\n            let showRedOutline = (this._state.searchString.length > 0 && this._state.matchesCount === 0);\r\n            this._domNode.classList.toggle('no-results', showRedOutline);\r\n            this._updateMatchesCount();\r\n            this._updateButtons();\r\n        }\r\n        if (e.searchString || e.currentMatch) {\r\n            this._layoutViewZone();\r\n        }\r\n        if (e.updateHistory) {\r\n            this._delayedUpdateHistory();\r\n        }\r\n        if (e.loop) {\r\n            this._updateButtons();\r\n        }\r\n    }\r\n    _delayedUpdateHistory() {\r\n        this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(undefined, onUnexpectedError);\r\n    }\r\n    _updateHistory() {\r\n        if (this._state.searchString) {\r\n            this._findInput.inputBox.addToHistory();\r\n        }\r\n        if (this._state.replaceString) {\r\n            this._replaceInput.inputBox.addToHistory();\r\n        }\r\n    }\r\n    _updateMatchesCount() {\r\n        this._matchesCount.style.minWidth = MAX_MATCHES_COUNT_WIDTH + 'px';\r\n        if (this._state.matchesCount >= MATCHES_LIMIT) {\r\n            this._matchesCount.title = NLS_MATCHES_COUNT_LIMIT_TITLE;\r\n        }\r\n        else {\r\n            this._matchesCount.title = '';\r\n        }\r\n        // remove previous content\r\n        if (this._matchesCount.firstChild) {\r\n            this._matchesCount.removeChild(this._matchesCount.firstChild);\r\n        }\r\n        let label;\r\n        if (this._state.matchesCount > 0) {\r\n            let matchesCount = String(this._state.matchesCount);\r\n            if (this._state.matchesCount >= MATCHES_LIMIT) {\r\n                matchesCount += '+';\r\n            }\r\n            let matchesPosition = String(this._state.matchesPosition);\r\n            if (matchesPosition === '0') {\r\n                matchesPosition = '?';\r\n            }\r\n            label = strings.format(NLS_MATCHES_LOCATION, matchesPosition, matchesCount);\r\n        }\r\n        else {\r\n            label = NLS_NO_RESULTS;\r\n        }\r\n        this._matchesCount.appendChild(document.createTextNode(label));\r\n        alertFn(this._getAriaLabel(label, this._state.currentMatch, this._state.searchString));\r\n        MAX_MATCHES_COUNT_WIDTH = Math.max(MAX_MATCHES_COUNT_WIDTH, this._matchesCount.clientWidth);\r\n    }\r\n    // ----- actions\r\n    _getAriaLabel(label, currentMatch, searchString) {\r\n        if (label === NLS_NO_RESULTS) {\r\n            return searchString === ''\r\n                ? nls.localize('ariaSearchNoResultEmpty', \"{0} found\", label)\r\n                : nls.localize('ariaSearchNoResult', \"{0} found for '{1}'\", label, searchString);\r\n        }\r\n        if (currentMatch) {\r\n            const ariaLabel = nls.localize('ariaSearchNoResultWithLineNum', \"{0} found for '{1}', at {2}\", label, searchString, currentMatch.startLineNumber + ':' + currentMatch.startColumn);\r\n            const model = this._codeEditor.getModel();\r\n            if (model && (currentMatch.startLineNumber <= model.getLineCount()) && (currentMatch.startLineNumber >= 1)) {\r\n                const lineContent = model.getLineContent(currentMatch.startLineNumber);\r\n                return `${lineContent}, ${ariaLabel}`;\r\n            }\r\n            return ariaLabel;\r\n        }\r\n        return nls.localize('ariaSearchNoResultWithLineNumNoCurrentMatch', \"{0} found for '{1}'\", label, searchString);\r\n    }\r\n    /**\r\n     * If 'selection find' is ON we should not disable the button (its function is to cancel 'selection find').\r\n     * If 'selection find' is OFF we enable the button only if there is a selection.\r\n     */\r\n    _updateToggleSelectionFindButton() {\r\n        let selection = this._codeEditor.getSelection();\r\n        let isSelection = selection ? (selection.startLineNumber !== selection.endLineNumber || selection.startColumn !== selection.endColumn) : false;\r\n        let isChecked = this._toggleSelectionFind.checked;\r\n        if (this._isVisible && (isChecked || isSelection)) {\r\n            this._toggleSelectionFind.enable();\r\n        }\r\n        else {\r\n            this._toggleSelectionFind.disable();\r\n        }\r\n    }\r\n    _updateButtons() {\r\n        this._findInput.setEnabled(this._isVisible);\r\n        this._replaceInput.setEnabled(this._isVisible && this._isReplaceVisible);\r\n        this._updateToggleSelectionFindButton();\r\n        this._closeBtn.setEnabled(this._isVisible);\r\n        let findInputIsNonEmpty = (this._state.searchString.length > 0);\r\n        let matchesCount = this._state.matchesCount ? true : false;\r\n        this._prevBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount && this._state.canNavigateBack());\r\n        this._nextBtn.setEnabled(this._isVisible && findInputIsNonEmpty && matchesCount && this._state.canNavigateForward());\r\n        this._replaceBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\r\n        this._replaceAllBtn.setEnabled(this._isVisible && this._isReplaceVisible && findInputIsNonEmpty);\r\n        this._domNode.classList.toggle('replaceToggled', this._isReplaceVisible);\r\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\r\n        let canReplace = !this._codeEditor.getOption(79 /* readOnly */);\r\n        this._toggleReplaceBtn.setEnabled(this._isVisible && canReplace);\r\n    }\r\n    _reveal() {\r\n        this._revealTimeouts.forEach(e => {\r\n            clearTimeout(e);\r\n        });\r\n        this._revealTimeouts = [];\r\n        if (!this._isVisible) {\r\n            this._isVisible = true;\r\n            const selection = this._codeEditor.getSelection();\r\n            switch (this._codeEditor.getOption(33 /* find */).autoFindInSelection) {\r\n                case 'always':\r\n                    this._toggleSelectionFind.checked = true;\r\n                    break;\r\n                case 'never':\r\n                    this._toggleSelectionFind.checked = false;\r\n                    break;\r\n                case 'multiline':\r\n                    const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\r\n                    this._toggleSelectionFind.checked = isSelectionMultipleLine;\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            this._tryUpdateWidgetWidth();\r\n            this._updateButtons();\r\n            this._revealTimeouts.push(setTimeout(() => {\r\n                this._domNode.classList.add('visible');\r\n                this._domNode.setAttribute('aria-hidden', 'false');\r\n            }, 0));\r\n            // validate query again as it's being dismissed when we hide the find widget.\r\n            this._revealTimeouts.push(setTimeout(() => {\r\n                this._findInput.validate();\r\n            }, 200));\r\n            this._codeEditor.layoutOverlayWidget(this);\r\n            let adjustEditorScrollTop = true;\r\n            if (this._codeEditor.getOption(33 /* find */).seedSearchStringFromSelection && selection) {\r\n                const domNode = this._codeEditor.getDomNode();\r\n                if (domNode) {\r\n                    const editorCoords = dom.getDomNodePagePosition(domNode);\r\n                    const startCoords = this._codeEditor.getScrolledVisiblePosition(selection.getStartPosition());\r\n                    const startLeft = editorCoords.left + (startCoords ? startCoords.left : 0);\r\n                    const startTop = startCoords ? startCoords.top : 0;\r\n                    if (this._viewZone && startTop < this._viewZone.heightInPx) {\r\n                        if (selection.endLineNumber > selection.startLineNumber) {\r\n                            adjustEditorScrollTop = false;\r\n                        }\r\n                        const leftOfFindWidget = dom.getTopLeftOffset(this._domNode).left;\r\n                        if (startLeft > leftOfFindWidget) {\r\n                            adjustEditorScrollTop = false;\r\n                        }\r\n                        const endCoords = this._codeEditor.getScrolledVisiblePosition(selection.getEndPosition());\r\n                        const endLeft = editorCoords.left + (endCoords ? endCoords.left : 0);\r\n                        if (endLeft > leftOfFindWidget) {\r\n                            adjustEditorScrollTop = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._showViewZone(adjustEditorScrollTop);\r\n        }\r\n    }\r\n    _hide(focusTheEditor) {\r\n        this._revealTimeouts.forEach(e => {\r\n            clearTimeout(e);\r\n        });\r\n        this._revealTimeouts = [];\r\n        if (this._isVisible) {\r\n            this._isVisible = false;\r\n            this._updateButtons();\r\n            this._domNode.classList.remove('visible');\r\n            this._domNode.setAttribute('aria-hidden', 'true');\r\n            this._findInput.clearMessage();\r\n            if (focusTheEditor) {\r\n                this._codeEditor.focus();\r\n            }\r\n            this._codeEditor.layoutOverlayWidget(this);\r\n            this._removeViewZone();\r\n        }\r\n    }\r\n    _layoutViewZone(targetScrollTop) {\r\n        const addExtraSpaceOnTop = this._codeEditor.getOption(33 /* find */).addExtraSpaceOnTop;\r\n        if (!addExtraSpaceOnTop) {\r\n            this._removeViewZone();\r\n            return;\r\n        }\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        const viewZone = this._viewZone;\r\n        if (this._viewZoneId !== undefined || !viewZone) {\r\n            return;\r\n        }\r\n        this._codeEditor.changeViewZones((accessor) => {\r\n            viewZone.heightInPx = this._getHeight();\r\n            this._viewZoneId = accessor.addZone(viewZone);\r\n            // scroll top adjust to make sure the editor doesn't scroll when adding viewzone at the beginning.\r\n            this._codeEditor.setScrollTop(targetScrollTop || this._codeEditor.getScrollTop() + viewZone.heightInPx);\r\n        });\r\n    }\r\n    _showViewZone(adjustScroll = true) {\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        const addExtraSpaceOnTop = this._codeEditor.getOption(33 /* find */).addExtraSpaceOnTop;\r\n        if (!addExtraSpaceOnTop) {\r\n            return;\r\n        }\r\n        if (this._viewZone === undefined) {\r\n            this._viewZone = new FindWidgetViewZone(0);\r\n        }\r\n        const viewZone = this._viewZone;\r\n        this._codeEditor.changeViewZones((accessor) => {\r\n            if (this._viewZoneId !== undefined) {\r\n                // the view zone already exists, we need to update the height\r\n                const newHeight = this._getHeight();\r\n                if (newHeight === viewZone.heightInPx) {\r\n                    return;\r\n                }\r\n                let scrollAdjustment = newHeight - viewZone.heightInPx;\r\n                viewZone.heightInPx = newHeight;\r\n                accessor.layoutZone(this._viewZoneId);\r\n                if (adjustScroll) {\r\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + scrollAdjustment);\r\n                }\r\n                return;\r\n            }\r\n            else {\r\n                let scrollAdjustment = this._getHeight();\r\n                // if the editor has top padding, factor that into the zone height\r\n                scrollAdjustment -= this._codeEditor.getOption(73 /* padding */).top;\r\n                if (scrollAdjustment <= 0) {\r\n                    return;\r\n                }\r\n                viewZone.heightInPx = scrollAdjustment;\r\n                this._viewZoneId = accessor.addZone(viewZone);\r\n                if (adjustScroll) {\r\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() + scrollAdjustment);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    _removeViewZone() {\r\n        this._codeEditor.changeViewZones((accessor) => {\r\n            if (this._viewZoneId !== undefined) {\r\n                accessor.removeZone(this._viewZoneId);\r\n                this._viewZoneId = undefined;\r\n                if (this._viewZone) {\r\n                    this._codeEditor.setScrollTop(this._codeEditor.getScrollTop() - this._viewZone.heightInPx);\r\n                    this._viewZone = undefined;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    _applyTheme(theme) {\r\n        let inputStyles = {\r\n            inputActiveOptionBorder: theme.getColor(inputActiveOptionBorder),\r\n            inputActiveOptionBackground: theme.getColor(inputActiveOptionBackground),\r\n            inputActiveOptionForeground: theme.getColor(inputActiveOptionForeground),\r\n            inputBackground: theme.getColor(inputBackground),\r\n            inputForeground: theme.getColor(inputForeground),\r\n            inputBorder: theme.getColor(inputBorder),\r\n            inputValidationInfoBackground: theme.getColor(inputValidationInfoBackground),\r\n            inputValidationInfoForeground: theme.getColor(inputValidationInfoForeground),\r\n            inputValidationInfoBorder: theme.getColor(inputValidationInfoBorder),\r\n            inputValidationWarningBackground: theme.getColor(inputValidationWarningBackground),\r\n            inputValidationWarningForeground: theme.getColor(inputValidationWarningForeground),\r\n            inputValidationWarningBorder: theme.getColor(inputValidationWarningBorder),\r\n            inputValidationErrorBackground: theme.getColor(inputValidationErrorBackground),\r\n            inputValidationErrorForeground: theme.getColor(inputValidationErrorForeground),\r\n            inputValidationErrorBorder: theme.getColor(inputValidationErrorBorder),\r\n        };\r\n        this._findInput.style(inputStyles);\r\n        this._replaceInput.style(inputStyles);\r\n        this._toggleSelectionFind.style(inputStyles);\r\n    }\r\n    _tryUpdateWidgetWidth() {\r\n        if (!this._isVisible) {\r\n            return;\r\n        }\r\n        if (!dom.isInDOM(this._domNode)) {\r\n            // the widget is not in the DOM\r\n            return;\r\n        }\r\n        const layoutInfo = this._codeEditor.getLayoutInfo();\r\n        const editorContentWidth = layoutInfo.contentWidth;\r\n        if (editorContentWidth <= 0) {\r\n            // for example, diff view original editor\r\n            this._domNode.classList.add('hiddenEditor');\r\n            return;\r\n        }\r\n        else if (this._domNode.classList.contains('hiddenEditor')) {\r\n            this._domNode.classList.remove('hiddenEditor');\r\n        }\r\n        const editorWidth = layoutInfo.width;\r\n        const minimapWidth = layoutInfo.minimap.minimapWidth;\r\n        let collapsedFindWidget = false;\r\n        let reducedFindWidget = false;\r\n        let narrowFindWidget = false;\r\n        if (this._resized) {\r\n            let widgetWidth = dom.getTotalWidth(this._domNode);\r\n            if (widgetWidth > FIND_WIDGET_INITIAL_WIDTH) {\r\n                // as the widget is resized by users, we may need to change the max width of the widget as the editor width changes.\r\n                this._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\r\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n                return;\r\n            }\r\n        }\r\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth >= editorWidth) {\r\n            reducedFindWidget = true;\r\n        }\r\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth) {\r\n            narrowFindWidget = true;\r\n        }\r\n        if (FIND_WIDGET_INITIAL_WIDTH + 28 + minimapWidth - MAX_MATCHES_COUNT_WIDTH >= editorWidth + 50) {\r\n            collapsedFindWidget = true;\r\n        }\r\n        this._domNode.classList.toggle('collapsed-find-widget', collapsedFindWidget);\r\n        this._domNode.classList.toggle('narrow-find-widget', narrowFindWidget);\r\n        this._domNode.classList.toggle('reduced-find-widget', reducedFindWidget);\r\n        if (!narrowFindWidget && !collapsedFindWidget) {\r\n            // the minimal left offset of findwidget is 15px.\r\n            this._domNode.style.maxWidth = `${editorWidth - 28 - minimapWidth - 15}px`;\r\n        }\r\n        if (this._resized) {\r\n            this._findInput.inputBox.layout();\r\n            let findInputWidth = this._findInput.inputBox.element.clientWidth;\r\n            if (findInputWidth > 0) {\r\n                this._replaceInput.width = findInputWidth;\r\n            }\r\n        }\r\n        else if (this._isReplaceVisible) {\r\n            this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n        }\r\n    }\r\n    _getHeight() {\r\n        let totalheight = 0;\r\n        // find input margin top\r\n        totalheight += 4;\r\n        // find input height\r\n        totalheight += this._findInput.inputBox.height + 2 /** input box border */;\r\n        if (this._isReplaceVisible) {\r\n            // replace input margin\r\n            totalheight += 4;\r\n            totalheight += this._replaceInput.inputBox.height + 2 /** input box border */;\r\n        }\r\n        // margin bottom\r\n        totalheight += 4;\r\n        return totalheight;\r\n    }\r\n    _tryUpdateHeight() {\r\n        const totalHeight = this._getHeight();\r\n        if (this._cachedHeight !== null && this._cachedHeight === totalHeight) {\r\n            return false;\r\n        }\r\n        this._cachedHeight = totalHeight;\r\n        this._domNode.style.height = `${totalHeight}px`;\r\n        return true;\r\n    }\r\n    // ----- Public\r\n    focusFindInput() {\r\n        this._findInput.select();\r\n        // Edge browser requires focus() in addition to select()\r\n        this._findInput.focus();\r\n    }\r\n    focusReplaceInput() {\r\n        this._replaceInput.select();\r\n        // Edge browser requires focus() in addition to select()\r\n        this._replaceInput.focus();\r\n    }\r\n    highlightFindOptions() {\r\n        this._findInput.highlightFindOptions();\r\n    }\r\n    _updateSearchScope() {\r\n        if (!this._codeEditor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this._toggleSelectionFind.checked) {\r\n            let selections = this._codeEditor.getSelections();\r\n            selections.map(selection => {\r\n                if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\r\n                    selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\r\n                }\r\n                const currentMatch = this._state.currentMatch;\r\n                if (selection.startLineNumber !== selection.endLineNumber) {\r\n                    if (!Range.equalsRange(selection, currentMatch)) {\r\n                        return selection;\r\n                    }\r\n                }\r\n                return null;\r\n            }).filter(element => !!element);\r\n            if (selections.length) {\r\n                this._state.change({ searchScope: selections }, true);\r\n            }\r\n        }\r\n    }\r\n    _onFindInputMouseDown(e) {\r\n        // on linux, middle key does pasting.\r\n        if (e.middleButton) {\r\n            e.stopPropagation();\r\n        }\r\n    }\r\n    _onFindInputKeyDown(e) {\r\n        if (e.equals(ctrlKeyMod | 3 /* Enter */)) {\r\n            this._findInput.inputBox.insertAtCursor('\\n');\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2 /* Tab */)) {\r\n            if (this._isReplaceVisible) {\r\n                this._replaceInput.focus();\r\n            }\r\n            else {\r\n                this._findInput.focusOnCaseSensitive();\r\n            }\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2048 /* CtrlCmd */ | 18 /* DownArrow */)) {\r\n            this._codeEditor.focus();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(16 /* UpArrow */)) {\r\n            return stopPropagationForMultiLineUpwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\r\n        }\r\n        if (e.equals(18 /* DownArrow */)) {\r\n            return stopPropagationForMultiLineDownwards(e, this._findInput.getValue(), this._findInput.domNode.querySelector('textarea'));\r\n        }\r\n    }\r\n    _onReplaceInputKeyDown(e) {\r\n        if (e.equals(ctrlKeyMod | 3 /* Enter */)) {\r\n            if (platform.isWindows && platform.isNative && !this._ctrlEnterReplaceAllWarningPrompted) {\r\n                // this is the first time when users press Ctrl + Enter to replace all\r\n                this._notificationService.info(nls.localize('ctrlEnter.keybindingChanged', 'Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.'));\r\n                this._ctrlEnterReplaceAllWarningPrompted = true;\r\n                this._storageService.store(ctrlEnterReplaceAllWarningPromptedKey, true, 0 /* GLOBAL */, 0 /* USER */);\r\n            }\r\n            this._replaceInput.inputBox.insertAtCursor('\\n');\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2 /* Tab */)) {\r\n            this._findInput.focusOnCaseSensitive();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n            this._findInput.focus();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(2048 /* CtrlCmd */ | 18 /* DownArrow */)) {\r\n            this._codeEditor.focus();\r\n            e.preventDefault();\r\n            return;\r\n        }\r\n        if (e.equals(16 /* UpArrow */)) {\r\n            return stopPropagationForMultiLineUpwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\r\n        }\r\n        if (e.equals(18 /* DownArrow */)) {\r\n            return stopPropagationForMultiLineDownwards(e, this._replaceInput.inputBox.value, this._replaceInput.inputBox.element.querySelector('textarea'));\r\n        }\r\n    }\r\n    // ----- sash\r\n    getVerticalSashLeft(_sash) {\r\n        return 0;\r\n    }\r\n    // ----- initialization\r\n    _keybindingLabelFor(actionId) {\r\n        let kb = this._keybindingService.lookupKeybinding(actionId);\r\n        if (!kb) {\r\n            return '';\r\n        }\r\n        return ` (${kb.getLabel()})`;\r\n    }\r\n    _buildDomNode() {\r\n        const flexibleHeight = true;\r\n        const flexibleWidth = true;\r\n        // Find input\r\n        this._findInput = this._register(new ContextScopedFindInput(null, this._contextViewProvider, {\r\n            width: FIND_INPUT_AREA_WIDTH,\r\n            label: NLS_FIND_INPUT_LABEL,\r\n            placeholder: NLS_FIND_INPUT_PLACEHOLDER,\r\n            appendCaseSensitiveLabel: this._keybindingLabelFor(FIND_IDS.ToggleCaseSensitiveCommand),\r\n            appendWholeWordsLabel: this._keybindingLabelFor(FIND_IDS.ToggleWholeWordCommand),\r\n            appendRegexLabel: this._keybindingLabelFor(FIND_IDS.ToggleRegexCommand),\r\n            validation: (value) => {\r\n                if (value.length === 0 || !this._findInput.getRegex()) {\r\n                    return null;\r\n                }\r\n                try {\r\n                    // use `g` and `u` which are also used by the TextModel search\r\n                    new RegExp(value, 'gu');\r\n                    return null;\r\n                }\r\n                catch (e) {\r\n                    return { content: e.message };\r\n                }\r\n            },\r\n            flexibleHeight,\r\n            flexibleWidth,\r\n            flexibleMaxHeight: 118\r\n        }, this._contextKeyService, true));\r\n        this._findInput.setRegex(!!this._state.isRegex);\r\n        this._findInput.setCaseSensitive(!!this._state.matchCase);\r\n        this._findInput.setWholeWords(!!this._state.wholeWord);\r\n        this._register(this._findInput.onKeyDown((e) => this._onFindInputKeyDown(e)));\r\n        this._register(this._findInput.inputBox.onDidChange(() => {\r\n            if (this._ignoreChangeEvent) {\r\n                return;\r\n            }\r\n            this._state.change({ searchString: this._findInput.getValue() }, true);\r\n        }));\r\n        this._register(this._findInput.onDidOptionChange(() => {\r\n            this._state.change({\r\n                isRegex: this._findInput.getRegex(),\r\n                wholeWord: this._findInput.getWholeWords(),\r\n                matchCase: this._findInput.getCaseSensitive()\r\n            }, true);\r\n        }));\r\n        this._register(this._findInput.onCaseSensitiveKeyDown((e) => {\r\n            if (e.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n                if (this._isReplaceVisible) {\r\n                    this._replaceInput.focus();\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        }));\r\n        this._register(this._findInput.onRegexKeyDown((e) => {\r\n            if (e.equals(2 /* Tab */)) {\r\n                if (this._isReplaceVisible) {\r\n                    this._replaceInput.focusOnPreserve();\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        }));\r\n        this._register(this._findInput.inputBox.onDidHeightChange((e) => {\r\n            if (this._tryUpdateHeight()) {\r\n                this._showViewZone();\r\n            }\r\n        }));\r\n        if (platform.isLinux) {\r\n            this._register(this._findInput.onMouseDown((e) => this._onFindInputMouseDown(e)));\r\n        }\r\n        this._matchesCount = document.createElement('div');\r\n        this._matchesCount.className = 'matchesCount';\r\n        this._updateMatchesCount();\r\n        // Previous button\r\n        this._prevBtn = this._register(new SimpleButton({\r\n            label: NLS_PREVIOUS_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.PreviousMatchFindAction),\r\n            icon: findPreviousMatchIcon,\r\n            onTrigger: () => {\r\n                this._codeEditor.getAction(FIND_IDS.PreviousMatchFindAction).run().then(undefined, onUnexpectedError);\r\n            }\r\n        }));\r\n        // Next button\r\n        this._nextBtn = this._register(new SimpleButton({\r\n            label: NLS_NEXT_MATCH_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.NextMatchFindAction),\r\n            icon: findNextMatchIcon,\r\n            onTrigger: () => {\r\n                this._codeEditor.getAction(FIND_IDS.NextMatchFindAction).run().then(undefined, onUnexpectedError);\r\n            }\r\n        }));\r\n        let findPart = document.createElement('div');\r\n        findPart.className = 'find-part';\r\n        findPart.appendChild(this._findInput.domNode);\r\n        const actionsContainer = document.createElement('div');\r\n        actionsContainer.className = 'find-actions';\r\n        findPart.appendChild(actionsContainer);\r\n        actionsContainer.appendChild(this._matchesCount);\r\n        actionsContainer.appendChild(this._prevBtn.domNode);\r\n        actionsContainer.appendChild(this._nextBtn.domNode);\r\n        // Toggle selection button\r\n        this._toggleSelectionFind = this._register(new Checkbox({\r\n            icon: findSelectionIcon,\r\n            title: NLS_TOGGLE_SELECTION_FIND_TITLE + this._keybindingLabelFor(FIND_IDS.ToggleSearchScopeCommand),\r\n            isChecked: false\r\n        }));\r\n        this._register(this._toggleSelectionFind.onChange(() => {\r\n            if (this._toggleSelectionFind.checked) {\r\n                if (this._codeEditor.hasModel()) {\r\n                    let selections = this._codeEditor.getSelections();\r\n                    selections.map(selection => {\r\n                        if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\r\n                            selection = selection.setEndPosition(selection.endLineNumber - 1, this._codeEditor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\r\n                        }\r\n                        if (!selection.isEmpty()) {\r\n                            return selection;\r\n                        }\r\n                        return null;\r\n                    }).filter(element => !!element);\r\n                    if (selections.length) {\r\n                        this._state.change({ searchScope: selections }, true);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                this._state.change({ searchScope: null }, true);\r\n            }\r\n        }));\r\n        actionsContainer.appendChild(this._toggleSelectionFind.domNode);\r\n        // Close button\r\n        this._closeBtn = this._register(new SimpleButton({\r\n            label: NLS_CLOSE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.CloseFindWidgetCommand),\r\n            icon: widgetClose,\r\n            onTrigger: () => {\r\n                this._state.change({ isRevealed: false, searchScope: null }, false);\r\n            },\r\n            onKeyDown: (e) => {\r\n                if (e.equals(2 /* Tab */)) {\r\n                    if (this._isReplaceVisible) {\r\n                        if (this._replaceBtn.isEnabled()) {\r\n                            this._replaceBtn.focus();\r\n                        }\r\n                        else {\r\n                            this._codeEditor.focus();\r\n                        }\r\n                        e.preventDefault();\r\n                    }\r\n                }\r\n            }\r\n        }));\r\n        actionsContainer.appendChild(this._closeBtn.domNode);\r\n        // Replace input\r\n        this._replaceInput = this._register(new ContextScopedReplaceInput(null, undefined, {\r\n            label: NLS_REPLACE_INPUT_LABEL,\r\n            placeholder: NLS_REPLACE_INPUT_PLACEHOLDER,\r\n            appendPreserveCaseLabel: this._keybindingLabelFor(FIND_IDS.TogglePreserveCaseCommand),\r\n            history: [],\r\n            flexibleHeight,\r\n            flexibleWidth,\r\n            flexibleMaxHeight: 118\r\n        }, this._contextKeyService, true));\r\n        this._replaceInput.setPreserveCase(!!this._state.preserveCase);\r\n        this._register(this._replaceInput.onKeyDown((e) => this._onReplaceInputKeyDown(e)));\r\n        this._register(this._replaceInput.inputBox.onDidChange(() => {\r\n            this._state.change({ replaceString: this._replaceInput.inputBox.value }, false);\r\n        }));\r\n        this._register(this._replaceInput.inputBox.onDidHeightChange((e) => {\r\n            if (this._isReplaceVisible && this._tryUpdateHeight()) {\r\n                this._showViewZone();\r\n            }\r\n        }));\r\n        this._register(this._replaceInput.onDidOptionChange(() => {\r\n            this._state.change({\r\n                preserveCase: this._replaceInput.getPreserveCase()\r\n            }, true);\r\n        }));\r\n        this._register(this._replaceInput.onPreserveCaseKeyDown((e) => {\r\n            if (e.equals(2 /* Tab */)) {\r\n                if (this._prevBtn.isEnabled()) {\r\n                    this._prevBtn.focus();\r\n                }\r\n                else if (this._nextBtn.isEnabled()) {\r\n                    this._nextBtn.focus();\r\n                }\r\n                else if (this._toggleSelectionFind.enabled) {\r\n                    this._toggleSelectionFind.focus();\r\n                }\r\n                else if (this._closeBtn.isEnabled()) {\r\n                    this._closeBtn.focus();\r\n                }\r\n                e.preventDefault();\r\n            }\r\n        }));\r\n        // Replace one button\r\n        this._replaceBtn = this._register(new SimpleButton({\r\n            label: NLS_REPLACE_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceOneAction),\r\n            icon: findReplaceIcon,\r\n            onTrigger: () => {\r\n                this._controller.replace();\r\n            },\r\n            onKeyDown: (e) => {\r\n                if (e.equals(1024 /* Shift */ | 2 /* Tab */)) {\r\n                    this._closeBtn.focus();\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        }));\r\n        // Replace all button\r\n        this._replaceAllBtn = this._register(new SimpleButton({\r\n            label: NLS_REPLACE_ALL_BTN_LABEL + this._keybindingLabelFor(FIND_IDS.ReplaceAllAction),\r\n            icon: findReplaceAllIcon,\r\n            onTrigger: () => {\r\n                this._controller.replaceAll();\r\n            }\r\n        }));\r\n        let replacePart = document.createElement('div');\r\n        replacePart.className = 'replace-part';\r\n        replacePart.appendChild(this._replaceInput.domNode);\r\n        const replaceActionsContainer = document.createElement('div');\r\n        replaceActionsContainer.className = 'replace-actions';\r\n        replacePart.appendChild(replaceActionsContainer);\r\n        replaceActionsContainer.appendChild(this._replaceBtn.domNode);\r\n        replaceActionsContainer.appendChild(this._replaceAllBtn.domNode);\r\n        // Toggle replace button\r\n        this._toggleReplaceBtn = this._register(new SimpleButton({\r\n            label: NLS_TOGGLE_REPLACE_MODE_BTN_LABEL,\r\n            className: 'codicon toggle left',\r\n            onTrigger: () => {\r\n                this._state.change({ isReplaceRevealed: !this._isReplaceVisible }, false);\r\n                if (this._isReplaceVisible) {\r\n                    this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n                    this._replaceInput.inputBox.layout();\r\n                }\r\n                this._showViewZone();\r\n            }\r\n        }));\r\n        this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);\r\n        // Widget\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.className = 'editor-widget find-widget';\r\n        this._domNode.setAttribute('aria-hidden', 'true');\r\n        // We need to set this explicitly, otherwise on IE11, the width inheritence of flex doesn't work.\r\n        this._domNode.style.width = `${FIND_WIDGET_INITIAL_WIDTH}px`;\r\n        this._domNode.appendChild(this._toggleReplaceBtn.domNode);\r\n        this._domNode.appendChild(findPart);\r\n        this._domNode.appendChild(replacePart);\r\n        this._resizeSash = new Sash(this._domNode, this, { orientation: 0 /* VERTICAL */, size: 2 });\r\n        this._resized = false;\r\n        let originalWidth = FIND_WIDGET_INITIAL_WIDTH;\r\n        this._register(this._resizeSash.onDidStart(() => {\r\n            originalWidth = dom.getTotalWidth(this._domNode);\r\n        }));\r\n        this._register(this._resizeSash.onDidChange((evt) => {\r\n            this._resized = true;\r\n            let width = originalWidth + evt.startX - evt.currentX;\r\n            if (width < FIND_WIDGET_INITIAL_WIDTH) {\r\n                // narrow down the find widget should be handled by CSS.\r\n                return;\r\n            }\r\n            const maxWidth = parseFloat(dom.getComputedStyle(this._domNode).maxWidth) || 0;\r\n            if (width > maxWidth) {\r\n                return;\r\n            }\r\n            this._domNode.style.width = `${width}px`;\r\n            if (this._isReplaceVisible) {\r\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n            }\r\n            this._findInput.inputBox.layout();\r\n            this._tryUpdateHeight();\r\n        }));\r\n        this._register(this._resizeSash.onDidReset(() => {\r\n            // users double click on the sash\r\n            const currentWidth = dom.getTotalWidth(this._domNode);\r\n            if (currentWidth < FIND_WIDGET_INITIAL_WIDTH) {\r\n                // The editor is narrow and the width of the find widget is controlled fully by CSS.\r\n                return;\r\n            }\r\n            let width = FIND_WIDGET_INITIAL_WIDTH;\r\n            if (!this._resized || currentWidth === FIND_WIDGET_INITIAL_WIDTH) {\r\n                // 1. never resized before, double click should maximizes it\r\n                // 2. users resized it already but its width is the same as default\r\n                const layoutInfo = this._codeEditor.getLayoutInfo();\r\n                width = layoutInfo.width - 28 - layoutInfo.minimap.minimapWidth - 15;\r\n                this._resized = true;\r\n            }\r\n            else {\r\n                /**\r\n                 * no op, the find widget should be shrinked to its default size.\r\n                 */\r\n            }\r\n            this._domNode.style.width = `${width}px`;\r\n            if (this._isReplaceVisible) {\r\n                this._replaceInput.width = dom.getTotalWidth(this._findInput.domNode);\r\n            }\r\n            this._findInput.inputBox.layout();\r\n        }));\r\n    }\r\n    updateAccessibilitySupport() {\r\n        const value = this._codeEditor.getOption(2 /* accessibilitySupport */);\r\n        this._findInput.setFocusInputOnOptionClick(value !== 2 /* Enabled */);\r\n    }\r\n}\r\nFindWidget.ID = 'editor.contrib.findWidget';\r\nexport class SimpleButton extends Widget {\r\n    constructor(opts) {\r\n        super();\r\n        this._opts = opts;\r\n        let className = 'button';\r\n        if (this._opts.className) {\r\n            className = className + ' ' + this._opts.className;\r\n        }\r\n        if (this._opts.icon) {\r\n            className = className + ' ' + ThemeIcon.asClassName(this._opts.icon);\r\n        }\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.title = this._opts.label;\r\n        this._domNode.tabIndex = 0;\r\n        this._domNode.className = className;\r\n        this._domNode.setAttribute('role', 'button');\r\n        this._domNode.setAttribute('aria-label', this._opts.label);\r\n        this.onclick(this._domNode, (e) => {\r\n            this._opts.onTrigger();\r\n            e.preventDefault();\r\n        });\r\n        this.onkeydown(this._domNode, (e) => {\r\n            if (e.equals(10 /* Space */) || e.equals(3 /* Enter */)) {\r\n                this._opts.onTrigger();\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n            if (this._opts.onKeyDown) {\r\n                this._opts.onKeyDown(e);\r\n            }\r\n        });\r\n    }\r\n    get domNode() {\r\n        return this._domNode;\r\n    }\r\n    isEnabled() {\r\n        return (this._domNode.tabIndex >= 0);\r\n    }\r\n    focus() {\r\n        this._domNode.focus();\r\n    }\r\n    setEnabled(enabled) {\r\n        this._domNode.classList.toggle('disabled', !enabled);\r\n        this._domNode.setAttribute('aria-disabled', String(!enabled));\r\n        this._domNode.tabIndex = enabled ? 0 : -1;\r\n    }\r\n    setExpanded(expanded) {\r\n        this._domNode.setAttribute('aria-expanded', String(!!expanded));\r\n        if (expanded) {\r\n            this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findCollapsedIcon));\r\n            this._domNode.classList.add(...ThemeIcon.asClassNameArray(findExpandedIcon));\r\n        }\r\n        else {\r\n            this._domNode.classList.remove(...ThemeIcon.asClassNameArray(findExpandedIcon));\r\n            this._domNode.classList.add(...ThemeIcon.asClassNameArray(findCollapsedIcon));\r\n        }\r\n    }\r\n}\r\n// theming\r\nregisterThemingParticipant((theme, collector) => {\r\n    const addBackgroundColorRule = (selector, color) => {\r\n        if (color) {\r\n            collector.addRule(`.monaco-editor ${selector} { background-color: ${color}; }`);\r\n        }\r\n    };\r\n    addBackgroundColorRule('.findMatch', theme.getColor(editorFindMatchHighlight));\r\n    addBackgroundColorRule('.currentFindMatch', theme.getColor(editorFindMatch));\r\n    addBackgroundColorRule('.findScope', theme.getColor(editorFindRangeHighlight));\r\n    const widgetBackground = theme.getColor(editorWidgetBackground);\r\n    addBackgroundColorRule('.find-widget', widgetBackground);\r\n    const widgetShadowColor = theme.getColor(widgetShadow);\r\n    if (widgetShadowColor) {\r\n        collector.addRule(`.monaco-editor .find-widget { box-shadow: 0 0 8px 2px ${widgetShadowColor}; }`);\r\n    }\r\n    const findMatchHighlightBorder = theme.getColor(editorFindMatchHighlightBorder);\r\n    if (findMatchHighlightBorder) {\r\n        collector.addRule(`.monaco-editor .findMatch { border: 1px ${theme.type === 'hc' ? 'dotted' : 'solid'} ${findMatchHighlightBorder}; box-sizing: border-box; }`);\r\n    }\r\n    const findMatchBorder = theme.getColor(editorFindMatchBorder);\r\n    if (findMatchBorder) {\r\n        collector.addRule(`.monaco-editor .currentFindMatch { border: 2px solid ${findMatchBorder}; padding: 1px; box-sizing: border-box; }`);\r\n    }\r\n    const findRangeHighlightBorder = theme.getColor(editorFindRangeHighlightBorder);\r\n    if (findRangeHighlightBorder) {\r\n        collector.addRule(`.monaco-editor .findScope { border: 1px ${theme.type === 'hc' ? 'dashed' : 'solid'} ${findRangeHighlightBorder}; }`);\r\n    }\r\n    const hcBorder = theme.getColor(contrastBorder);\r\n    if (hcBorder) {\r\n        collector.addRule(`.monaco-editor .find-widget { border: 1px solid ${hcBorder}; }`);\r\n    }\r\n    const foreground = theme.getColor(editorWidgetForeground);\r\n    if (foreground) {\r\n        collector.addRule(`.monaco-editor .find-widget { color: ${foreground}; }`);\r\n    }\r\n    const error = theme.getColor(errorForeground);\r\n    if (error) {\r\n        collector.addRule(`.monaco-editor .find-widget.no-results .matchesCount { color: ${error}; }`);\r\n    }\r\n    const resizeBorderBackground = theme.getColor(editorWidgetResizeBorder);\r\n    if (resizeBorderBackground) {\r\n        collector.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${resizeBorderBackground}; }`);\r\n    }\r\n    else {\r\n        const border = theme.getColor(editorWidgetBorder);\r\n        if (border) {\r\n            collector.addRule(`.monaco-editor .find-widget .monaco-sash { background-color: ${border}; }`);\r\n        }\r\n    }\r\n    // This rule is used to override the outline color for synthetic-focus find input.\r\n    const focusOutline = theme.getColor(focusBorder);\r\n    if (focusOutline) {\r\n        collector.addRule(`.monaco-editor .find-widget .monaco-inputbox.synthetic-focus { outline-color: ${focusOutline}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Delayer } from '../../../base/common/async.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, MultiEditorAction, registerMultiEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_FIND_WIDGET_VISIBLE, FIND_IDS, FindModelBoundToEditorModel, ToggleCaseSensitiveKeybinding, TogglePreserveCaseKeybinding, ToggleRegexKeybinding, ToggleSearchScopeKeybinding, ToggleWholeWordKeybinding, CONTEXT_REPLACE_INPUT_FOCUSED } from './findModel.js';\r\nimport { FindOptionsWidget } from './findOptionsWidget.js';\r\nimport { FindReplaceState } from './findState.js';\r\nimport { FindWidget } from './findWidget.js';\r\nimport { MenuId } from '../../../platform/actions/common/actions.js';\r\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\r\nimport { IContextKeyService, ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IContextViewService } from '../../../platform/contextview/browser/contextView.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { IStorageService } from '../../../platform/storage/common/storage.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nconst SEARCH_STRING_MAX_LENGTH = 524288;\r\nexport function getSelectionSearchString(editor, seedSearchStringFromSelection = 'single', seedSearchStringFromNonEmptySelection = false) {\r\n    if (!editor.hasModel()) {\r\n        return null;\r\n    }\r\n    const selection = editor.getSelection();\r\n    // if selection spans multiple lines, default search string to empty\r\n    if ((seedSearchStringFromSelection === 'single' && selection.startLineNumber === selection.endLineNumber)\r\n        || seedSearchStringFromSelection === 'multiple') {\r\n        if (selection.isEmpty()) {\r\n            const wordAtPosition = editor.getConfiguredWordAtPosition(selection.getStartPosition());\r\n            if (wordAtPosition && (false === seedSearchStringFromNonEmptySelection)) {\r\n                return wordAtPosition.word;\r\n            }\r\n        }\r\n        else {\r\n            if (editor.getModel().getValueLengthInRange(selection) < SEARCH_STRING_MAX_LENGTH) {\r\n                return editor.getModel().getValueInRange(selection);\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\nlet CommonFindController = class CommonFindController extends Disposable {\r\n    constructor(editor, contextKeyService, storageService, clipboardService) {\r\n        super();\r\n        this._editor = editor;\r\n        this._findWidgetVisible = CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService);\r\n        this._contextKeyService = contextKeyService;\r\n        this._storageService = storageService;\r\n        this._clipboardService = clipboardService;\r\n        this._updateHistoryDelayer = new Delayer(500);\r\n        this._state = this._register(new FindReplaceState());\r\n        this.loadQueryState();\r\n        this._register(this._state.onFindReplaceStateChange((e) => this._onStateChanged(e)));\r\n        this._model = null;\r\n        this._register(this._editor.onDidChangeModel(() => {\r\n            let shouldRestartFind = (this._editor.getModel() && this._state.isRevealed);\r\n            this.disposeModel();\r\n            this._state.change({\r\n                searchScope: null,\r\n                matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* WORKSPACE */, false),\r\n                wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* WORKSPACE */, false),\r\n                isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* WORKSPACE */, false),\r\n                preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* WORKSPACE */, false)\r\n            }, false);\r\n            if (shouldRestartFind) {\r\n                this._start({\r\n                    forceRevealReplace: false,\r\n                    seedSearchStringFromSelection: 'none',\r\n                    seedSearchStringFromNonEmptySelection: false,\r\n                    seedSearchStringFromGlobalClipboard: false,\r\n                    shouldFocus: 0 /* NoFocusChange */,\r\n                    shouldAnimate: false,\r\n                    updateSearchScope: false,\r\n                    loop: this._editor.getOption(33 /* find */).loop\r\n                });\r\n            }\r\n        }));\r\n    }\r\n    get editor() {\r\n        return this._editor;\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(CommonFindController.ID);\r\n    }\r\n    dispose() {\r\n        this.disposeModel();\r\n        super.dispose();\r\n    }\r\n    disposeModel() {\r\n        if (this._model) {\r\n            this._model.dispose();\r\n            this._model = null;\r\n        }\r\n    }\r\n    _onStateChanged(e) {\r\n        this.saveQueryState(e);\r\n        if (e.isRevealed) {\r\n            if (this._state.isRevealed) {\r\n                this._findWidgetVisible.set(true);\r\n            }\r\n            else {\r\n                this._findWidgetVisible.reset();\r\n                this.disposeModel();\r\n            }\r\n        }\r\n        if (e.searchString) {\r\n            this.setGlobalBufferTerm(this._state.searchString);\r\n        }\r\n    }\r\n    saveQueryState(e) {\r\n        if (e.isRegex) {\r\n            this._storageService.store('editor.isRegex', this._state.actualIsRegex, 1 /* WORKSPACE */, 0 /* USER */);\r\n        }\r\n        if (e.wholeWord) {\r\n            this._storageService.store('editor.wholeWord', this._state.actualWholeWord, 1 /* WORKSPACE */, 0 /* USER */);\r\n        }\r\n        if (e.matchCase) {\r\n            this._storageService.store('editor.matchCase', this._state.actualMatchCase, 1 /* WORKSPACE */, 0 /* USER */);\r\n        }\r\n        if (e.preserveCase) {\r\n            this._storageService.store('editor.preserveCase', this._state.actualPreserveCase, 1 /* WORKSPACE */, 0 /* USER */);\r\n        }\r\n    }\r\n    loadQueryState() {\r\n        this._state.change({\r\n            matchCase: this._storageService.getBoolean('editor.matchCase', 1 /* WORKSPACE */, this._state.matchCase),\r\n            wholeWord: this._storageService.getBoolean('editor.wholeWord', 1 /* WORKSPACE */, this._state.wholeWord),\r\n            isRegex: this._storageService.getBoolean('editor.isRegex', 1 /* WORKSPACE */, this._state.isRegex),\r\n            preserveCase: this._storageService.getBoolean('editor.preserveCase', 1 /* WORKSPACE */, this._state.preserveCase)\r\n        }, false);\r\n    }\r\n    isFindInputFocused() {\r\n        return !!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService);\r\n    }\r\n    getState() {\r\n        return this._state;\r\n    }\r\n    closeFindWidget() {\r\n        this._state.change({\r\n            isRevealed: false,\r\n            searchScope: null\r\n        }, false);\r\n        this._editor.focus();\r\n    }\r\n    toggleCaseSensitive() {\r\n        this._state.change({ matchCase: !this._state.matchCase }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    }\r\n    toggleWholeWords() {\r\n        this._state.change({ wholeWord: !this._state.wholeWord }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    }\r\n    toggleRegex() {\r\n        this._state.change({ isRegex: !this._state.isRegex }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    }\r\n    togglePreserveCase() {\r\n        this._state.change({ preserveCase: !this._state.preserveCase }, false);\r\n        if (!this._state.isRevealed) {\r\n            this.highlightFindOptions();\r\n        }\r\n    }\r\n    toggleSearchScope() {\r\n        if (this._state.searchScope) {\r\n            this._state.change({ searchScope: null }, true);\r\n        }\r\n        else {\r\n            if (this._editor.hasModel()) {\r\n                let selections = this._editor.getSelections();\r\n                selections.map(selection => {\r\n                    if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\r\n                        selection = selection.setEndPosition(selection.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\r\n                    }\r\n                    if (!selection.isEmpty()) {\r\n                        return selection;\r\n                    }\r\n                    return null;\r\n                }).filter(element => !!element);\r\n                if (selections.length) {\r\n                    this._state.change({ searchScope: selections }, true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    setSearchString(searchString) {\r\n        if (this._state.isRegex) {\r\n            searchString = strings.escapeRegExpCharacters(searchString);\r\n        }\r\n        this._state.change({ searchString: searchString }, false);\r\n    }\r\n    highlightFindOptions(ignoreWhenVisible = false) {\r\n        // overwritten in subclass\r\n    }\r\n    _start(opts) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this.disposeModel();\r\n            if (!this._editor.hasModel()) {\r\n                // cannot do anything with an editor that doesn't have a model...\r\n                return;\r\n            }\r\n            let stateChanges = {\r\n                isRevealed: true\r\n            };\r\n            if (opts.seedSearchStringFromSelection === 'single') {\r\n                let selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection, opts.seedSearchStringFromNonEmptySelection);\r\n                if (selectionSearchString) {\r\n                    if (this._state.isRegex) {\r\n                        stateChanges.searchString = strings.escapeRegExpCharacters(selectionSearchString);\r\n                    }\r\n                    else {\r\n                        stateChanges.searchString = selectionSearchString;\r\n                    }\r\n                }\r\n            }\r\n            else if (opts.seedSearchStringFromSelection === 'multiple' && !opts.updateSearchScope) {\r\n                let selectionSearchString = getSelectionSearchString(this._editor, opts.seedSearchStringFromSelection);\r\n                if (selectionSearchString) {\r\n                    stateChanges.searchString = selectionSearchString;\r\n                }\r\n            }\r\n            if (!stateChanges.searchString && opts.seedSearchStringFromGlobalClipboard) {\r\n                let selectionSearchString = yield this.getGlobalBufferTerm();\r\n                if (!this._editor.hasModel()) {\r\n                    // the editor has lost its model in the meantime\r\n                    return;\r\n                }\r\n                if (selectionSearchString) {\r\n                    stateChanges.searchString = selectionSearchString;\r\n                }\r\n            }\r\n            // Overwrite isReplaceRevealed\r\n            if (opts.forceRevealReplace) {\r\n                stateChanges.isReplaceRevealed = true;\r\n            }\r\n            else if (!this._findWidgetVisible.get()) {\r\n                stateChanges.isReplaceRevealed = false;\r\n            }\r\n            if (opts.updateSearchScope) {\r\n                let currentSelections = this._editor.getSelections();\r\n                if (currentSelections.some(selection => !selection.isEmpty())) {\r\n                    stateChanges.searchScope = currentSelections;\r\n                }\r\n            }\r\n            stateChanges.loop = opts.loop;\r\n            this._state.change(stateChanges, false);\r\n            if (!this._model) {\r\n                this._model = new FindModelBoundToEditorModel(this._editor, this._state);\r\n            }\r\n        });\r\n    }\r\n    start(opts) {\r\n        return this._start(opts);\r\n    }\r\n    moveToNextMatch() {\r\n        if (this._model) {\r\n            this._model.moveToNextMatch();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    moveToPrevMatch() {\r\n        if (this._model) {\r\n            this._model.moveToPrevMatch();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    replace() {\r\n        if (this._model) {\r\n            this._model.replace();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    replaceAll() {\r\n        if (this._model) {\r\n            this._model.replaceAll();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    selectAllMatches() {\r\n        if (this._model) {\r\n            this._model.selectAllMatches();\r\n            this._editor.focus();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    getGlobalBufferTerm() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this._editor.getOption(33 /* find */).globalFindClipboard\r\n                && this._editor.hasModel()\r\n                && !this._editor.getModel().isTooLargeForSyncing()) {\r\n                return this._clipboardService.readFindText();\r\n            }\r\n            return '';\r\n        });\r\n    }\r\n    setGlobalBufferTerm(text) {\r\n        if (this._editor.getOption(33 /* find */).globalFindClipboard\r\n            && this._editor.hasModel()\r\n            && !this._editor.getModel().isTooLargeForSyncing()) {\r\n            // intentionally not awaited\r\n            this._clipboardService.writeFindText(text);\r\n        }\r\n    }\r\n};\r\nCommonFindController.ID = 'editor.contrib.findController';\r\nCommonFindController = __decorate([\r\n    __param(1, IContextKeyService),\r\n    __param(2, IStorageService),\r\n    __param(3, IClipboardService)\r\n], CommonFindController);\r\nexport { CommonFindController };\r\nlet FindController = class FindController extends CommonFindController {\r\n    constructor(editor, _contextViewService, _contextKeyService, _keybindingService, _themeService, _notificationService, _storageService, clipboardService) {\r\n        super(editor, _contextKeyService, _storageService, clipboardService);\r\n        this._contextViewService = _contextViewService;\r\n        this._keybindingService = _keybindingService;\r\n        this._themeService = _themeService;\r\n        this._notificationService = _notificationService;\r\n        this._widget = null;\r\n        this._findOptionsWidget = null;\r\n    }\r\n    _start(opts) {\r\n        const _super = Object.create(null, {\r\n            _start: { get: () => super._start }\r\n        });\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this._widget) {\r\n                this._createFindWidget();\r\n            }\r\n            const selection = this._editor.getSelection();\r\n            let updateSearchScope = false;\r\n            switch (this._editor.getOption(33 /* find */).autoFindInSelection) {\r\n                case 'always':\r\n                    updateSearchScope = true;\r\n                    break;\r\n                case 'never':\r\n                    updateSearchScope = false;\r\n                    break;\r\n                case 'multiline':\r\n                    const isSelectionMultipleLine = !!selection && selection.startLineNumber !== selection.endLineNumber;\r\n                    updateSearchScope = isSelectionMultipleLine;\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            opts.updateSearchScope = updateSearchScope;\r\n            yield _super._start.call(this, opts);\r\n            if (this._widget) {\r\n                if (opts.shouldFocus === 2 /* FocusReplaceInput */) {\r\n                    this._widget.focusReplaceInput();\r\n                }\r\n                else if (opts.shouldFocus === 1 /* FocusFindInput */) {\r\n                    this._widget.focusFindInput();\r\n                }\r\n            }\r\n        });\r\n    }\r\n    highlightFindOptions(ignoreWhenVisible = false) {\r\n        if (!this._widget) {\r\n            this._createFindWidget();\r\n        }\r\n        if (this._state.isRevealed && !ignoreWhenVisible) {\r\n            this._widget.highlightFindOptions();\r\n        }\r\n        else {\r\n            this._findOptionsWidget.highlightFindOptions();\r\n        }\r\n    }\r\n    _createFindWidget() {\r\n        this._widget = this._register(new FindWidget(this._editor, this, this._state, this._contextViewService, this._keybindingService, this._contextKeyService, this._themeService, this._storageService, this._notificationService));\r\n        this._findOptionsWidget = this._register(new FindOptionsWidget(this._editor, this._state, this._keybindingService, this._themeService));\r\n    }\r\n};\r\nFindController = __decorate([\r\n    __param(1, IContextViewService),\r\n    __param(2, IContextKeyService),\r\n    __param(3, IKeybindingService),\r\n    __param(4, IThemeService),\r\n    __param(5, INotificationService),\r\n    __param(6, IStorageService),\r\n    __param(7, IClipboardService)\r\n], FindController);\r\nexport { FindController };\r\nexport const StartFindAction = registerMultiEditorAction(new MultiEditorAction({\r\n    id: FIND_IDS.StartFindAction,\r\n    label: nls.localize('startFindAction', \"Find\"),\r\n    alias: 'Find',\r\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\r\n    kbOpts: {\r\n        kbExpr: null,\r\n        primary: 2048 /* CtrlCmd */ | 36 /* KEY_F */,\r\n        weight: 100 /* EditorContrib */\r\n    },\r\n    menuOpts: {\r\n        menuId: MenuId.MenubarEditMenu,\r\n        group: '3_find',\r\n        title: nls.localize({ key: 'miFind', comment: ['&& denotes a mnemonic'] }, \"&&Find\"),\r\n        order: 1\r\n    }\r\n}));\r\nStartFindAction.addImplementation(0, (accessor, editor, args) => {\r\n    const controller = CommonFindController.get(editor);\r\n    if (!controller) {\r\n        return false;\r\n    }\r\n    return controller.start({\r\n        forceRevealReplace: false,\r\n        seedSearchStringFromSelection: editor.getOption(33 /* find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\r\n        seedSearchStringFromNonEmptySelection: editor.getOption(33 /* find */).seedSearchStringFromSelection === 'selection',\r\n        seedSearchStringFromGlobalClipboard: editor.getOption(33 /* find */).globalFindClipboard,\r\n        shouldFocus: 1 /* FocusFindInput */,\r\n        shouldAnimate: true,\r\n        updateSearchScope: false,\r\n        loop: editor.getOption(33 /* find */).loop\r\n    });\r\n});\r\nexport class StartFindWithSelectionAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: FIND_IDS.StartFindWithSelection,\r\n            label: nls.localize('startFindWithSelectionAction', \"Find With Selection\"),\r\n            alias: 'Find With Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 0,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 35 /* KEY_E */,\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let controller = CommonFindController.get(editor);\r\n            if (controller) {\r\n                yield controller.start({\r\n                    forceRevealReplace: false,\r\n                    seedSearchStringFromSelection: 'multiple',\r\n                    seedSearchStringFromNonEmptySelection: false,\r\n                    seedSearchStringFromGlobalClipboard: false,\r\n                    shouldFocus: 0 /* NoFocusChange */,\r\n                    shouldAnimate: true,\r\n                    updateSearchScope: false,\r\n                    loop: editor.getOption(33 /* find */).loop\r\n                });\r\n                controller.setGlobalBufferTerm(controller.getState().searchString);\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class MatchFindAction extends EditorAction {\r\n    run(accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let controller = CommonFindController.get(editor);\r\n            if (controller && !this._run(controller)) {\r\n                yield controller.start({\r\n                    forceRevealReplace: false,\r\n                    seedSearchStringFromSelection: (controller.getState().searchString.length === 0) && editor.getOption(33 /* find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\r\n                    seedSearchStringFromNonEmptySelection: editor.getOption(33 /* find */).seedSearchStringFromSelection === 'selection',\r\n                    seedSearchStringFromGlobalClipboard: true,\r\n                    shouldFocus: 0 /* NoFocusChange */,\r\n                    shouldAnimate: true,\r\n                    updateSearchScope: false,\r\n                    loop: editor.getOption(33 /* find */).loop\r\n                });\r\n                this._run(controller);\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class NextMatchFindAction extends MatchFindAction {\r\n    constructor() {\r\n        super({\r\n            id: FIND_IDS.NextMatchFindAction,\r\n            label: nls.localize('findNextMatchAction', \"Find Next\"),\r\n            alias: 'Find Next',\r\n            precondition: undefined,\r\n            kbOpts: [{\r\n                    kbExpr: EditorContextKeys.focus,\r\n                    primary: 61 /* F3 */,\r\n                    mac: { primary: 2048 /* CtrlCmd */ | 37 /* KEY_G */, secondary: [61 /* F3 */] },\r\n                    weight: 100 /* EditorContrib */\r\n                }, {\r\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\r\n                    primary: 3 /* Enter */,\r\n                    weight: 100 /* EditorContrib */\r\n                }]\r\n        });\r\n    }\r\n    _run(controller) {\r\n        const result = controller.moveToNextMatch();\r\n        if (result) {\r\n            controller.editor.pushUndoStop();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nexport class PreviousMatchFindAction extends MatchFindAction {\r\n    constructor() {\r\n        super({\r\n            id: FIND_IDS.PreviousMatchFindAction,\r\n            label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\r\n            alias: 'Find Previous',\r\n            precondition: undefined,\r\n            kbOpts: [{\r\n                    kbExpr: EditorContextKeys.focus,\r\n                    primary: 1024 /* Shift */ | 61 /* F3 */,\r\n                    mac: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 37 /* KEY_G */, secondary: [1024 /* Shift */ | 61 /* F3 */] },\r\n                    weight: 100 /* EditorContrib */\r\n                }, {\r\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\r\n                    primary: 1024 /* Shift */ | 3 /* Enter */,\r\n                    weight: 100 /* EditorContrib */\r\n                }\r\n            ]\r\n        });\r\n    }\r\n    _run(controller) {\r\n        return controller.moveToPrevMatch();\r\n    }\r\n}\r\nexport class SelectionMatchFindAction extends EditorAction {\r\n    run(accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let controller = CommonFindController.get(editor);\r\n            if (!controller) {\r\n                return;\r\n            }\r\n            const seedSearchStringFromNonEmptySelection = editor.getOption(33 /* find */).seedSearchStringFromSelection === 'selection';\r\n            let selectionSearchString = null;\r\n            if (editor.getOption(33 /* find */).seedSearchStringFromSelection !== 'never') {\r\n                selectionSearchString = getSelectionSearchString(editor, 'single', seedSearchStringFromNonEmptySelection);\r\n            }\r\n            if (selectionSearchString) {\r\n                controller.setSearchString(selectionSearchString);\r\n            }\r\n            if (!this._run(controller)) {\r\n                yield controller.start({\r\n                    forceRevealReplace: false,\r\n                    seedSearchStringFromSelection: editor.getOption(33 /* find */).seedSearchStringFromSelection !== 'never' ? 'single' : 'none',\r\n                    seedSearchStringFromNonEmptySelection: seedSearchStringFromNonEmptySelection,\r\n                    seedSearchStringFromGlobalClipboard: false,\r\n                    shouldFocus: 0 /* NoFocusChange */,\r\n                    shouldAnimate: true,\r\n                    updateSearchScope: false,\r\n                    loop: editor.getOption(33 /* find */).loop\r\n                });\r\n                this._run(controller);\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class NextSelectionMatchFindAction extends SelectionMatchFindAction {\r\n    constructor() {\r\n        super({\r\n            id: FIND_IDS.NextSelectionMatchFindAction,\r\n            label: nls.localize('nextSelectionMatchFindAction', \"Find Next Selection\"),\r\n            alias: 'Find Next Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 61 /* F3 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    _run(controller) {\r\n        return controller.moveToNextMatch();\r\n    }\r\n}\r\nexport class PreviousSelectionMatchFindAction extends SelectionMatchFindAction {\r\n    constructor() {\r\n        super({\r\n            id: FIND_IDS.PreviousSelectionMatchFindAction,\r\n            label: nls.localize('previousSelectionMatchFindAction', \"Find Previous Selection\"),\r\n            alias: 'Find Previous Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 61 /* F3 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    _run(controller) {\r\n        return controller.moveToPrevMatch();\r\n    }\r\n}\r\nexport const StartFindReplaceAction = registerMultiEditorAction(new MultiEditorAction({\r\n    id: FIND_IDS.StartFindReplaceAction,\r\n    label: nls.localize('startReplace', \"Replace\"),\r\n    alias: 'Replace',\r\n    precondition: ContextKeyExpr.or(EditorContextKeys.focus, ContextKeyExpr.has('editorIsOpen')),\r\n    kbOpts: {\r\n        kbExpr: null,\r\n        primary: 2048 /* CtrlCmd */ | 38 /* KEY_H */,\r\n        mac: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 36 /* KEY_F */ },\r\n        weight: 100 /* EditorContrib */\r\n    },\r\n    menuOpts: {\r\n        menuId: MenuId.MenubarEditMenu,\r\n        group: '3_find',\r\n        title: nls.localize({ key: 'miReplace', comment: ['&& denotes a mnemonic'] }, \"&&Replace\"),\r\n        order: 2\r\n    }\r\n}));\r\nStartFindReplaceAction.addImplementation(0, (accessor, editor, args) => {\r\n    if (!editor.hasModel() || editor.getOption(79 /* readOnly */)) {\r\n        return false;\r\n    }\r\n    const controller = CommonFindController.get(editor);\r\n    if (!controller) {\r\n        return false;\r\n    }\r\n    const currentSelection = editor.getSelection();\r\n    const findInputFocused = controller.isFindInputFocused();\r\n    // we only seed search string from selection when the current selection is single line and not empty,\r\n    // + the find input is not focused\r\n    const seedSearchStringFromSelection = !currentSelection.isEmpty()\r\n        && currentSelection.startLineNumber === currentSelection.endLineNumber\r\n        && (editor.getOption(33 /* find */).seedSearchStringFromSelection !== 'never')\r\n        && !findInputFocused;\r\n    /*\r\n    * if the existing search string in find widget is empty and we don't seed search string from selection, it means the Find Input is still empty, so we should focus the Find Input instead of Replace Input.\r\n\r\n    * findInputFocused true -> seedSearchStringFromSelection false, FocusReplaceInput\r\n    * findInputFocused false, seedSearchStringFromSelection true FocusReplaceInput\r\n    * findInputFocused false seedSearchStringFromSelection false FocusFindInput\r\n    */\r\n    const shouldFocus = (findInputFocused || seedSearchStringFromSelection) ?\r\n        2 /* FocusReplaceInput */ : 1 /* FocusFindInput */;\r\n    return controller.start({\r\n        forceRevealReplace: true,\r\n        seedSearchStringFromSelection: seedSearchStringFromSelection ? 'single' : 'none',\r\n        seedSearchStringFromNonEmptySelection: editor.getOption(33 /* find */).seedSearchStringFromSelection === 'selection',\r\n        seedSearchStringFromGlobalClipboard: editor.getOption(33 /* find */).seedSearchStringFromSelection !== 'never',\r\n        shouldFocus: shouldFocus,\r\n        shouldAnimate: true,\r\n        updateSearchScope: false,\r\n        loop: editor.getOption(33 /* find */).loop\r\n    });\r\n});\r\nregisterEditorContribution(CommonFindController.ID, FindController);\r\nregisterEditorAction(StartFindWithSelectionAction);\r\nregisterEditorAction(NextMatchFindAction);\r\nregisterEditorAction(PreviousMatchFindAction);\r\nregisterEditorAction(NextSelectionMatchFindAction);\r\nregisterEditorAction(PreviousSelectionMatchFindAction);\r\nconst FindCommand = EditorCommand.bindToContribution(CommonFindController.get);\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.CloseFindWidgetCommand,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: x => x.closeFindWidget(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, ContextKeyExpr.not('isComposing')),\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleCaseSensitiveCommand,\r\n    precondition: undefined,\r\n    handler: x => x.toggleCaseSensitive(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleCaseSensitiveKeybinding.primary,\r\n        mac: ToggleCaseSensitiveKeybinding.mac,\r\n        win: ToggleCaseSensitiveKeybinding.win,\r\n        linux: ToggleCaseSensitiveKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleWholeWordCommand,\r\n    precondition: undefined,\r\n    handler: x => x.toggleWholeWords(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleWholeWordKeybinding.primary,\r\n        mac: ToggleWholeWordKeybinding.mac,\r\n        win: ToggleWholeWordKeybinding.win,\r\n        linux: ToggleWholeWordKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleRegexCommand,\r\n    precondition: undefined,\r\n    handler: x => x.toggleRegex(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleRegexKeybinding.primary,\r\n        mac: ToggleRegexKeybinding.mac,\r\n        win: ToggleRegexKeybinding.win,\r\n        linux: ToggleRegexKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ToggleSearchScopeCommand,\r\n    precondition: undefined,\r\n    handler: x => x.toggleSearchScope(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: ToggleSearchScopeKeybinding.primary,\r\n        mac: ToggleSearchScopeKeybinding.mac,\r\n        win: ToggleSearchScopeKeybinding.win,\r\n        linux: ToggleSearchScopeKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.TogglePreserveCaseCommand,\r\n    precondition: undefined,\r\n    handler: x => x.togglePreserveCase(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: TogglePreserveCaseKeybinding.primary,\r\n        mac: TogglePreserveCaseKeybinding.mac,\r\n        win: TogglePreserveCaseKeybinding.win,\r\n        linux: TogglePreserveCaseKeybinding.linux\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceOneAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: x => x.replace(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 22 /* KEY_1 */\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceOneAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: x => x.replace(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\r\n        primary: 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceAllAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: x => x.replaceAll(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.ReplaceAllAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: x => x.replaceAll(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\r\n        primary: undefined,\r\n        mac: {\r\n            primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n        }\r\n    }\r\n}));\r\nregisterEditorCommand(new FindCommand({\r\n    id: FIND_IDS.SelectAllMatchesAction,\r\n    precondition: CONTEXT_FIND_WIDGET_VISIBLE,\r\n    handler: x => x.selectAllMatches(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 5,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 512 /* Alt */ | 3 /* Enter */\r\n    }\r\n}));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport const MAX_FOLDING_REGIONS = 0xFFFF;\r\nexport const MAX_LINE_NUMBER = 0xFFFFFF;\r\nconst MASK_INDENT = 0xFF000000;\r\nexport class FoldingRegions {\r\n    constructor(startIndexes, endIndexes, types) {\r\n        if (startIndexes.length !== endIndexes.length || startIndexes.length > MAX_FOLDING_REGIONS) {\r\n            throw new Error('invalid startIndexes or endIndexes size');\r\n        }\r\n        this._startIndexes = startIndexes;\r\n        this._endIndexes = endIndexes;\r\n        this._collapseStates = new Uint32Array(Math.ceil(startIndexes.length / 32));\r\n        this._types = types;\r\n        this._parentsComputed = false;\r\n    }\r\n    ensureParentIndices() {\r\n        if (!this._parentsComputed) {\r\n            this._parentsComputed = true;\r\n            let parentIndexes = [];\r\n            let isInsideLast = (startLineNumber, endLineNumber) => {\r\n                let index = parentIndexes[parentIndexes.length - 1];\r\n                return this.getStartLineNumber(index) <= startLineNumber && this.getEndLineNumber(index) >= endLineNumber;\r\n            };\r\n            for (let i = 0, len = this._startIndexes.length; i < len; i++) {\r\n                let startLineNumber = this._startIndexes[i];\r\n                let endLineNumber = this._endIndexes[i];\r\n                if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\r\n                    throw new Error('startLineNumber or endLineNumber must not exceed ' + MAX_LINE_NUMBER);\r\n                }\r\n                while (parentIndexes.length > 0 && !isInsideLast(startLineNumber, endLineNumber)) {\r\n                    parentIndexes.pop();\r\n                }\r\n                let parentIndex = parentIndexes.length > 0 ? parentIndexes[parentIndexes.length - 1] : -1;\r\n                parentIndexes.push(i);\r\n                this._startIndexes[i] = startLineNumber + ((parentIndex & 0xFF) << 24);\r\n                this._endIndexes[i] = endLineNumber + ((parentIndex & 0xFF00) << 16);\r\n            }\r\n        }\r\n    }\r\n    get length() {\r\n        return this._startIndexes.length;\r\n    }\r\n    getStartLineNumber(index) {\r\n        return this._startIndexes[index] & MAX_LINE_NUMBER;\r\n    }\r\n    getEndLineNumber(index) {\r\n        return this._endIndexes[index] & MAX_LINE_NUMBER;\r\n    }\r\n    getType(index) {\r\n        return this._types ? this._types[index] : undefined;\r\n    }\r\n    hasTypes() {\r\n        return !!this._types;\r\n    }\r\n    isCollapsed(index) {\r\n        let arrayIndex = (index / 32) | 0;\r\n        let bit = index % 32;\r\n        return (this._collapseStates[arrayIndex] & (1 << bit)) !== 0;\r\n    }\r\n    setCollapsed(index, newState) {\r\n        let arrayIndex = (index / 32) | 0;\r\n        let bit = index % 32;\r\n        let value = this._collapseStates[arrayIndex];\r\n        if (newState) {\r\n            this._collapseStates[arrayIndex] = value | (1 << bit);\r\n        }\r\n        else {\r\n            this._collapseStates[arrayIndex] = value & ~(1 << bit);\r\n        }\r\n    }\r\n    setCollapsedAllOfType(type, newState) {\r\n        let hasChanged = false;\r\n        if (this._types) {\r\n            for (let i = 0; i < this._types.length; i++) {\r\n                if (this._types[i] === type) {\r\n                    this.setCollapsed(i, newState);\r\n                    hasChanged = true;\r\n                }\r\n            }\r\n        }\r\n        return hasChanged;\r\n    }\r\n    toRegion(index) {\r\n        return new FoldingRegion(this, index);\r\n    }\r\n    getParentIndex(index) {\r\n        this.ensureParentIndices();\r\n        let parent = ((this._startIndexes[index] & MASK_INDENT) >>> 24) + ((this._endIndexes[index] & MASK_INDENT) >>> 16);\r\n        if (parent === MAX_FOLDING_REGIONS) {\r\n            return -1;\r\n        }\r\n        return parent;\r\n    }\r\n    contains(index, line) {\r\n        return this.getStartLineNumber(index) <= line && this.getEndLineNumber(index) >= line;\r\n    }\r\n    findIndex(line) {\r\n        let low = 0, high = this._startIndexes.length;\r\n        if (high === 0) {\r\n            return -1; // no children\r\n        }\r\n        while (low < high) {\r\n            let mid = Math.floor((low + high) / 2);\r\n            if (line < this.getStartLineNumber(mid)) {\r\n                high = mid;\r\n            }\r\n            else {\r\n                low = mid + 1;\r\n            }\r\n        }\r\n        return low - 1;\r\n    }\r\n    findRange(line) {\r\n        let index = this.findIndex(line);\r\n        if (index >= 0) {\r\n            let endLineNumber = this.getEndLineNumber(index);\r\n            if (endLineNumber >= line) {\r\n                return index;\r\n            }\r\n            index = this.getParentIndex(index);\r\n            while (index !== -1) {\r\n                if (this.contains(index, line)) {\r\n                    return index;\r\n                }\r\n                index = this.getParentIndex(index);\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    toString() {\r\n        let res = [];\r\n        for (let i = 0; i < this.length; i++) {\r\n            res[i] = `[${this.isCollapsed(i) ? '+' : '-'}] ${this.getStartLineNumber(i)}/${this.getEndLineNumber(i)}`;\r\n        }\r\n        return res.join(', ');\r\n    }\r\n}\r\nexport class FoldingRegion {\r\n    constructor(ranges, index) {\r\n        this.ranges = ranges;\r\n        this.index = index;\r\n    }\r\n    get startLineNumber() {\r\n        return this.ranges.getStartLineNumber(this.index);\r\n    }\r\n    get endLineNumber() {\r\n        return this.ranges.getEndLineNumber(this.index);\r\n    }\r\n    get regionIndex() {\r\n        return this.index;\r\n    }\r\n    get parentIndex() {\r\n        return this.ranges.getParentIndex(this.index);\r\n    }\r\n    get isCollapsed() {\r\n        return this.ranges.isCollapsed(this.index);\r\n    }\r\n    containedBy(range) {\r\n        return range.startLineNumber <= this.startLineNumber && range.endLineNumber >= this.endLineNumber;\r\n    }\r\n    containsLine(lineNumber) {\r\n        return this.startLineNumber <= lineNumber && lineNumber <= this.endLineNumber;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { FoldingRegions } from './foldingRanges.js';\r\nexport class FoldingModel {\r\n    constructor(textModel, decorationProvider) {\r\n        this._updateEventEmitter = new Emitter();\r\n        this.onDidChange = this._updateEventEmitter.event;\r\n        this._textModel = textModel;\r\n        this._decorationProvider = decorationProvider;\r\n        this._regions = new FoldingRegions(new Uint32Array(0), new Uint32Array(0));\r\n        this._editorDecorationIds = [];\r\n        this._isInitialized = false;\r\n    }\r\n    get regions() { return this._regions; }\r\n    get textModel() { return this._textModel; }\r\n    get isInitialized() { return this._isInitialized; }\r\n    toggleCollapseState(toggledRegions) {\r\n        if (!toggledRegions.length) {\r\n            return;\r\n        }\r\n        toggledRegions = toggledRegions.sort((r1, r2) => r1.regionIndex - r2.regionIndex);\r\n        const processed = {};\r\n        this._decorationProvider.changeDecorations(accessor => {\r\n            let k = 0; // index from [0 ... this.regions.length]\r\n            let dirtyRegionEndLine = -1; // end of the range where decorations need to be updated\r\n            let lastHiddenLine = -1; // the end of the last hidden lines\r\n            const updateDecorationsUntil = (index) => {\r\n                while (k < index) {\r\n                    const endLineNumber = this._regions.getEndLineNumber(k);\r\n                    const isCollapsed = this._regions.isCollapsed(k);\r\n                    if (endLineNumber <= dirtyRegionEndLine) {\r\n                        accessor.changeDecorationOptions(this._editorDecorationIds[k], this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine));\r\n                    }\r\n                    if (isCollapsed && endLineNumber > lastHiddenLine) {\r\n                        lastHiddenLine = endLineNumber;\r\n                    }\r\n                    k++;\r\n                }\r\n            };\r\n            for (let region of toggledRegions) {\r\n                let index = region.regionIndex;\r\n                let editorDecorationId = this._editorDecorationIds[index];\r\n                if (editorDecorationId && !processed[editorDecorationId]) {\r\n                    processed[editorDecorationId] = true;\r\n                    updateDecorationsUntil(index); // update all decorations up to current index using the old dirtyRegionEndLine\r\n                    let newCollapseState = !this._regions.isCollapsed(index);\r\n                    this._regions.setCollapsed(index, newCollapseState);\r\n                    dirtyRegionEndLine = Math.max(dirtyRegionEndLine, this._regions.getEndLineNumber(index));\r\n                }\r\n            }\r\n            updateDecorationsUntil(this._regions.length);\r\n        });\r\n        this._updateEventEmitter.fire({ model: this, collapseStateChanged: toggledRegions });\r\n    }\r\n    update(newRegions, blockedLineNumers = []) {\r\n        let newEditorDecorations = [];\r\n        let isBlocked = (startLineNumber, endLineNumber) => {\r\n            for (let blockedLineNumber of blockedLineNumers) {\r\n                if (startLineNumber < blockedLineNumber && blockedLineNumber <= endLineNumber) { // first line is visible\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        let lastHiddenLine = -1;\r\n        let initRange = (index, isCollapsed) => {\r\n            const startLineNumber = newRegions.getStartLineNumber(index);\r\n            const endLineNumber = newRegions.getEndLineNumber(index);\r\n            if (!isCollapsed) {\r\n                isCollapsed = newRegions.isCollapsed(index);\r\n            }\r\n            if (isCollapsed && isBlocked(startLineNumber, endLineNumber)) {\r\n                isCollapsed = false;\r\n            }\r\n            newRegions.setCollapsed(index, isCollapsed);\r\n            const maxColumn = this._textModel.getLineMaxColumn(startLineNumber);\r\n            const decorationRange = {\r\n                startLineNumber: startLineNumber,\r\n                startColumn: Math.max(maxColumn - 1, 1),\r\n                endLineNumber: startLineNumber,\r\n                endColumn: maxColumn\r\n            };\r\n            newEditorDecorations.push({ range: decorationRange, options: this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine) });\r\n            if (isCollapsed && endLineNumber > lastHiddenLine) {\r\n                lastHiddenLine = endLineNumber;\r\n            }\r\n        };\r\n        let i = 0;\r\n        let nextCollapsed = () => {\r\n            while (i < this._regions.length) {\r\n                let isCollapsed = this._regions.isCollapsed(i);\r\n                i++;\r\n                if (isCollapsed) {\r\n                    return i - 1;\r\n                }\r\n            }\r\n            return -1;\r\n        };\r\n        let k = 0;\r\n        let collapsedIndex = nextCollapsed();\r\n        while (collapsedIndex !== -1 && k < newRegions.length) {\r\n            // get the latest range\r\n            let decRange = this._textModel.getDecorationRange(this._editorDecorationIds[collapsedIndex]);\r\n            if (decRange) {\r\n                let collapsedStartLineNumber = decRange.startLineNumber;\r\n                if (decRange.startColumn === Math.max(decRange.endColumn - 1, 1) && this._textModel.getLineMaxColumn(collapsedStartLineNumber) === decRange.endColumn) { // test that the decoration is still covering the full line else it got deleted\r\n                    while (k < newRegions.length) {\r\n                        let startLineNumber = newRegions.getStartLineNumber(k);\r\n                        if (collapsedStartLineNumber >= startLineNumber) {\r\n                            initRange(k, collapsedStartLineNumber === startLineNumber);\r\n                            k++;\r\n                        }\r\n                        else {\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            collapsedIndex = nextCollapsed();\r\n        }\r\n        while (k < newRegions.length) {\r\n            initRange(k, false);\r\n            k++;\r\n        }\r\n        this._editorDecorationIds = this._decorationProvider.deltaDecorations(this._editorDecorationIds, newEditorDecorations);\r\n        this._regions = newRegions;\r\n        this._isInitialized = true;\r\n        this._updateEventEmitter.fire({ model: this });\r\n    }\r\n    /**\r\n     * Collapse state memento, for persistence only\r\n     */\r\n    getMemento() {\r\n        let collapsedRanges = [];\r\n        for (let i = 0; i < this._regions.length; i++) {\r\n            if (this._regions.isCollapsed(i)) {\r\n                let range = this._textModel.getDecorationRange(this._editorDecorationIds[i]);\r\n                if (range) {\r\n                    let startLineNumber = range.startLineNumber;\r\n                    let endLineNumber = range.endLineNumber + this._regions.getEndLineNumber(i) - this._regions.getStartLineNumber(i);\r\n                    collapsedRanges.push({ startLineNumber, endLineNumber });\r\n                }\r\n            }\r\n        }\r\n        if (collapsedRanges.length > 0) {\r\n            return collapsedRanges;\r\n        }\r\n        return undefined;\r\n    }\r\n    /**\r\n     * Apply persisted state, for persistence only\r\n     */\r\n    applyMemento(state) {\r\n        if (!Array.isArray(state)) {\r\n            return;\r\n        }\r\n        let toToogle = [];\r\n        for (let range of state) {\r\n            let region = this.getRegionAtLine(range.startLineNumber);\r\n            if (region && !region.isCollapsed) {\r\n                toToogle.push(region);\r\n            }\r\n        }\r\n        this.toggleCollapseState(toToogle);\r\n    }\r\n    dispose() {\r\n        this._decorationProvider.deltaDecorations(this._editorDecorationIds, []);\r\n    }\r\n    getAllRegionsAtLine(lineNumber, filter) {\r\n        let result = [];\r\n        if (this._regions) {\r\n            let index = this._regions.findRange(lineNumber);\r\n            let level = 1;\r\n            while (index >= 0) {\r\n                let current = this._regions.toRegion(index);\r\n                if (!filter || filter(current, level)) {\r\n                    result.push(current);\r\n                }\r\n                level++;\r\n                index = current.parentIndex;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    getRegionAtLine(lineNumber) {\r\n        if (this._regions) {\r\n            let index = this._regions.findRange(lineNumber);\r\n            if (index >= 0) {\r\n                return this._regions.toRegion(index);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    getRegionsInside(region, filter) {\r\n        let result = [];\r\n        let index = region ? region.regionIndex + 1 : 0;\r\n        let endLineNumber = region ? region.endLineNumber : Number.MAX_VALUE;\r\n        if (filter && filter.length === 2) {\r\n            const levelStack = [];\r\n            for (let i = index, len = this._regions.length; i < len; i++) {\r\n                let current = this._regions.toRegion(i);\r\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\r\n                    while (levelStack.length > 0 && !current.containedBy(levelStack[levelStack.length - 1])) {\r\n                        levelStack.pop();\r\n                    }\r\n                    levelStack.push(current);\r\n                    if (filter(current, levelStack.length)) {\r\n                        result.push(current);\r\n                    }\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (let i = index, len = this._regions.length; i < len; i++) {\r\n                let current = this._regions.toRegion(i);\r\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\r\n                    if (!filter || filter(current)) {\r\n                        result.push(current);\r\n                    }\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n}\r\n/**\r\n * Collapse or expand the regions at the given locations\r\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\r\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\r\n */\r\nexport function toggleCollapseState(foldingModel, levels, lineNumbers) {\r\n    let toToggle = [];\r\n    for (let lineNumber of lineNumbers) {\r\n        let region = foldingModel.getRegionAtLine(lineNumber);\r\n        if (region) {\r\n            const doCollapse = !region.isCollapsed;\r\n            toToggle.push(region);\r\n            if (levels > 1) {\r\n                let regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\r\n                toToggle.push(...regionsInside);\r\n            }\r\n        }\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Collapse or expand the regions at the given locations including all children.\r\n * @param doCollapse Whether to collapse or expand\r\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\r\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\r\n */\r\nexport function setCollapseStateLevelsDown(foldingModel, doCollapse, levels = Number.MAX_VALUE, lineNumbers) {\r\n    let toToggle = [];\r\n    if (lineNumbers && lineNumbers.length > 0) {\r\n        for (let lineNumber of lineNumbers) {\r\n            let region = foldingModel.getRegionAtLine(lineNumber);\r\n            if (region) {\r\n                if (region.isCollapsed !== doCollapse) {\r\n                    toToggle.push(region);\r\n                }\r\n                if (levels > 1) {\r\n                    let regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\r\n                    toToggle.push(...regionsInside);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        let regionsInside = foldingModel.getRegionsInside(null, (r, level) => r.isCollapsed !== doCollapse && level < levels);\r\n        toToggle.push(...regionsInside);\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Collapse or expand the regions at the given locations including all parents.\r\n * @param doCollapse Whether to collapse or expand\r\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\r\n * @param lineNumbers the location of the regions to collapse or expand.\r\n */\r\nexport function setCollapseStateLevelsUp(foldingModel, doCollapse, levels, lineNumbers) {\r\n    let toToggle = [];\r\n    for (let lineNumber of lineNumbers) {\r\n        let regions = foldingModel.getAllRegionsAtLine(lineNumber, (region, level) => region.isCollapsed !== doCollapse && level <= levels);\r\n        toToggle.push(...regions);\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Collapse or expand a region at the given locations. If the inner most region is already collapsed/expanded, uses the first parent instead.\r\n * @param doCollapse Whether to collapse or expand\r\n * @param lineNumbers the location of the regions to collapse or expand.\r\n */\r\nexport function setCollapseStateUp(foldingModel, doCollapse, lineNumbers) {\r\n    let toToggle = [];\r\n    for (let lineNumber of lineNumbers) {\r\n        let regions = foldingModel.getAllRegionsAtLine(lineNumber, (region) => region.isCollapsed !== doCollapse);\r\n        if (regions.length > 0) {\r\n            toToggle.push(regions[0]);\r\n        }\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds or unfolds all regions that have a given level, except if they contain one of the blocked lines.\r\n * @param foldLevel level. Level == 1 is the top level\r\n * @param doCollapse Whether to collapse or expand\r\n*/\r\nexport function setCollapseStateAtLevel(foldingModel, foldLevel, doCollapse, blockedLineNumbers) {\r\n    let filter = (region, level) => level === foldLevel && region.isCollapsed !== doCollapse && !blockedLineNumbers.some(line => region.containsLine(line));\r\n    let toToggle = foldingModel.getRegionsInside(null, filter);\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds or unfolds all regions, except if they contain or are contained by a region of one of the blocked lines.\r\n * @param doCollapse Whether to collapse or expand\r\n * @param blockedLineNumbers the location of regions to not collapse or expand\r\n */\r\nexport function setCollapseStateForRest(foldingModel, doCollapse, blockedLineNumbers) {\r\n    let filteredRegions = [];\r\n    for (let lineNumber of blockedLineNumbers) {\r\n        filteredRegions.push(foldingModel.getAllRegionsAtLine(lineNumber, undefined)[0]);\r\n    }\r\n    let filter = (region) => filteredRegions.every((filteredRegion) => !filteredRegion.containedBy(region) && !region.containedBy(filteredRegion)) && region.isCollapsed !== doCollapse;\r\n    let toToggle = foldingModel.getRegionsInside(null, filter);\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds all regions for which the lines start with a given regex\r\n * @param foldingModel the folding model\r\n */\r\nexport function setCollapseStateForMatchingLines(foldingModel, regExp, doCollapse) {\r\n    let editorModel = foldingModel.textModel;\r\n    let regions = foldingModel.regions;\r\n    let toToggle = [];\r\n    for (let i = regions.length - 1; i >= 0; i--) {\r\n        if (doCollapse !== regions.isCollapsed(i)) {\r\n            let startLineNumber = regions.getStartLineNumber(i);\r\n            if (regExp.test(editorModel.getLineContent(startLineNumber))) {\r\n                toToggle.push(regions.toRegion(i));\r\n            }\r\n        }\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Folds all regions of the given type\r\n * @param foldingModel the folding model\r\n */\r\nexport function setCollapseStateForType(foldingModel, type, doCollapse) {\r\n    let regions = foldingModel.regions;\r\n    let toToggle = [];\r\n    for (let i = regions.length - 1; i >= 0; i--) {\r\n        if (doCollapse !== regions.isCollapsed(i) && type === regions.getType(i)) {\r\n            toToggle.push(regions.toRegion(i));\r\n        }\r\n    }\r\n    foldingModel.toggleCollapseState(toToggle);\r\n}\r\n/**\r\n * Get line to go to for parent fold of current line\r\n * @param lineNumber the current line number\r\n * @param foldingModel the folding model\r\n *\r\n * @return Parent fold start line\r\n */\r\nexport function getParentFoldLine(lineNumber, foldingModel) {\r\n    let startLineNumber = null;\r\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\r\n    if (foldingRegion !== null) {\r\n        startLineNumber = foldingRegion.startLineNumber;\r\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to parent fold\r\n        if (lineNumber === startLineNumber) {\r\n            let parentFoldingIdx = foldingRegion.parentIndex;\r\n            if (parentFoldingIdx !== -1) {\r\n                startLineNumber = foldingModel.regions.getStartLineNumber(parentFoldingIdx);\r\n            }\r\n            else {\r\n                startLineNumber = null;\r\n            }\r\n        }\r\n    }\r\n    return startLineNumber;\r\n}\r\n/**\r\n * Get line to go to for previous fold at the same level of current line\r\n * @param lineNumber the current line number\r\n * @param foldingModel the folding model\r\n *\r\n * @return Previous fold start line\r\n */\r\nexport function getPreviousFoldLine(lineNumber, foldingModel) {\r\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\r\n    if (foldingRegion !== null) {\r\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to previous fold.\r\n        if (lineNumber !== foldingRegion.startLineNumber) {\r\n            return foldingRegion.startLineNumber;\r\n        }\r\n        else {\r\n            // Find min line number to stay within parent.\r\n            let expectedParentIndex = foldingRegion.parentIndex;\r\n            if (expectedParentIndex === -1) {\r\n                return null;\r\n            }\r\n            let minLineNumber = foldingModel.regions.getStartLineNumber(foldingRegion.parentIndex);\r\n            // Find fold at same level.\r\n            while (foldingRegion !== null) {\r\n                if (foldingRegion.regionIndex > 0) {\r\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\r\n                    // Keep at same level.\r\n                    if (foldingRegion.startLineNumber <= minLineNumber) {\r\n                        return null;\r\n                    }\r\n                    else if (foldingRegion.parentIndex === expectedParentIndex) {\r\n                        return foldingRegion.startLineNumber;\r\n                    }\r\n                }\r\n                else {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Get line to go to next fold at the same level of current line\r\n * @param lineNumber the current line number\r\n * @param foldingModel the folding model\r\n *\r\n * @return Next fold start line\r\n */\r\nexport function getNextFoldLine(lineNumber, foldingModel) {\r\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\r\n    if (foldingRegion !== null) {\r\n        // Find max line number to stay within parent.\r\n        let expectedParentIndex = foldingRegion.parentIndex;\r\n        if (expectedParentIndex === -1) {\r\n            return null;\r\n        }\r\n        let maxLineNumber = foldingModel.regions.getEndLineNumber(foldingRegion.parentIndex);\r\n        // Find fold at same level.\r\n        while (foldingRegion !== null) {\r\n            if (foldingRegion.regionIndex < foldingModel.regions.length) {\r\n                foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\r\n                // Keep at same level.\r\n                if (foldingRegion.startLineNumber >= maxLineNumber) {\r\n                    return null;\r\n                }\r\n                else if (foldingRegion.parentIndex === expectedParentIndex) {\r\n                    return foldingRegion.startLineNumber;\r\n                }\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { registerIcon } from '../../../platform/theme/common/iconRegistry.js';\r\nimport { ThemeIcon } from '../../../platform/theme/common/themeService.js';\r\nexport const foldingExpandedIcon = registerIcon('folding-expanded', Codicon.chevronDown, localize('foldingExpandedIcon', 'Icon for expanded ranges in the editor glyph margin.'));\r\nexport const foldingCollapsedIcon = registerIcon('folding-collapsed', Codicon.chevronRight, localize('foldingCollapsedIcon', 'Icon for collapsed ranges in the editor glyph margin.'));\r\nexport class FoldingDecorationProvider {\r\n    constructor(editor) {\r\n        this.editor = editor;\r\n        this.autoHideFoldingControls = true;\r\n        this.showFoldingHighlights = true;\r\n    }\r\n    getDecorationOption(isCollapsed, isHidden) {\r\n        if (isHidden) {\r\n            return FoldingDecorationProvider.HIDDEN_RANGE_DECORATION;\r\n        }\r\n        if (isCollapsed) {\r\n            return this.showFoldingHighlights ? FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION;\r\n        }\r\n        else if (this.autoHideFoldingControls) {\r\n            return FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION;\r\n        }\r\n        else {\r\n            return FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION;\r\n        }\r\n    }\r\n    deltaDecorations(oldDecorations, newDecorations) {\r\n        return this.editor.deltaDecorations(oldDecorations, newDecorations);\r\n    }\r\n    changeDecorations(callback) {\r\n        return this.editor.changeDecorations(callback);\r\n    }\r\n}\r\nFoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n    description: 'folding-collapsed-visual-decoration',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    afterContentClassName: 'inline-folded',\r\n    isWholeLine: true,\r\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon)\r\n});\r\nFoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n    description: 'folding-collapsed-highlighted-visual-decoration',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    afterContentClassName: 'inline-folded',\r\n    className: 'folded-background',\r\n    isWholeLine: true,\r\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon)\r\n});\r\nFoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n    description: 'folding-expanded-auto-hide-visual-decoration',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    isWholeLine: true,\r\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingExpandedIcon)\r\n});\r\nFoldingDecorationProvider.EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\r\n    description: 'folding-expanded-visual-decoration',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    isWholeLine: true,\r\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingExpandedIcon)\r\n});\r\nFoldingDecorationProvider.HIDDEN_RANGE_DECORATION = ModelDecorationOptions.register({\r\n    description: 'folding-hidden-range-decoration',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { findFirstInSorted } from '../../../base/common/arrays.js';\r\nexport class HiddenRangeModel {\r\n    constructor(model) {\r\n        this._updateEventEmitter = new Emitter();\r\n        this._foldingModel = model;\r\n        this._foldingModelListener = model.onDidChange(_ => this.updateHiddenRanges());\r\n        this._hiddenRanges = [];\r\n        if (model.regions.length) {\r\n            this.updateHiddenRanges();\r\n        }\r\n    }\r\n    get onDidChange() { return this._updateEventEmitter.event; }\r\n    get hiddenRanges() { return this._hiddenRanges; }\r\n    updateHiddenRanges() {\r\n        let updateHiddenAreas = false;\r\n        let newHiddenAreas = [];\r\n        let i = 0; // index into hidden\r\n        let k = 0;\r\n        let lastCollapsedStart = Number.MAX_VALUE;\r\n        let lastCollapsedEnd = -1;\r\n        let ranges = this._foldingModel.regions;\r\n        for (; i < ranges.length; i++) {\r\n            if (!ranges.isCollapsed(i)) {\r\n                continue;\r\n            }\r\n            let startLineNumber = ranges.getStartLineNumber(i) + 1; // the first line is not hidden\r\n            let endLineNumber = ranges.getEndLineNumber(i);\r\n            if (lastCollapsedStart <= startLineNumber && endLineNumber <= lastCollapsedEnd) {\r\n                // ignore ranges contained in collapsed regions\r\n                continue;\r\n            }\r\n            if (!updateHiddenAreas && k < this._hiddenRanges.length && this._hiddenRanges[k].startLineNumber === startLineNumber && this._hiddenRanges[k].endLineNumber === endLineNumber) {\r\n                // reuse the old ranges\r\n                newHiddenAreas.push(this._hiddenRanges[k]);\r\n                k++;\r\n            }\r\n            else {\r\n                updateHiddenAreas = true;\r\n                newHiddenAreas.push(new Range(startLineNumber, 1, endLineNumber, 1));\r\n            }\r\n            lastCollapsedStart = startLineNumber;\r\n            lastCollapsedEnd = endLineNumber;\r\n        }\r\n        if (updateHiddenAreas || k < this._hiddenRanges.length) {\r\n            this.applyHiddenRanges(newHiddenAreas);\r\n        }\r\n    }\r\n    applyMemento(state) {\r\n        if (!Array.isArray(state) || state.length === 0) {\r\n            return false;\r\n        }\r\n        let hiddenRanges = [];\r\n        for (let r of state) {\r\n            if (!r.startLineNumber || !r.endLineNumber) {\r\n                return false;\r\n            }\r\n            hiddenRanges.push(new Range(r.startLineNumber + 1, 1, r.endLineNumber, 1));\r\n        }\r\n        this.applyHiddenRanges(hiddenRanges);\r\n        return true;\r\n    }\r\n    /**\r\n     * Collapse state memento, for persistence only, only used if folding model is not yet initialized\r\n     */\r\n    getMemento() {\r\n        return this._hiddenRanges.map(r => ({ startLineNumber: r.startLineNumber - 1, endLineNumber: r.endLineNumber }));\r\n    }\r\n    applyHiddenRanges(newHiddenAreas) {\r\n        this._hiddenRanges = newHiddenAreas;\r\n        this._updateEventEmitter.fire(newHiddenAreas);\r\n    }\r\n    hasRanges() {\r\n        return this._hiddenRanges.length > 0;\r\n    }\r\n    isHidden(line) {\r\n        return findRange(this._hiddenRanges, line) !== null;\r\n    }\r\n    adjustSelections(selections) {\r\n        let hasChanges = false;\r\n        let editorModel = this._foldingModel.textModel;\r\n        let lastRange = null;\r\n        let adjustLine = (line) => {\r\n            if (!lastRange || !isInside(line, lastRange)) {\r\n                lastRange = findRange(this._hiddenRanges, line);\r\n            }\r\n            if (lastRange) {\r\n                return lastRange.startLineNumber - 1;\r\n            }\r\n            return null;\r\n        };\r\n        for (let i = 0, len = selections.length; i < len; i++) {\r\n            let selection = selections[i];\r\n            let adjustedStartLine = adjustLine(selection.startLineNumber);\r\n            if (adjustedStartLine) {\r\n                selection = selection.setStartPosition(adjustedStartLine, editorModel.getLineMaxColumn(adjustedStartLine));\r\n                hasChanges = true;\r\n            }\r\n            let adjustedEndLine = adjustLine(selection.endLineNumber);\r\n            if (adjustedEndLine) {\r\n                selection = selection.setEndPosition(adjustedEndLine, editorModel.getLineMaxColumn(adjustedEndLine));\r\n                hasChanges = true;\r\n            }\r\n            selections[i] = selection;\r\n        }\r\n        return hasChanges;\r\n    }\r\n    dispose() {\r\n        if (this.hiddenRanges.length > 0) {\r\n            this._hiddenRanges = [];\r\n            this._updateEventEmitter.fire(this._hiddenRanges);\r\n        }\r\n        if (this._foldingModelListener) {\r\n            this._foldingModelListener.dispose();\r\n            this._foldingModelListener = null;\r\n        }\r\n    }\r\n}\r\nfunction isInside(line, range) {\r\n    return line >= range.startLineNumber && line <= range.endLineNumber;\r\n}\r\nfunction findRange(ranges, line) {\r\n    let i = findFirstInSorted(ranges, r => line < r.startLineNumber) - 1;\r\n    if (i >= 0 && ranges[i].endLineNumber >= line) {\r\n        return ranges[i];\r\n    }\r\n    return null;\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\r\nimport { TextModel } from '../../common/model/textModel.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nconst MAX_FOLDING_REGIONS_FOR_INDENT_LIMIT = 5000;\r\nexport const ID_INDENT_PROVIDER = 'indent';\r\nexport class IndentRangeProvider {\r\n    constructor(editorModel) {\r\n        this.editorModel = editorModel;\r\n        this.id = ID_INDENT_PROVIDER;\r\n    }\r\n    dispose() {\r\n    }\r\n    compute(cancelationToken) {\r\n        let foldingRules = LanguageConfigurationRegistry.getFoldingRules(this.editorModel.getLanguageIdentifier().id);\r\n        let offSide = foldingRules && !!foldingRules.offSide;\r\n        let markers = foldingRules && foldingRules.markers;\r\n        return Promise.resolve(computeRanges(this.editorModel, offSide, markers));\r\n    }\r\n}\r\n// public only for testing\r\nexport class RangesCollector {\r\n    constructor(foldingRangesLimit) {\r\n        this._startIndexes = [];\r\n        this._endIndexes = [];\r\n        this._indentOccurrences = [];\r\n        this._length = 0;\r\n        this._foldingRangesLimit = foldingRangesLimit;\r\n    }\r\n    insertFirst(startLineNumber, endLineNumber, indent) {\r\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\r\n            return;\r\n        }\r\n        let index = this._length;\r\n        this._startIndexes[index] = startLineNumber;\r\n        this._endIndexes[index] = endLineNumber;\r\n        this._length++;\r\n        if (indent < 1000) {\r\n            this._indentOccurrences[indent] = (this._indentOccurrences[indent] || 0) + 1;\r\n        }\r\n    }\r\n    toIndentRanges(model) {\r\n        if (this._length <= this._foldingRangesLimit) {\r\n            // reverse and create arrays of the exact length\r\n            let startIndexes = new Uint32Array(this._length);\r\n            let endIndexes = new Uint32Array(this._length);\r\n            for (let i = this._length - 1, k = 0; i >= 0; i--, k++) {\r\n                startIndexes[k] = this._startIndexes[i];\r\n                endIndexes[k] = this._endIndexes[i];\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes);\r\n        }\r\n        else {\r\n            let entries = 0;\r\n            let maxIndent = this._indentOccurrences.length;\r\n            for (let i = 0; i < this._indentOccurrences.length; i++) {\r\n                let n = this._indentOccurrences[i];\r\n                if (n) {\r\n                    if (n + entries > this._foldingRangesLimit) {\r\n                        maxIndent = i;\r\n                        break;\r\n                    }\r\n                    entries += n;\r\n                }\r\n            }\r\n            const tabSize = model.getOptions().tabSize;\r\n            // reverse and create arrays of the exact length\r\n            let startIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            let endIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            for (let i = this._length - 1, k = 0; i >= 0; i--) {\r\n                let startIndex = this._startIndexes[i];\r\n                let lineContent = model.getLineContent(startIndex);\r\n                let indent = TextModel.computeIndentLevel(lineContent, tabSize);\r\n                if (indent < maxIndent || (indent === maxIndent && entries++ < this._foldingRangesLimit)) {\r\n                    startIndexes[k] = startIndex;\r\n                    endIndexes[k] = this._endIndexes[i];\r\n                    k++;\r\n                }\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes);\r\n        }\r\n    }\r\n}\r\nexport function computeRanges(model, offSide, markers, foldingRangesLimit = MAX_FOLDING_REGIONS_FOR_INDENT_LIMIT) {\r\n    const tabSize = model.getOptions().tabSize;\r\n    let result = new RangesCollector(foldingRangesLimit);\r\n    let pattern = undefined;\r\n    if (markers) {\r\n        pattern = new RegExp(`(${markers.start.source})|(?:${markers.end.source})`);\r\n    }\r\n    let previousRegions = [];\r\n    let line = model.getLineCount() + 1;\r\n    previousRegions.push({ indent: -1, endAbove: line, line }); // sentinel, to make sure there's at least one entry\r\n    for (let line = model.getLineCount(); line > 0; line--) {\r\n        let lineContent = model.getLineContent(line);\r\n        let indent = TextModel.computeIndentLevel(lineContent, tabSize);\r\n        let previous = previousRegions[previousRegions.length - 1];\r\n        if (indent === -1) {\r\n            if (offSide) {\r\n                // for offSide languages, empty lines are associated to the previous block\r\n                // note: the next block is already written to the results, so this only\r\n                // impacts the end position of the block before\r\n                previous.endAbove = line;\r\n            }\r\n            continue; // only whitespace\r\n        }\r\n        let m;\r\n        if (pattern && (m = lineContent.match(pattern))) {\r\n            // folding pattern match\r\n            if (m[1]) { // start pattern match\r\n                // discard all regions until the folding pattern\r\n                let i = previousRegions.length - 1;\r\n                while (i > 0 && previousRegions[i].indent !== -2) {\r\n                    i--;\r\n                }\r\n                if (i > 0) {\r\n                    previousRegions.length = i + 1;\r\n                    previous = previousRegions[i];\r\n                    // new folding range from pattern, includes the end line\r\n                    result.insertFirst(line, previous.line, indent);\r\n                    previous.line = line;\r\n                    previous.indent = indent;\r\n                    previous.endAbove = line;\r\n                    continue;\r\n                }\r\n                else {\r\n                    // no end marker found, treat line as a regular line\r\n                }\r\n            }\r\n            else { // end pattern match\r\n                previousRegions.push({ indent: -2, endAbove: line, line });\r\n                continue;\r\n            }\r\n        }\r\n        if (previous.indent > indent) {\r\n            // discard all regions with larger indent\r\n            do {\r\n                previousRegions.pop();\r\n                previous = previousRegions[previousRegions.length - 1];\r\n            } while (previous.indent > indent);\r\n            // new folding range\r\n            let endLineNumber = previous.endAbove - 1;\r\n            if (endLineNumber - line >= 1) { // needs at east size 1\r\n                result.insertFirst(line, endLineNumber, indent);\r\n            }\r\n        }\r\n        if (previous.indent === indent) {\r\n            previous.endAbove = line;\r\n        }\r\n        else { // previous.indent < indent\r\n            // new region with a bigger indent\r\n            previousRegions.push({ indent, endAbove: line, line });\r\n        }\r\n    }\r\n    return result.toIndentRanges(model);\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { MAX_LINE_NUMBER, FoldingRegions } from './foldingRanges.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nconst MAX_FOLDING_REGIONS = 5000;\r\nconst foldingContext = {};\r\nexport const ID_SYNTAX_PROVIDER = 'syntax';\r\nexport class SyntaxRangeProvider {\r\n    constructor(editorModel, providers, handleFoldingRangesChange, limit = MAX_FOLDING_REGIONS) {\r\n        this.editorModel = editorModel;\r\n        this.providers = providers;\r\n        this.limit = limit;\r\n        this.id = ID_SYNTAX_PROVIDER;\r\n        for (const provider of providers) {\r\n            if (typeof provider.onDidChange === 'function') {\r\n                if (!this.disposables) {\r\n                    this.disposables = new DisposableStore();\r\n                }\r\n                this.disposables.add(provider.onDidChange(handleFoldingRangesChange));\r\n            }\r\n        }\r\n    }\r\n    compute(cancellationToken) {\r\n        return collectSyntaxRanges(this.providers, this.editorModel, cancellationToken).then(ranges => {\r\n            if (ranges) {\r\n                let res = sanitizeRanges(ranges, this.limit);\r\n                return res;\r\n            }\r\n            return null;\r\n        });\r\n    }\r\n    dispose() {\r\n        var _a;\r\n        (_a = this.disposables) === null || _a === void 0 ? void 0 : _a.dispose();\r\n    }\r\n}\r\nfunction collectSyntaxRanges(providers, model, cancellationToken) {\r\n    let rangeData = null;\r\n    let promises = providers.map((provider, i) => {\r\n        return Promise.resolve(provider.provideFoldingRanges(model, foldingContext, cancellationToken)).then(ranges => {\r\n            if (cancellationToken.isCancellationRequested) {\r\n                return;\r\n            }\r\n            if (Array.isArray(ranges)) {\r\n                if (!Array.isArray(rangeData)) {\r\n                    rangeData = [];\r\n                }\r\n                let nLines = model.getLineCount();\r\n                for (let r of ranges) {\r\n                    if (r.start > 0 && r.end > r.start && r.end <= nLines) {\r\n                        rangeData.push({ start: r.start, end: r.end, rank: i, kind: r.kind });\r\n                    }\r\n                }\r\n            }\r\n        }, onUnexpectedExternalError);\r\n    });\r\n    return Promise.all(promises).then(_ => {\r\n        return rangeData;\r\n    });\r\n}\r\nexport class RangesCollector {\r\n    constructor(foldingRangesLimit) {\r\n        this._startIndexes = [];\r\n        this._endIndexes = [];\r\n        this._nestingLevels = [];\r\n        this._nestingLevelCounts = [];\r\n        this._types = [];\r\n        this._length = 0;\r\n        this._foldingRangesLimit = foldingRangesLimit;\r\n    }\r\n    add(startLineNumber, endLineNumber, type, nestingLevel) {\r\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\r\n            return;\r\n        }\r\n        let index = this._length;\r\n        this._startIndexes[index] = startLineNumber;\r\n        this._endIndexes[index] = endLineNumber;\r\n        this._nestingLevels[index] = nestingLevel;\r\n        this._types[index] = type;\r\n        this._length++;\r\n        if (nestingLevel < 30) {\r\n            this._nestingLevelCounts[nestingLevel] = (this._nestingLevelCounts[nestingLevel] || 0) + 1;\r\n        }\r\n    }\r\n    toIndentRanges() {\r\n        if (this._length <= this._foldingRangesLimit) {\r\n            let startIndexes = new Uint32Array(this._length);\r\n            let endIndexes = new Uint32Array(this._length);\r\n            for (let i = 0; i < this._length; i++) {\r\n                startIndexes[i] = this._startIndexes[i];\r\n                endIndexes[i] = this._endIndexes[i];\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes, this._types);\r\n        }\r\n        else {\r\n            let entries = 0;\r\n            let maxLevel = this._nestingLevelCounts.length;\r\n            for (let i = 0; i < this._nestingLevelCounts.length; i++) {\r\n                let n = this._nestingLevelCounts[i];\r\n                if (n) {\r\n                    if (n + entries > this._foldingRangesLimit) {\r\n                        maxLevel = i;\r\n                        break;\r\n                    }\r\n                    entries += n;\r\n                }\r\n            }\r\n            let startIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            let endIndexes = new Uint32Array(this._foldingRangesLimit);\r\n            let types = [];\r\n            for (let i = 0, k = 0; i < this._length; i++) {\r\n                let level = this._nestingLevels[i];\r\n                if (level < maxLevel || (level === maxLevel && entries++ < this._foldingRangesLimit)) {\r\n                    startIndexes[k] = this._startIndexes[i];\r\n                    endIndexes[k] = this._endIndexes[i];\r\n                    types[k] = this._types[i];\r\n                    k++;\r\n                }\r\n            }\r\n            return new FoldingRegions(startIndexes, endIndexes, types);\r\n        }\r\n    }\r\n}\r\nexport function sanitizeRanges(rangeData, limit) {\r\n    let sorted = rangeData.sort((d1, d2) => {\r\n        let diff = d1.start - d2.start;\r\n        if (diff === 0) {\r\n            diff = d1.rank - d2.rank;\r\n        }\r\n        return diff;\r\n    });\r\n    let collector = new RangesCollector(limit);\r\n    let top = undefined;\r\n    let previous = [];\r\n    for (let entry of sorted) {\r\n        if (!top) {\r\n            top = entry;\r\n            collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\r\n        }\r\n        else {\r\n            if (entry.start > top.start) {\r\n                if (entry.end <= top.end) {\r\n                    previous.push(top);\r\n                    top = entry;\r\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\r\n                }\r\n                else {\r\n                    if (entry.start > top.end) {\r\n                        do {\r\n                            top = previous.pop();\r\n                        } while (top && entry.start > top.end);\r\n                        if (top) {\r\n                            previous.push(top);\r\n                        }\r\n                        top = entry;\r\n                    }\r\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return collector.toIndentRanges();\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { sanitizeRanges } from './syntaxRangeProvider.js';\r\nexport const ID_INIT_PROVIDER = 'init';\r\nexport class InitializingRangeProvider {\r\n    constructor(editorModel, initialRanges, onTimeout, timeoutTime) {\r\n        this.editorModel = editorModel;\r\n        this.id = ID_INIT_PROVIDER;\r\n        if (initialRanges.length) {\r\n            let toDecorationRange = (range) => {\r\n                return {\r\n                    range: {\r\n                        startLineNumber: range.startLineNumber,\r\n                        startColumn: 0,\r\n                        endLineNumber: range.endLineNumber,\r\n                        endColumn: editorModel.getLineLength(range.endLineNumber)\r\n                    },\r\n                    options: {\r\n                        description: 'folding-initializing-range-provider',\r\n                        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */\r\n                    }\r\n                };\r\n            };\r\n            this.decorationIds = editorModel.deltaDecorations([], initialRanges.map(toDecorationRange));\r\n            this.timeout = setTimeout(onTimeout, timeoutTime);\r\n        }\r\n    }\r\n    dispose() {\r\n        if (this.decorationIds) {\r\n            this.editorModel.deltaDecorations(this.decorationIds, []);\r\n            this.decorationIds = undefined;\r\n        }\r\n        if (typeof this.timeout === 'number') {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = undefined;\r\n        }\r\n    }\r\n    compute(cancelationToken) {\r\n        let foldingRangeData = [];\r\n        if (this.decorationIds) {\r\n            for (let id of this.decorationIds) {\r\n                let range = this.editorModel.getDecorationRange(id);\r\n                if (range) {\r\n                    foldingRangeData.push({ start: range.startLineNumber, end: range.endLineNumber, rank: 1 });\r\n                }\r\n            }\r\n        }\r\n        return Promise.resolve(sanitizeRanges(foldingRangeData, Number.MAX_VALUE));\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './folding.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as types from '../../../base/common/types.js';\r\nimport { escapeRegExpCharacters } from '../../../base/common/strings.js';\r\nimport { RunOnceScheduler, Delayer, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, registerInstantiatedEditorAction } from '../../browser/editorExtensions.js';\r\nimport { FoldingModel, setCollapseStateAtLevel, setCollapseStateLevelsDown, setCollapseStateLevelsUp, setCollapseStateForMatchingLines, setCollapseStateForType, setCollapseStateForRest, toggleCollapseState, setCollapseStateUp, getParentFoldLine as getParentFoldLine, getPreviousFoldLine, getNextFoldLine } from './foldingModel.js';\r\nimport { FoldingDecorationProvider, foldingCollapsedIcon, foldingExpandedIcon } from './foldingDecorations.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { HiddenRangeModel } from './hiddenRangeModel.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { IndentRangeProvider } from './indentRangeProvider.js';\r\nimport { FoldingRangeProviderRegistry, FoldingRangeKind } from '../../common/modes.js';\r\nimport { SyntaxRangeProvider, ID_SYNTAX_PROVIDER } from './syntaxRangeProvider.js';\r\nimport { InitializingRangeProvider, ID_INIT_PROVIDER } from './intializingRangeProvider.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerThemingParticipant, ThemeIcon } from '../../../platform/theme/common/themeService.js';\r\nimport { registerColor, editorSelectionBackground, transparent, iconForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { StableEditorScrollState } from '../../browser/core/editorState.js';\r\nconst CONTEXT_FOLDING_ENABLED = new RawContextKey('foldingEnabled', false);\r\nlet FoldingController = class FoldingController extends Disposable {\r\n    constructor(editor, contextKeyService) {\r\n        super();\r\n        this.contextKeyService = contextKeyService;\r\n        this.localToDispose = this._register(new DisposableStore());\r\n        this.editor = editor;\r\n        const options = this.editor.getOptions();\r\n        this._isEnabled = options.get(35 /* folding */);\r\n        this._useFoldingProviders = options.get(36 /* foldingStrategy */) !== 'indentation';\r\n        this._unfoldOnClickAfterEndOfLine = options.get(39 /* unfoldOnClickAfterEndOfLine */);\r\n        this._restoringViewState = false;\r\n        this._currentModelHasFoldedImports = false;\r\n        this._foldingImportsByDefault = options.get(38 /* foldingImportsByDefault */);\r\n        this.foldingModel = null;\r\n        this.hiddenRangeModel = null;\r\n        this.rangeProvider = null;\r\n        this.foldingRegionPromise = null;\r\n        this.foldingStateMemento = null;\r\n        this.foldingModelPromise = null;\r\n        this.updateScheduler = null;\r\n        this.cursorChangedScheduler = null;\r\n        this.mouseDownInfo = null;\r\n        this.foldingDecorationProvider = new FoldingDecorationProvider(editor);\r\n        this.foldingDecorationProvider.autoHideFoldingControls = options.get(98 /* showFoldingControls */) === 'mouseover';\r\n        this.foldingDecorationProvider.showFoldingHighlights = options.get(37 /* foldingHighlight */);\r\n        this.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService);\r\n        this.foldingEnabled.set(this._isEnabled);\r\n        this._register(this.editor.onDidChangeModel(() => this.onModelChanged()));\r\n        this._register(this.editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(35 /* folding */)) {\r\n                this._isEnabled = this.editor.getOptions().get(35 /* folding */);\r\n                this.foldingEnabled.set(this._isEnabled);\r\n                this.onModelChanged();\r\n            }\r\n            if (e.hasChanged(98 /* showFoldingControls */) || e.hasChanged(37 /* foldingHighlight */)) {\r\n                const options = this.editor.getOptions();\r\n                this.foldingDecorationProvider.autoHideFoldingControls = options.get(98 /* showFoldingControls */) === 'mouseover';\r\n                this.foldingDecorationProvider.showFoldingHighlights = options.get(37 /* foldingHighlight */);\r\n                this.onModelContentChanged();\r\n            }\r\n            if (e.hasChanged(36 /* foldingStrategy */)) {\r\n                this._useFoldingProviders = this.editor.getOptions().get(36 /* foldingStrategy */) !== 'indentation';\r\n                this.onFoldingStrategyChanged();\r\n            }\r\n            if (e.hasChanged(39 /* unfoldOnClickAfterEndOfLine */)) {\r\n                this._unfoldOnClickAfterEndOfLine = this.editor.getOptions().get(39 /* unfoldOnClickAfterEndOfLine */);\r\n            }\r\n            if (e.hasChanged(38 /* foldingImportsByDefault */)) {\r\n                this._foldingImportsByDefault = this.editor.getOptions().get(38 /* foldingImportsByDefault */);\r\n            }\r\n        }));\r\n        this.onModelChanged();\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(FoldingController.ID);\r\n    }\r\n    /**\r\n     * Store view state.\r\n     */\r\n    saveViewState() {\r\n        let model = this.editor.getModel();\r\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\r\n            return {};\r\n        }\r\n        if (this.foldingModel) { // disposed ?\r\n            let collapsedRegions = this.foldingModel.isInitialized ? this.foldingModel.getMemento() : this.hiddenRangeModel.getMemento();\r\n            let provider = this.rangeProvider ? this.rangeProvider.id : undefined;\r\n            return { collapsedRegions, lineCount: model.getLineCount(), provider, foldedImports: this._currentModelHasFoldedImports };\r\n        }\r\n        return undefined;\r\n    }\r\n    /**\r\n     * Restore view state.\r\n     */\r\n    restoreViewState(state) {\r\n        let model = this.editor.getModel();\r\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization() || !this.hiddenRangeModel) {\r\n            return;\r\n        }\r\n        if (!state || state.lineCount !== model.getLineCount()) {\r\n            return;\r\n        }\r\n        this._currentModelHasFoldedImports = !!state.foldedImports;\r\n        if (!state.collapsedRegions) {\r\n            return;\r\n        }\r\n        if (state.provider === ID_SYNTAX_PROVIDER || state.provider === ID_INIT_PROVIDER) {\r\n            this.foldingStateMemento = state;\r\n        }\r\n        const collapsedRegions = state.collapsedRegions;\r\n        // set the hidden ranges right away, before waiting for the folding model.\r\n        if (this.hiddenRangeModel.applyMemento(collapsedRegions)) {\r\n            const foldingModel = this.getFoldingModel();\r\n            if (foldingModel) {\r\n                foldingModel.then(foldingModel => {\r\n                    if (foldingModel) {\r\n                        this._restoringViewState = true;\r\n                        try {\r\n                            foldingModel.applyMemento(collapsedRegions);\r\n                        }\r\n                        finally {\r\n                            this._restoringViewState = false;\r\n                        }\r\n                    }\r\n                }).then(undefined, onUnexpectedError);\r\n            }\r\n        }\r\n    }\r\n    onModelChanged() {\r\n        this.localToDispose.clear();\r\n        let model = this.editor.getModel();\r\n        if (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\r\n            // huge files get no view model, so they cannot support hidden areas\r\n            return;\r\n        }\r\n        this._currentModelHasFoldedImports = false;\r\n        this.foldingModel = new FoldingModel(model, this.foldingDecorationProvider);\r\n        this.localToDispose.add(this.foldingModel);\r\n        this.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\r\n        this.localToDispose.add(this.hiddenRangeModel);\r\n        this.localToDispose.add(this.hiddenRangeModel.onDidChange(hr => this.onHiddenRangesChanges(hr)));\r\n        this.updateScheduler = new Delayer(200);\r\n        this.cursorChangedScheduler = new RunOnceScheduler(() => this.revealCursor(), 200);\r\n        this.localToDispose.add(this.cursorChangedScheduler);\r\n        this.localToDispose.add(FoldingRangeProviderRegistry.onDidChange(() => this.onFoldingStrategyChanged()));\r\n        this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(() => this.onFoldingStrategyChanged())); // covers model language changes as well\r\n        this.localToDispose.add(this.editor.onDidChangeModelContent(() => this.onModelContentChanged()));\r\n        this.localToDispose.add(this.editor.onDidChangeCursorPosition(() => this.onCursorPositionChanged()));\r\n        this.localToDispose.add(this.editor.onMouseDown(e => this.onEditorMouseDown(e)));\r\n        this.localToDispose.add(this.editor.onMouseUp(e => this.onEditorMouseUp(e)));\r\n        this.localToDispose.add({\r\n            dispose: () => {\r\n                if (this.foldingRegionPromise) {\r\n                    this.foldingRegionPromise.cancel();\r\n                    this.foldingRegionPromise = null;\r\n                }\r\n                if (this.updateScheduler) {\r\n                    this.updateScheduler.cancel();\r\n                }\r\n                this.updateScheduler = null;\r\n                this.foldingModel = null;\r\n                this.foldingModelPromise = null;\r\n                this.hiddenRangeModel = null;\r\n                this.cursorChangedScheduler = null;\r\n                this.foldingStateMemento = null;\r\n                if (this.rangeProvider) {\r\n                    this.rangeProvider.dispose();\r\n                }\r\n                this.rangeProvider = null;\r\n            }\r\n        });\r\n        this.onModelContentChanged();\r\n    }\r\n    onFoldingStrategyChanged() {\r\n        if (this.rangeProvider) {\r\n            this.rangeProvider.dispose();\r\n        }\r\n        this.rangeProvider = null;\r\n        this.onModelContentChanged();\r\n    }\r\n    getRangeProvider(editorModel) {\r\n        if (this.rangeProvider) {\r\n            return this.rangeProvider;\r\n        }\r\n        this.rangeProvider = new IndentRangeProvider(editorModel); // fallback\r\n        if (this._useFoldingProviders && this.foldingModel) {\r\n            let foldingProviders = FoldingRangeProviderRegistry.ordered(this.foldingModel.textModel);\r\n            if (foldingProviders.length === 0 && this.foldingStateMemento && this.foldingStateMemento.collapsedRegions) {\r\n                const rangeProvider = this.rangeProvider = new InitializingRangeProvider(editorModel, this.foldingStateMemento.collapsedRegions, () => {\r\n                    // if after 30 the InitializingRangeProvider is still not replaced, force a refresh\r\n                    this.foldingStateMemento = null;\r\n                    this.onFoldingStrategyChanged();\r\n                }, 30000);\r\n                return rangeProvider; // keep memento in case there are still no foldingProviders on the next request.\r\n            }\r\n            else if (foldingProviders.length > 0) {\r\n                this.rangeProvider = new SyntaxRangeProvider(editorModel, foldingProviders, () => this.onModelContentChanged());\r\n            }\r\n        }\r\n        this.foldingStateMemento = null;\r\n        return this.rangeProvider;\r\n    }\r\n    getFoldingModel() {\r\n        return this.foldingModelPromise;\r\n    }\r\n    onModelContentChanged() {\r\n        if (this.updateScheduler) {\r\n            if (this.foldingRegionPromise) {\r\n                this.foldingRegionPromise.cancel();\r\n                this.foldingRegionPromise = null;\r\n            }\r\n            this.foldingModelPromise = this.updateScheduler.trigger(() => {\r\n                const foldingModel = this.foldingModel;\r\n                if (!foldingModel) { // null if editor has been disposed, or folding turned off\r\n                    return null;\r\n                }\r\n                const provider = this.getRangeProvider(foldingModel.textModel);\r\n                let foldingRegionPromise = this.foldingRegionPromise = createCancelablePromise(token => provider.compute(token));\r\n                return foldingRegionPromise.then(foldingRanges => {\r\n                    if (foldingRanges && foldingRegionPromise === this.foldingRegionPromise) { // new request or cancelled in the meantime?\r\n                        let scrollState;\r\n                        if (this._foldingImportsByDefault && !this._currentModelHasFoldedImports) {\r\n                            const hasChanges = foldingRanges.setCollapsedAllOfType(FoldingRangeKind.Imports.value, true);\r\n                            if (hasChanges) {\r\n                                scrollState = StableEditorScrollState.capture(this.editor);\r\n                                this._currentModelHasFoldedImports = hasChanges;\r\n                            }\r\n                        }\r\n                        // some cursors might have moved into hidden regions, make sure they are in expanded regions\r\n                        let selections = this.editor.getSelections();\r\n                        let selectionLineNumbers = selections ? selections.map(s => s.startLineNumber) : [];\r\n                        foldingModel.update(foldingRanges, selectionLineNumbers);\r\n                        if (scrollState) {\r\n                            scrollState.restore(this.editor);\r\n                        }\r\n                    }\r\n                    return foldingModel;\r\n                });\r\n            }).then(undefined, (err) => {\r\n                onUnexpectedError(err);\r\n                return null;\r\n            });\r\n        }\r\n    }\r\n    onHiddenRangesChanges(hiddenRanges) {\r\n        if (this.hiddenRangeModel && hiddenRanges.length && !this._restoringViewState) {\r\n            let selections = this.editor.getSelections();\r\n            if (selections) {\r\n                if (this.hiddenRangeModel.adjustSelections(selections)) {\r\n                    this.editor.setSelections(selections);\r\n                }\r\n            }\r\n        }\r\n        this.editor.setHiddenAreas(hiddenRanges);\r\n    }\r\n    onCursorPositionChanged() {\r\n        if (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\r\n            this.cursorChangedScheduler.schedule();\r\n        }\r\n    }\r\n    revealCursor() {\r\n        const foldingModel = this.getFoldingModel();\r\n        if (!foldingModel) {\r\n            return;\r\n        }\r\n        foldingModel.then(foldingModel => {\r\n            if (foldingModel) {\r\n                let selections = this.editor.getSelections();\r\n                if (selections && selections.length > 0) {\r\n                    let toToggle = [];\r\n                    for (let selection of selections) {\r\n                        let lineNumber = selection.selectionStartLineNumber;\r\n                        if (this.hiddenRangeModel && this.hiddenRangeModel.isHidden(lineNumber)) {\r\n                            toToggle.push(...foldingModel.getAllRegionsAtLine(lineNumber, r => r.isCollapsed && lineNumber > r.startLineNumber));\r\n                        }\r\n                    }\r\n                    if (toToggle.length) {\r\n                        foldingModel.toggleCollapseState(toToggle);\r\n                        this.reveal(selections[0].getPosition());\r\n                    }\r\n                }\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    }\r\n    onEditorMouseDown(e) {\r\n        this.mouseDownInfo = null;\r\n        if (!this.hiddenRangeModel || !e.target || !e.target.range) {\r\n            return;\r\n        }\r\n        if (!e.event.leftButton && !e.event.middleButton) {\r\n            return;\r\n        }\r\n        const range = e.target.range;\r\n        let iconClicked = false;\r\n        switch (e.target.type) {\r\n            case 4 /* GUTTER_LINE_DECORATIONS */:\r\n                const data = e.target.detail;\r\n                const offsetLeftInGutter = e.target.element.offsetLeft;\r\n                const gutterOffsetX = data.offsetX - offsetLeftInGutter;\r\n                // const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\r\n                // TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\r\n                if (gutterOffsetX < 5) { // the whitespace between the border and the real folding icon border is 5px\r\n                    return;\r\n                }\r\n                iconClicked = true;\r\n                break;\r\n            case 7 /* CONTENT_EMPTY */: {\r\n                if (this._unfoldOnClickAfterEndOfLine && this.hiddenRangeModel.hasRanges()) {\r\n                    const data = e.target.detail;\r\n                    if (!data.isAfterLines) {\r\n                        break;\r\n                    }\r\n                }\r\n                return;\r\n            }\r\n            case 6 /* CONTENT_TEXT */: {\r\n                if (this.hiddenRangeModel.hasRanges()) {\r\n                    let model = this.editor.getModel();\r\n                    if (model && range.startColumn === model.getLineMaxColumn(range.startLineNumber)) {\r\n                        break;\r\n                    }\r\n                }\r\n                return;\r\n            }\r\n            default:\r\n                return;\r\n        }\r\n        this.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked };\r\n    }\r\n    onEditorMouseUp(e) {\r\n        const foldingModel = this.getFoldingModel();\r\n        if (!foldingModel || !this.mouseDownInfo || !e.target) {\r\n            return;\r\n        }\r\n        let lineNumber = this.mouseDownInfo.lineNumber;\r\n        let iconClicked = this.mouseDownInfo.iconClicked;\r\n        let range = e.target.range;\r\n        if (!range || range.startLineNumber !== lineNumber) {\r\n            return;\r\n        }\r\n        if (iconClicked) {\r\n            if (e.target.type !== 4 /* GUTTER_LINE_DECORATIONS */) {\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            let model = this.editor.getModel();\r\n            if (!model || range.startColumn !== model.getLineMaxColumn(lineNumber)) {\r\n                return;\r\n            }\r\n        }\r\n        foldingModel.then(foldingModel => {\r\n            if (foldingModel) {\r\n                let region = foldingModel.getRegionAtLine(lineNumber);\r\n                if (region && region.startLineNumber === lineNumber) {\r\n                    let isCollapsed = region.isCollapsed;\r\n                    if (iconClicked || isCollapsed) {\r\n                        let surrounding = e.event.altKey;\r\n                        let toToggle = [];\r\n                        if (surrounding) {\r\n                            let filter = (otherRegion) => !otherRegion.containedBy(region) && !region.containedBy(otherRegion);\r\n                            let toMaybeToggle = foldingModel.getRegionsInside(null, filter);\r\n                            for (const r of toMaybeToggle) {\r\n                                if (r.isCollapsed) {\r\n                                    toToggle.push(r);\r\n                                }\r\n                            }\r\n                            // if any surrounding regions are folded, unfold those. Otherwise, fold all surrounding\r\n                            if (toToggle.length === 0) {\r\n                                toToggle = toMaybeToggle;\r\n                            }\r\n                        }\r\n                        else {\r\n                            let recursive = e.event.middleButton || e.event.shiftKey;\r\n                            if (recursive) {\r\n                                for (const r of foldingModel.getRegionsInside(region)) {\r\n                                    if (r.isCollapsed === isCollapsed) {\r\n                                        toToggle.push(r);\r\n                                    }\r\n                                }\r\n                            }\r\n                            // when recursive, first only collapse all children. If all are already folded or there are no children, also fold parent.\r\n                            if (isCollapsed || !recursive || toToggle.length === 0) {\r\n                                toToggle.push(region);\r\n                            }\r\n                        }\r\n                        foldingModel.toggleCollapseState(toToggle);\r\n                        this.reveal({ lineNumber, column: 1 });\r\n                    }\r\n                }\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    }\r\n    reveal(position) {\r\n        this.editor.revealPositionInCenterIfOutsideViewport(position, 0 /* Smooth */);\r\n    }\r\n};\r\nFoldingController.ID = 'editor.contrib.folding';\r\nFoldingController = __decorate([\r\n    __param(1, IContextKeyService)\r\n], FoldingController);\r\nexport { FoldingController };\r\nclass FoldingAction extends EditorAction {\r\n    runEditorCommand(accessor, editor, args) {\r\n        let foldingController = FoldingController.get(editor);\r\n        if (!foldingController) {\r\n            return;\r\n        }\r\n        let foldingModelPromise = foldingController.getFoldingModel();\r\n        if (foldingModelPromise) {\r\n            this.reportTelemetry(accessor, editor);\r\n            return foldingModelPromise.then(foldingModel => {\r\n                if (foldingModel) {\r\n                    this.invoke(foldingController, foldingModel, editor, args);\r\n                    const selection = editor.getSelection();\r\n                    if (selection) {\r\n                        foldingController.reveal(selection.getStartPosition());\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n    getSelectedLines(editor) {\r\n        let selections = editor.getSelections();\r\n        return selections ? selections.map(s => s.startLineNumber) : [];\r\n    }\r\n    getLineNumbers(args, editor) {\r\n        if (args && args.selectionLines) {\r\n            return args.selectionLines.map(l => l + 1); // to 0-bases line numbers\r\n        }\r\n        return this.getSelectedLines(editor);\r\n    }\r\n    run(_accessor, _editor) {\r\n    }\r\n}\r\nfunction foldingArgumentsConstraint(args) {\r\n    if (!types.isUndefined(args)) {\r\n        if (!types.isObject(args)) {\r\n            return false;\r\n        }\r\n        const foldingArgs = args;\r\n        if (!types.isUndefined(foldingArgs.levels) && !types.isNumber(foldingArgs.levels)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(foldingArgs.direction) && !types.isString(foldingArgs.direction)) {\r\n            return false;\r\n        }\r\n        if (!types.isUndefined(foldingArgs.selectionLines) && (!types.isArray(foldingArgs.selectionLines) || !foldingArgs.selectionLines.every(types.isNumber))) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nclass UnfoldAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.unfold',\r\n            label: nls.localize('unfoldAction.label', \"Unfold\"),\r\n            alias: 'Unfold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 89 /* US_CLOSE_SQUARE_BRACKET */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 89 /* US_CLOSE_SQUARE_BRACKET */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            description: {\r\n                description: 'Unfold the content in the editor',\r\n                args: [\r\n                    {\r\n                        name: 'Unfold editor argument',\r\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t`,\r\n                        constraint: foldingArgumentsConstraint,\r\n                        schema: {\r\n                            'type': 'object',\r\n                            'properties': {\r\n                                'levels': {\r\n                                    'type': 'number',\r\n                                    'default': 1\r\n                                },\r\n                                'direction': {\r\n                                    'type': 'string',\r\n                                    'enum': ['up', 'down'],\r\n                                    'default': 'down'\r\n                                },\r\n                                'selectionLines': {\r\n                                    'type': 'array',\r\n                                    'items': {\r\n                                        'type': 'number'\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor, args) {\r\n        let levels = args && args.levels || 1;\r\n        let lineNumbers = this.getLineNumbers(args, editor);\r\n        if (args && args.direction === 'up') {\r\n            setCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\r\n        }\r\n        else {\r\n            setCollapseStateLevelsDown(foldingModel, false, levels, lineNumbers);\r\n        }\r\n    }\r\n}\r\nclass UnFoldRecursivelyAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.unfoldRecursively',\r\n            label: nls.localize('unFoldRecursivelyAction.label', \"Unfold Recursively\"),\r\n            alias: 'Unfold Recursively',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 89 /* US_CLOSE_SQUARE_BRACKET */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor, _args) {\r\n        setCollapseStateLevelsDown(foldingModel, false, Number.MAX_VALUE, this.getSelectedLines(editor));\r\n    }\r\n}\r\nclass FoldAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.fold',\r\n            label: nls.localize('foldAction.label', \"Fold\"),\r\n            alias: 'Fold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 87 /* US_OPEN_SQUARE_BRACKET */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 87 /* US_OPEN_SQUARE_BRACKET */\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            description: {\r\n                description: 'Fold the content in the editor',\r\n                args: [\r\n                    {\r\n                        name: 'Fold editor argument',\r\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': The start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t`,\r\n                        constraint: foldingArgumentsConstraint,\r\n                        schema: {\r\n                            'type': 'object',\r\n                            'properties': {\r\n                                'levels': {\r\n                                    'type': 'number',\r\n                                },\r\n                                'direction': {\r\n                                    'type': 'string',\r\n                                    'enum': ['up', 'down'],\r\n                                },\r\n                                'selectionLines': {\r\n                                    'type': 'array',\r\n                                    'items': {\r\n                                        'type': 'number'\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                ]\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor, args) {\r\n        let lineNumbers = this.getLineNumbers(args, editor);\r\n        const levels = args && args.levels;\r\n        const direction = args && args.direction;\r\n        if (typeof levels !== 'number' && typeof direction !== 'string') {\r\n            // fold the region at the location or if already collapsed, the first uncollapsed parent instead.\r\n            setCollapseStateUp(foldingModel, true, lineNumbers);\r\n        }\r\n        else {\r\n            if (direction === 'up') {\r\n                setCollapseStateLevelsUp(foldingModel, true, levels || 1, lineNumbers);\r\n            }\r\n            else {\r\n                setCollapseStateLevelsDown(foldingModel, true, levels || 1, lineNumbers);\r\n            }\r\n        }\r\n    }\r\n}\r\nclass ToggleFoldAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.toggleFold',\r\n            label: nls.localize('toggleFoldAction.label', \"Toggle Fold\"),\r\n            alias: 'Toggle Fold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 42 /* KEY_L */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        let selectedLines = this.getSelectedLines(editor);\r\n        toggleCollapseState(foldingModel, 1, selectedLines);\r\n    }\r\n}\r\nclass FoldRecursivelyAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.foldRecursively',\r\n            label: nls.localize('foldRecursivelyAction.label', \"Fold Recursively\"),\r\n            alias: 'Fold Recursively',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 87 /* US_OPEN_SQUARE_BRACKET */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        let selectedLines = this.getSelectedLines(editor);\r\n        setCollapseStateLevelsDown(foldingModel, true, Number.MAX_VALUE, selectedLines);\r\n    }\r\n}\r\nclass FoldAllBlockCommentsAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.foldAllBlockComments',\r\n            label: nls.localize('foldAllBlockComments.label', \"Fold All Block Comments\"),\r\n            alias: 'Fold All Block Comments',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 85 /* US_SLASH */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        if (foldingModel.regions.hasTypes()) {\r\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Comment.value, true);\r\n        }\r\n        else {\r\n            const editorModel = editor.getModel();\r\n            if (!editorModel) {\r\n                return;\r\n            }\r\n            let comments = LanguageConfigurationRegistry.getComments(editorModel.getLanguageIdentifier().id);\r\n            if (comments && comments.blockCommentStartToken) {\r\n                let regExp = new RegExp('^\\\\s*' + escapeRegExpCharacters(comments.blockCommentStartToken));\r\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\r\n            }\r\n        }\r\n    }\r\n}\r\nclass FoldAllRegionsAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.foldAllMarkerRegions',\r\n            label: nls.localize('foldAllMarkerRegions.label', \"Fold All Regions\"),\r\n            alias: 'Fold All Regions',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 29 /* KEY_8 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        if (foldingModel.regions.hasTypes()) {\r\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, true);\r\n        }\r\n        else {\r\n            const editorModel = editor.getModel();\r\n            if (!editorModel) {\r\n                return;\r\n            }\r\n            let foldingRules = LanguageConfigurationRegistry.getFoldingRules(editorModel.getLanguageIdentifier().id);\r\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\r\n                let regExp = new RegExp(foldingRules.markers.start);\r\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\r\n            }\r\n        }\r\n    }\r\n}\r\nclass UnfoldAllRegionsAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.unfoldAllMarkerRegions',\r\n            label: nls.localize('unfoldAllMarkerRegions.label', \"Unfold All Regions\"),\r\n            alias: 'Unfold All Regions',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 30 /* KEY_9 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        if (foldingModel.regions.hasTypes()) {\r\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, false);\r\n        }\r\n        else {\r\n            const editorModel = editor.getModel();\r\n            if (!editorModel) {\r\n                return;\r\n            }\r\n            let foldingRules = LanguageConfigurationRegistry.getFoldingRules(editorModel.getLanguageIdentifier().id);\r\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\r\n                let regExp = new RegExp(foldingRules.markers.start);\r\n                setCollapseStateForMatchingLines(foldingModel, regExp, false);\r\n            }\r\n        }\r\n    }\r\n}\r\nclass FoldAllRegionsExceptAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.foldAllExcept',\r\n            label: nls.localize('foldAllExcept.label', \"Fold All Regions Except Selected\"),\r\n            alias: 'Fold All Regions Except Selected',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 83 /* US_MINUS */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        let selectedLines = this.getSelectedLines(editor);\r\n        setCollapseStateForRest(foldingModel, true, selectedLines);\r\n    }\r\n}\r\nclass UnfoldAllRegionsExceptAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.unfoldAllExcept',\r\n            label: nls.localize('unfoldAllExcept.label', \"Unfold All Regions Except Selected\"),\r\n            alias: 'Unfold All Regions Except Selected',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 81 /* US_EQUAL */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        let selectedLines = this.getSelectedLines(editor);\r\n        setCollapseStateForRest(foldingModel, false, selectedLines);\r\n    }\r\n}\r\nclass FoldAllAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.foldAll',\r\n            label: nls.localize('foldAllAction.label', \"Fold All\"),\r\n            alias: 'Fold All',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 21 /* KEY_0 */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, _editor) {\r\n        setCollapseStateLevelsDown(foldingModel, true);\r\n    }\r\n}\r\nclass UnfoldAllAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.unfoldAll',\r\n            label: nls.localize('unfoldAllAction.label', \"Unfold All\"),\r\n            alias: 'Unfold All',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 40 /* KEY_J */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, _editor) {\r\n        setCollapseStateLevelsDown(foldingModel, false);\r\n    }\r\n}\r\nclass FoldLevelAction extends FoldingAction {\r\n    getFoldingLevel() {\r\n        return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length));\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        setCollapseStateAtLevel(foldingModel, this.getFoldingLevel(), true, this.getSelectedLines(editor));\r\n    }\r\n}\r\nFoldLevelAction.ID_PREFIX = 'editor.foldLevel';\r\nFoldLevelAction.ID = (level) => FoldLevelAction.ID_PREFIX + level;\r\n/** Action to go to the parent fold of current line */\r\nclass GotoParentFoldAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.gotoParentFold',\r\n            label: nls.localize('gotoParentFold.label', \"Go to Parent Fold\"),\r\n            alias: 'Go to Parent Fold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        let selectedLines = this.getSelectedLines(editor);\r\n        if (selectedLines.length > 0) {\r\n            let startLineNumber = getParentFoldLine(selectedLines[0], foldingModel);\r\n            if (startLineNumber !== null) {\r\n                editor.setSelection({\r\n                    startLineNumber: startLineNumber,\r\n                    startColumn: 1,\r\n                    endLineNumber: startLineNumber,\r\n                    endColumn: 1\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n/** Action to go to the previous fold of current line */\r\nclass GotoPreviousFoldAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.gotoPreviousFold',\r\n            label: nls.localize('gotoPreviousFold.label', \"Go to Previous Fold\"),\r\n            alias: 'Go to Previous Fold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        let selectedLines = this.getSelectedLines(editor);\r\n        if (selectedLines.length > 0) {\r\n            let startLineNumber = getPreviousFoldLine(selectedLines[0], foldingModel);\r\n            if (startLineNumber !== null) {\r\n                editor.setSelection({\r\n                    startLineNumber: startLineNumber,\r\n                    startColumn: 1,\r\n                    endLineNumber: startLineNumber,\r\n                    endColumn: 1\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n/** Action to go to the next fold of current line */\r\nclass GotoNextFoldAction extends FoldingAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.gotoNextFold',\r\n            label: nls.localize('gotoNextFold.label', \"Go to Next Fold\"),\r\n            alias: 'Go to Next Fold',\r\n            precondition: CONTEXT_FOLDING_ENABLED,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    invoke(_foldingController, foldingModel, editor) {\r\n        let selectedLines = this.getSelectedLines(editor);\r\n        if (selectedLines.length > 0) {\r\n            let startLineNumber = getNextFoldLine(selectedLines[0], foldingModel);\r\n            if (startLineNumber !== null) {\r\n                editor.setSelection({\r\n                    startLineNumber: startLineNumber,\r\n                    startColumn: 1,\r\n                    endLineNumber: startLineNumber,\r\n                    endColumn: 1\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\nregisterEditorContribution(FoldingController.ID, FoldingController);\r\nregisterEditorAction(UnfoldAction);\r\nregisterEditorAction(UnFoldRecursivelyAction);\r\nregisterEditorAction(FoldAction);\r\nregisterEditorAction(FoldRecursivelyAction);\r\nregisterEditorAction(FoldAllAction);\r\nregisterEditorAction(UnfoldAllAction);\r\nregisterEditorAction(FoldAllBlockCommentsAction);\r\nregisterEditorAction(FoldAllRegionsAction);\r\nregisterEditorAction(UnfoldAllRegionsAction);\r\nregisterEditorAction(FoldAllRegionsExceptAction);\r\nregisterEditorAction(UnfoldAllRegionsExceptAction);\r\nregisterEditorAction(ToggleFoldAction);\r\nregisterEditorAction(GotoParentFoldAction);\r\nregisterEditorAction(GotoPreviousFoldAction);\r\nregisterEditorAction(GotoNextFoldAction);\r\nfor (let i = 1; i <= 7; i++) {\r\n    registerInstantiatedEditorAction(new FoldLevelAction({\r\n        id: FoldLevelAction.ID(i),\r\n        label: nls.localize('foldLevelAction.label', \"Fold Level {0}\", i),\r\n        alias: `Fold Level ${i}`,\r\n        precondition: CONTEXT_FOLDING_ENABLED,\r\n        kbOpts: {\r\n            kbExpr: EditorContextKeys.editorTextFocus,\r\n            primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | (21 /* KEY_0 */ + i)),\r\n            weight: 100 /* EditorContrib */\r\n        }\r\n    }));\r\n}\r\nexport const foldBackgroundBackground = registerColor('editor.foldBackground', { light: transparent(editorSelectionBackground, 0.3), dark: transparent(editorSelectionBackground, 0.3), hc: null }, nls.localize('foldBackgroundBackground', \"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations.\"), true);\r\nexport const editorFoldForeground = registerColor('editorGutter.foldingControlForeground', { dark: iconForeground, light: iconForeground, hc: iconForeground }, nls.localize('editorGutter.foldingControlForeground', 'Color of the folding control in the editor gutter.'));\r\nregisterThemingParticipant((theme, collector) => {\r\n    const foldBackground = theme.getColor(foldBackgroundBackground);\r\n    if (foldBackground) {\r\n        collector.addRule(`.monaco-editor .folded-background { background-color: ${foldBackground}; }`);\r\n    }\r\n    const editorFoldColor = theme.getColor(editorFoldForeground);\r\n    if (editorFoldColor) {\r\n        collector.addRule(`\n\t\t.monaco-editor .cldr${ThemeIcon.asCSSSelector(foldingExpandedIcon)},\n\t\t.monaco-editor .cldr${ThemeIcon.asCSSSelector(foldingCollapsedIcon)} {\n\t\t\tcolor: ${editorFoldColor} !important;\n\t\t}\n\t\t`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { EditorZoom } from '../../common/config/editorZoom.js';\r\nclass EditorFontZoomIn extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.fontZoomIn',\r\n            label: nls.localize('EditorFontZoomIn.label', \"Editor Font Zoom In\"),\r\n            alias: 'Editor Font Zoom In',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\r\n    }\r\n}\r\nclass EditorFontZoomOut extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.fontZoomOut',\r\n            label: nls.localize('EditorFontZoomOut.label', \"Editor Font Zoom Out\"),\r\n            alias: 'Editor Font Zoom Out',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\r\n    }\r\n}\r\nclass EditorFontZoomReset extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.fontZoomReset',\r\n            label: nls.localize('EditorFontZoomReset.label', \"Editor Font Zoom Reset\"),\r\n            alias: 'Editor Font Zoom Reset',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        EditorZoom.setZoomLevel(0);\r\n    }\r\n}\r\nregisterEditorAction(EditorFontZoomIn);\r\nregisterEditorAction(EditorFontZoomOut);\r\nregisterEditorAction(EditorFontZoomReset);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { DocumentRangeFormattingEditProviderRegistry, OnTypeFormattingEditProviderRegistry } from '../../common/modes.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { getOnTypeFormattingEdits, alertFormattingEdits, formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider } from './format.js';\r\nimport { FormattingEdit } from './formattingEdit.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Progress, IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nlet FormatOnType = class FormatOnType {\r\n    constructor(editor, _workerService) {\r\n        this._workerService = _workerService;\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModel = new DisposableStore();\r\n        this._editor = editor;\r\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\r\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\r\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\r\n        this._callOnDispose.add(OnTypeFormattingEditProviderRegistry.onDidChange(this._update, this));\r\n    }\r\n    dispose() {\r\n        this._callOnDispose.dispose();\r\n        this._callOnModel.dispose();\r\n    }\r\n    _update() {\r\n        // clean up\r\n        this._callOnModel.clear();\r\n        // we are disabled\r\n        if (!this._editor.getOption(46 /* formatOnType */)) {\r\n            return;\r\n        }\r\n        // no model\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        // no support\r\n        const [support] = OnTypeFormattingEditProviderRegistry.ordered(model);\r\n        if (!support || !support.autoFormatTriggerCharacters) {\r\n            return;\r\n        }\r\n        // register typing listeners that will trigger the format\r\n        let triggerChars = new CharacterSet();\r\n        for (let ch of support.autoFormatTriggerCharacters) {\r\n            triggerChars.add(ch.charCodeAt(0));\r\n        }\r\n        this._callOnModel.add(this._editor.onDidType((text) => {\r\n            let lastCharCode = text.charCodeAt(text.length - 1);\r\n            if (triggerChars.has(lastCharCode)) {\r\n                this._trigger(String.fromCharCode(lastCharCode));\r\n            }\r\n        }));\r\n    }\r\n    _trigger(ch) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this._editor.getSelections().length > 1) {\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        const position = this._editor.getPosition();\r\n        let canceled = false;\r\n        // install a listener that checks if edits happens before the\r\n        // position on which we format right now. If so, we won't\r\n        // apply the format edits\r\n        const unbind = this._editor.onDidChangeModelContent((e) => {\r\n            if (e.isFlush) {\r\n                // a model.setValue() was called\r\n                // cancel only once\r\n                canceled = true;\r\n                unbind.dispose();\r\n                return;\r\n            }\r\n            for (let i = 0, len = e.changes.length; i < len; i++) {\r\n                const change = e.changes[i];\r\n                if (change.range.endLineNumber <= position.lineNumber) {\r\n                    // cancel only once\r\n                    canceled = true;\r\n                    unbind.dispose();\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n        getOnTypeFormattingEdits(this._workerService, model, position, ch, model.getFormattingOptions()).then(edits => {\r\n            unbind.dispose();\r\n            if (canceled) {\r\n                return;\r\n            }\r\n            if (isNonEmptyArray(edits)) {\r\n                FormattingEdit.execute(this._editor, edits, true);\r\n                alertFormattingEdits(edits);\r\n            }\r\n        }, (err) => {\r\n            unbind.dispose();\r\n            throw err;\r\n        });\r\n    }\r\n};\r\nFormatOnType.ID = 'editor.contrib.autoFormat';\r\nFormatOnType = __decorate([\r\n    __param(1, IEditorWorkerService)\r\n], FormatOnType);\r\nlet FormatOnPaste = class FormatOnPaste {\r\n    constructor(editor, _instantiationService) {\r\n        this.editor = editor;\r\n        this._instantiationService = _instantiationService;\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModel = new DisposableStore();\r\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\r\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\r\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\r\n        this._callOnDispose.add(DocumentRangeFormattingEditProviderRegistry.onDidChange(this._update, this));\r\n    }\r\n    dispose() {\r\n        this._callOnDispose.dispose();\r\n        this._callOnModel.dispose();\r\n    }\r\n    _update() {\r\n        // clean up\r\n        this._callOnModel.clear();\r\n        // we are disabled\r\n        if (!this.editor.getOption(45 /* formatOnPaste */)) {\r\n            return;\r\n        }\r\n        // no model\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        // no formatter\r\n        if (!DocumentRangeFormattingEditProviderRegistry.has(this.editor.getModel())) {\r\n            return;\r\n        }\r\n        this._callOnModel.add(this.editor.onDidPaste(({ range }) => this._trigger(range)));\r\n    }\r\n    _trigger(range) {\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (this.editor.getSelections().length > 1) {\r\n            return;\r\n        }\r\n        this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, this.editor, range, 2 /* Silent */, Progress.None, CancellationToken.None).catch(onUnexpectedError);\r\n    }\r\n};\r\nFormatOnPaste.ID = 'editor.contrib.formatOnPaste';\r\nFormatOnPaste = __decorate([\r\n    __param(1, IInstantiationService)\r\n], FormatOnPaste);\r\nclass FormatDocumentAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.formatDocument',\r\n            label: nls.localize('formatDocument.label', \"Format Document\"),\r\n            alias: 'Format Document',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor, EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 36 /* KEY_F */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 39 /* KEY_I */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 1.3\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (editor.hasModel()) {\r\n                const instaService = accessor.get(IInstantiationService);\r\n                const progressService = accessor.get(IEditorProgressService);\r\n                yield progressService.showWhile(instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* Explicit */, Progress.None, CancellationToken.None), 250);\r\n            }\r\n        });\r\n    }\r\n}\r\nclass FormatSelectionAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.formatSelection',\r\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\r\n            alias: 'Format Selection',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 36 /* KEY_F */),\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                when: EditorContextKeys.hasNonEmptySelection,\r\n                group: '1_modification',\r\n                order: 1.31\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!editor.hasModel()) {\r\n                return;\r\n            }\r\n            const instaService = accessor.get(IInstantiationService);\r\n            const model = editor.getModel();\r\n            const ranges = editor.getSelections().map(range => {\r\n                return range.isEmpty()\r\n                    ? new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber))\r\n                    : range;\r\n            });\r\n            const progressService = accessor.get(IEditorProgressService);\r\n            yield progressService.showWhile(instaService.invokeFunction(formatDocumentRangesWithSelectedProvider, editor, ranges, 1 /* Explicit */, Progress.None, CancellationToken.None), 250);\r\n        });\r\n    }\r\n}\r\nregisterEditorContribution(FormatOnType.ID, FormatOnType);\r\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste);\r\nregisterEditorAction(FormatDocumentAction);\r\nregisterEditorAction(FormatSelectionAction);\r\n// this is the old format action that does both (format document OR format selection)\r\n// and we keep it here such that existing keybinding configurations etc will still work\r\nCommandsRegistry.registerCommand('editor.action.format', (accessor) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n    if (!editor || !editor.hasModel()) {\r\n        return;\r\n    }\r\n    const commandService = accessor.get(ICommandService);\r\n    if (editor.getSelection().isEmpty()) {\r\n        yield commandService.executeCommand('editor.action.formatDocument');\r\n    }\r\n    else {\r\n        yield commandService.executeCommand('editor.action.formatSelection');\r\n    }\r\n}));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { escapeIcons } from './iconLabels.js';\r\nimport { illegalArgument } from './errors.js';\r\nexport class MarkdownString {\r\n    constructor(value = '', isTrustedOrOptions = false) {\r\n        var _a, _b;\r\n        this.value = value;\r\n        if (typeof this.value !== 'string') {\r\n            throw illegalArgument('value');\r\n        }\r\n        if (typeof isTrustedOrOptions === 'boolean') {\r\n            this.isTrusted = isTrustedOrOptions;\r\n            this.supportThemeIcons = false;\r\n        }\r\n        else {\r\n            this.isTrusted = (_a = isTrustedOrOptions.isTrusted) !== null && _a !== void 0 ? _a : undefined;\r\n            this.supportThemeIcons = (_b = isTrustedOrOptions.supportThemeIcons) !== null && _b !== void 0 ? _b : false;\r\n        }\r\n    }\r\n    appendText(value, newlineStyle = 0 /* Paragraph */) {\r\n        this.value += escapeMarkdownSyntaxTokens(this.supportThemeIcons ? escapeIcons(value) : value)\r\n            .replace(/([ \\t]+)/g, (_match, g1) => '&nbsp;'.repeat(g1.length))\r\n            .replace(/^>/gm, '\\\\>')\r\n            .replace(/\\n/g, newlineStyle === 1 /* Break */ ? '\\\\\\n' : '\\n\\n');\r\n        return this;\r\n    }\r\n    appendMarkdown(value) {\r\n        this.value += value;\r\n        return this;\r\n    }\r\n    appendCodeblock(langId, code) {\r\n        this.value += '\\n```';\r\n        this.value += langId;\r\n        this.value += '\\n';\r\n        this.value += code;\r\n        this.value += '\\n```\\n';\r\n        return this;\r\n    }\r\n}\r\nexport function isEmptyMarkdownString(oneOrMany) {\r\n    if (isMarkdownString(oneOrMany)) {\r\n        return !oneOrMany.value;\r\n    }\r\n    else if (Array.isArray(oneOrMany)) {\r\n        return oneOrMany.every(isEmptyMarkdownString);\r\n    }\r\n    else {\r\n        return true;\r\n    }\r\n}\r\nexport function isMarkdownString(thing) {\r\n    if (thing instanceof MarkdownString) {\r\n        return true;\r\n    }\r\n    else if (thing && typeof thing === 'object') {\r\n        return typeof thing.value === 'string'\r\n            && (typeof thing.isTrusted === 'boolean' || thing.isTrusted === undefined)\r\n            && (typeof thing.supportThemeIcons === 'boolean' || thing.supportThemeIcons === undefined);\r\n    }\r\n    return false;\r\n}\r\nexport function escapeMarkdownSyntaxTokens(text) {\r\n    // escape markdown syntax tokens: http://daringfireball.net/projects/markdown/syntax#backslash\r\n    return text.replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, '\\\\$&');\r\n}\r\nexport function removeMarkdownEscapes(text) {\r\n    if (!text) {\r\n        return text;\r\n    }\r\n    return text.replace(/\\\\([\\\\`*_{}[\\]()#+\\-.!])/g, '$1');\r\n}\r\nexport function parseHrefAndDimensions(href) {\r\n    const dimensions = [];\r\n    const splitted = href.split('|').map(s => s.trim());\r\n    href = splitted[0];\r\n    const parameters = splitted[1];\r\n    if (parameters) {\r\n        const heightFromParams = /height=(\\d+)/.exec(parameters);\r\n        const widthFromParams = /width=(\\d+)/.exec(parameters);\r\n        const height = heightFromParams ? heightFromParams[1] : '';\r\n        const width = widthFromParams ? widthFromParams[1] : '';\r\n        const widthIsFinite = isFinite(parseInt(width));\r\n        const heightIsFinite = isFinite(parseInt(height));\r\n        if (widthIsFinite) {\r\n            dimensions.push(`width=\"${width}\"`);\r\n        }\r\n        if (heightIsFinite) {\r\n            dimensions.push(`height=\"${height}\"`);\r\n        }\r\n    }\r\n    return { href, dimensions };\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { localize } from '../../../nls.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { basename, extUri } from '../../../base/common/resources.js';\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { defaultGenerator } from '../../../base/common/idGenerator.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ResourceMap } from '../../../base/common/map.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nexport class OneReference {\r\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\r\n        this.isProviderFirst = isProviderFirst;\r\n        this.parent = parent;\r\n        this.link = link;\r\n        this._rangeCallback = _rangeCallback;\r\n        this.id = defaultGenerator.nextId();\r\n    }\r\n    get uri() {\r\n        return this.link.uri;\r\n    }\r\n    get range() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._range) !== null && _a !== void 0 ? _a : this.link.targetSelectionRange) !== null && _b !== void 0 ? _b : this.link.range;\r\n    }\r\n    set range(value) {\r\n        this._range = value;\r\n        this._rangeCallback(this);\r\n    }\r\n    get ariaMessage() {\r\n        var _a;\r\n        const preview = (_a = this.parent.getPreview(this)) === null || _a === void 0 ? void 0 : _a.preview(this.range);\r\n        if (!preview) {\r\n            return localize('aria.oneReference', \"symbol in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\r\n        }\r\n        else {\r\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"symbol in {0} on line {1} at column {2}, {3}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn, preview.value);\r\n        }\r\n    }\r\n}\r\nexport class FilePreview {\r\n    constructor(_modelReference) {\r\n        this._modelReference = _modelReference;\r\n    }\r\n    dispose() {\r\n        this._modelReference.dispose();\r\n    }\r\n    preview(range, n = 8) {\r\n        const model = this._modelReference.object.textEditorModel;\r\n        if (!model) {\r\n            return undefined;\r\n        }\r\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\r\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\r\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\r\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\r\n        const inside = model.getValueInRange(range);\r\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\r\n        return {\r\n            value: before + inside + after,\r\n            highlight: { start: before.length, end: before.length + inside.length }\r\n        };\r\n    }\r\n}\r\nexport class FileReferences {\r\n    constructor(parent, uri) {\r\n        this.parent = parent;\r\n        this.uri = uri;\r\n        this.children = [];\r\n        this._previews = new ResourceMap();\r\n    }\r\n    dispose() {\r\n        dispose(this._previews.values());\r\n        this._previews.clear();\r\n    }\r\n    getPreview(child) {\r\n        return this._previews.get(child.uri);\r\n    }\r\n    get ariaMessage() {\r\n        const len = this.children.length;\r\n        if (len === 1) {\r\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\r\n        }\r\n        else {\r\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\r\n        }\r\n    }\r\n    resolve(textModelResolverService) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this._previews.size !== 0) {\r\n                return this;\r\n            }\r\n            for (let child of this.children) {\r\n                if (this._previews.has(child.uri)) {\r\n                    continue;\r\n                }\r\n                try {\r\n                    const ref = yield textModelResolverService.createModelReference(child.uri);\r\n                    this._previews.set(child.uri, new FilePreview(ref));\r\n                }\r\n                catch (err) {\r\n                    onUnexpectedError(err);\r\n                }\r\n            }\r\n            return this;\r\n        });\r\n    }\r\n}\r\nexport class ReferencesModel {\r\n    constructor(links, title) {\r\n        this.groups = [];\r\n        this.references = [];\r\n        this._onDidChangeReferenceRange = new Emitter();\r\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\r\n        this._links = links;\r\n        this._title = title;\r\n        // grouping and sorting\r\n        const [providersFirst] = links;\r\n        links.sort(ReferencesModel._compareReferences);\r\n        let current;\r\n        for (let link of links) {\r\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\r\n                // new group\r\n                current = new FileReferences(this, link.uri);\r\n                this.groups.push(current);\r\n            }\r\n            // append, check for equality first!\r\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\r\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\r\n                this.references.push(oneRef);\r\n                current.children.push(oneRef);\r\n            }\r\n        }\r\n    }\r\n    dispose() {\r\n        dispose(this.groups);\r\n        this._onDidChangeReferenceRange.dispose();\r\n        this.groups.length = 0;\r\n    }\r\n    clone() {\r\n        return new ReferencesModel(this._links, this._title);\r\n    }\r\n    get title() {\r\n        return this._title;\r\n    }\r\n    get isEmpty() {\r\n        return this.groups.length === 0;\r\n    }\r\n    get ariaMessage() {\r\n        if (this.isEmpty) {\r\n            return localize('aria.result.0', \"No results found\");\r\n        }\r\n        else if (this.references.length === 1) {\r\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\r\n        }\r\n        else if (this.groups.length === 1) {\r\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\r\n        }\r\n        else {\r\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\r\n        }\r\n    }\r\n    nextOrPreviousReference(reference, next) {\r\n        let { parent } = reference;\r\n        let idx = parent.children.indexOf(reference);\r\n        let childCount = parent.children.length;\r\n        let groupCount = parent.parent.groups.length;\r\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\r\n            // cycling within one file\r\n            if (next) {\r\n                idx = (idx + 1) % childCount;\r\n            }\r\n            else {\r\n                idx = (idx + childCount - 1) % childCount;\r\n            }\r\n            return parent.children[idx];\r\n        }\r\n        idx = parent.parent.groups.indexOf(parent);\r\n        if (next) {\r\n            idx = (idx + 1) % groupCount;\r\n            return parent.parent.groups[idx].children[0];\r\n        }\r\n        else {\r\n            idx = (idx + groupCount - 1) % groupCount;\r\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\r\n        }\r\n    }\r\n    nearestReference(resource, position) {\r\n        const nearest = this.references.map((ref, idx) => {\r\n            return {\r\n                idx,\r\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\r\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\r\n            };\r\n        }).sort((a, b) => {\r\n            if (a.prefixLen > b.prefixLen) {\r\n                return -1;\r\n            }\r\n            else if (a.prefixLen < b.prefixLen) {\r\n                return 1;\r\n            }\r\n            else if (a.offsetDist < b.offsetDist) {\r\n                return -1;\r\n            }\r\n            else if (a.offsetDist > b.offsetDist) {\r\n                return 1;\r\n            }\r\n            else {\r\n                return 0;\r\n            }\r\n        })[0];\r\n        if (nearest) {\r\n            return this.references[nearest.idx];\r\n        }\r\n        return undefined;\r\n    }\r\n    referenceAt(resource, position) {\r\n        for (const ref of this.references) {\r\n            if (ref.uri.toString() === resource.toString()) {\r\n                if (Range.containsPosition(ref.range, position)) {\r\n                    return ref;\r\n                }\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    firstReference() {\r\n        for (const ref of this.references) {\r\n            if (ref.isProviderFirst) {\r\n                return ref;\r\n            }\r\n        }\r\n        return this.references[0];\r\n    }\r\n    static _compareReferences(a, b) {\r\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerModelAndPositionCommand } from '../../browser/editorExtensions.js';\r\nimport { DefinitionProviderRegistry, ImplementationProviderRegistry, TypeDefinitionProviderRegistry, DeclarationProviderRegistry, ReferenceProviderRegistry } from '../../common/modes.js';\r\nimport { ReferencesModel } from './referencesModel.js';\r\nfunction getLocationLinks(model, position, registry, provide) {\r\n    const provider = registry.ordered(model);\r\n    // get results\r\n    const promises = provider.map((provider) => {\r\n        return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\r\n            onUnexpectedExternalError(err);\r\n            return undefined;\r\n        });\r\n    });\r\n    return Promise.all(promises).then(values => {\r\n        const result = [];\r\n        for (let value of values) {\r\n            if (Array.isArray(value)) {\r\n                result.push(...value);\r\n            }\r\n            else if (value) {\r\n                result.push(value);\r\n            }\r\n        }\r\n        return result;\r\n    });\r\n}\r\nexport function getDefinitionsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, DefinitionProviderRegistry, (provider, model, position) => {\r\n        return provider.provideDefinition(model, position, token);\r\n    });\r\n}\r\nexport function getDeclarationsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, DeclarationProviderRegistry, (provider, model, position) => {\r\n        return provider.provideDeclaration(model, position, token);\r\n    });\r\n}\r\nexport function getImplementationsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, ImplementationProviderRegistry, (provider, model, position) => {\r\n        return provider.provideImplementation(model, position, token);\r\n    });\r\n}\r\nexport function getTypeDefinitionsAtPosition(model, position, token) {\r\n    return getLocationLinks(model, position, TypeDefinitionProviderRegistry, (provider, model, position) => {\r\n        return provider.provideTypeDefinition(model, position, token);\r\n    });\r\n}\r\nexport function getReferencesAtPosition(model, position, compact, token) {\r\n    return getLocationLinks(model, position, ReferenceProviderRegistry, (provider, model, position) => __awaiter(this, void 0, void 0, function* () {\r\n        const result = yield provider.provideReferences(model, position, { includeDeclaration: true }, token);\r\n        if (!compact || !result || result.length !== 2) {\r\n            return result;\r\n        }\r\n        const resultWithoutDeclaration = yield provider.provideReferences(model, position, { includeDeclaration: false }, token);\r\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\r\n            return resultWithoutDeclaration;\r\n        }\r\n        return result;\r\n    }));\r\n}\r\n// -- API commands ----\r\nfunction _sortedAndDeduped(callback) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const rawLinks = yield callback();\r\n        const model = new ReferencesModel(rawLinks, '');\r\n        const modelLinks = model.references.map(ref => ref.link);\r\n        model.dispose();\r\n        return modelLinks;\r\n    });\r\n}\r\nregisterModelAndPositionCommand('_executeDefinitionProvider', (model, position) => _sortedAndDeduped(() => getDefinitionsAtPosition(model, position, CancellationToken.None)));\r\nregisterModelAndPositionCommand('_executeDeclarationProvider', (model, position) => _sortedAndDeduped(() => getDeclarationsAtPosition(model, position, CancellationToken.None)));\r\nregisterModelAndPositionCommand('_executeImplementationProvider', (model, position) => _sortedAndDeduped(() => getImplementationsAtPosition(model, position, CancellationToken.None)));\r\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (model, position) => _sortedAndDeduped(() => getTypeDefinitionsAtPosition(model, position, CancellationToken.None)));\r\nregisterModelAndPositionCommand('_executeReferenceProvider', (model, position) => _sortedAndDeduped(() => getReferencesAtPosition(model, position, false, CancellationToken.None)));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { ICodeEditorService } from '../services/codeEditorService.js';\r\nimport { CodeEditorWidget } from './codeEditorWidget.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\r\nlet EmbeddedCodeEditorWidget = class EmbeddedCodeEditorWidget extends CodeEditorWidget {\r\n    constructor(domElement, options, parentEditor, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService) {\r\n        super(domElement, Object.assign(Object.assign({}, parentEditor.getRawOptions()), { overflowWidgetsDomNode: parentEditor.getOverflowWidgetsDomNode() }), {}, instantiationService, codeEditorService, commandService, contextKeyService, themeService, notificationService, accessibilityService);\r\n        this._parentEditor = parentEditor;\r\n        this._overwriteOptions = options;\r\n        // Overwrite parent's options\r\n        super.updateOptions(this._overwriteOptions);\r\n        this._register(parentEditor.onDidChangeConfiguration((e) => this._onParentConfigurationChanged(e)));\r\n    }\r\n    getParentEditor() {\r\n        return this._parentEditor;\r\n    }\r\n    _onParentConfigurationChanged(e) {\r\n        super.updateOptions(this._parentEditor.getRawOptions());\r\n        super.updateOptions(this._overwriteOptions);\r\n    }\r\n    updateOptions(newOptions) {\r\n        objects.mixin(this._overwriteOptions, newOptions, true);\r\n        super.updateOptions(this._overwriteOptions);\r\n    }\r\n};\r\nEmbeddedCodeEditorWidget = __decorate([\r\n    __param(3, IInstantiationService),\r\n    __param(4, ICodeEditorService),\r\n    __param(5, ICommandService),\r\n    __param(6, IContextKeyService),\r\n    __param(7, IThemeService),\r\n    __param(8, INotificationService),\r\n    __param(9, IAccessibilityService)\r\n], EmbeddedCodeEditorWidget);\r\nexport { EmbeddedCodeEditorWidget };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './zoneWidget.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { Sash } from '../../../base/browser/ui/sash/sash.js';\r\nimport { Color, RGBA } from '../../../base/common/color.js';\r\nimport { IdGenerator } from '../../../base/common/idGenerator.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nconst defaultColor = new Color(new RGBA(0, 122, 204));\r\nconst defaultOptions = {\r\n    showArrow: true,\r\n    showFrame: true,\r\n    className: '',\r\n    frameColor: defaultColor,\r\n    arrowColor: defaultColor,\r\n    keepEditorSelection: false\r\n};\r\nconst WIDGET_ID = 'vs.editor.contrib.zoneWidget';\r\nexport class ViewZoneDelegate {\r\n    constructor(domNode, afterLineNumber, afterColumn, heightInLines, onDomNodeTop, onComputedHeight) {\r\n        this.id = ''; // A valid zone id should be greater than 0\r\n        this.domNode = domNode;\r\n        this.afterLineNumber = afterLineNumber;\r\n        this.afterColumn = afterColumn;\r\n        this.heightInLines = heightInLines;\r\n        this._onDomNodeTop = onDomNodeTop;\r\n        this._onComputedHeight = onComputedHeight;\r\n    }\r\n    onDomNodeTop(top) {\r\n        this._onDomNodeTop(top);\r\n    }\r\n    onComputedHeight(height) {\r\n        this._onComputedHeight(height);\r\n    }\r\n}\r\nexport class OverlayWidgetDelegate {\r\n    constructor(id, domNode) {\r\n        this._id = id;\r\n        this._domNode = domNode;\r\n    }\r\n    getId() {\r\n        return this._id;\r\n    }\r\n    getDomNode() {\r\n        return this._domNode;\r\n    }\r\n    getPosition() {\r\n        return null;\r\n    }\r\n}\r\nclass Arrow {\r\n    constructor(_editor) {\r\n        this._editor = _editor;\r\n        this._ruleName = Arrow._IdGenerator.nextId();\r\n        this._decorations = [];\r\n        this._color = null;\r\n        this._height = -1;\r\n        //\r\n    }\r\n    dispose() {\r\n        this.hide();\r\n        dom.removeCSSRulesContainingSelector(this._ruleName);\r\n    }\r\n    set color(value) {\r\n        if (this._color !== value) {\r\n            this._color = value;\r\n            this._updateStyle();\r\n        }\r\n    }\r\n    set height(value) {\r\n        if (this._height !== value) {\r\n            this._height = value;\r\n            this._updateStyle();\r\n        }\r\n    }\r\n    _updateStyle() {\r\n        dom.removeCSSRulesContainingSelector(this._ruleName);\r\n        dom.createCSSRule(`.monaco-editor ${this._ruleName}`, `border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px; margin-left: -${this._height}px; `);\r\n    }\r\n    show(where) {\r\n        this._decorations = this._editor.deltaDecorations(this._decorations, [{ range: Range.fromPositions(where), options: { description: 'zone-widget-arrow', className: this._ruleName, stickiness: 1 /* NeverGrowsWhenTypingAtEdges */ } }]);\r\n    }\r\n    hide() {\r\n        this._editor.deltaDecorations(this._decorations, []);\r\n    }\r\n}\r\nArrow._IdGenerator = new IdGenerator('.arrow-decoration-');\r\nexport class ZoneWidget {\r\n    constructor(editor, options = {}) {\r\n        this._arrow = null;\r\n        this._overlayWidget = null;\r\n        this._resizeSash = null;\r\n        this._positionMarkerId = [];\r\n        this._viewZone = null;\r\n        this._disposables = new DisposableStore();\r\n        this.container = null;\r\n        this._isShowing = false;\r\n        this.editor = editor;\r\n        this.options = objects.deepClone(options);\r\n        objects.mixin(this.options, defaultOptions, false);\r\n        this.domNode = document.createElement('div');\r\n        if (!this.options.isAccessible) {\r\n            this.domNode.setAttribute('aria-hidden', 'true');\r\n            this.domNode.setAttribute('role', 'presentation');\r\n        }\r\n        this._disposables.add(this.editor.onDidLayoutChange((info) => {\r\n            const width = this._getWidth(info);\r\n            this.domNode.style.width = width + 'px';\r\n            this.domNode.style.left = this._getLeft(info) + 'px';\r\n            this._onWidth(width);\r\n        }));\r\n    }\r\n    dispose() {\r\n        if (this._overlayWidget) {\r\n            this.editor.removeOverlayWidget(this._overlayWidget);\r\n            this._overlayWidget = null;\r\n        }\r\n        if (this._viewZone) {\r\n            this.editor.changeViewZones(accessor => {\r\n                if (this._viewZone) {\r\n                    accessor.removeZone(this._viewZone.id);\r\n                }\r\n                this._viewZone = null;\r\n            });\r\n        }\r\n        this.editor.deltaDecorations(this._positionMarkerId, []);\r\n        this._positionMarkerId = [];\r\n        this._disposables.dispose();\r\n    }\r\n    create() {\r\n        this.domNode.classList.add('zone-widget');\r\n        if (this.options.className) {\r\n            this.domNode.classList.add(this.options.className);\r\n        }\r\n        this.container = document.createElement('div');\r\n        this.container.classList.add('zone-widget-container');\r\n        this.domNode.appendChild(this.container);\r\n        if (this.options.showArrow) {\r\n            this._arrow = new Arrow(this.editor);\r\n            this._disposables.add(this._arrow);\r\n        }\r\n        this._fillContainer(this.container);\r\n        this._initSash();\r\n        this._applyStyles();\r\n    }\r\n    style(styles) {\r\n        if (styles.frameColor) {\r\n            this.options.frameColor = styles.frameColor;\r\n        }\r\n        if (styles.arrowColor) {\r\n            this.options.arrowColor = styles.arrowColor;\r\n        }\r\n        this._applyStyles();\r\n    }\r\n    _applyStyles() {\r\n        if (this.container && this.options.frameColor) {\r\n            let frameColor = this.options.frameColor.toString();\r\n            this.container.style.borderTopColor = frameColor;\r\n            this.container.style.borderBottomColor = frameColor;\r\n        }\r\n        if (this._arrow && this.options.arrowColor) {\r\n            let arrowColor = this.options.arrowColor.toString();\r\n            this._arrow.color = arrowColor;\r\n        }\r\n    }\r\n    _getWidth(info) {\r\n        return info.width - info.minimap.minimapWidth - info.verticalScrollbarWidth;\r\n    }\r\n    _getLeft(info) {\r\n        // If minimap is to the left, we move beyond it\r\n        if (info.minimap.minimapWidth > 0 && info.minimap.minimapLeft === 0) {\r\n            return info.minimap.minimapWidth;\r\n        }\r\n        return 0;\r\n    }\r\n    _onViewZoneTop(top) {\r\n        this.domNode.style.top = top + 'px';\r\n    }\r\n    _onViewZoneHeight(height) {\r\n        this.domNode.style.height = `${height}px`;\r\n        if (this.container) {\r\n            let containerHeight = height - this._decoratingElementsHeight();\r\n            this.container.style.height = `${containerHeight}px`;\r\n            const layoutInfo = this.editor.getLayoutInfo();\r\n            this._doLayout(containerHeight, this._getWidth(layoutInfo));\r\n        }\r\n        if (this._resizeSash) {\r\n            this._resizeSash.layout();\r\n        }\r\n    }\r\n    get position() {\r\n        const [id] = this._positionMarkerId;\r\n        if (!id) {\r\n            return undefined;\r\n        }\r\n        const model = this.editor.getModel();\r\n        if (!model) {\r\n            return undefined;\r\n        }\r\n        const range = model.getDecorationRange(id);\r\n        if (!range) {\r\n            return undefined;\r\n        }\r\n        return range.getStartPosition();\r\n    }\r\n    show(rangeOrPos, heightInLines) {\r\n        const range = Range.isIRange(rangeOrPos) ? Range.lift(rangeOrPos) : Range.fromPositions(rangeOrPos);\r\n        this._isShowing = true;\r\n        this._showImpl(range, heightInLines);\r\n        this._isShowing = false;\r\n        this._positionMarkerId = this.editor.deltaDecorations(this._positionMarkerId, [{ range, options: ModelDecorationOptions.EMPTY }]);\r\n    }\r\n    hide() {\r\n        if (this._viewZone) {\r\n            this.editor.changeViewZones(accessor => {\r\n                if (this._viewZone) {\r\n                    accessor.removeZone(this._viewZone.id);\r\n                }\r\n            });\r\n            this._viewZone = null;\r\n        }\r\n        if (this._overlayWidget) {\r\n            this.editor.removeOverlayWidget(this._overlayWidget);\r\n            this._overlayWidget = null;\r\n        }\r\n        if (this._arrow) {\r\n            this._arrow.hide();\r\n        }\r\n    }\r\n    _decoratingElementsHeight() {\r\n        let lineHeight = this.editor.getOption(57 /* lineHeight */);\r\n        let result = 0;\r\n        if (this.options.showArrow) {\r\n            let arrowHeight = Math.round(lineHeight / 3);\r\n            result += 2 * arrowHeight;\r\n        }\r\n        if (this.options.showFrame) {\r\n            let frameThickness = Math.round(lineHeight / 9);\r\n            result += 2 * frameThickness;\r\n        }\r\n        return result;\r\n    }\r\n    _showImpl(where, heightInLines) {\r\n        const position = where.getStartPosition();\r\n        const layoutInfo = this.editor.getLayoutInfo();\r\n        const width = this._getWidth(layoutInfo);\r\n        this.domNode.style.width = `${width}px`;\r\n        this.domNode.style.left = this._getLeft(layoutInfo) + 'px';\r\n        // Render the widget as zone (rendering) and widget (lifecycle)\r\n        const viewZoneDomNode = document.createElement('div');\r\n        viewZoneDomNode.style.overflow = 'hidden';\r\n        const lineHeight = this.editor.getOption(57 /* lineHeight */);\r\n        // adjust heightInLines to viewport\r\n        const maxHeightInLines = Math.max(12, (this.editor.getLayoutInfo().height / lineHeight) * 0.8);\r\n        heightInLines = Math.min(heightInLines, maxHeightInLines);\r\n        let arrowHeight = 0;\r\n        let frameThickness = 0;\r\n        // Render the arrow one 1/3 of an editor line height\r\n        if (this._arrow && this.options.showArrow) {\r\n            arrowHeight = Math.round(lineHeight / 3);\r\n            this._arrow.height = arrowHeight;\r\n            this._arrow.show(position);\r\n        }\r\n        // Render the frame as 1/9 of an editor line height\r\n        if (this.options.showFrame) {\r\n            frameThickness = Math.round(lineHeight / 9);\r\n        }\r\n        // insert zone widget\r\n        this.editor.changeViewZones((accessor) => {\r\n            if (this._viewZone) {\r\n                accessor.removeZone(this._viewZone.id);\r\n            }\r\n            if (this._overlayWidget) {\r\n                this.editor.removeOverlayWidget(this._overlayWidget);\r\n                this._overlayWidget = null;\r\n            }\r\n            this.domNode.style.top = '-1000px';\r\n            this._viewZone = new ViewZoneDelegate(viewZoneDomNode, position.lineNumber, position.column, heightInLines, (top) => this._onViewZoneTop(top), (height) => this._onViewZoneHeight(height));\r\n            this._viewZone.id = accessor.addZone(this._viewZone);\r\n            this._overlayWidget = new OverlayWidgetDelegate(WIDGET_ID + this._viewZone.id, this.domNode);\r\n            this.editor.addOverlayWidget(this._overlayWidget);\r\n        });\r\n        if (this.container && this.options.showFrame) {\r\n            const width = this.options.frameWidth ? this.options.frameWidth : frameThickness;\r\n            this.container.style.borderTopWidth = width + 'px';\r\n            this.container.style.borderBottomWidth = width + 'px';\r\n        }\r\n        let containerHeight = heightInLines * lineHeight - this._decoratingElementsHeight();\r\n        if (this.container) {\r\n            this.container.style.top = arrowHeight + 'px';\r\n            this.container.style.height = containerHeight + 'px';\r\n            this.container.style.overflow = 'hidden';\r\n        }\r\n        this._doLayout(containerHeight, width);\r\n        if (!this.options.keepEditorSelection) {\r\n            this.editor.setSelection(where);\r\n        }\r\n        const model = this.editor.getModel();\r\n        if (model) {\r\n            const revealLine = where.endLineNumber + 1;\r\n            if (revealLine <= model.getLineCount()) {\r\n                // reveal line below the zone widget\r\n                this.revealLine(revealLine, false);\r\n            }\r\n            else {\r\n                // reveal last line atop\r\n                this.revealLine(model.getLineCount(), true);\r\n            }\r\n        }\r\n    }\r\n    revealLine(lineNumber, isLastLine) {\r\n        if (isLastLine) {\r\n            this.editor.revealLineInCenter(lineNumber, 0 /* Smooth */);\r\n        }\r\n        else {\r\n            this.editor.revealLine(lineNumber, 0 /* Smooth */);\r\n        }\r\n    }\r\n    setCssClass(className, classToReplace) {\r\n        if (!this.container) {\r\n            return;\r\n        }\r\n        if (classToReplace) {\r\n            this.container.classList.remove(classToReplace);\r\n        }\r\n        this.container.classList.add(className);\r\n    }\r\n    _onWidth(widthInPixel) {\r\n        // implement in subclass\r\n    }\r\n    _doLayout(heightInPixel, widthInPixel) {\r\n        // implement in subclass\r\n    }\r\n    _relayout(newHeightInLines) {\r\n        if (this._viewZone && this._viewZone.heightInLines !== newHeightInLines) {\r\n            this.editor.changeViewZones(accessor => {\r\n                if (this._viewZone) {\r\n                    this._viewZone.heightInLines = newHeightInLines;\r\n                    accessor.layoutZone(this._viewZone.id);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    // --- sash\r\n    _initSash() {\r\n        if (this._resizeSash) {\r\n            return;\r\n        }\r\n        this._resizeSash = this._disposables.add(new Sash(this.domNode, this, { orientation: 1 /* HORIZONTAL */ }));\r\n        if (!this.options.isResizeable) {\r\n            this._resizeSash.hide();\r\n            this._resizeSash.state = 0 /* Disabled */;\r\n        }\r\n        let data;\r\n        this._disposables.add(this._resizeSash.onDidStart((e) => {\r\n            if (this._viewZone) {\r\n                data = {\r\n                    startY: e.startY,\r\n                    heightInLines: this._viewZone.heightInLines,\r\n                };\r\n            }\r\n        }));\r\n        this._disposables.add(this._resizeSash.onDidEnd(() => {\r\n            data = undefined;\r\n        }));\r\n        this._disposables.add(this._resizeSash.onDidChange((evt) => {\r\n            if (data) {\r\n                let lineDelta = (evt.currentY - data.startY) / this.editor.getOption(57 /* lineHeight */);\r\n                let roundedLineDelta = lineDelta < 0 ? Math.ceil(lineDelta) : Math.floor(lineDelta);\r\n                let newHeightInLines = data.heightInLines + roundedLineDelta;\r\n                if (newHeightInLines > 5 && newHeightInLines < 35) {\r\n                    this._relayout(newHeightInLines);\r\n                }\r\n            }\r\n        }));\r\n    }\r\n    getHorizontalSashLeft() {\r\n        return 0;\r\n    }\r\n    getHorizontalSashTop() {\r\n        return (this.domNode.style.height === null ? 0 : parseInt(this.domNode.style.height)) - (this._decoratingElementsHeight() / 2);\r\n    }\r\n    getHorizontalSashWidth() {\r\n        const layoutInfo = this.editor.getLayoutInfo();\r\n        return layoutInfo.width - layoutInfo.minimap.minimapWidth;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './dropdown.css';\r\nimport { Gesture, EventType as GestureEventType } from '../../touch.js';\r\nimport { ActionRunner } from '../../../common/actions.js';\r\nimport { EventHelper, EventType, append, $, addDisposableListener } from '../../dom.js';\r\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nexport class BaseDropdown extends ActionRunner {\r\n    constructor(container, options) {\r\n        super();\r\n        this._onDidChangeVisibility = new Emitter();\r\n        this.onDidChangeVisibility = this._onDidChangeVisibility.event;\r\n        this._element = append(container, $('.monaco-dropdown'));\r\n        this._label = append(this._element, $('.dropdown-label'));\r\n        let labelRenderer = options.labelRenderer;\r\n        if (!labelRenderer) {\r\n            labelRenderer = (container) => {\r\n                container.textContent = options.label || '';\r\n                return null;\r\n            };\r\n        }\r\n        for (const event of [EventType.CLICK, EventType.MOUSE_DOWN, GestureEventType.Tap]) {\r\n            this._register(addDisposableListener(this.element, event, e => EventHelper.stop(e, true))); // prevent default click behaviour to trigger\r\n        }\r\n        for (const event of [EventType.MOUSE_DOWN, GestureEventType.Tap]) {\r\n            this._register(addDisposableListener(this._label, event, e => {\r\n                if (e instanceof MouseEvent && e.detail > 1) {\r\n                    return; // prevent multiple clicks to open multiple context menus (https://github.com/microsoft/vscode/issues/41363)\r\n                }\r\n                if (this.visible) {\r\n                    this.hide();\r\n                }\r\n                else {\r\n                    this.show();\r\n                }\r\n            }));\r\n        }\r\n        this._register(addDisposableListener(this._label, EventType.KEY_UP, e => {\r\n            const event = new StandardKeyboardEvent(e);\r\n            if (event.equals(3 /* Enter */) || event.equals(10 /* Space */)) {\r\n                EventHelper.stop(e, true); // https://github.com/microsoft/vscode/issues/57997\r\n                if (this.visible) {\r\n                    this.hide();\r\n                }\r\n                else {\r\n                    this.show();\r\n                }\r\n            }\r\n        }));\r\n        const cleanupFn = labelRenderer(this._label);\r\n        if (cleanupFn) {\r\n            this._register(cleanupFn);\r\n        }\r\n        this._register(Gesture.addTarget(this._label));\r\n    }\r\n    get element() {\r\n        return this._element;\r\n    }\r\n    show() {\r\n        if (!this.visible) {\r\n            this.visible = true;\r\n            this._onDidChangeVisibility.fire(true);\r\n        }\r\n    }\r\n    hide() {\r\n        if (this.visible) {\r\n            this.visible = false;\r\n            this._onDidChangeVisibility.fire(false);\r\n        }\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n        this.hide();\r\n        if (this.boxContainer) {\r\n            this.boxContainer.remove();\r\n            this.boxContainer = undefined;\r\n        }\r\n        if (this.contents) {\r\n            this.contents.remove();\r\n            this.contents = undefined;\r\n        }\r\n        if (this._label) {\r\n            this._label.remove();\r\n            this._label = undefined;\r\n        }\r\n    }\r\n}\r\nexport class DropdownMenu extends BaseDropdown {\r\n    constructor(container, options) {\r\n        super(container, options);\r\n        this._actions = [];\r\n        this._contextMenuProvider = options.contextMenuProvider;\r\n        this.actions = options.actions || [];\r\n        this.actionProvider = options.actionProvider;\r\n        this.menuClassName = options.menuClassName || '';\r\n        this.menuAsChild = !!options.menuAsChild;\r\n    }\r\n    set menuOptions(options) {\r\n        this._menuOptions = options;\r\n    }\r\n    get menuOptions() {\r\n        return this._menuOptions;\r\n    }\r\n    get actions() {\r\n        if (this.actionProvider) {\r\n            return this.actionProvider.getActions();\r\n        }\r\n        return this._actions;\r\n    }\r\n    set actions(actions) {\r\n        this._actions = actions;\r\n    }\r\n    show() {\r\n        super.show();\r\n        this.element.classList.add('active');\r\n        this._contextMenuProvider.showContextMenu({\r\n            getAnchor: () => this.element,\r\n            getActions: () => this.actions,\r\n            getActionsContext: () => this.menuOptions ? this.menuOptions.context : null,\r\n            getActionViewItem: action => this.menuOptions && this.menuOptions.actionViewItemProvider ? this.menuOptions.actionViewItemProvider(action) : undefined,\r\n            getKeyBinding: action => this.menuOptions && this.menuOptions.getKeyBinding ? this.menuOptions.getKeyBinding(action) : undefined,\r\n            getMenuClassName: () => this.menuClassName,\r\n            onHide: () => this.onHide(),\r\n            actionRunner: this.menuOptions ? this.menuOptions.actionRunner : undefined,\r\n            anchorAlignment: this.menuOptions ? this.menuOptions.anchorAlignment : 0 /* LEFT */,\r\n            domForShadowRoot: this.menuAsChild ? this.element : undefined\r\n        });\r\n    }\r\n    hide() {\r\n        super.hide();\r\n    }\r\n    onHide() {\r\n        this.hide();\r\n        this.element.classList.remove('active');\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './dropdown.css';\r\nimport { append, $ } from '../../dom.js';\r\nimport { Emitter } from '../../../common/event.js';\r\nimport { BaseActionViewItem } from '../actionbar/actionViewItems.js';\r\nimport { DropdownMenu } from './dropdown.js';\r\nexport class DropdownMenuActionViewItem extends BaseActionViewItem {\r\n    constructor(action, menuActionsOrProvider, contextMenuProvider, options = Object.create(null)) {\r\n        super(null, action, options);\r\n        this.actionItem = null;\r\n        this._onDidChangeVisibility = this._register(new Emitter());\r\n        this.menuActionsOrProvider = menuActionsOrProvider;\r\n        this.contextMenuProvider = contextMenuProvider;\r\n        this.options = options;\r\n        if (this.options.actionRunner) {\r\n            this.actionRunner = this.options.actionRunner;\r\n        }\r\n    }\r\n    render(container) {\r\n        this.actionItem = container;\r\n        const labelRenderer = (el) => {\r\n            this.element = append(el, $('a.action-label'));\r\n            let classNames = [];\r\n            if (typeof this.options.classNames === 'string') {\r\n                classNames = this.options.classNames.split(/\\s+/g).filter(s => !!s);\r\n            }\r\n            else if (this.options.classNames) {\r\n                classNames = this.options.classNames;\r\n            }\r\n            // todo@aeschli: remove codicon, should come through `this.options.classNames`\r\n            if (!classNames.find(c => c === 'icon')) {\r\n                classNames.push('codicon');\r\n            }\r\n            this.element.classList.add(...classNames);\r\n            this.element.setAttribute('role', 'button');\r\n            this.element.setAttribute('aria-haspopup', 'true');\r\n            this.element.setAttribute('aria-expanded', 'false');\r\n            this.element.title = this._action.label || '';\r\n            return null;\r\n        };\r\n        const isActionsArray = Array.isArray(this.menuActionsOrProvider);\r\n        const options = {\r\n            contextMenuProvider: this.contextMenuProvider,\r\n            labelRenderer: labelRenderer,\r\n            menuAsChild: this.options.menuAsChild,\r\n            actions: isActionsArray ? this.menuActionsOrProvider : undefined,\r\n            actionProvider: isActionsArray ? undefined : this.menuActionsOrProvider\r\n        };\r\n        this.dropdownMenu = this._register(new DropdownMenu(container, options));\r\n        this._register(this.dropdownMenu.onDidChangeVisibility(visible => {\r\n            var _a;\r\n            (_a = this.element) === null || _a === void 0 ? void 0 : _a.setAttribute('aria-expanded', `${visible}`);\r\n            this._onDidChangeVisibility.fire(visible);\r\n        }));\r\n        this.dropdownMenu.menuOptions = {\r\n            actionViewItemProvider: this.options.actionViewItemProvider,\r\n            actionRunner: this.actionRunner,\r\n            getKeyBinding: this.options.keybindingProvider,\r\n            context: this._context\r\n        };\r\n        if (this.options.anchorAlignmentProvider) {\r\n            const that = this;\r\n            this.dropdownMenu.menuOptions = Object.assign(Object.assign({}, this.dropdownMenu.menuOptions), { get anchorAlignment() {\r\n                    return that.options.anchorAlignmentProvider();\r\n                } });\r\n        }\r\n        this.updateEnabled();\r\n    }\r\n    setActionContext(newContext) {\r\n        super.setActionContext(newContext);\r\n        if (this.dropdownMenu) {\r\n            if (this.dropdownMenu.menuOptions) {\r\n                this.dropdownMenu.menuOptions.context = newContext;\r\n            }\r\n            else {\r\n                this.dropdownMenu.menuOptions = { context: newContext };\r\n            }\r\n        }\r\n    }\r\n    updateEnabled() {\r\n        var _a, _b;\r\n        const disabled = !this.getAction().enabled;\r\n        (_a = this.actionItem) === null || _a === void 0 ? void 0 : _a.classList.toggle('disabled', disabled);\r\n        (_b = this.element) === null || _b === void 0 ? void 0 : _b.classList.toggle('disabled', disabled);\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport './menuEntryActionViewItem.css';\r\nimport { addDisposableListener, asCSSUrl, ModifierKeyEmitter, append, EventType, $, prepend } from '../../../base/browser/dom.js';\r\nimport { ActionRunner, Separator, SubmenuAction } from '../../../base/common/actions.js';\r\nimport { toDisposable, MutableDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { MenuItemAction, SubmenuItemAction, IMenuService } from '../common/actions.js';\r\nimport { IContextMenuService } from '../../contextview/browser/contextView.js';\r\nimport { IKeybindingService } from '../../keybinding/common/keybinding.js';\r\nimport { UILabelProvider } from '../../../base/common/keybindingLabels.js';\r\nimport { INotificationService } from '../../notification/common/notification.js';\r\nimport { ThemeIcon } from '../../theme/common/themeService.js';\r\nimport { ActionViewItem, BaseActionViewItem } from '../../../base/browser/ui/actionbar/actionViewItems.js';\r\nimport { DropdownMenuActionViewItem } from '../../../base/browser/ui/dropdown/dropdownActionViewItem.js';\r\nimport { isWindows, isLinux, OS } from '../../../base/common/platform.js';\r\nimport { IInstantiationService } from '../../instantiation/common/instantiation.js';\r\nimport { IContextKeyService } from '../../contextkey/common/contextkey.js';\r\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\r\nimport { IStorageService } from '../../storage/common/storage.js';\r\nexport function createAndFillInActionBarActions(menu, options, target, primaryGroup, primaryMaxCount, shouldInlineSubmenu, useSeparatorsInPrimaryActions) {\r\n    const groups = menu.getActions(options);\r\n    const isPrimaryAction = typeof primaryGroup === 'string' ? (actionGroup) => actionGroup === primaryGroup : primaryGroup;\r\n    // Action bars handle alternative actions on their own so the alternative actions should be ignored\r\n    fillInActions(groups, target, false, isPrimaryAction, primaryMaxCount, shouldInlineSubmenu, useSeparatorsInPrimaryActions);\r\n    return asDisposable(groups);\r\n}\r\nfunction asDisposable(groups) {\r\n    const disposables = new DisposableStore();\r\n    for (const [, actions] of groups) {\r\n        for (const action of actions) {\r\n            disposables.add(action);\r\n        }\r\n    }\r\n    return disposables;\r\n}\r\nfunction fillInActions(groups, target, useAlternativeActions, isPrimaryAction = actionGroup => actionGroup === 'navigation', primaryMaxCount = Number.MAX_SAFE_INTEGER, shouldInlineSubmenu = () => false, useSeparatorsInPrimaryActions = false) {\r\n    let primaryBucket;\r\n    let secondaryBucket;\r\n    if (Array.isArray(target)) {\r\n        primaryBucket = target;\r\n        secondaryBucket = target;\r\n    }\r\n    else {\r\n        primaryBucket = target.primary;\r\n        secondaryBucket = target.secondary;\r\n    }\r\n    const submenuInfo = new Set();\r\n    for (const [group, actions] of groups) {\r\n        let target;\r\n        if (isPrimaryAction(group)) {\r\n            target = primaryBucket;\r\n            if (target.length > 0 && useSeparatorsInPrimaryActions) {\r\n                target.push(new Separator());\r\n            }\r\n        }\r\n        else {\r\n            target = secondaryBucket;\r\n            if (target.length > 0) {\r\n                target.push(new Separator());\r\n            }\r\n        }\r\n        for (let action of actions) {\r\n            if (useAlternativeActions) {\r\n                action = action instanceof MenuItemAction && action.alt ? action.alt : action;\r\n            }\r\n            const newLen = target.push(action);\r\n            // keep submenu info for later inlining\r\n            if (action instanceof SubmenuAction) {\r\n                submenuInfo.add({ group, action, index: newLen - 1 });\r\n            }\r\n        }\r\n    }\r\n    // ask the outside if submenu should be inlined or not. only ask when\r\n    // there would be enough space\r\n    for (const { group, action, index } of submenuInfo) {\r\n        const target = isPrimaryAction(group) ? primaryBucket : secondaryBucket;\r\n        // inlining submenus with length 0 or 1 is easy,\r\n        // larger submenus need to be checked with the overall limit\r\n        const submenuActions = action.actions;\r\n        if ((submenuActions.length <= 1 || target.length + submenuActions.length - 2 <= primaryMaxCount) && shouldInlineSubmenu(action, group, target.length)) {\r\n            target.splice(index, 1, ...submenuActions);\r\n        }\r\n    }\r\n    // overflow items from the primary group into the secondary bucket\r\n    if (primaryBucket !== secondaryBucket && primaryBucket.length > primaryMaxCount) {\r\n        const overflow = primaryBucket.splice(primaryMaxCount, primaryBucket.length - primaryMaxCount);\r\n        secondaryBucket.unshift(...overflow, new Separator());\r\n    }\r\n}\r\nlet MenuEntryActionViewItem = class MenuEntryActionViewItem extends ActionViewItem {\r\n    constructor(_action, options, _keybindingService, _notificationService, _contextKeyService) {\r\n        super(undefined, _action, { icon: !!(_action.class || _action.item.icon), label: !_action.class && !_action.item.icon, draggable: options === null || options === void 0 ? void 0 : options.draggable });\r\n        this._keybindingService = _keybindingService;\r\n        this._notificationService = _notificationService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._wantsAltCommand = false;\r\n        this._itemClassDispose = this._register(new MutableDisposable());\r\n        this._altKey = ModifierKeyEmitter.getInstance();\r\n    }\r\n    get _menuItemAction() {\r\n        return this._action;\r\n    }\r\n    get _commandAction() {\r\n        return this._wantsAltCommand && this._menuItemAction.alt || this._menuItemAction;\r\n    }\r\n    onClick(event) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            try {\r\n                yield this.actionRunner.run(this._commandAction, this._context);\r\n            }\r\n            catch (err) {\r\n                this._notificationService.error(err);\r\n            }\r\n        });\r\n    }\r\n    render(container) {\r\n        super.render(container);\r\n        container.classList.add('menu-entry');\r\n        this._updateItemClass(this._menuItemAction.item);\r\n        let mouseOver = false;\r\n        let alternativeKeyDown = this._altKey.keyStatus.altKey || ((isWindows || isLinux) && this._altKey.keyStatus.shiftKey);\r\n        const updateAltState = () => {\r\n            const wantsAltCommand = mouseOver && alternativeKeyDown;\r\n            if (wantsAltCommand !== this._wantsAltCommand) {\r\n                this._wantsAltCommand = wantsAltCommand;\r\n                this.updateLabel();\r\n                this.updateTooltip();\r\n                this.updateClass();\r\n            }\r\n        };\r\n        if (this._menuItemAction.alt) {\r\n            this._register(this._altKey.event(value => {\r\n                alternativeKeyDown = value.altKey || ((isWindows || isLinux) && value.shiftKey);\r\n                updateAltState();\r\n            }));\r\n        }\r\n        this._register(addDisposableListener(container, 'mouseleave', _ => {\r\n            mouseOver = false;\r\n            updateAltState();\r\n        }));\r\n        this._register(addDisposableListener(container, 'mouseenter', _ => {\r\n            mouseOver = true;\r\n            updateAltState();\r\n        }));\r\n    }\r\n    updateLabel() {\r\n        if (this.options.label && this.label) {\r\n            this.label.textContent = this._commandAction.label;\r\n        }\r\n    }\r\n    updateTooltip() {\r\n        if (this.label) {\r\n            const keybinding = this._keybindingService.lookupKeybinding(this._commandAction.id, this._contextKeyService);\r\n            const keybindingLabel = keybinding && keybinding.getLabel();\r\n            const tooltip = this._commandAction.tooltip || this._commandAction.label;\r\n            let title = keybindingLabel\r\n                ? localize('titleAndKb', \"{0} ({1})\", tooltip, keybindingLabel)\r\n                : tooltip;\r\n            if (!this._wantsAltCommand && this._menuItemAction.alt) {\r\n                const altTooltip = this._menuItemAction.alt.tooltip || this._menuItemAction.alt.label;\r\n                const altKeybinding = this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id, this._contextKeyService);\r\n                const altKeybindingLabel = altKeybinding && altKeybinding.getLabel();\r\n                const altTitleSection = altKeybindingLabel\r\n                    ? localize('titleAndKb', \"{0} ({1})\", altTooltip, altKeybindingLabel)\r\n                    : altTooltip;\r\n                title += `\\n[${UILabelProvider.modifierLabels[OS].altKey}] ${altTitleSection}`;\r\n            }\r\n            this.label.title = title;\r\n        }\r\n    }\r\n    updateClass() {\r\n        if (this.options.icon) {\r\n            if (this._commandAction !== this._menuItemAction) {\r\n                if (this._menuItemAction.alt) {\r\n                    this._updateItemClass(this._menuItemAction.alt.item);\r\n                }\r\n            }\r\n            else if (this._menuItemAction.alt) {\r\n                this._updateItemClass(this._menuItemAction.item);\r\n            }\r\n        }\r\n    }\r\n    _updateItemClass(item) {\r\n        var _a;\r\n        this._itemClassDispose.value = undefined;\r\n        const { element, label } = this;\r\n        if (!element || !label) {\r\n            return;\r\n        }\r\n        const icon = this._commandAction.checked && ((_a = item.toggled) === null || _a === void 0 ? void 0 : _a.icon) ? item.toggled.icon : item.icon;\r\n        if (!icon) {\r\n            return;\r\n        }\r\n        if (ThemeIcon.isThemeIcon(icon)) {\r\n            // theme icons\r\n            const iconClasses = ThemeIcon.asClassNameArray(icon);\r\n            label.classList.add(...iconClasses);\r\n            this._itemClassDispose.value = toDisposable(() => {\r\n                label.classList.remove(...iconClasses);\r\n            });\r\n        }\r\n        else {\r\n            // icon path/url\r\n            if (icon.light) {\r\n                label.style.setProperty('--menu-entry-icon-light', asCSSUrl(icon.light));\r\n            }\r\n            if (icon.dark) {\r\n                label.style.setProperty('--menu-entry-icon-dark', asCSSUrl(icon.dark));\r\n            }\r\n            label.classList.add('icon');\r\n            this._itemClassDispose.value = toDisposable(() => {\r\n                label.classList.remove('icon');\r\n                label.style.removeProperty('--menu-entry-icon-light');\r\n                label.style.removeProperty('--menu-entry-icon-dark');\r\n            });\r\n        }\r\n    }\r\n};\r\nMenuEntryActionViewItem = __decorate([\r\n    __param(2, IKeybindingService),\r\n    __param(3, INotificationService),\r\n    __param(4, IContextKeyService)\r\n], MenuEntryActionViewItem);\r\nexport { MenuEntryActionViewItem };\r\nlet SubmenuEntryActionViewItem = class SubmenuEntryActionViewItem extends DropdownMenuActionViewItem {\r\n    constructor(action, contextMenuService) {\r\n        super(action, { getActions: () => action.actions }, contextMenuService, {\r\n            menuAsChild: true,\r\n            classNames: ThemeIcon.isThemeIcon(action.item.icon) ? ThemeIcon.asClassName(action.item.icon) : undefined,\r\n        });\r\n    }\r\n    render(container) {\r\n        super.render(container);\r\n        if (this.element) {\r\n            container.classList.add('menu-entry');\r\n            const { icon } = this._action.item;\r\n            if (icon && !ThemeIcon.isThemeIcon(icon)) {\r\n                this.element.classList.add('icon');\r\n                if (icon.light) {\r\n                    this.element.style.setProperty('--menu-entry-icon-light', asCSSUrl(icon.light));\r\n                }\r\n                if (icon.dark) {\r\n                    this.element.style.setProperty('--menu-entry-icon-dark', asCSSUrl(icon.dark));\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\nSubmenuEntryActionViewItem = __decorate([\r\n    __param(1, IContextMenuService)\r\n], SubmenuEntryActionViewItem);\r\nexport { SubmenuEntryActionViewItem };\r\nlet DropdownWithDefaultActionViewItem = class DropdownWithDefaultActionViewItem extends BaseActionViewItem {\r\n    constructor(submenuAction, _keybindingService, _notificationService, _contextMenuService, _menuService, _instaService, _storageService) {\r\n        super(null, submenuAction);\r\n        this._keybindingService = _keybindingService;\r\n        this._notificationService = _notificationService;\r\n        this._contextMenuService = _contextMenuService;\r\n        this._menuService = _menuService;\r\n        this._instaService = _instaService;\r\n        this._storageService = _storageService;\r\n        this._container = null;\r\n        this._storageKey = `${submenuAction.item.submenu._debugName}_lastActionId`;\r\n        // determine default action\r\n        let defaultAction;\r\n        let defaultActionId = _storageService.get(this._storageKey, 1 /* WORKSPACE */);\r\n        if (defaultActionId) {\r\n            defaultAction = submenuAction.actions.find(a => defaultActionId === a.id);\r\n        }\r\n        if (!defaultAction) {\r\n            defaultAction = submenuAction.actions[0];\r\n        }\r\n        this._defaultAction = this._instaService.createInstance(MenuEntryActionViewItem, defaultAction, undefined);\r\n        this._dropdown = new DropdownMenuActionViewItem(submenuAction, submenuAction.actions, this._contextMenuService, {\r\n            menuAsChild: true,\r\n            classNames: ['codicon', 'codicon-chevron-down']\r\n        });\r\n        this._dropdown.actionRunner.onDidRun((e) => {\r\n            if (e.action instanceof MenuItemAction) {\r\n                this.update(e.action);\r\n            }\r\n        });\r\n    }\r\n    update(lastAction) {\r\n        this._storageService.store(this._storageKey, lastAction.id, 1 /* WORKSPACE */, 0 /* USER */);\r\n        this._defaultAction.dispose();\r\n        this._defaultAction = this._instaService.createInstance(MenuEntryActionViewItem, lastAction, undefined);\r\n        this._defaultAction.actionRunner = new class extends ActionRunner {\r\n            runAction(action, context) {\r\n                return __awaiter(this, void 0, void 0, function* () {\r\n                    yield action.run(undefined);\r\n                });\r\n            }\r\n        }();\r\n        if (this._container) {\r\n            this._defaultAction.render(prepend(this._container, $('.action-container')));\r\n        }\r\n    }\r\n    setActionContext(newContext) {\r\n        super.setActionContext(newContext);\r\n        this._defaultAction.setActionContext(newContext);\r\n        this._dropdown.setActionContext(newContext);\r\n    }\r\n    render(container) {\r\n        this._container = container;\r\n        super.render(this._container);\r\n        this._container.classList.add('monaco-dropdown-with-primary');\r\n        const primaryContainer = $('.action-container');\r\n        this._defaultAction.render(append(this._container, primaryContainer));\r\n        this._register(addDisposableListener(primaryContainer, EventType.KEY_DOWN, (e) => {\r\n            const event = new StandardKeyboardEvent(e);\r\n            if (event.equals(17 /* RightArrow */)) {\r\n                this._defaultAction.element.tabIndex = -1;\r\n                this._dropdown.focus();\r\n                event.stopPropagation();\r\n            }\r\n        }));\r\n        const dropdownContainer = $('.dropdown-action-container');\r\n        this._dropdown.render(append(this._container, dropdownContainer));\r\n        this._register(addDisposableListener(dropdownContainer, EventType.KEY_DOWN, (e) => {\r\n            var _a;\r\n            const event = new StandardKeyboardEvent(e);\r\n            if (event.equals(15 /* LeftArrow */)) {\r\n                this._defaultAction.element.tabIndex = 0;\r\n                this._dropdown.setFocusable(false);\r\n                (_a = this._defaultAction.element) === null || _a === void 0 ? void 0 : _a.focus();\r\n                event.stopPropagation();\r\n            }\r\n        }));\r\n    }\r\n    focus(fromRight) {\r\n        if (fromRight) {\r\n            this._dropdown.focus();\r\n        }\r\n        else {\r\n            this._defaultAction.element.tabIndex = 0;\r\n            this._defaultAction.element.focus();\r\n        }\r\n    }\r\n    blur() {\r\n        this._defaultAction.element.tabIndex = -1;\r\n        this._dropdown.blur();\r\n        this._container.blur();\r\n    }\r\n    setFocusable(focusable) {\r\n        if (focusable) {\r\n            this._defaultAction.element.tabIndex = 0;\r\n        }\r\n        else {\r\n            this._defaultAction.element.tabIndex = -1;\r\n            this._dropdown.setFocusable(false);\r\n        }\r\n    }\r\n    dispose() {\r\n        this._defaultAction.dispose();\r\n        this._dropdown.dispose();\r\n        super.dispose();\r\n    }\r\n};\r\nDropdownWithDefaultActionViewItem = __decorate([\r\n    __param(1, IKeybindingService),\r\n    __param(2, INotificationService),\r\n    __param(3, IContextMenuService),\r\n    __param(4, IMenuService),\r\n    __param(5, IInstantiationService),\r\n    __param(6, IStorageService)\r\n], DropdownWithDefaultActionViewItem);\r\n/**\r\n * Creates action view items for menu actions or submenu actions.\r\n */\r\nexport function createActionViewItem(instaService, action) {\r\n    if (action instanceof MenuItemAction) {\r\n        return instaService.createInstance(MenuEntryActionViewItem, action, undefined);\r\n    }\r\n    else if (action instanceof SubmenuItemAction) {\r\n        const allCodicons = !action.actions.some(a => a instanceof MenuItemAction && a.item.icon && !ThemeIcon.isThemeIcon(a.item.icon));\r\n        if (action.item.rememberDefaultAction && allCodicons) {\r\n            return instaService.createInstance(DropdownWithDefaultActionViewItem, action);\r\n        }\r\n        else {\r\n            return instaService.createInstance(SubmenuEntryActionViewItem, action);\r\n        }\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/peekViewWidget.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { ActionBar } from '../../../base/browser/ui/actionbar/actionbar.js';\r\nimport { Action } from '../../../base/common/actions.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport * as objects from '../../../base/common/objects.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { ZoneWidget } from '../zoneWidget/zoneWidget.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { createDecorator, IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { registerColor, contrastBorder, activeContrastBorder } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nimport { createActionViewItem } from '../../../platform/actions/browser/menuEntryActionViewItem.js';\r\nexport const IPeekViewService = createDecorator('IPeekViewService');\r\nregisterSingleton(IPeekViewService, class {\r\n    constructor() {\r\n        this._widgets = new Map();\r\n    }\r\n    addExclusiveWidget(editor, widget) {\r\n        const existing = this._widgets.get(editor);\r\n        if (existing) {\r\n            existing.listener.dispose();\r\n            existing.widget.dispose();\r\n        }\r\n        const remove = () => {\r\n            const data = this._widgets.get(editor);\r\n            if (data && data.widget === widget) {\r\n                data.listener.dispose();\r\n                this._widgets.delete(editor);\r\n            }\r\n        };\r\n        this._widgets.set(editor, { widget, listener: widget.onDidClose(remove) });\r\n    }\r\n});\r\nexport var PeekContext;\r\n(function (PeekContext) {\r\n    PeekContext.inPeekEditor = new RawContextKey('inReferenceSearchEditor', true, nls.localize('inReferenceSearchEditor', \"Whether the current code editor is embedded inside peek\"));\r\n    PeekContext.notInPeekEditor = PeekContext.inPeekEditor.toNegated();\r\n})(PeekContext || (PeekContext = {}));\r\nlet PeekContextController = class PeekContextController {\r\n    constructor(editor, contextKeyService) {\r\n        if (editor instanceof EmbeddedCodeEditorWidget) {\r\n            PeekContext.inPeekEditor.bindTo(contextKeyService);\r\n        }\r\n    }\r\n    dispose() { }\r\n};\r\nPeekContextController.ID = 'editor.contrib.referenceController';\r\nPeekContextController = __decorate([\r\n    __param(1, IContextKeyService)\r\n], PeekContextController);\r\nregisterEditorContribution(PeekContextController.ID, PeekContextController);\r\nexport function getOuterEditor(accessor) {\r\n    let editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\r\n    if (editor instanceof EmbeddedCodeEditorWidget) {\r\n        return editor.getParentEditor();\r\n    }\r\n    return editor;\r\n}\r\nconst defaultOptions = {\r\n    headerBackgroundColor: Color.white,\r\n    primaryHeadingColor: Color.fromHex('#333333'),\r\n    secondaryHeadingColor: Color.fromHex('#6c6c6cb3')\r\n};\r\nlet PeekViewWidget = class PeekViewWidget extends ZoneWidget {\r\n    constructor(editor, options, instantiationService) {\r\n        super(editor, options);\r\n        this.instantiationService = instantiationService;\r\n        this._onDidClose = new Emitter();\r\n        this.onDidClose = this._onDidClose.event;\r\n        objects.mixin(this.options, defaultOptions, false);\r\n    }\r\n    dispose() {\r\n        if (!this.disposed) {\r\n            this.disposed = true; // prevent consumers who dispose on onDidClose from looping\r\n            super.dispose();\r\n            this._onDidClose.fire(this);\r\n        }\r\n    }\r\n    style(styles) {\r\n        let options = this.options;\r\n        if (styles.headerBackgroundColor) {\r\n            options.headerBackgroundColor = styles.headerBackgroundColor;\r\n        }\r\n        if (styles.primaryHeadingColor) {\r\n            options.primaryHeadingColor = styles.primaryHeadingColor;\r\n        }\r\n        if (styles.secondaryHeadingColor) {\r\n            options.secondaryHeadingColor = styles.secondaryHeadingColor;\r\n        }\r\n        super.style(styles);\r\n    }\r\n    _applyStyles() {\r\n        super._applyStyles();\r\n        let options = this.options;\r\n        if (this._headElement && options.headerBackgroundColor) {\r\n            this._headElement.style.backgroundColor = options.headerBackgroundColor.toString();\r\n        }\r\n        if (this._primaryHeading && options.primaryHeadingColor) {\r\n            this._primaryHeading.style.color = options.primaryHeadingColor.toString();\r\n        }\r\n        if (this._secondaryHeading && options.secondaryHeadingColor) {\r\n            this._secondaryHeading.style.color = options.secondaryHeadingColor.toString();\r\n        }\r\n        if (this._bodyElement && options.frameColor) {\r\n            this._bodyElement.style.borderColor = options.frameColor.toString();\r\n        }\r\n    }\r\n    _fillContainer(container) {\r\n        this.setCssClass('peekview-widget');\r\n        this._headElement = dom.$('.head');\r\n        this._bodyElement = dom.$('.body');\r\n        this._fillHead(this._headElement);\r\n        this._fillBody(this._bodyElement);\r\n        container.appendChild(this._headElement);\r\n        container.appendChild(this._bodyElement);\r\n    }\r\n    _fillHead(container, noCloseAction) {\r\n        const titleElement = dom.$('.peekview-title');\r\n        dom.append(this._headElement, titleElement);\r\n        dom.addStandardDisposableListener(titleElement, 'click', event => this._onTitleClick(event));\r\n        this._fillTitleIcon(titleElement);\r\n        this._primaryHeading = dom.$('span.filename');\r\n        this._secondaryHeading = dom.$('span.dirname');\r\n        this._metaHeading = dom.$('span.meta');\r\n        dom.append(titleElement, this._primaryHeading, this._secondaryHeading, this._metaHeading);\r\n        const actionsContainer = dom.$('.peekview-actions');\r\n        dom.append(this._headElement, actionsContainer);\r\n        const actionBarOptions = this._getActionBarOptions();\r\n        this._actionbarWidget = new ActionBar(actionsContainer, actionBarOptions);\r\n        this._disposables.add(this._actionbarWidget);\r\n        if (!noCloseAction) {\r\n            this._actionbarWidget.push(new Action('peekview.close', nls.localize('label.close', \"Close\"), Codicon.close.classNames, true, () => {\r\n                this.dispose();\r\n                return Promise.resolve();\r\n            }), { label: false, icon: true });\r\n        }\r\n    }\r\n    _fillTitleIcon(container) {\r\n    }\r\n    _getActionBarOptions() {\r\n        return {\r\n            actionViewItemProvider: createActionViewItem.bind(undefined, this.instantiationService),\r\n            orientation: 0 /* HORIZONTAL */\r\n        };\r\n    }\r\n    _onTitleClick(event) {\r\n        // implement me\r\n    }\r\n    setTitle(primaryHeading, secondaryHeading) {\r\n        if (this._primaryHeading && this._secondaryHeading) {\r\n            this._primaryHeading.innerText = primaryHeading;\r\n            this._primaryHeading.setAttribute('title', primaryHeading);\r\n            if (secondaryHeading) {\r\n                this._secondaryHeading.innerText = secondaryHeading;\r\n            }\r\n            else {\r\n                dom.clearNode(this._secondaryHeading);\r\n            }\r\n        }\r\n    }\r\n    setMetaTitle(value) {\r\n        if (this._metaHeading) {\r\n            if (value) {\r\n                this._metaHeading.innerText = value;\r\n                dom.show(this._metaHeading);\r\n            }\r\n            else {\r\n                dom.hide(this._metaHeading);\r\n            }\r\n        }\r\n    }\r\n    _doLayout(heightInPixel, widthInPixel) {\r\n        if (!this._isShowing && heightInPixel < 0) {\r\n            // Looks like the view zone got folded away!\r\n            this.dispose();\r\n            return;\r\n        }\r\n        const headHeight = Math.ceil(this.editor.getOption(57 /* lineHeight */) * 1.2);\r\n        const bodyHeight = Math.round(heightInPixel - (headHeight + 2 /* the border-top/bottom width*/));\r\n        this._doLayoutHead(headHeight, widthInPixel);\r\n        this._doLayoutBody(bodyHeight, widthInPixel);\r\n    }\r\n    _doLayoutHead(heightInPixel, widthInPixel) {\r\n        if (this._headElement) {\r\n            this._headElement.style.height = `${heightInPixel}px`;\r\n            this._headElement.style.lineHeight = this._headElement.style.height;\r\n        }\r\n    }\r\n    _doLayoutBody(heightInPixel, widthInPixel) {\r\n        if (this._bodyElement) {\r\n            this._bodyElement.style.height = `${heightInPixel}px`;\r\n        }\r\n    }\r\n};\r\nPeekViewWidget = __decorate([\r\n    __param(2, IInstantiationService)\r\n], PeekViewWidget);\r\nexport { PeekViewWidget };\r\nexport const peekViewTitleBackground = registerColor('peekViewTitle.background', { dark: '#1E1E1E', light: '#FFFFFF', hc: '#0C141F' }, nls.localize('peekViewTitleBackground', 'Background color of the peek view title area.'));\r\nexport const peekViewTitleForeground = registerColor('peekViewTitleLabel.foreground', { dark: '#FFFFFF', light: '#333333', hc: '#FFFFFF' }, nls.localize('peekViewTitleForeground', 'Color of the peek view title.'));\r\nexport const peekViewTitleInfoForeground = registerColor('peekViewTitleDescription.foreground', { dark: '#ccccccb3', light: '#616161e6', hc: '#FFFFFF99' }, nls.localize('peekViewTitleInfoForeground', 'Color of the peek view title info.'));\r\nexport const peekViewBorder = registerColor('peekView.border', { dark: '#007acc', light: '#007acc', hc: contrastBorder }, nls.localize('peekViewBorder', 'Color of the peek view borders and arrow.'));\r\nexport const peekViewResultsBackground = registerColor('peekViewResult.background', { dark: '#252526', light: '#F3F3F3', hc: Color.black }, nls.localize('peekViewResultsBackground', 'Background color of the peek view result list.'));\r\nexport const peekViewResultsMatchForeground = registerColor('peekViewResult.lineForeground', { dark: '#bbbbbb', light: '#646465', hc: Color.white }, nls.localize('peekViewResultsMatchForeground', 'Foreground color for line nodes in the peek view result list.'));\r\nexport const peekViewResultsFileForeground = registerColor('peekViewResult.fileForeground', { dark: Color.white, light: '#1E1E1E', hc: Color.white }, nls.localize('peekViewResultsFileForeground', 'Foreground color for file nodes in the peek view result list.'));\r\nexport const peekViewResultsSelectionBackground = registerColor('peekViewResult.selectionBackground', { dark: '#3399ff33', light: '#3399ff33', hc: null }, nls.localize('peekViewResultsSelectionBackground', 'Background color of the selected entry in the peek view result list.'));\r\nexport const peekViewResultsSelectionForeground = registerColor('peekViewResult.selectionForeground', { dark: Color.white, light: '#6C6C6C', hc: Color.white }, nls.localize('peekViewResultsSelectionForeground', 'Foreground color of the selected entry in the peek view result list.'));\r\nexport const peekViewEditorBackground = registerColor('peekViewEditor.background', { dark: '#001F33', light: '#F2F8FC', hc: Color.black }, nls.localize('peekViewEditorBackground', 'Background color of the peek view editor.'));\r\nexport const peekViewEditorGutterBackground = registerColor('peekViewEditorGutter.background', { dark: peekViewEditorBackground, light: peekViewEditorBackground, hc: peekViewEditorBackground }, nls.localize('peekViewEditorGutterBackground', 'Background color of the gutter in the peek view editor.'));\r\nexport const peekViewResultsMatchHighlight = registerColor('peekViewResult.matchHighlightBackground', { dark: '#ea5c004d', light: '#ea5c004d', hc: null }, nls.localize('peekViewResultsMatchHighlight', 'Match highlight color in the peek view result list.'));\r\nexport const peekViewEditorMatchHighlight = registerColor('peekViewEditor.matchHighlightBackground', { dark: '#ff8f0099', light: '#f5d802de', hc: null }, nls.localize('peekViewEditorMatchHighlight', 'Match highlight color in the peek view editor.'));\r\nexport const peekViewEditorMatchHighlightBorder = registerColor('peekViewEditor.matchHighlightBorder', { dark: null, light: null, hc: activeContrastBorder }, nls.localize('peekViewEditorMatchHighlightBorder', 'Match highlight border in the peek view editor.'));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { URI } from './uri.js';\r\nimport { Schemas } from './network.js';\r\nimport { isWindows } from './platform.js';\r\nimport { basename } from './resources.js';\r\nimport { hasDriveLetter, isRootOrDriveLetter } from './extpath.js';\r\nexport function getBaseLabel(resource) {\r\n    if (!resource) {\r\n        return undefined;\r\n    }\r\n    if (typeof resource === 'string') {\r\n        resource = URI.file(resource);\r\n    }\r\n    const base = basename(resource) || (resource.scheme === Schemas.file ? resource.fsPath : resource.path) /* can be empty string if '/' is passed in */;\r\n    // convert c: => C:\r\n    if (isWindows && isRootOrDriveLetter(base)) {\r\n        return normalizeDriveLetter(base);\r\n    }\r\n    return base;\r\n}\r\nexport function normalizeDriveLetter(path) {\r\n    if (hasDriveLetter(path)) {\r\n        return path.charAt(0).toUpperCase() + path.slice(1);\r\n    }\r\n    return path;\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { ReferencesModel, FileReferences, OneReference } from '../referencesModel.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { IconLabel } from '../../../../base/browser/ui/iconLabel/iconLabel.js';\r\nimport { CountBadge } from '../../../../base/browser/ui/countBadge/countBadge.js';\r\nimport { ILabelService } from '../../../../platform/label/common/label.js';\r\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\r\nimport { attachBadgeStyler } from '../../../../platform/theme/common/styler.js';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { localize } from '../../../../nls.js';\r\nimport { getBaseLabel } from '../../../../base/common/labels.js';\r\nimport { dirname, basename } from '../../../../base/common/resources.js';\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nimport { FuzzyScore, createMatches } from '../../../../base/common/filters.js';\r\nimport { HighlightedLabel } from '../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\r\nlet DataSource = class DataSource {\r\n    constructor(_resolverService) {\r\n        this._resolverService = _resolverService;\r\n    }\r\n    hasChildren(element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return true;\r\n        }\r\n        if (element instanceof FileReferences) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    getChildren(element) {\r\n        if (element instanceof ReferencesModel) {\r\n            return element.groups;\r\n        }\r\n        if (element instanceof FileReferences) {\r\n            return element.resolve(this._resolverService).then(val => {\r\n                // if (element.failure) {\r\n                // \t// refresh the element on failure so that\r\n                // \t// we can update its rendering\r\n                // \treturn tree.refresh(element).then(() => val.children);\r\n                // }\r\n                return val.children;\r\n            });\r\n        }\r\n        throw new Error('bad tree');\r\n    }\r\n};\r\nDataSource = __decorate([\r\n    __param(0, ITextModelService)\r\n], DataSource);\r\nexport { DataSource };\r\n//#endregion\r\nexport class Delegate {\r\n    getHeight() {\r\n        return 23;\r\n    }\r\n    getTemplateId(element) {\r\n        if (element instanceof FileReferences) {\r\n            return FileReferencesRenderer.id;\r\n        }\r\n        else {\r\n            return OneReferenceRenderer.id;\r\n        }\r\n    }\r\n}\r\nlet StringRepresentationProvider = class StringRepresentationProvider {\r\n    constructor(_keybindingService) {\r\n        this._keybindingService = _keybindingService;\r\n    }\r\n    getKeyboardNavigationLabel(element) {\r\n        var _a;\r\n        if (element instanceof OneReference) {\r\n            const parts = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\r\n            if (parts) {\r\n                return parts.value;\r\n            }\r\n        }\r\n        // FileReferences or unresolved OneReference\r\n        return basename(element.uri);\r\n    }\r\n};\r\nStringRepresentationProvider = __decorate([\r\n    __param(0, IKeybindingService)\r\n], StringRepresentationProvider);\r\nexport { StringRepresentationProvider };\r\nexport class IdentityProvider {\r\n    getId(element) {\r\n        return element instanceof OneReference ? element.id : element.uri;\r\n    }\r\n}\r\n//#region render: File\r\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\r\n    constructor(container, _uriLabel, themeService) {\r\n        super();\r\n        this._uriLabel = _uriLabel;\r\n        const parent = document.createElement('div');\r\n        parent.classList.add('reference-file');\r\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\r\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')));\r\n        this._register(attachBadgeStyler(this.badge, themeService));\r\n        container.appendChild(parent);\r\n    }\r\n    set(element, matches) {\r\n        let parent = dirname(element.uri);\r\n        this.file.setLabel(getBaseLabel(element.uri), this._uriLabel.getUriLabel(parent, { relative: true }), { title: this._uriLabel.getUriLabel(element.uri), matches });\r\n        const len = element.children.length;\r\n        this.badge.setCount(len);\r\n        if (len > 1) {\r\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\r\n        }\r\n        else {\r\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\r\n        }\r\n    }\r\n};\r\nFileReferencesTemplate = __decorate([\r\n    __param(1, ILabelService),\r\n    __param(2, IThemeService)\r\n], FileReferencesTemplate);\r\nlet FileReferencesRenderer = class FileReferencesRenderer {\r\n    constructor(_instantiationService) {\r\n        this._instantiationService = _instantiationService;\r\n        this.templateId = FileReferencesRenderer.id;\r\n    }\r\n    renderTemplate(container) {\r\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\r\n    }\r\n    renderElement(node, index, template) {\r\n        template.set(node.element, createMatches(node.filterData));\r\n    }\r\n    disposeTemplate(templateData) {\r\n        templateData.dispose();\r\n    }\r\n};\r\nFileReferencesRenderer.id = 'FileReferencesRenderer';\r\nFileReferencesRenderer = __decorate([\r\n    __param(0, IInstantiationService)\r\n], FileReferencesRenderer);\r\nexport { FileReferencesRenderer };\r\n//#endregion\r\n//#region render: Reference\r\nclass OneReferenceTemplate {\r\n    constructor(container) {\r\n        this.label = new HighlightedLabel(container, false);\r\n    }\r\n    set(element, score) {\r\n        var _a;\r\n        const preview = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\r\n        if (!preview || !preview.value) {\r\n            // this means we FAILED to resolve the document or the value is the empty string\r\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\r\n        }\r\n        else {\r\n            // render search match as highlight unless\r\n            // we have score, then render the score\r\n            const { value, highlight } = preview;\r\n            if (score && !FuzzyScore.isDefault(score)) {\r\n                this.label.element.classList.toggle('referenceMatch', false);\r\n                this.label.set(value, createMatches(score));\r\n            }\r\n            else {\r\n                this.label.element.classList.toggle('referenceMatch', true);\r\n                this.label.set(value, [highlight]);\r\n            }\r\n        }\r\n    }\r\n}\r\nexport class OneReferenceRenderer {\r\n    constructor() {\r\n        this.templateId = OneReferenceRenderer.id;\r\n    }\r\n    renderTemplate(container) {\r\n        return new OneReferenceTemplate(container);\r\n    }\r\n    renderElement(node, index, templateData) {\r\n        templateData.set(node.element, node.filterData);\r\n    }\r\n    disposeTemplate() {\r\n    }\r\n}\r\nOneReferenceRenderer.id = 'OneReferenceRenderer';\r\n//#endregion\r\nexport class AccessibilityProvider {\r\n    getWidgetAriaLabel() {\r\n        return localize('treeAriaLabel', \"References\");\r\n    }\r\n    getAriaLabel(element) {\r\n        return element.ariaMessage;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport './referencesWidget.css';\r\nimport * as dom from '../../../../base/browser/dom.js';\r\nimport { Color } from '../../../../base/common/color.js';\r\nimport { Emitter, Event } from '../../../../base/common/event.js';\r\nimport { dispose, DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { Schemas } from '../../../../base/common/network.js';\r\nimport { basenameOrAuthority, dirname } from '../../../../base/common/resources.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { ModelDecorationOptions, TextModel } from '../../../common/model/textModel.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, OneReferenceRenderer, StringRepresentationProvider, IdentityProvider } from './referencesTree.js';\r\nimport * as nls from '../../../../nls.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { ILabelService } from '../../../../platform/label/common/label.js';\r\nimport { WorkbenchAsyncDataTree } from '../../../../platform/list/browser/listService.js';\r\nimport { activeContrastBorder } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport * as peekView from '../../peekView/peekView.js';\r\nimport { FileReferences, OneReference } from '../referencesModel.js';\r\nimport { SplitView, Sizing } from '../../../../base/browser/ui/splitview/splitview.js';\r\nimport { IUndoRedoService } from '../../../../platform/undoRedo/common/undoRedo.js';\r\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\r\nclass DecorationsManager {\r\n    constructor(_editor, _model) {\r\n        this._editor = _editor;\r\n        this._model = _model;\r\n        this._decorations = new Map();\r\n        this._decorationIgnoreSet = new Set();\r\n        this._callOnDispose = new DisposableStore();\r\n        this._callOnModelChange = new DisposableStore();\r\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\r\n        this._onModelChanged();\r\n    }\r\n    dispose() {\r\n        this._callOnModelChange.dispose();\r\n        this._callOnDispose.dispose();\r\n        this.removeDecorations();\r\n    }\r\n    _onModelChanged() {\r\n        this._callOnModelChange.clear();\r\n        const model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        for (let ref of this._model.references) {\r\n            if (ref.uri.toString() === model.uri.toString()) {\r\n                this._addDecorations(ref.parent);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n    _addDecorations(reference) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\r\n        const newDecorations = [];\r\n        const newDecorationsActualIndex = [];\r\n        for (let i = 0, len = reference.children.length; i < len; i++) {\r\n            let oneReference = reference.children[i];\r\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\r\n                continue;\r\n            }\r\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\r\n                continue;\r\n            }\r\n            newDecorations.push({\r\n                range: oneReference.range,\r\n                options: DecorationsManager.DecorationOptions\r\n            });\r\n            newDecorationsActualIndex.push(i);\r\n        }\r\n        const decorations = this._editor.deltaDecorations([], newDecorations);\r\n        for (let i = 0; i < decorations.length; i++) {\r\n            this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\r\n        }\r\n    }\r\n    _onDecorationChanged() {\r\n        const toRemove = [];\r\n        const model = this._editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        for (let [decorationId, reference] of this._decorations) {\r\n            const newRange = model.getDecorationRange(decorationId);\r\n            if (!newRange) {\r\n                continue;\r\n            }\r\n            let ignore = false;\r\n            if (Range.equalsRange(newRange, reference.range)) {\r\n                continue;\r\n            }\r\n            if (Range.spansMultipleLines(newRange)) {\r\n                ignore = true;\r\n            }\r\n            else {\r\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\r\n                const newLineLength = newRange.endColumn - newRange.startColumn;\r\n                if (lineLength !== newLineLength) {\r\n                    ignore = true;\r\n                }\r\n            }\r\n            if (ignore) {\r\n                this._decorationIgnoreSet.add(reference.id);\r\n                toRemove.push(decorationId);\r\n            }\r\n            else {\r\n                reference.range = newRange;\r\n            }\r\n        }\r\n        for (let i = 0, len = toRemove.length; i < len; i++) {\r\n            this._decorations.delete(toRemove[i]);\r\n        }\r\n        this._editor.deltaDecorations(toRemove, []);\r\n    }\r\n    removeDecorations() {\r\n        this._editor.deltaDecorations([...this._decorations.keys()], []);\r\n        this._decorations.clear();\r\n    }\r\n}\r\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\r\n    description: 'reference-decoration',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'reference-decoration'\r\n});\r\nexport class LayoutData {\r\n    constructor() {\r\n        this.ratio = 0.7;\r\n        this.heightInLines = 18;\r\n    }\r\n    static fromJSON(raw) {\r\n        let ratio;\r\n        let heightInLines;\r\n        try {\r\n            const data = JSON.parse(raw);\r\n            ratio = data.ratio;\r\n            heightInLines = data.heightInLines;\r\n        }\r\n        catch (_a) {\r\n            //\r\n        }\r\n        return {\r\n            ratio: ratio || 0.7,\r\n            heightInLines: heightInLines || 18\r\n        };\r\n    }\r\n}\r\nclass ReferencesTree extends WorkbenchAsyncDataTree {\r\n}\r\n/**\r\n * ZoneWidget that is shown inside the editor\r\n */\r\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\r\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService) {\r\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true }, _instantiationService);\r\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\r\n        this.layoutData = layoutData;\r\n        this._textModelResolverService = _textModelResolverService;\r\n        this._instantiationService = _instantiationService;\r\n        this._peekViewService = _peekViewService;\r\n        this._uriLabel = _uriLabel;\r\n        this._undoRedoService = _undoRedoService;\r\n        this._keybindingService = _keybindingService;\r\n        this._disposeOnNewModel = new DisposableStore();\r\n        this._callOnDispose = new DisposableStore();\r\n        this._onDidSelectReference = new Emitter();\r\n        this.onDidSelectReference = this._onDidSelectReference.event;\r\n        this._dim = new dom.Dimension(0, 0);\r\n        this._applyTheme(themeService.getColorTheme());\r\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\r\n        this._peekViewService.addExclusiveWidget(editor, this);\r\n        this.create();\r\n    }\r\n    dispose() {\r\n        this.setModel(undefined);\r\n        this._callOnDispose.dispose();\r\n        this._disposeOnNewModel.dispose();\r\n        dispose(this._preview);\r\n        dispose(this._previewNotAvailableMessage);\r\n        dispose(this._tree);\r\n        dispose(this._previewModelReference);\r\n        this._splitView.dispose();\r\n        super.dispose();\r\n    }\r\n    _applyTheme(theme) {\r\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\r\n        this.style({\r\n            arrowColor: borderColor,\r\n            frameColor: borderColor,\r\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\r\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\r\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\r\n        });\r\n    }\r\n    show(where) {\r\n        this.editor.revealRangeInCenterIfOutsideViewport(where, 0 /* Smooth */);\r\n        super.show(where, this.layoutData.heightInLines || 18);\r\n    }\r\n    focusOnReferenceTree() {\r\n        this._tree.domFocus();\r\n    }\r\n    focusOnPreviewEditor() {\r\n        this._preview.focus();\r\n    }\r\n    isPreviewEditorFocused() {\r\n        return this._preview.hasTextFocus();\r\n    }\r\n    _onTitleClick(e) {\r\n        if (this._preview && this._preview.getModel()) {\r\n            this._onDidSelectReference.fire({\r\n                element: this._getFocusedReference(),\r\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\r\n                source: 'title'\r\n            });\r\n        }\r\n    }\r\n    _fillBody(containerElement) {\r\n        this.setCssClass('reference-zone-widget');\r\n        // message pane\r\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\r\n        dom.hide(this._messageContainer);\r\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* HORIZONTAL */ });\r\n        // editor\r\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\r\n        let options = {\r\n            scrollBeyondLastLine: false,\r\n            scrollbar: {\r\n                verticalScrollbarSize: 14,\r\n                horizontal: 'auto',\r\n                useShadows: true,\r\n                verticalHasArrows: false,\r\n                horizontalHasArrows: false,\r\n                alwaysConsumeMouseWheel: false\r\n            },\r\n            overviewRulerLanes: 2,\r\n            fixedOverflowWidgets: true,\r\n            minimap: {\r\n                enabled: false\r\n            }\r\n        };\r\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\r\n        dom.hide(this._previewContainer);\r\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), TextModel.DEFAULT_CREATION_OPTIONS, null, null, this._undoRedoService);\r\n        // tree\r\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\r\n        const treeOptions = {\r\n            keyboardSupport: this._defaultTreeKeyboardSupport,\r\n            accessibilityProvider: new AccessibilityProvider(),\r\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\r\n            identityProvider: new IdentityProvider(),\r\n            openOnSingleClick: true,\r\n            selectionNavigation: true,\r\n            overrideStyles: {\r\n                listBackground: peekView.peekViewResultsBackground\r\n            }\r\n        };\r\n        if (this._defaultTreeKeyboardSupport) {\r\n            // the tree will consume `Escape` and prevent the widget from closing\r\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\r\n                if (e.equals(9 /* Escape */)) {\r\n                    this._keybindingService.dispatchEvent(e, e.target);\r\n                    e.stopPropagation();\r\n                }\r\n            }, true));\r\n        }\r\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\r\n            this._instantiationService.createInstance(FileReferencesRenderer),\r\n            this._instantiationService.createInstance(OneReferenceRenderer),\r\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\r\n        // split stuff\r\n        this._splitView.addView({\r\n            onDidChange: Event.None,\r\n            element: this._previewContainer,\r\n            minimumSize: 200,\r\n            maximumSize: Number.MAX_VALUE,\r\n            layout: (width) => {\r\n                this._preview.layout({ height: this._dim.height, width });\r\n            }\r\n        }, Sizing.Distribute);\r\n        this._splitView.addView({\r\n            onDidChange: Event.None,\r\n            element: this._treeContainer,\r\n            minimumSize: 100,\r\n            maximumSize: Number.MAX_VALUE,\r\n            layout: (width) => {\r\n                this._treeContainer.style.height = `${this._dim.height}px`;\r\n                this._treeContainer.style.width = `${width}px`;\r\n                this._tree.layout(this._dim.height, width);\r\n            }\r\n        }, Sizing.Distribute);\r\n        this._disposables.add(this._splitView.onDidSashChange(() => {\r\n            if (this._dim.width) {\r\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\r\n            }\r\n        }, undefined));\r\n        // listen on selection and focus\r\n        let onEvent = (element, kind) => {\r\n            if (element instanceof OneReference) {\r\n                if (kind === 'show') {\r\n                    this._revealReference(element, false);\r\n                }\r\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\r\n            }\r\n        };\r\n        this._tree.onDidOpen(e => {\r\n            if (e.sideBySide) {\r\n                onEvent(e.element, 'side');\r\n            }\r\n            else if (e.editorOptions.pinned) {\r\n                onEvent(e.element, 'goto');\r\n            }\r\n            else {\r\n                onEvent(e.element, 'show');\r\n            }\r\n        });\r\n        dom.hide(this._treeContainer);\r\n    }\r\n    _onWidth(width) {\r\n        if (this._dim) {\r\n            this._doLayoutBody(this._dim.height, width);\r\n        }\r\n    }\r\n    _doLayoutBody(heightInPixel, widthInPixel) {\r\n        super._doLayoutBody(heightInPixel, widthInPixel);\r\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\r\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\r\n        this._splitView.layout(widthInPixel);\r\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\r\n    }\r\n    setSelection(selection) {\r\n        return this._revealReference(selection, true).then(() => {\r\n            if (!this._model) {\r\n                // disposed\r\n                return;\r\n            }\r\n            // show in tree\r\n            this._tree.setSelection([selection]);\r\n            this._tree.setFocus([selection]);\r\n        });\r\n    }\r\n    setModel(newModel) {\r\n        // clean up\r\n        this._disposeOnNewModel.clear();\r\n        this._model = newModel;\r\n        if (this._model) {\r\n            return this._onNewModel();\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    _onNewModel() {\r\n        if (!this._model) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        if (this._model.isEmpty) {\r\n            this.setTitle('');\r\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\r\n            dom.show(this._messageContainer);\r\n            return Promise.resolve(undefined);\r\n        }\r\n        dom.hide(this._messageContainer);\r\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\r\n        this._disposeOnNewModel.add(this._decorationsManager);\r\n        // listen on model changes\r\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\r\n        // listen on editor\r\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\r\n            const { event, target } = e;\r\n            if (event.detail !== 2) {\r\n                return;\r\n            }\r\n            const element = this._getFocusedReference();\r\n            if (!element) {\r\n                return;\r\n            }\r\n            this._onDidSelectReference.fire({\r\n                element: { uri: element.uri, range: target.range },\r\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\r\n                source: 'editor'\r\n            });\r\n        }));\r\n        // make sure things are rendered\r\n        this.container.classList.add('results-loaded');\r\n        dom.show(this._treeContainer);\r\n        dom.show(this._previewContainer);\r\n        this._splitView.layout(this._dim.width);\r\n        this.focusOnReferenceTree();\r\n        // pick input and a reference to begin with\r\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\r\n    }\r\n    _getFocusedReference() {\r\n        const [element] = this._tree.getFocus();\r\n        if (element instanceof OneReference) {\r\n            return element;\r\n        }\r\n        else if (element instanceof FileReferences) {\r\n            if (element.children.length > 0) {\r\n                return element.children[0];\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    revealReference(reference) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            yield this._revealReference(reference, false);\r\n            this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\r\n        });\r\n    }\r\n    _revealReference(reference, revealParent) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            // check if there is anything to do...\r\n            if (this._revealedReference === reference) {\r\n                return;\r\n            }\r\n            this._revealedReference = reference;\r\n            // Update widget header\r\n            if (reference.uri.scheme !== Schemas.inMemory) {\r\n                this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\r\n            }\r\n            else {\r\n                this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\r\n            }\r\n            const promise = this._textModelResolverService.createModelReference(reference.uri);\r\n            if (this._tree.getInput() === reference.parent) {\r\n                this._tree.reveal(reference);\r\n            }\r\n            else {\r\n                if (revealParent) {\r\n                    this._tree.reveal(reference.parent);\r\n                }\r\n                yield this._tree.expand(reference.parent);\r\n                this._tree.reveal(reference);\r\n            }\r\n            const ref = yield promise;\r\n            if (!this._model) {\r\n                // disposed\r\n                ref.dispose();\r\n                return;\r\n            }\r\n            dispose(this._previewModelReference);\r\n            // show in editor\r\n            const model = ref.object;\r\n            if (model) {\r\n                const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* Smooth */ : 1 /* Immediate */;\r\n                const sel = Range.lift(reference.range).collapseToStart();\r\n                this._previewModelReference = ref;\r\n                this._preview.setModel(model.textEditorModel);\r\n                this._preview.setSelection(sel);\r\n                this._preview.revealRangeInCenter(sel, scrollType);\r\n            }\r\n            else {\r\n                this._preview.setModel(this._previewNotAvailableMessage);\r\n                ref.dispose();\r\n            }\r\n        });\r\n    }\r\n};\r\nReferenceWidget = __decorate([\r\n    __param(3, IThemeService),\r\n    __param(4, ITextModelService),\r\n    __param(5, IInstantiationService),\r\n    __param(6, peekView.IPeekViewService),\r\n    __param(7, ILabelService),\r\n    __param(8, IUndoRedoService),\r\n    __param(9, IKeybindingService)\r\n], ReferenceWidget);\r\nexport { ReferenceWidget };\r\n// theming\r\nregisterThemingParticipant((theme, collector) => {\r\n    const findMatchHighlightColor = theme.getColor(peekView.peekViewResultsMatchHighlight);\r\n    if (findMatchHighlightColor) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: ${findMatchHighlightColor}; }`);\r\n    }\r\n    const referenceHighlightColor = theme.getColor(peekView.peekViewEditorMatchHighlight);\r\n    if (referenceHighlightColor) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: ${referenceHighlightColor}; }`);\r\n    }\r\n    const referenceHighlightBorder = theme.getColor(peekView.peekViewEditorMatchHighlightBorder);\r\n    if (referenceHighlightBorder) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid ${referenceHighlightBorder}; box-sizing: border-box; }`);\r\n    }\r\n    const hcOutline = theme.getColor(activeContrastBorder);\r\n    if (hcOutline) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted ${hcOutline}; box-sizing: border-box; }`);\r\n    }\r\n    const resultsBackground = theme.getColor(peekView.peekViewResultsBackground);\r\n    if (resultsBackground) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree { background-color: ${resultsBackground}; }`);\r\n    }\r\n    const resultsMatchForeground = theme.getColor(peekView.peekViewResultsMatchForeground);\r\n    if (resultsMatchForeground) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree { color: ${resultsMatchForeground}; }`);\r\n    }\r\n    const resultsFileForeground = theme.getColor(peekView.peekViewResultsFileForeground);\r\n    if (resultsFileForeground) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .reference-file { color: ${resultsFileForeground}; }`);\r\n    }\r\n    const resultsSelectedBackground = theme.getColor(peekView.peekViewResultsSelectionBackground);\r\n    if (resultsSelectedBackground) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: ${resultsSelectedBackground}; }`);\r\n    }\r\n    const resultsSelectedForeground = theme.getColor(peekView.peekViewResultsSelectionForeground);\r\n    if (resultsSelectedForeground) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: ${resultsSelectedForeground} !important; }`);\r\n    }\r\n    const editorBackground = theme.getColor(peekView.peekViewEditorBackground);\r\n    if (editorBackground) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,` +\r\n            `.monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {` +\r\n            `\tbackground-color: ${editorBackground};` +\r\n            `}`);\r\n    }\r\n    const editorGutterBackground = theme.getColor(peekView.peekViewEditorGutterBackground);\r\n    if (editorGutterBackground) {\r\n        collector.addRule(`.monaco-editor .reference-zone-widget .preview .monaco-editor .margin {` +\r\n            `\tbackground-color: ${editorGutterBackground};` +\r\n            `}`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as nls from '../../../../nls.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\r\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\r\nimport { IContextKeyService, RawContextKey, ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\r\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\r\nimport { IStorageService } from '../../../../platform/storage/common/storage.js';\r\nimport { OneReference } from '../referencesModel.js';\r\nimport { ReferenceWidget, LayoutData } from './referencesWidget.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\r\nimport { createCancelablePromise } from '../../../../base/common/async.js';\r\nimport { getOuterEditor, PeekContext } from '../../peekView/peekView.js';\r\nimport { IListService, WorkbenchListFocusContextKey } from '../../../../platform/list/browser/listService.js';\r\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\r\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\r\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\r\nlet ReferencesController = class ReferencesController {\r\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\r\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\r\n        this._editor = _editor;\r\n        this._editorService = _editorService;\r\n        this._notificationService = _notificationService;\r\n        this._instantiationService = _instantiationService;\r\n        this._storageService = _storageService;\r\n        this._configurationService = _configurationService;\r\n        this._disposables = new DisposableStore();\r\n        this._requestIdPool = 0;\r\n        this._ignoreModelChangeEvent = false;\r\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(ReferencesController.ID);\r\n    }\r\n    dispose() {\r\n        var _a, _b;\r\n        this._referenceSearchVisible.reset();\r\n        this._disposables.dispose();\r\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\r\n        this._widget = undefined;\r\n        this._model = undefined;\r\n    }\r\n    toggleWidget(range, modelPromise, peekMode) {\r\n        // close current widget and return early is position didn't change\r\n        let widgetPosition;\r\n        if (this._widget) {\r\n            widgetPosition = this._widget.position;\r\n        }\r\n        this.closeWidget();\r\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\r\n            return;\r\n        }\r\n        this._peekMode = peekMode;\r\n        this._referenceSearchVisible.set(true);\r\n        // close the widget on model/mode changes\r\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\r\n        this._disposables.add(this._editor.onDidChangeModel(() => {\r\n            if (!this._ignoreModelChangeEvent) {\r\n                this.closeWidget();\r\n            }\r\n        }));\r\n        const storageKey = 'peekViewLayout';\r\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* GLOBAL */, '{}'));\r\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\r\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\r\n        this._widget.show(range);\r\n        this._disposables.add(this._widget.onDidClose(() => {\r\n            modelPromise.cancel();\r\n            if (this._widget) {\r\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* GLOBAL */, 1 /* MACHINE */);\r\n                this._widget = undefined;\r\n            }\r\n            this.closeWidget();\r\n        }));\r\n        this._disposables.add(this._widget.onDidSelectReference(event => {\r\n            let { element, kind } = event;\r\n            if (!element) {\r\n                return;\r\n            }\r\n            switch (kind) {\r\n                case 'open':\r\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\r\n                        // when stable peek is configured we don't close\r\n                        // the peek window on selecting the editor\r\n                        this.openReference(element, false, false);\r\n                    }\r\n                    break;\r\n                case 'side':\r\n                    this.openReference(element, true, false);\r\n                    break;\r\n                case 'goto':\r\n                    if (peekMode) {\r\n                        this._gotoReference(element);\r\n                    }\r\n                    else {\r\n                        this.openReference(element, false, true);\r\n                    }\r\n                    break;\r\n            }\r\n        }));\r\n        const requestId = ++this._requestIdPool;\r\n        modelPromise.then(model => {\r\n            var _a;\r\n            // still current request? widget still open?\r\n            if (requestId !== this._requestIdPool || !this._widget) {\r\n                model.dispose();\r\n                return undefined;\r\n            }\r\n            (_a = this._model) === null || _a === void 0 ? void 0 : _a.dispose();\r\n            this._model = model;\r\n            // show widget\r\n            return this._widget.setModel(this._model).then(() => {\r\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\r\n                    // set title\r\n                    if (!this._model.isEmpty) {\r\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\r\n                    }\r\n                    else {\r\n                        this._widget.setMetaTitle('');\r\n                    }\r\n                    // set 'best' selection\r\n                    let uri = this._editor.getModel().uri;\r\n                    let pos = new Position(range.startLineNumber, range.startColumn);\r\n                    let selection = this._model.nearestReference(uri, pos);\r\n                    if (selection) {\r\n                        return this._widget.setSelection(selection).then(() => {\r\n                            if (this._widget && this._editor.getOption(75 /* peekWidgetDefaultFocus */) === 'editor') {\r\n                                this._widget.focusOnPreviewEditor();\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n                return undefined;\r\n            });\r\n        }, error => {\r\n            this._notificationService.error(error);\r\n        });\r\n    }\r\n    changeFocusBetweenPreviewAndReferences() {\r\n        if (!this._widget) {\r\n            // can be called while still resolving...\r\n            return;\r\n        }\r\n        if (this._widget.isPreviewEditorFocused()) {\r\n            this._widget.focusOnReferenceTree();\r\n        }\r\n        else {\r\n            this._widget.focusOnPreviewEditor();\r\n        }\r\n    }\r\n    goToNextOrPreviousReference(fwd) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\r\n                // can be called while still resolving...\r\n                return;\r\n            }\r\n            const currentPosition = this._widget.position;\r\n            if (!currentPosition) {\r\n                return;\r\n            }\r\n            const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\r\n            if (!source) {\r\n                return;\r\n            }\r\n            const target = this._model.nextOrPreviousReference(source, fwd);\r\n            const editorFocus = this._editor.hasTextFocus();\r\n            const previewEditorFocus = this._widget.isPreviewEditorFocused();\r\n            yield this._widget.setSelection(target);\r\n            yield this._gotoReference(target);\r\n            if (editorFocus) {\r\n                this._editor.focus();\r\n            }\r\n            else if (this._widget && previewEditorFocus) {\r\n                this._widget.focusOnPreviewEditor();\r\n            }\r\n        });\r\n    }\r\n    revealReference(reference) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\r\n                // can be called while still resolving...\r\n                return;\r\n            }\r\n            yield this._widget.revealReference(reference);\r\n        });\r\n    }\r\n    closeWidget(focusEditor = true) {\r\n        var _a, _b;\r\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\r\n        this._referenceSearchVisible.reset();\r\n        this._disposables.clear();\r\n        this._widget = undefined;\r\n        this._model = undefined;\r\n        if (focusEditor) {\r\n            this._editor.focus();\r\n        }\r\n        this._requestIdPool += 1; // Cancel pending requests\r\n    }\r\n    _gotoReference(ref) {\r\n        if (this._widget) {\r\n            this._widget.hide();\r\n        }\r\n        this._ignoreModelChangeEvent = true;\r\n        const range = Range.lift(ref.range).collapseToStart();\r\n        return this._editorService.openCodeEditor({\r\n            resource: ref.uri,\r\n            options: { selection: range }\r\n        }, this._editor).then(openedEditor => {\r\n            var _a;\r\n            this._ignoreModelChangeEvent = false;\r\n            if (!openedEditor || !this._widget) {\r\n                // something went wrong...\r\n                this.closeWidget();\r\n                return;\r\n            }\r\n            if (this._editor === openedEditor) {\r\n                //\r\n                this._widget.show(range);\r\n                this._widget.focusOnReferenceTree();\r\n            }\r\n            else {\r\n                // we opened a different editor instance which means a different controller instance.\r\n                // therefore we stop with this controller and continue with the other\r\n                const other = ReferencesController.get(openedEditor);\r\n                const model = this._model.clone();\r\n                this.closeWidget();\r\n                openedEditor.focus();\r\n                other.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), (_a = this._peekMode) !== null && _a !== void 0 ? _a : false);\r\n            }\r\n        }, (err) => {\r\n            this._ignoreModelChangeEvent = false;\r\n            onUnexpectedError(err);\r\n        });\r\n    }\r\n    openReference(ref, sideBySide, pinned) {\r\n        // clear stage\r\n        if (!sideBySide) {\r\n            this.closeWidget();\r\n        }\r\n        const { uri, range } = ref;\r\n        this._editorService.openCodeEditor({\r\n            resource: uri,\r\n            options: { selection: range, pinned }\r\n        }, this._editor, sideBySide);\r\n    }\r\n};\r\nReferencesController.ID = 'editor.contrib.referencesController';\r\nReferencesController = __decorate([\r\n    __param(2, IContextKeyService),\r\n    __param(3, ICodeEditorService),\r\n    __param(4, INotificationService),\r\n    __param(5, IInstantiationService),\r\n    __param(6, IStorageService),\r\n    __param(7, IConfigurationService)\r\n], ReferencesController);\r\nexport { ReferencesController };\r\nfunction withController(accessor, fn) {\r\n    const outerEditor = getOuterEditor(accessor);\r\n    if (!outerEditor) {\r\n        return;\r\n    }\r\n    let controller = ReferencesController.get(outerEditor);\r\n    if (controller) {\r\n        fn(controller);\r\n    }\r\n}\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'togglePeekWidgetFocus',\r\n    weight: 100 /* EditorContrib */,\r\n    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 60 /* F2 */),\r\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\r\n    handler(accessor) {\r\n        withController(accessor, controller => {\r\n            controller.changeFocusBetweenPreviewAndReferences();\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToNextReference',\r\n    weight: 100 /* EditorContrib */ - 10,\r\n    primary: 62 /* F4 */,\r\n    secondary: [70 /* F12 */],\r\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\r\n    handler(accessor) {\r\n        withController(accessor, controller => {\r\n            controller.goToNextOrPreviousReference(true);\r\n        });\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'goToPreviousReference',\r\n    weight: 100 /* EditorContrib */ - 10,\r\n    primary: 1024 /* Shift */ | 62 /* F4 */,\r\n    secondary: [1024 /* Shift */ | 70 /* F12 */],\r\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\r\n    handler(accessor) {\r\n        withController(accessor, controller => {\r\n            controller.goToNextOrPreviousReference(false);\r\n        });\r\n    }\r\n});\r\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\r\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\r\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\r\n// close\r\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\r\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'closeReferenceSearch',\r\n    weight: 100 /* EditorContrib */ - 101,\r\n    primary: 9 /* Escape */,\r\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\r\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\r\n});\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'closeReferenceSearch',\r\n    weight: 200 /* WorkbenchContrib */ + 50,\r\n    primary: 9 /* Escape */,\r\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\r\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'))\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'revealReference',\r\n    weight: 200 /* WorkbenchContrib */,\r\n    primary: 3 /* Enter */,\r\n    mac: {\r\n        primary: 3 /* Enter */,\r\n        secondary: [2048 /* CtrlCmd */ | 18 /* DownArrow */]\r\n    },\r\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey),\r\n    handler(accessor) {\r\n        var _a;\r\n        const listService = accessor.get(IListService);\r\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\r\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\r\n            withController(accessor, controller => controller.revealReference(focus[0]));\r\n        }\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'openReferenceToSide',\r\n    weight: 100 /* EditorContrib */,\r\n    primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n    mac: {\r\n        primary: 256 /* WinCtrl */ | 3 /* Enter */\r\n    },\r\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey),\r\n    handler(accessor) {\r\n        var _a;\r\n        const listService = accessor.get(IListService);\r\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\r\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\r\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\r\n        }\r\n    }\r\n});\r\nCommandsRegistry.registerCommand('openReference', (accessor) => {\r\n    var _a;\r\n    const listService = accessor.get(IListService);\r\n    const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\r\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\r\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { registerEditorCommand, EditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { dispose, combinedDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { isEqual } from '../../../base/common/resources.js';\r\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\r\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\r\nlet SymbolNavigationService = class SymbolNavigationService {\r\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\r\n        this._editorService = _editorService;\r\n        this._notificationService = _notificationService;\r\n        this._keybindingService = _keybindingService;\r\n        this._currentModel = undefined;\r\n        this._currentIdx = -1;\r\n        this._ignoreEditorChange = false;\r\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\r\n    }\r\n    reset() {\r\n        var _a, _b;\r\n        this._ctxHasSymbols.reset();\r\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\r\n        this._currentModel = undefined;\r\n        this._currentIdx = -1;\r\n    }\r\n    put(anchor) {\r\n        const refModel = anchor.parent.parent;\r\n        if (refModel.references.length <= 1) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._currentModel = refModel;\r\n        this._currentIdx = refModel.references.indexOf(anchor);\r\n        this._ctxHasSymbols.set(true);\r\n        this._showMessage();\r\n        const editorState = new EditorState(this._editorService);\r\n        const listener = editorState.onDidChange(_ => {\r\n            if (this._ignoreEditorChange) {\r\n                return;\r\n            }\r\n            const editor = this._editorService.getActiveCodeEditor();\r\n            if (!editor) {\r\n                return;\r\n            }\r\n            const model = editor.getModel();\r\n            const position = editor.getPosition();\r\n            if (!model || !position) {\r\n                return;\r\n            }\r\n            let seenUri = false;\r\n            let seenPosition = false;\r\n            for (const reference of refModel.references) {\r\n                if (isEqual(reference.uri, model.uri)) {\r\n                    seenUri = true;\r\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\r\n                }\r\n                else if (seenUri) {\r\n                    break;\r\n                }\r\n            }\r\n            if (!seenUri || !seenPosition) {\r\n                this.reset();\r\n            }\r\n        });\r\n        this._currentState = combinedDisposable(editorState, listener);\r\n    }\r\n    revealNext(source) {\r\n        if (!this._currentModel) {\r\n            return Promise.resolve();\r\n        }\r\n        // get next result and advance\r\n        this._currentIdx += 1;\r\n        this._currentIdx %= this._currentModel.references.length;\r\n        const reference = this._currentModel.references[this._currentIdx];\r\n        // status\r\n        this._showMessage();\r\n        // open editor, ignore events while that happens\r\n        this._ignoreEditorChange = true;\r\n        return this._editorService.openCodeEditor({\r\n            resource: reference.uri,\r\n            options: {\r\n                selection: Range.collapseToStart(reference.range),\r\n                selectionRevealType: 3 /* NearTopIfOutsideViewport */\r\n            }\r\n        }, source).finally(() => {\r\n            this._ignoreEditorChange = false;\r\n        });\r\n    }\r\n    _showMessage() {\r\n        var _a;\r\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\r\n        const message = kb\r\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\r\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\r\n        this._currentMessage = this._notificationService.status(message);\r\n    }\r\n};\r\nSymbolNavigationService = __decorate([\r\n    __param(0, IContextKeyService),\r\n    __param(1, ICodeEditorService),\r\n    __param(2, INotificationService),\r\n    __param(3, IKeybindingService)\r\n], SymbolNavigationService);\r\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, true);\r\nregisterEditorCommand(new class extends EditorCommand {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.gotoNextSymbolFromResult',\r\n            precondition: ctxHasSymbols,\r\n            kbOpts: {\r\n                weight: 100 /* EditorContrib */,\r\n                primary: 70 /* F12 */\r\n            }\r\n        });\r\n    }\r\n    runEditorCommand(accessor, editor) {\r\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\r\n    }\r\n});\r\nKeybindingsRegistry.registerCommandAndKeybindingRule({\r\n    id: 'editor.gotoNextSymbolFromResult.cancel',\r\n    weight: 100 /* EditorContrib */,\r\n    when: ctxHasSymbols,\r\n    primary: 9 /* Escape */,\r\n    handler(accessor) {\r\n        accessor.get(ISymbolNavigationService).reset();\r\n    }\r\n});\r\n//\r\nlet EditorState = class EditorState {\r\n    constructor(editorService) {\r\n        this._listener = new Map();\r\n        this._disposables = new DisposableStore();\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\r\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\r\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\r\n    }\r\n    dispose() {\r\n        this._disposables.dispose();\r\n        this._onDidChange.dispose();\r\n        dispose(this._listener.values());\r\n    }\r\n    _onDidAddEditor(editor) {\r\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\r\n    }\r\n    _onDidRemoveEditor(editor) {\r\n        var _a;\r\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        this._listener.delete(editor);\r\n    }\r\n};\r\nEditorState = __decorate([\r\n    __param(0, ICodeEditorService)\r\n], EditorState);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar _a, _b, _c, _d, _e, _f, _g, _h;\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { createCancelablePromise, raceCancellation } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { isWeb } from '../../../base/common/platform.js';\r\nimport { isCodeEditor } from '../../browser/editorBrowser.js';\r\nimport { EditorAction, registerInstantiatedEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport * as corePosition from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { isLocationLink } from '../../common/modes.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { PeekContext } from '../peekView/peekView.js';\r\nimport { ReferencesController } from './peek/referencesController.js';\r\nimport { ReferencesModel } from './referencesModel.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { MenuId, MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { getDefinitionsAtPosition, getImplementationsAtPosition, getTypeDefinitionsAtPosition, getDeclarationsAtPosition, getReferencesAtPosition } from './goToSymbol.js';\r\nimport { CommandsRegistry, ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { EditorStateCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { ISymbolNavigationService } from './symbolNavigation.js';\r\nimport { isStandalone } from '../../../base/browser/browser.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\r\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\r\n    submenu: MenuId.EditorContextPeek,\r\n    title: nls.localize('peek.submenu', \"Peek\"),\r\n    group: 'navigation',\r\n    order: 100\r\n});\r\nconst _goToActionIds = new Set();\r\nfunction registerGoToAction(ctor) {\r\n    const result = new ctor();\r\n    registerInstantiatedEditorAction(result);\r\n    _goToActionIds.add(result.id);\r\n    return result;\r\n}\r\nclass SymbolNavigationAction extends EditorAction {\r\n    constructor(configuration, opts) {\r\n        super(opts);\r\n        this._configuration = configuration;\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return Promise.resolve(undefined);\r\n        }\r\n        const notificationService = accessor.get(INotificationService);\r\n        const editorService = accessor.get(ICodeEditorService);\r\n        const progressService = accessor.get(IEditorProgressService);\r\n        const symbolNavService = accessor.get(ISymbolNavigationService);\r\n        const model = editor.getModel();\r\n        const pos = editor.getPosition();\r\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* Value */ | 4 /* Position */);\r\n        const promise = raceCancellation(this._getLocationModel(model, pos, cts.token), cts.token).then((references) => __awaiter(this, void 0, void 0, function* () {\r\n            if (!references || cts.token.isCancellationRequested) {\r\n                return;\r\n            }\r\n            alert(references.ariaMessage);\r\n            let altAction;\r\n            if (references.referenceAt(model.uri, pos)) {\r\n                const altActionId = this._getAlternativeCommand(editor);\r\n                if (altActionId !== this.id && _goToActionIds.has(altActionId)) {\r\n                    altAction = editor.getAction(altActionId);\r\n                }\r\n            }\r\n            const referenceCount = references.references.length;\r\n            if (referenceCount === 0) {\r\n                // no result -> show message\r\n                if (!this._configuration.muteMessage) {\r\n                    const info = model.getWordAtPosition(pos);\r\n                    MessageController.get(editor).showMessage(this._getNoResultFoundMessage(info), pos);\r\n                }\r\n            }\r\n            else if (referenceCount === 1 && altAction) {\r\n                // already at the only result, run alternative\r\n                altAction.run();\r\n            }\r\n            else {\r\n                // normal results handling\r\n                return this._onResult(editorService, symbolNavService, editor, references);\r\n            }\r\n        }), (err) => {\r\n            // report an error\r\n            notificationService.error(err);\r\n        }).finally(() => {\r\n            cts.dispose();\r\n        });\r\n        progressService.showWhile(promise, 250);\r\n        return promise;\r\n    }\r\n    _onResult(editorService, symbolNavService, editor, model) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const gotoLocation = this._getGoToPreference(editor);\r\n            if (!(editor instanceof EmbeddedCodeEditorWidget) && (this._configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\r\n                this._openInPeek(editor, model);\r\n            }\r\n            else {\r\n                const next = model.firstReference();\r\n                const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\r\n                const targetEditor = yield this._openReference(editor, editorService, next, this._configuration.openToSide, !peek);\r\n                if (peek && targetEditor) {\r\n                    this._openInPeek(targetEditor, model);\r\n                }\r\n                else {\r\n                    model.dispose();\r\n                }\r\n                // keep remaining locations around when using\r\n                // 'goto'-mode\r\n                if (gotoLocation === 'goto') {\r\n                    symbolNavService.put(next);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    _openReference(editor, editorService, reference, sideBySide, highlight) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            // range is the target-selection-range when we have one\r\n            // and the fallback is the 'full' range\r\n            let range = undefined;\r\n            if (isLocationLink(reference)) {\r\n                range = reference.targetSelectionRange;\r\n            }\r\n            if (!range) {\r\n                range = reference.range;\r\n            }\r\n            if (!range) {\r\n                return undefined;\r\n            }\r\n            const targetEditor = yield editorService.openCodeEditor({\r\n                resource: reference.uri,\r\n                options: {\r\n                    selection: Range.collapseToStart(range),\r\n                    selectionRevealType: 3 /* NearTopIfOutsideViewport */\r\n                }\r\n            }, editor, sideBySide);\r\n            if (!targetEditor) {\r\n                return undefined;\r\n            }\r\n            if (highlight) {\r\n                const modelNow = targetEditor.getModel();\r\n                const ids = targetEditor.deltaDecorations([], [{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\r\n                setTimeout(() => {\r\n                    if (targetEditor.getModel() === modelNow) {\r\n                        targetEditor.deltaDecorations(ids, []);\r\n                    }\r\n                }, 350);\r\n            }\r\n            return targetEditor;\r\n        });\r\n    }\r\n    _openInPeek(target, model) {\r\n        let controller = ReferencesController.get(target);\r\n        if (controller && target.hasModel()) {\r\n            controller.toggleWidget(target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this._configuration.openInPeek);\r\n        }\r\n        else {\r\n            model.dispose();\r\n        }\r\n    }\r\n}\r\n//#region --- DEFINITION\r\nexport class DefinitionAction extends SymbolNavigationAction {\r\n    _getLocationModel(model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new ReferencesModel(yield getDefinitionsAtPosition(model, position, token), nls.localize('def.title', 'Definitions'));\r\n        });\r\n    }\r\n    _getNoResultFoundMessage(info) {\r\n        return info && info.word\r\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\r\n            : nls.localize('generic.noResults', \"No definition found\");\r\n    }\r\n    _getAlternativeCommand(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).alternativeDefinitionCommand;\r\n    }\r\n    _getGoToPreference(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).multipleDefinitions;\r\n    }\r\n}\r\nconst goToDefinitionKb = isWeb && !isStandalone\r\n    ? 2048 /* CtrlCmd */ | 70 /* F12 */\r\n    : 70 /* F12 */;\r\nregisterGoToAction((_a = class GoToDefinitionAction extends DefinitionAction {\r\n        constructor() {\r\n            super({\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToDefinitionAction.id,\r\n                label: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\r\n                alias: 'Go to Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: goToDefinitionKb,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.1\r\n                },\r\n                menuOpts: {\r\n                    menuId: MenuId.MenubarGoMenu,\r\n                    group: '4_symbol_nav',\r\n                    order: 2,\r\n                    title: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\r\n                }\r\n            });\r\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\r\n        }\r\n    },\r\n    _a.id = 'editor.action.revealDefinition',\r\n    _a));\r\nregisterGoToAction((_b = class OpenDefinitionToSideAction extends DefinitionAction {\r\n        constructor() {\r\n            super({\r\n                openToSide: true,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: OpenDefinitionToSideAction.id,\r\n                label: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\r\n                alias: 'Open Definition to the Side',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, goToDefinitionKb),\r\n                    weight: 100 /* EditorContrib */\r\n                }\r\n            });\r\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\r\n        }\r\n    },\r\n    _b.id = 'editor.action.revealDefinitionAside',\r\n    _b));\r\nregisterGoToAction((_c = class PeekDefinitionAction extends DefinitionAction {\r\n        constructor() {\r\n            super({\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekDefinitionAction.id,\r\n                label: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\r\n                alias: 'Peek Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 512 /* Alt */ | 70 /* F12 */,\r\n                    linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 68 /* F10 */ },\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    menuId: MenuId.EditorContextPeek,\r\n                    group: 'peek',\r\n                    order: 2\r\n                }\r\n            });\r\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\r\n        }\r\n    },\r\n    _c.id = 'editor.action.peekDefinition',\r\n    _c));\r\n//#endregion\r\n//#region --- DECLARATION\r\nclass DeclarationAction extends SymbolNavigationAction {\r\n    _getLocationModel(model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new ReferencesModel(yield getDeclarationsAtPosition(model, position, token), nls.localize('decl.title', 'Declarations'));\r\n        });\r\n    }\r\n    _getNoResultFoundMessage(info) {\r\n        return info && info.word\r\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\r\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\r\n    }\r\n    _getAlternativeCommand(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).alternativeDeclarationCommand;\r\n    }\r\n    _getGoToPreference(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).multipleDeclarations;\r\n    }\r\n}\r\nregisterGoToAction((_d = class GoToDeclarationAction extends DeclarationAction {\r\n        constructor() {\r\n            super({\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToDeclarationAction.id,\r\n                label: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\r\n                alias: 'Go to Declaration',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.3\r\n                },\r\n                menuOpts: {\r\n                    menuId: MenuId.MenubarGoMenu,\r\n                    group: '4_symbol_nav',\r\n                    order: 3,\r\n                    title: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\r\n                },\r\n            });\r\n        }\r\n        _getNoResultFoundMessage(info) {\r\n            return info && info.word\r\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\r\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\r\n        }\r\n    },\r\n    _d.id = 'editor.action.revealDeclaration',\r\n    _d));\r\nregisterGoToAction(class PeekDeclarationAction extends DeclarationAction {\r\n    constructor() {\r\n        super({\r\n            openToSide: false,\r\n            openInPeek: true,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.peekDeclaration',\r\n            label: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\r\n            alias: 'Peek Declaration',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n            contextMenuOpts: {\r\n                menuId: MenuId.EditorContextPeek,\r\n                group: 'peek',\r\n                order: 3\r\n            }\r\n        });\r\n    }\r\n});\r\n//#endregion\r\n//#region --- TYPE DEFINITION\r\nclass TypeDefinitionAction extends SymbolNavigationAction {\r\n    _getLocationModel(model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new ReferencesModel(yield getTypeDefinitionsAtPosition(model, position, token), nls.localize('typedef.title', 'Type Definitions'));\r\n        });\r\n    }\r\n    _getNoResultFoundMessage(info) {\r\n        return info && info.word\r\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\r\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\r\n    }\r\n    _getAlternativeCommand(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).alternativeTypeDefinitionCommand;\r\n    }\r\n    _getGoToPreference(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).multipleTypeDefinitions;\r\n    }\r\n}\r\nregisterGoToAction((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\r\n        constructor() {\r\n            super({\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToTypeDefinitionAction.ID,\r\n                label: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\r\n                alias: 'Go to Type Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 0,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.4\r\n                },\r\n                menuOpts: {\r\n                    menuId: MenuId.MenubarGoMenu,\r\n                    group: '4_symbol_nav',\r\n                    order: 3,\r\n                    title: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\r\n                }\r\n            });\r\n        }\r\n    },\r\n    _e.ID = 'editor.action.goToTypeDefinition',\r\n    _e));\r\nregisterGoToAction((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\r\n        constructor() {\r\n            super({\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekTypeDefinitionAction.ID,\r\n                label: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\r\n                alias: 'Peek Type Definition',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n                contextMenuOpts: {\r\n                    menuId: MenuId.EditorContextPeek,\r\n                    group: 'peek',\r\n                    order: 4\r\n                }\r\n            });\r\n        }\r\n    },\r\n    _f.ID = 'editor.action.peekTypeDefinition',\r\n    _f));\r\n//#endregion\r\n//#region --- IMPLEMENTATION\r\nclass ImplementationAction extends SymbolNavigationAction {\r\n    _getLocationModel(model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new ReferencesModel(yield getImplementationsAtPosition(model, position, token), nls.localize('impl.title', 'Implementations'));\r\n        });\r\n    }\r\n    _getNoResultFoundMessage(info) {\r\n        return info && info.word\r\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\r\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\r\n    }\r\n    _getAlternativeCommand(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).alternativeImplementationCommand;\r\n    }\r\n    _getGoToPreference(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).multipleImplementations;\r\n    }\r\n}\r\nregisterGoToAction((_g = class GoToImplementationAction extends ImplementationAction {\r\n        constructor() {\r\n            super({\r\n                openToSide: false,\r\n                openInPeek: false,\r\n                muteMessage: false\r\n            }, {\r\n                id: GoToImplementationAction.ID,\r\n                label: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\r\n                alias: 'Go to Implementations',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 70 /* F12 */,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                menuOpts: {\r\n                    menuId: MenuId.MenubarGoMenu,\r\n                    group: '4_symbol_nav',\r\n                    order: 4,\r\n                    title: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\r\n                },\r\n                contextMenuOpts: {\r\n                    group: 'navigation',\r\n                    order: 1.45\r\n                }\r\n            });\r\n        }\r\n    },\r\n    _g.ID = 'editor.action.goToImplementation',\r\n    _g));\r\nregisterGoToAction((_h = class PeekImplementationAction extends ImplementationAction {\r\n        constructor() {\r\n            super({\r\n                openToSide: false,\r\n                openInPeek: true,\r\n                muteMessage: false\r\n            }, {\r\n                id: PeekImplementationAction.ID,\r\n                label: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\r\n                alias: 'Peek Implementations',\r\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n                kbOpts: {\r\n                    kbExpr: EditorContextKeys.editorTextFocus,\r\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 70 /* F12 */,\r\n                    weight: 100 /* EditorContrib */\r\n                },\r\n                contextMenuOpts: {\r\n                    menuId: MenuId.EditorContextPeek,\r\n                    group: 'peek',\r\n                    order: 5\r\n                }\r\n            });\r\n        }\r\n    },\r\n    _h.ID = 'editor.action.peekImplementation',\r\n    _h));\r\n//#endregion\r\n//#region --- REFERENCES\r\nclass ReferencesAction extends SymbolNavigationAction {\r\n    _getNoResultFoundMessage(info) {\r\n        return info\r\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\r\n            : nls.localize('references.noGeneric', \"No references found\");\r\n    }\r\n    _getAlternativeCommand(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).alternativeReferenceCommand;\r\n    }\r\n    _getGoToPreference(editor) {\r\n        return editor.getOption(48 /* gotoLocation */).multipleReferences;\r\n    }\r\n}\r\nregisterGoToAction(class GoToReferencesAction extends ReferencesAction {\r\n    constructor() {\r\n        super({\r\n            openToSide: false,\r\n            openInPeek: false,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.goToReferences',\r\n            label: nls.localize('goToReferences.label', \"Go to References\"),\r\n            alias: 'Go to References',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 70 /* F12 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: 'navigation',\r\n                order: 1.45\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarGoMenu,\r\n                group: '4_symbol_nav',\r\n                order: 5,\r\n                title: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\r\n            },\r\n        });\r\n    }\r\n    _getLocationModel(model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new ReferencesModel(yield getReferencesAtPosition(model, position, true, token), nls.localize('ref.title', 'References'));\r\n        });\r\n    }\r\n});\r\nregisterGoToAction(class PeekReferencesAction extends ReferencesAction {\r\n    constructor() {\r\n        super({\r\n            openToSide: false,\r\n            openInPeek: true,\r\n            muteMessage: false\r\n        }, {\r\n            id: 'editor.action.referenceSearch.trigger',\r\n            label: nls.localize('references.action.label', \"Peek References\"),\r\n            alias: 'Peek References',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n            contextMenuOpts: {\r\n                menuId: MenuId.EditorContextPeek,\r\n                group: 'peek',\r\n                order: 6\r\n            }\r\n        });\r\n    }\r\n    _getLocationModel(model, position, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new ReferencesModel(yield getReferencesAtPosition(model, position, false, token), nls.localize('ref.title', 'References'));\r\n        });\r\n    }\r\n});\r\n//#endregion\r\n//#region --- GENERIC goto symbols command\r\nclass GenericGoToLocationAction extends SymbolNavigationAction {\r\n    constructor(config, _references, _gotoMultipleBehaviour) {\r\n        super(config, {\r\n            id: 'editor.action.goToLocation',\r\n            label: nls.localize('label.generic', \"Go To Any Symbol\"),\r\n            alias: 'Go To Any Symbol',\r\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\r\n        });\r\n        this._references = _references;\r\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\r\n    }\r\n    _getLocationModel(_model, _position, _token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\r\n        });\r\n    }\r\n    _getNoResultFoundMessage(info) {\r\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\r\n    }\r\n    _getGoToPreference(editor) {\r\n        var _a;\r\n        return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(48 /* gotoLocation */).multipleReferences;\r\n    }\r\n    _getAlternativeCommand() { return ''; }\r\n}\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.goToLocations',\r\n    description: {\r\n        description: 'Go to locations from a position in a file',\r\n        args: [\r\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\r\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\r\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\r\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\r\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\r\n        ]\r\n    },\r\n    handler: (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => __awaiter(void 0, void 0, void 0, function* () {\r\n        assertType(URI.isUri(resource));\r\n        assertType(corePosition.Position.isIPosition(position));\r\n        assertType(Array.isArray(references));\r\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\r\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\r\n        const editorService = accessor.get(ICodeEditorService);\r\n        const editor = yield editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\r\n        if (isCodeEditor(editor)) {\r\n            editor.setPosition(position);\r\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* Smooth */);\r\n            return editor.invokeWithinContext(accessor => {\r\n                const command = new class extends GenericGoToLocationAction {\r\n                    _getNoResultFoundMessage(info) {\r\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\r\n                    }\r\n                }({\r\n                    muteMessage: !Boolean(noResultsMessage),\r\n                    openInPeek: Boolean(openInPeek),\r\n                    openToSide: false\r\n                }, references, multiple);\r\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\r\n            });\r\n        }\r\n    })\r\n});\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.peekLocations',\r\n    description: {\r\n        description: 'Peek locations from a position in a file',\r\n        args: [\r\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\r\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\r\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\r\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\r\n        ]\r\n    },\r\n    handler: (accessor, resource, position, references, multiple) => __awaiter(void 0, void 0, void 0, function* () {\r\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\r\n    })\r\n});\r\n//#endregion\r\n//#region --- REFERENCE search special commands\r\nCommandsRegistry.registerCommand({\r\n    id: 'editor.action.findReferences',\r\n    handler: (accessor, resource, position) => {\r\n        assertType(URI.isUri(resource));\r\n        assertType(corePosition.Position.isIPosition(position));\r\n        const codeEditorService = accessor.get(ICodeEditorService);\r\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\r\n            if (!isCodeEditor(control) || !control.hasModel()) {\r\n                return undefined;\r\n            }\r\n            const controller = ReferencesController.get(control);\r\n            if (!controller) {\r\n                return undefined;\r\n            }\r\n            const references = createCancelablePromise(token => getReferencesAtPosition(control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\r\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n            return Promise.resolve(controller.toggleWidget(range, references, false));\r\n        });\r\n    }\r\n});\r\n// use NEW command\r\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\r\n//#endregion\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Disposable } from '../../../../base/common/lifecycle.js';\r\nimport { Emitter } from '../../../../base/common/event.js';\r\nimport * as platform from '../../../../base/common/platform.js';\r\nfunction hasModifier(e, modifier) {\r\n    return !!e[modifier];\r\n}\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nexport class ClickLinkMouseEvent {\r\n    constructor(source, opts) {\r\n        this.target = source.target;\r\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\r\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\r\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\r\n    }\r\n}\r\n/**\r\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\r\n */\r\nexport class ClickLinkKeyboardEvent {\r\n    constructor(source, opts) {\r\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\r\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\r\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\r\n    }\r\n}\r\nexport class ClickLinkOptions {\r\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\r\n        this.triggerKey = triggerKey;\r\n        this.triggerModifier = triggerModifier;\r\n        this.triggerSideBySideKey = triggerSideBySideKey;\r\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\r\n    }\r\n    equals(other) {\r\n        return (this.triggerKey === other.triggerKey\r\n            && this.triggerModifier === other.triggerModifier\r\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\r\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\r\n    }\r\n}\r\nfunction createOptions(multiCursorModifier) {\r\n    if (multiCursorModifier === 'altKey') {\r\n        if (platform.isMacintosh) {\r\n            return new ClickLinkOptions(57 /* Meta */, 'metaKey', 6 /* Alt */, 'altKey');\r\n        }\r\n        return new ClickLinkOptions(5 /* Ctrl */, 'ctrlKey', 6 /* Alt */, 'altKey');\r\n    }\r\n    if (platform.isMacintosh) {\r\n        return new ClickLinkOptions(6 /* Alt */, 'altKey', 57 /* Meta */, 'metaKey');\r\n    }\r\n    return new ClickLinkOptions(6 /* Alt */, 'altKey', 5 /* Ctrl */, 'ctrlKey');\r\n}\r\nexport class ClickLinkGesture extends Disposable {\r\n    constructor(editor) {\r\n        super();\r\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\r\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\r\n        this._onExecute = this._register(new Emitter());\r\n        this.onExecute = this._onExecute.event;\r\n        this._onCancel = this._register(new Emitter());\r\n        this.onCancel = this._onCancel.event;\r\n        this._editor = editor;\r\n        this._opts = createOptions(this._editor.getOption(68 /* multiCursorModifier */));\r\n        this._lastMouseMoveEvent = null;\r\n        this._hasTriggerKeyOnMouseDown = false;\r\n        this._lineNumberOnMouseDown = 0;\r\n        this._register(this._editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(68 /* multiCursorModifier */)) {\r\n                const newOpts = createOptions(this._editor.getOption(68 /* multiCursorModifier */));\r\n                if (this._opts.equals(newOpts)) {\r\n                    return;\r\n                }\r\n                this._opts = newOpts;\r\n                this._lastMouseMoveEvent = null;\r\n                this._hasTriggerKeyOnMouseDown = false;\r\n                this._lineNumberOnMouseDown = 0;\r\n                this._onCancel.fire();\r\n            }\r\n        }));\r\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\r\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\r\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\r\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\r\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\r\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\r\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\r\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\r\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\r\n        this._register(this._editor.onDidScrollChange((e) => {\r\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\r\n                this._resetHandler();\r\n            }\r\n        }));\r\n    }\r\n    _onDidChangeCursorSelection(e) {\r\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\r\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\r\n        }\r\n    }\r\n    _onEditorMouseMove(mouseEvent) {\r\n        this._lastMouseMoveEvent = mouseEvent;\r\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\r\n    }\r\n    _onEditorMouseDown(mouseEvent) {\r\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\r\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\r\n        // release the mouse button without wanting to do the navigation.\r\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\r\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\r\n        this._lineNumberOnMouseDown = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\r\n    }\r\n    _onEditorMouseUp(mouseEvent) {\r\n        const currentLineNumber = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\r\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber) {\r\n            this._onExecute.fire(mouseEvent);\r\n        }\r\n    }\r\n    _onEditorKeyDown(e) {\r\n        if (this._lastMouseMoveEvent\r\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\r\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\r\n            )) {\r\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\r\n        }\r\n        else if (e.hasTriggerModifier) {\r\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\r\n        }\r\n    }\r\n    _onEditorKeyUp(e) {\r\n        if (e.keyCodeIsTriggerKey) {\r\n            this._onCancel.fire();\r\n        }\r\n    }\r\n    _resetHandler() {\r\n        this._lastMouseMoveEvent = null;\r\n        this._hasTriggerKeyOnMouseDown = false;\r\n        this._onCancel.fire();\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './goToDefinitionAtPosition.css';\r\nimport * as nls from '../../../../nls.js';\r\nimport { createCancelablePromise } from '../../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\r\nimport { MarkdownString } from '../../../../base/common/htmlContent.js';\r\nimport { IModeService } from '../../../common/services/modeService.js';\r\nimport { Range } from '../../../common/core/range.js';\r\nimport { DefinitionProviderRegistry } from '../../../common/modes.js';\r\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\r\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\r\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\r\nimport { ITextModelService } from '../../../common/services/resolverService.js';\r\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\r\nimport { editorActiveLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\r\nimport { EditorState } from '../../../browser/core/editorState.js';\r\nimport { DefinitionAction } from '../goToCommands.js';\r\nimport { ClickLinkGesture } from './clickLinkGesture.js';\r\nimport { Position } from '../../../common/core/position.js';\r\nimport { withNullAsUndefined } from '../../../../base/common/types.js';\r\nimport { PeekContext } from '../../peekView/peekView.js';\r\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\r\nlet GotoDefinitionAtPositionEditorContribution = class GotoDefinitionAtPositionEditorContribution {\r\n    constructor(editor, textModelResolverService, modeService) {\r\n        this.textModelResolverService = textModelResolverService;\r\n        this.modeService = modeService;\r\n        this.toUnhook = new DisposableStore();\r\n        this.toUnhookForKeyboard = new DisposableStore();\r\n        this.linkDecorations = [];\r\n        this.currentWordAtPosition = null;\r\n        this.previousPromise = null;\r\n        this.editor = editor;\r\n        let linkGesture = new ClickLinkGesture(editor);\r\n        this.toUnhook.add(linkGesture);\r\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\r\n            this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\r\n        }));\r\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\r\n            if (this.isEnabled(mouseEvent)) {\r\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier).then(() => {\r\n                    this.removeLinkDecorations();\r\n                }, (error) => {\r\n                    this.removeLinkDecorations();\r\n                    onUnexpectedError(error);\r\n                });\r\n            }\r\n        }));\r\n        this.toUnhook.add(linkGesture.onCancel(() => {\r\n            this.removeLinkDecorations();\r\n            this.currentWordAtPosition = null;\r\n        }));\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\r\n    }\r\n    startFindDefinitionFromCursor(position) {\r\n        // For issue: https://github.com/microsoft/vscode/issues/46257\r\n        // equivalent to mouse move with meta/ctrl key\r\n        // First find the definition and add decorations\r\n        // to the editor to be shown with the content hover widget\r\n        return this.startFindDefinition(position).then(() => {\r\n            // Add listeners for editor cursor move and key down events\r\n            // Dismiss the \"extended\" editor decorations when the user hides\r\n            // the hover widget. There is no event for the widget itself so these\r\n            // serve as a best effort. After removing the link decorations, the hover\r\n            // widget is clean and will only show declarations per next request.\r\n            this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\r\n                this.currentWordAtPosition = null;\r\n                this.removeLinkDecorations();\r\n                this.toUnhookForKeyboard.clear();\r\n            }));\r\n            this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\r\n                if (e) {\r\n                    this.currentWordAtPosition = null;\r\n                    this.removeLinkDecorations();\r\n                    this.toUnhookForKeyboard.clear();\r\n                }\r\n            }));\r\n        });\r\n    }\r\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\r\n        // check if we are active and on a content widget\r\n        if (mouseEvent.target.type === 9 /* CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\r\n            this.currentWordAtPosition = null;\r\n            this.removeLinkDecorations();\r\n            return;\r\n        }\r\n        const position = mouseEvent.target.position;\r\n        this.startFindDefinition(position);\r\n    }\r\n    startFindDefinition(position) {\r\n        var _a;\r\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\r\n        this.toUnhookForKeyboard.clear();\r\n        // Find word at mouse position\r\n        const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\r\n        if (!word) {\r\n            this.currentWordAtPosition = null;\r\n            this.removeLinkDecorations();\r\n            return Promise.resolve(0);\r\n        }\r\n        // Return early if word at position is still the same\r\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\r\n            return Promise.resolve(0);\r\n        }\r\n        this.currentWordAtPosition = word;\r\n        // Find definition and decorate word if found\r\n        let state = new EditorState(this.editor, 4 /* Position */ | 1 /* Value */ | 2 /* Selection */ | 8 /* Scroll */);\r\n        if (this.previousPromise) {\r\n            this.previousPromise.cancel();\r\n            this.previousPromise = null;\r\n        }\r\n        this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\r\n        return this.previousPromise.then(results => {\r\n            if (!results || !results.length || !state.validate(this.editor)) {\r\n                this.removeLinkDecorations();\r\n                return;\r\n            }\r\n            // Multiple results\r\n            if (results.length > 1) {\r\n                this.addDecoration(new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn), new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\r\n            }\r\n            // Single result\r\n            else {\r\n                let result = results[0];\r\n                if (!result.uri) {\r\n                    return;\r\n                }\r\n                this.textModelResolverService.createModelReference(result.uri).then(ref => {\r\n                    if (!ref.object || !ref.object.textEditorModel) {\r\n                        ref.dispose();\r\n                        return;\r\n                    }\r\n                    const { object: { textEditorModel } } = ref;\r\n                    const { startLineNumber } = result.range;\r\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\r\n                        // invalid range\r\n                        ref.dispose();\r\n                        return;\r\n                    }\r\n                    const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\r\n                    let wordRange;\r\n                    if (result.originSelectionRange) {\r\n                        wordRange = Range.lift(result.originSelectionRange);\r\n                    }\r\n                    else {\r\n                        wordRange = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\r\n                    }\r\n                    const modeId = this.modeService.getModeIdByFilepathOrFirstLine(textEditorModel.uri);\r\n                    this.addDecoration(wordRange, new MarkdownString().appendCodeblock(modeId ? modeId : '', previewValue));\r\n                    ref.dispose();\r\n                });\r\n            }\r\n        }).then(undefined, onUnexpectedError);\r\n    }\r\n    getPreviewValue(textEditorModel, startLineNumber, result) {\r\n        let rangeToUse = result.targetSelectionRange ? result.range : this.getPreviewRangeBasedOnBrackets(textEditorModel, startLineNumber);\r\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\r\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\r\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\r\n        }\r\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\r\n        return previewValue;\r\n    }\r\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\r\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\r\n        let minIndent = startIndent;\r\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\r\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\r\n            minIndent = Math.min(minIndent, endIndent);\r\n        }\r\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\r\n        return previewValue;\r\n    }\r\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\r\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\r\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\r\n        let endLineNumber = startLineNumber + 1;\r\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\r\n            let endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\r\n            if (startIndent === endIndent) {\r\n                break;\r\n            }\r\n        }\r\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\r\n    }\r\n    getPreviewRangeBasedOnBrackets(textEditorModel, startLineNumber) {\r\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\r\n        const brackets = [];\r\n        let ignoreFirstEmpty = true;\r\n        let currentBracket = textEditorModel.findNextBracket(new Position(startLineNumber, 1));\r\n        while (currentBracket !== null) {\r\n            if (brackets.length === 0) {\r\n                brackets.push(currentBracket);\r\n            }\r\n            else {\r\n                const lastBracket = brackets[brackets.length - 1];\r\n                if (lastBracket.open[0] === currentBracket.open[0] && lastBracket.isOpen && !currentBracket.isOpen) {\r\n                    brackets.pop();\r\n                }\r\n                else {\r\n                    brackets.push(currentBracket);\r\n                }\r\n                if (brackets.length === 0) {\r\n                    if (ignoreFirstEmpty) {\r\n                        ignoreFirstEmpty = false;\r\n                    }\r\n                    else {\r\n                        return new Range(startLineNumber, 1, currentBracket.range.endLineNumber + 1, 1);\r\n                    }\r\n                }\r\n            }\r\n            const maxColumn = textEditorModel.getLineMaxColumn(startLineNumber);\r\n            let nextLineNumber = currentBracket.range.endLineNumber;\r\n            let nextColumn = currentBracket.range.endColumn;\r\n            if (maxColumn === currentBracket.range.endColumn) {\r\n                nextLineNumber++;\r\n                nextColumn = 1;\r\n            }\r\n            if (nextLineNumber > maxLineNumber) {\r\n                return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\r\n            }\r\n            currentBracket = textEditorModel.findNextBracket(new Position(nextLineNumber, nextColumn));\r\n        }\r\n        return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\r\n    }\r\n    addDecoration(range, hoverMessage) {\r\n        const newDecorations = {\r\n            range: range,\r\n            options: {\r\n                description: 'goto-definition-link',\r\n                inlineClassName: 'goto-definition-link',\r\n                hoverMessage\r\n            }\r\n        };\r\n        this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, [newDecorations]);\r\n    }\r\n    removeLinkDecorations() {\r\n        if (this.linkDecorations.length > 0) {\r\n            this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, []);\r\n        }\r\n    }\r\n    isEnabled(mouseEvent, withKey) {\r\n        return this.editor.hasModel() &&\r\n            mouseEvent.isNoneOrSingleMouseDown &&\r\n            (mouseEvent.target.type === 6 /* CONTENT_TEXT */) &&\r\n            (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false)) &&\r\n            DefinitionProviderRegistry.has(this.editor.getModel());\r\n    }\r\n    findDefinition(position, token) {\r\n        const model = this.editor.getModel();\r\n        if (!model) {\r\n            return Promise.resolve(null);\r\n        }\r\n        return getDefinitionsAtPosition(model, position, token);\r\n    }\r\n    gotoDefinition(position, openToSide) {\r\n        this.editor.setPosition(position);\r\n        return this.editor.invokeWithinContext((accessor) => {\r\n            const canPeek = !openToSide && this.editor.getOption(76 /* definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\r\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { alias: '', label: '', id: '', precondition: undefined });\r\n            return action.run(accessor, this.editor);\r\n        });\r\n    }\r\n    isInPeekEditor(accessor) {\r\n        const contextKeyService = accessor.get(IContextKeyService);\r\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\r\n    }\r\n    dispose() {\r\n        this.toUnhook.dispose();\r\n    }\r\n};\r\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\r\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\r\nGotoDefinitionAtPositionEditorContribution = __decorate([\r\n    __param(1, ITextModelService),\r\n    __param(2, IModeService)\r\n], GotoDefinitionAtPositionEditorContribution);\r\nexport { GotoDefinitionAtPositionEditorContribution };\r\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution);\r\nregisterThemingParticipant((theme, collector) => {\r\n    const activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(`.monaco-editor .goto-definition-link { color: ${activeLinkForeground} !important; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { RunOnceScheduler, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nexport class HoverOperation {\r\n    constructor(computer, success, error, progress, hoverTime) {\r\n        this._computer = computer;\r\n        this._state = 0 /* IDLE */;\r\n        this._hoverTime = hoverTime;\r\n        this._firstWaitScheduler = new RunOnceScheduler(() => this._triggerAsyncComputation(), 0);\r\n        this._secondWaitScheduler = new RunOnceScheduler(() => this._triggerSyncComputation(), 0);\r\n        this._loadingMessageScheduler = new RunOnceScheduler(() => this._showLoadingMessage(), 0);\r\n        this._asyncComputationPromise = null;\r\n        this._asyncComputationPromiseDone = false;\r\n        this._completeCallback = success;\r\n        this._errorCallback = error;\r\n        this._progressCallback = progress;\r\n    }\r\n    setHoverTime(hoverTime) {\r\n        this._hoverTime = hoverTime;\r\n    }\r\n    _firstWaitTime() {\r\n        return this._hoverTime / 2;\r\n    }\r\n    _secondWaitTime() {\r\n        return this._hoverTime / 2;\r\n    }\r\n    _loadingMessageTime() {\r\n        return 3 * this._hoverTime;\r\n    }\r\n    _triggerAsyncComputation() {\r\n        this._state = 2 /* SECOND_WAIT */;\r\n        this._secondWaitScheduler.schedule(this._secondWaitTime());\r\n        if (this._computer.computeAsync) {\r\n            this._asyncComputationPromiseDone = false;\r\n            this._asyncComputationPromise = createCancelablePromise(token => this._computer.computeAsync(token));\r\n            this._asyncComputationPromise.then((asyncResult) => {\r\n                this._asyncComputationPromiseDone = true;\r\n                this._withAsyncResult(asyncResult);\r\n            }, (e) => this._onError(e));\r\n        }\r\n        else {\r\n            this._asyncComputationPromiseDone = true;\r\n        }\r\n    }\r\n    _triggerSyncComputation() {\r\n        if (this._computer.computeSync) {\r\n            this._computer.onResult(this._computer.computeSync(), true);\r\n        }\r\n        if (this._asyncComputationPromiseDone) {\r\n            this._state = 0 /* IDLE */;\r\n            this._onComplete(this._computer.getResult());\r\n        }\r\n        else {\r\n            this._state = 3 /* WAITING_FOR_ASYNC_COMPUTATION */;\r\n            this._onProgress(this._computer.getResult());\r\n        }\r\n    }\r\n    _showLoadingMessage() {\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            this._onProgress(this._computer.getResultWithLoadingMessage());\r\n        }\r\n    }\r\n    _withAsyncResult(asyncResult) {\r\n        if (asyncResult) {\r\n            this._computer.onResult(asyncResult, false);\r\n        }\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            this._state = 0 /* IDLE */;\r\n            this._onComplete(this._computer.getResult());\r\n        }\r\n    }\r\n    _onComplete(value) {\r\n        this._completeCallback(value);\r\n    }\r\n    _onError(error) {\r\n        if (this._errorCallback) {\r\n            this._errorCallback(error);\r\n        }\r\n        else {\r\n            onUnexpectedError(error);\r\n        }\r\n    }\r\n    _onProgress(value) {\r\n        this._progressCallback(value);\r\n    }\r\n    start(mode) {\r\n        if (mode === 0 /* Delayed */) {\r\n            if (this._state === 0 /* IDLE */) {\r\n                this._state = 1 /* FIRST_WAIT */;\r\n                this._firstWaitScheduler.schedule(this._firstWaitTime());\r\n                this._loadingMessageScheduler.schedule(this._loadingMessageTime());\r\n            }\r\n        }\r\n        else {\r\n            switch (this._state) {\r\n                case 0 /* IDLE */:\r\n                    this._triggerAsyncComputation();\r\n                    this._secondWaitScheduler.cancel();\r\n                    this._triggerSyncComputation();\r\n                    break;\r\n                case 2 /* SECOND_WAIT */:\r\n                    this._secondWaitScheduler.cancel();\r\n                    this._triggerSyncComputation();\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    cancel() {\r\n        this._loadingMessageScheduler.cancel();\r\n        if (this._state === 1 /* FIRST_WAIT */) {\r\n            this._firstWaitScheduler.cancel();\r\n        }\r\n        if (this._state === 2 /* SECOND_WAIT */) {\r\n            this._secondWaitScheduler.cancel();\r\n            if (this._asyncComputationPromise) {\r\n                this._asyncComputationPromise.cancel();\r\n                this._asyncComputationPromise = null;\r\n            }\r\n        }\r\n        if (this._state === 3 /* WAITING_FOR_ASYNC_COMPUTATION */) {\r\n            if (this._asyncComputationPromise) {\r\n                this._asyncComputationPromise.cancel();\r\n                this._asyncComputationPromise = null;\r\n            }\r\n        }\r\n        this._state = 0 /* IDLE */;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './hover.css';\r\nimport * as dom from '../../dom.js';\r\nimport { Disposable } from '../../../common/lifecycle.js';\r\nimport { DomScrollableElement } from '../scrollbar/scrollableElement.js';\r\nconst $ = dom.$;\r\nexport class HoverWidget extends Disposable {\r\n    constructor() {\r\n        super();\r\n        this.containerDomNode = document.createElement('div');\r\n        this.containerDomNode.className = 'monaco-hover';\r\n        this.containerDomNode.tabIndex = 0;\r\n        this.containerDomNode.setAttribute('role', 'tooltip');\r\n        this.contentsDomNode = document.createElement('div');\r\n        this.contentsDomNode.className = 'monaco-hover-content';\r\n        this._scrollbar = this._register(new DomScrollableElement(this.contentsDomNode, {\r\n            consumeMouseWheelIfScrollbarIsNeeded: true\r\n        }));\r\n        this.containerDomNode.appendChild(this._scrollbar.getDomNode());\r\n    }\r\n    onContentsChanged() {\r\n        this._scrollbar.scanDomNode();\r\n    }\r\n}\r\nexport class HoverAction extends Disposable {\r\n    constructor(parent, actionOptions, keybindingLabel) {\r\n        super();\r\n        this.actionContainer = dom.append(parent, $('div.action-container'));\r\n        this.action = dom.append(this.actionContainer, $('a.action'));\r\n        this.action.setAttribute('href', '#');\r\n        this.action.setAttribute('role', 'button');\r\n        if (actionOptions.iconClass) {\r\n            dom.append(this.action, $(`span.icon.${actionOptions.iconClass}`));\r\n        }\r\n        const label = dom.append(this.action, $('span'));\r\n        label.textContent = keybindingLabel ? `${actionOptions.label} (${keybindingLabel})` : actionOptions.label;\r\n        this._register(dom.addDisposableListener(this.actionContainer, dom.EventType.CLICK, e => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            actionOptions.run(this.actionContainer);\r\n        }));\r\n        this.setEnabled(true);\r\n    }\r\n    static render(parent, actionOptions, keybindingLabel) {\r\n        return new HoverAction(parent, actionOptions, keybindingLabel);\r\n    }\r\n    setEnabled(enabled) {\r\n        if (enabled) {\r\n            this.actionContainer.classList.remove('disabled');\r\n            this.actionContainer.removeAttribute('aria-disabled');\r\n        }\r\n        else {\r\n            this.actionContainer.classList.add('disabled');\r\n            this.actionContainer.setAttribute('aria-disabled', 'true');\r\n        }\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport Severity from '../../../base/common/severity.js';\r\nimport { registerThemingParticipant } from '../../theme/common/themeService.js';\r\nimport { problemsErrorIconForeground, problemsInfoIconForeground, problemsWarningIconForeground } from '../../theme/common/colorRegistry.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nexport var SeverityIcon;\r\n(function (SeverityIcon) {\r\n    function className(severity) {\r\n        switch (severity) {\r\n            case Severity.Ignore:\r\n                return 'severity-ignore ' + Codicon.info.classNames;\r\n            case Severity.Info:\r\n                return Codicon.info.classNames;\r\n            case Severity.Warning:\r\n                return Codicon.warning.classNames;\r\n            case Severity.Error:\r\n                return Codicon.error.classNames;\r\n            default:\r\n                return '';\r\n        }\r\n    }\r\n    SeverityIcon.className = className;\r\n})(SeverityIcon || (SeverityIcon = {}));\r\nregisterThemingParticipant((theme, collector) => {\r\n    const errorIconForeground = theme.getColor(problemsErrorIconForeground);\r\n    if (errorIconForeground) {\r\n        const errorCodiconSelector = Codicon.error.cssSelector;\r\n        collector.addRule(`\n\t\t\t.monaco-editor .zone-widget ${errorCodiconSelector},\n\t\t\t.markers-panel .marker-icon${errorCodiconSelector},\n\t\t\t.text-search-provider-messages .providerMessage ${errorCodiconSelector},\n\t\t\t.extensions-viewlet > .extensions ${errorCodiconSelector} {\n\t\t\t\tcolor: ${errorIconForeground};\n\t\t\t}\n\t\t`);\r\n    }\r\n    const warningIconForeground = theme.getColor(problemsWarningIconForeground);\r\n    if (warningIconForeground) {\r\n        const warningCodiconSelector = Codicon.warning.cssSelector;\r\n        collector.addRule(`\n\t\t\t.monaco-editor .zone-widget ${warningCodiconSelector},\n\t\t\t.markers-panel .marker-icon${warningCodiconSelector},\n\t\t\t.extensions-viewlet > .extensions ${warningCodiconSelector},\n\t\t\t.extension-editor ${warningCodiconSelector},\n\t\t\t.text-search-provider-messages .providerMessage ${warningCodiconSelector},\n\t\t\t.preferences-editor ${warningCodiconSelector} {\n\t\t\t\tcolor: ${warningIconForeground};\n\t\t\t}\n\t\t`);\r\n    }\r\n    const infoIconForeground = theme.getColor(problemsInfoIconForeground);\r\n    if (infoIconForeground) {\r\n        const infoCodiconSelector = Codicon.info.cssSelector;\r\n        collector.addRule(`\n\t\t\t.monaco-editor .zone-widget ${infoCodiconSelector},\n\t\t\t.markers-panel .marker-icon${infoCodiconSelector},\n\t\t\t.extensions-viewlet > .extensions ${infoCodiconSelector},\n\t\t\t.text-search-provider-messages .providerMessage ${infoCodiconSelector},\n\t\t\t.extension-editor ${infoCodiconSelector} {\n\t\t\t\tcolor: ${infoIconForeground};\n\t\t\t}\n\t\t`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './media/gotoErrorWidget.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerColor, oneOf, textLinkForeground, editorErrorForeground, editorErrorBorder, editorWarningForeground, editorWarningBorder, editorInfoForeground, editorInfoBorder, textLinkActiveForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { Color } from '../../../base/common/color.js';\r\nimport { ScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { getBaseLabel } from '../../../base/common/labels.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { PeekViewWidget, peekViewTitleForeground, peekViewTitleInfoForeground } from '../peekView/peekView.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { SeverityIcon } from '../../../platform/severityIcon/common/severityIcon.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { MenuId, IMenuService } from '../../../platform/actions/common/actions.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { createAndFillInActionBarActions } from '../../../platform/actions/browser/menuEntryActionViewItem.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { splitLines } from '../../../base/common/strings.js';\r\nimport { ILabelService } from '../../../platform/label/common/label.js';\r\nclass MessageWidget {\r\n    constructor(parent, editor, onRelatedInformation, _openerService, _labelService) {\r\n        this._openerService = _openerService;\r\n        this._labelService = _labelService;\r\n        this._lines = 0;\r\n        this._longestLineLength = 0;\r\n        this._relatedDiagnostics = new WeakMap();\r\n        this._disposables = new DisposableStore();\r\n        this._editor = editor;\r\n        const domNode = document.createElement('div');\r\n        domNode.className = 'descriptioncontainer';\r\n        this._messageBlock = document.createElement('div');\r\n        this._messageBlock.classList.add('message');\r\n        this._messageBlock.setAttribute('aria-live', 'assertive');\r\n        this._messageBlock.setAttribute('role', 'alert');\r\n        domNode.appendChild(this._messageBlock);\r\n        this._relatedBlock = document.createElement('div');\r\n        domNode.appendChild(this._relatedBlock);\r\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', event => {\r\n            event.preventDefault();\r\n            const related = this._relatedDiagnostics.get(event.target);\r\n            if (related) {\r\n                onRelatedInformation(related);\r\n            }\r\n        }));\r\n        this._scrollable = new ScrollableElement(domNode, {\r\n            horizontal: 1 /* Auto */,\r\n            vertical: 1 /* Auto */,\r\n            useShadows: false,\r\n            horizontalScrollbarSize: 3,\r\n            verticalScrollbarSize: 3\r\n        });\r\n        parent.appendChild(this._scrollable.getDomNode());\r\n        this._disposables.add(this._scrollable.onScroll(e => {\r\n            domNode.style.left = `-${e.scrollLeft}px`;\r\n            domNode.style.top = `-${e.scrollTop}px`;\r\n        }));\r\n        this._disposables.add(this._scrollable);\r\n    }\r\n    dispose() {\r\n        dispose(this._disposables);\r\n    }\r\n    update(marker) {\r\n        const { source, message, relatedInformation, code } = marker;\r\n        let sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\r\n        if (code) {\r\n            if (typeof code === 'string') {\r\n                sourceAndCodeLength += code.length;\r\n            }\r\n            else {\r\n                sourceAndCodeLength += code.value.length;\r\n            }\r\n        }\r\n        const lines = splitLines(message);\r\n        this._lines = lines.length;\r\n        this._longestLineLength = 0;\r\n        for (const line of lines) {\r\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\r\n        }\r\n        dom.clearNode(this._messageBlock);\r\n        this._messageBlock.setAttribute('aria-label', this.getAriaLabel(marker));\r\n        this._editor.applyFontInfo(this._messageBlock);\r\n        let lastLineElement = this._messageBlock;\r\n        for (const line of lines) {\r\n            lastLineElement = document.createElement('div');\r\n            lastLineElement.innerText = line;\r\n            if (line === '') {\r\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\r\n            }\r\n            this._messageBlock.appendChild(lastLineElement);\r\n        }\r\n        if (source || code) {\r\n            const detailsElement = document.createElement('span');\r\n            detailsElement.classList.add('details');\r\n            lastLineElement.appendChild(detailsElement);\r\n            if (source) {\r\n                const sourceElement = document.createElement('span');\r\n                sourceElement.innerText = source;\r\n                sourceElement.classList.add('source');\r\n                detailsElement.appendChild(sourceElement);\r\n            }\r\n            if (code) {\r\n                if (typeof code === 'string') {\r\n                    const codeElement = document.createElement('span');\r\n                    codeElement.innerText = `(${code})`;\r\n                    codeElement.classList.add('code');\r\n                    detailsElement.appendChild(codeElement);\r\n                }\r\n                else {\r\n                    this._codeLink = dom.$('a.code-link');\r\n                    this._codeLink.setAttribute('href', `${code.target.toString()}`);\r\n                    this._codeLink.onclick = (e) => {\r\n                        this._openerService.open(code.target, { allowCommands: true });\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                    };\r\n                    const codeElement = dom.append(this._codeLink, dom.$('span'));\r\n                    codeElement.innerText = code.value;\r\n                    detailsElement.appendChild(this._codeLink);\r\n                }\r\n            }\r\n        }\r\n        dom.clearNode(this._relatedBlock);\r\n        this._editor.applyFontInfo(this._relatedBlock);\r\n        if (isNonEmptyArray(relatedInformation)) {\r\n            const relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\r\n            relatedInformationNode.style.paddingTop = `${Math.floor(this._editor.getOption(57 /* lineHeight */) * 0.66)}px`;\r\n            this._lines += 1;\r\n            for (const related of relatedInformation) {\r\n                let container = document.createElement('div');\r\n                let relatedResource = document.createElement('a');\r\n                relatedResource.classList.add('filename');\r\n                relatedResource.innerText = `${getBaseLabel(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `;\r\n                relatedResource.title = this._labelService.getUriLabel(related.resource);\r\n                this._relatedDiagnostics.set(relatedResource, related);\r\n                let relatedMessage = document.createElement('span');\r\n                relatedMessage.innerText = related.message;\r\n                container.appendChild(relatedResource);\r\n                container.appendChild(relatedMessage);\r\n                this._lines += 1;\r\n                relatedInformationNode.appendChild(container);\r\n            }\r\n        }\r\n        const fontInfo = this._editor.getOption(41 /* fontInfo */);\r\n        const scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\r\n        const scrollHeight = fontInfo.lineHeight * this._lines;\r\n        this._scrollable.setScrollDimensions({ scrollWidth, scrollHeight });\r\n    }\r\n    layout(height, width) {\r\n        this._scrollable.getDomNode().style.height = `${height}px`;\r\n        this._scrollable.getDomNode().style.width = `${width}px`;\r\n        this._scrollable.setScrollDimensions({ width, height });\r\n    }\r\n    getHeightInLines() {\r\n        return Math.min(17, this._lines);\r\n    }\r\n    getAriaLabel(marker) {\r\n        let severityLabel = '';\r\n        switch (marker.severity) {\r\n            case MarkerSeverity.Error:\r\n                severityLabel = nls.localize('Error', \"Error\");\r\n                break;\r\n            case MarkerSeverity.Warning:\r\n                severityLabel = nls.localize('Warning', \"Warning\");\r\n                break;\r\n            case MarkerSeverity.Info:\r\n                severityLabel = nls.localize('Info', \"Info\");\r\n                break;\r\n            case MarkerSeverity.Hint:\r\n                severityLabel = nls.localize('Hint', \"Hint\");\r\n                break;\r\n        }\r\n        let ariaLabel = nls.localize('marker aria', \"{0} at {1}. \", severityLabel, marker.startLineNumber + ':' + marker.startColumn);\r\n        const model = this._editor.getModel();\r\n        if (model && (marker.startLineNumber <= model.getLineCount()) && (marker.startLineNumber >= 1)) {\r\n            const lineContent = model.getLineContent(marker.startLineNumber);\r\n            ariaLabel = `${lineContent}, ${ariaLabel}`;\r\n        }\r\n        return ariaLabel;\r\n    }\r\n}\r\nlet MarkerNavigationWidget = class MarkerNavigationWidget extends PeekViewWidget {\r\n    constructor(editor, _themeService, _openerService, _menuService, instantiationService, _contextKeyService, _labelService) {\r\n        super(editor, { showArrow: true, showFrame: true, isAccessible: true }, instantiationService);\r\n        this._themeService = _themeService;\r\n        this._openerService = _openerService;\r\n        this._menuService = _menuService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._labelService = _labelService;\r\n        this._callOnDispose = new DisposableStore();\r\n        this._onDidSelectRelatedInformation = new Emitter();\r\n        this.onDidSelectRelatedInformation = this._onDidSelectRelatedInformation.event;\r\n        this._severity = MarkerSeverity.Warning;\r\n        this._backgroundColor = Color.white;\r\n        this._applyTheme(_themeService.getColorTheme());\r\n        this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\r\n        this.create();\r\n    }\r\n    _applyTheme(theme) {\r\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\r\n        let colorId = editorMarkerNavigationError;\r\n        if (this._severity === MarkerSeverity.Warning) {\r\n            colorId = editorMarkerNavigationWarning;\r\n        }\r\n        else if (this._severity === MarkerSeverity.Info) {\r\n            colorId = editorMarkerNavigationInfo;\r\n        }\r\n        const frameColor = theme.getColor(colorId);\r\n        this.style({\r\n            arrowColor: frameColor,\r\n            frameColor: frameColor,\r\n            headerBackgroundColor: this._backgroundColor,\r\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\r\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\r\n        }); // style() will trigger _applyStyles\r\n    }\r\n    _applyStyles() {\r\n        if (this._parentContainer) {\r\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\r\n        }\r\n        super._applyStyles();\r\n    }\r\n    dispose() {\r\n        this._callOnDispose.dispose();\r\n        super.dispose();\r\n    }\r\n    _fillHead(container) {\r\n        super._fillHead(container);\r\n        this._disposables.add(this._actionbarWidget.actionRunner.onBeforeRun(e => this.editor.focus()));\r\n        const actions = [];\r\n        const menu = this._menuService.createMenu(MarkerNavigationWidget.TitleMenu, this._contextKeyService);\r\n        createAndFillInActionBarActions(menu, undefined, actions);\r\n        this._actionbarWidget.push(actions, { label: false, icon: true, index: 0 });\r\n        menu.dispose();\r\n    }\r\n    _fillTitleIcon(container) {\r\n        this._icon = dom.append(container, dom.$(''));\r\n    }\r\n    _fillBody(container) {\r\n        this._parentContainer = container;\r\n        container.classList.add('marker-widget');\r\n        this._parentContainer.tabIndex = 0;\r\n        this._parentContainer.setAttribute('role', 'tooltip');\r\n        this._container = document.createElement('div');\r\n        container.appendChild(this._container);\r\n        this._message = new MessageWidget(this._container, this.editor, related => this._onDidSelectRelatedInformation.fire(related), this._openerService, this._labelService);\r\n        this._disposables.add(this._message);\r\n    }\r\n    show() {\r\n        throw new Error('call showAtMarker');\r\n    }\r\n    showAtMarker(marker, markerIdx, markerCount) {\r\n        // update:\r\n        // * title\r\n        // * message\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n        // update frame color (only applied on 'show')\r\n        this._severity = marker.severity;\r\n        this._applyTheme(this._themeService.getColorTheme());\r\n        // show\r\n        let range = Range.lift(marker);\r\n        const editorPosition = this.editor.getPosition();\r\n        let position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\r\n        super.show(position, this.computeRequiredHeight());\r\n        const model = this.editor.getModel();\r\n        if (model) {\r\n            const detail = markerCount > 1\r\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\r\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\r\n            this.setTitle(basename(model.uri), detail);\r\n        }\r\n        this._icon.className = `codicon ${SeverityIcon.className(MarkerSeverity.toSeverity(this._severity))}`;\r\n        this.editor.revealPositionNearTop(position, 0 /* Smooth */);\r\n        this.editor.focus();\r\n    }\r\n    updateMarker(marker) {\r\n        this._container.classList.remove('stale');\r\n        this._message.update(marker);\r\n    }\r\n    showStale() {\r\n        this._container.classList.add('stale');\r\n        this._relayout();\r\n    }\r\n    _doLayoutBody(heightInPixel, widthInPixel) {\r\n        super._doLayoutBody(heightInPixel, widthInPixel);\r\n        this._heightInPixel = heightInPixel;\r\n        this._message.layout(heightInPixel, widthInPixel);\r\n        this._container.style.height = `${heightInPixel}px`;\r\n    }\r\n    _onWidth(widthInPixel) {\r\n        this._message.layout(this._heightInPixel, widthInPixel);\r\n    }\r\n    _relayout() {\r\n        super._relayout(this.computeRequiredHeight());\r\n    }\r\n    computeRequiredHeight() {\r\n        return 3 + this._message.getHeightInLines();\r\n    }\r\n};\r\nMarkerNavigationWidget.TitleMenu = new MenuId('gotoErrorTitleMenu');\r\nMarkerNavigationWidget = __decorate([\r\n    __param(1, IThemeService),\r\n    __param(2, IOpenerService),\r\n    __param(3, IMenuService),\r\n    __param(4, IInstantiationService),\r\n    __param(5, IContextKeyService),\r\n    __param(6, ILabelService)\r\n], MarkerNavigationWidget);\r\nexport { MarkerNavigationWidget };\r\n// theming\r\nlet errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\r\nlet warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\r\nlet infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\r\nexport const editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hc: errorDefault }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\r\nexport const editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hc: warningDefault }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\r\nexport const editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hc: infoDefault }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\r\nexport const editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: '#2D2D30', light: Color.white, hc: '#0C141F' }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\r\nregisterThemingParticipant((theme, collector) => {\r\n    const linkFg = theme.getColor(textLinkForeground);\r\n    if (linkFg) {\r\n        collector.addRule(`.monaco-editor .marker-widget a.code-link span { color: ${linkFg}; }`);\r\n    }\r\n    const activeLinkFg = theme.getColor(textLinkActiveForeground);\r\n    if (activeLinkFg) {\r\n        collector.addRule(`.monaco-editor .marker-widget a.code-link span:hover { color: ${activeLinkFg}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { IMarkerService, MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { compare } from '../../../base/common/strings.js';\r\nimport { binarySearch } from '../../../base/common/arrays.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nexport class MarkerCoordinate {\r\n    constructor(marker, index, total) {\r\n        this.marker = marker;\r\n        this.index = index;\r\n        this.total = total;\r\n    }\r\n}\r\nlet MarkerList = class MarkerList {\r\n    constructor(resourceFilter, _markerService) {\r\n        this._markerService = _markerService;\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._dispoables = new DisposableStore();\r\n        this._markers = [];\r\n        this._nextIdx = -1;\r\n        if (URI.isUri(resourceFilter)) {\r\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\r\n        }\r\n        else if (resourceFilter) {\r\n            this._resourceFilter = resourceFilter;\r\n        }\r\n        const updateMarker = () => {\r\n            this._markers = this._markerService.read({\r\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\r\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\r\n            });\r\n            if (typeof resourceFilter === 'function') {\r\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\r\n            }\r\n            this._markers.sort(MarkerList._compareMarker);\r\n        };\r\n        updateMarker();\r\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\r\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\r\n                updateMarker();\r\n                this._nextIdx = -1;\r\n                this._onDidChange.fire();\r\n            }\r\n        }));\r\n    }\r\n    dispose() {\r\n        this._dispoables.dispose();\r\n        this._onDidChange.dispose();\r\n    }\r\n    matches(uri) {\r\n        if (!this._resourceFilter && !uri) {\r\n            return true;\r\n        }\r\n        if (!this._resourceFilter || !uri) {\r\n            return false;\r\n        }\r\n        return this._resourceFilter(uri);\r\n    }\r\n    get selected() {\r\n        const marker = this._markers[this._nextIdx];\r\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\r\n    }\r\n    _initIdx(model, position, fwd) {\r\n        let found = false;\r\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\r\n        if (idx < 0) {\r\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\r\n            if (idx < 0) {\r\n                idx = ~idx;\r\n            }\r\n        }\r\n        for (let i = idx; i < this._markers.length; i++) {\r\n            let range = Range.lift(this._markers[i]);\r\n            if (range.isEmpty()) {\r\n                const word = model.getWordAtPosition(range.getStartPosition());\r\n                if (word) {\r\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\r\n                }\r\n            }\r\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\r\n                this._nextIdx = i;\r\n                found = true;\r\n                break;\r\n            }\r\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\r\n                break;\r\n            }\r\n        }\r\n        if (!found) {\r\n            // after the last change\r\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\r\n        }\r\n        if (this._nextIdx < 0) {\r\n            this._nextIdx = this._markers.length - 1;\r\n        }\r\n    }\r\n    resetIndex() {\r\n        this._nextIdx = -1;\r\n    }\r\n    move(fwd, model, position) {\r\n        if (this._markers.length === 0) {\r\n            return false;\r\n        }\r\n        let oldIdx = this._nextIdx;\r\n        if (this._nextIdx === -1) {\r\n            this._initIdx(model, position, fwd);\r\n        }\r\n        else if (fwd) {\r\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\r\n        }\r\n        else if (!fwd) {\r\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\r\n        }\r\n        if (oldIdx !== this._nextIdx) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    find(uri, position) {\r\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\r\n        if (idx < 0) {\r\n            return undefined;\r\n        }\r\n        for (; idx < this._markers.length; idx++) {\r\n            if (Range.containsPosition(this._markers[idx], position)) {\r\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    static _compareMarker(a, b) {\r\n        let res = compare(a.resource.toString(), b.resource.toString());\r\n        if (res === 0) {\r\n            res = MarkerSeverity.compare(a.severity, b.severity);\r\n        }\r\n        if (res === 0) {\r\n            res = Range.compareRangesUsingStarts(a, b);\r\n        }\r\n        return res;\r\n    }\r\n};\r\nMarkerList = __decorate([\r\n    __param(1, IMarkerService)\r\n], MarkerList);\r\nexport { MarkerList };\r\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\r\nlet MarkerNavigationService = class MarkerNavigationService {\r\n    constructor(_markerService) {\r\n        this._markerService = _markerService;\r\n        this._provider = new LinkedList();\r\n    }\r\n    getMarkerList(resource) {\r\n        for (let provider of this._provider) {\r\n            const result = provider.getMarkerList(resource);\r\n            if (result) {\r\n                return result;\r\n            }\r\n        }\r\n        // default\r\n        return new MarkerList(resource, this._markerService);\r\n    }\r\n};\r\nMarkerNavigationService = __decorate([\r\n    __param(0, IMarkerService)\r\n], MarkerNavigationService);\r\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, true);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { MenuId } from '../../../platform/actions/common/actions.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IMarkerNavigationService } from './markerNavigationService.js';\r\nimport { registerIcon } from '../../../platform/theme/common/iconRegistry.js';\r\nlet MarkerController = class MarkerController {\r\n    constructor(editor, _markerNavigationService, _contextKeyService, _editorService, _instantiationService) {\r\n        this._markerNavigationService = _markerNavigationService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._editorService = _editorService;\r\n        this._instantiationService = _instantiationService;\r\n        this._sessionDispoables = new DisposableStore();\r\n        this._editor = editor;\r\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(MarkerController.ID);\r\n    }\r\n    dispose() {\r\n        this._cleanUp();\r\n        this._sessionDispoables.dispose();\r\n    }\r\n    _cleanUp() {\r\n        this._widgetVisible.reset();\r\n        this._sessionDispoables.clear();\r\n        this._widget = undefined;\r\n        this._model = undefined;\r\n    }\r\n    _getOrCreateModel(uri) {\r\n        if (this._model && this._model.matches(uri)) {\r\n            return this._model;\r\n        }\r\n        let reusePosition = false;\r\n        if (this._model) {\r\n            reusePosition = true;\r\n            this._cleanUp();\r\n        }\r\n        this._model = this._markerNavigationService.getMarkerList(uri);\r\n        if (reusePosition) {\r\n            this._model.move(true, this._editor.getModel(), this._editor.getPosition());\r\n        }\r\n        this._widget = this._instantiationService.createInstance(MarkerNavigationWidget, this._editor);\r\n        this._widget.onDidClose(() => this.close(), this, this._sessionDispoables);\r\n        this._widgetVisible.set(true);\r\n        this._sessionDispoables.add(this._model);\r\n        this._sessionDispoables.add(this._widget);\r\n        // follow cursor\r\n        this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e => {\r\n            var _a, _b, _c;\r\n            if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.selected) || !Range.containsPosition((_b = this._model) === null || _b === void 0 ? void 0 : _b.selected.marker, e.position)) {\r\n                (_c = this._model) === null || _c === void 0 ? void 0 : _c.resetIndex();\r\n            }\r\n        }));\r\n        // update markers\r\n        this._sessionDispoables.add(this._model.onDidChange(() => {\r\n            if (!this._widget || !this._widget.position || !this._model) {\r\n                return;\r\n            }\r\n            const info = this._model.find(this._editor.getModel().uri, this._widget.position);\r\n            if (info) {\r\n                this._widget.updateMarker(info.marker);\r\n            }\r\n            else {\r\n                this._widget.showStale();\r\n            }\r\n        }));\r\n        // open related\r\n        this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(related => {\r\n            this._editorService.openCodeEditor({\r\n                resource: related.resource,\r\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\r\n            }, this._editor);\r\n            this.close(false);\r\n        }));\r\n        this._sessionDispoables.add(this._editor.onDidChangeModel(() => this._cleanUp()));\r\n        return this._model;\r\n    }\r\n    close(focusEditor = true) {\r\n        this._cleanUp();\r\n        if (focusEditor) {\r\n            this._editor.focus();\r\n        }\r\n    }\r\n    showAtMarker(marker) {\r\n        if (this._editor.hasModel()) {\r\n            const model = this._getOrCreateModel(this._editor.getModel().uri);\r\n            model.resetIndex();\r\n            model.move(true, this._editor.getModel(), new Position(marker.startLineNumber, marker.startColumn));\r\n            if (model.selected) {\r\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\r\n            }\r\n        }\r\n    }\r\n    nagivate(next, multiFile) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this._editor.hasModel()) {\r\n                const model = this._getOrCreateModel(multiFile ? undefined : this._editor.getModel().uri);\r\n                model.move(next, this._editor.getModel(), this._editor.getPosition());\r\n                if (!model.selected) {\r\n                    return;\r\n                }\r\n                if (model.selected.marker.resource.toString() !== this._editor.getModel().uri.toString()) {\r\n                    // show in different editor\r\n                    this._cleanUp();\r\n                    const otherEditor = yield this._editorService.openCodeEditor({\r\n                        resource: model.selected.marker.resource,\r\n                        options: { pinned: false, revealIfOpened: true, selectionRevealType: 2 /* NearTop */, selection: model.selected.marker }\r\n                    }, this._editor);\r\n                    if (otherEditor) {\r\n                        MarkerController.get(otherEditor).close();\r\n                        MarkerController.get(otherEditor).nagivate(next, multiFile);\r\n                    }\r\n                }\r\n                else {\r\n                    // show in this editor\r\n                    this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\r\n                }\r\n            }\r\n        });\r\n    }\r\n};\r\nMarkerController.ID = 'editor.contrib.markerController';\r\nMarkerController = __decorate([\r\n    __param(1, IMarkerNavigationService),\r\n    __param(2, IContextKeyService),\r\n    __param(3, ICodeEditorService),\r\n    __param(4, IInstantiationService)\r\n], MarkerController);\r\nexport { MarkerController };\r\nclass MarkerNavigationAction extends EditorAction {\r\n    constructor(_next, _multiFile, opts) {\r\n        super(opts);\r\n        this._next = _next;\r\n        this._multiFile = _multiFile;\r\n    }\r\n    run(_accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (editor.hasModel()) {\r\n                MarkerController.get(editor).nagivate(this._next, this._multiFile);\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class NextMarkerAction extends MarkerNavigationAction {\r\n    constructor() {\r\n        super(true, false, {\r\n            id: NextMarkerAction.ID,\r\n            label: NextMarkerAction.LABEL,\r\n            alias: 'Go to Next Problem (Error, Warning, Info)',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 512 /* Alt */ | 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MarkerNavigationWidget.TitleMenu,\r\n                title: NextMarkerAction.LABEL,\r\n                icon: registerIcon('marker-navigation-next', Codicon.chevronDown, nls.localize('nextMarkerIcon', 'Icon for goto next marker.')),\r\n                group: 'navigation',\r\n                order: 1\r\n            }\r\n        });\r\n    }\r\n}\r\nNextMarkerAction.ID = 'editor.action.marker.next';\r\nNextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\r\nclass PrevMarkerAction extends MarkerNavigationAction {\r\n    constructor() {\r\n        super(false, false, {\r\n            id: PrevMarkerAction.ID,\r\n            label: PrevMarkerAction.LABEL,\r\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MarkerNavigationWidget.TitleMenu,\r\n                title: NextMarkerAction.LABEL,\r\n                icon: registerIcon('marker-navigation-previous', Codicon.chevronUp, nls.localize('previousMarkerIcon', 'Icon for goto previous marker.')),\r\n                group: 'navigation',\r\n                order: 2\r\n            }\r\n        });\r\n    }\r\n}\r\nPrevMarkerAction.ID = 'editor.action.marker.prev';\r\nPrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\r\nclass NextMarkerInFilesAction extends MarkerNavigationAction {\r\n    constructor() {\r\n        super(true, true, {\r\n            id: 'editor.action.marker.nextInFiles',\r\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarGoMenu,\r\n                title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\"),\r\n                group: '6_problem_nav',\r\n                order: 1\r\n            }\r\n        });\r\n    }\r\n}\r\nclass PrevMarkerInFilesAction extends MarkerNavigationAction {\r\n    constructor() {\r\n        super(false, true, {\r\n            id: 'editor.action.marker.prevInFiles',\r\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\r\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 1024 /* Shift */ | 66 /* F8 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarGoMenu,\r\n                title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\"),\r\n                group: '6_problem_nav',\r\n                order: 2\r\n            }\r\n        });\r\n    }\r\n}\r\nregisterEditorContribution(MarkerController.ID, MarkerController);\r\nregisterEditorAction(NextMarkerAction);\r\nregisterEditorAction(PrevMarkerAction);\r\nregisterEditorAction(NextMarkerInFilesAction);\r\nregisterEditorAction(PrevMarkerInFilesAction);\r\nconst CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\r\nconst MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\r\nregisterEditorCommand(new MarkerCommand({\r\n    id: 'closeMarkersNavigation',\r\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\r\n    handler: x => x.close(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 50,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { toDisposable, DisposableStore, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { IMarkerData, MarkerSeverity } from '../../../platform/markers/common/markers.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nimport { IMarkerDecorationsService } from '../../common/services/markersDecorationService.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { MarkerController, NextMarkerAction } from '../gotoError/gotoError.js';\r\nimport { createCancelablePromise, disposableTimeout } from '../../../base/common/async.js';\r\nimport { getCodeActions } from '../codeAction/codeAction.js';\r\nimport { QuickFixAction, QuickFixController } from '../codeAction/codeActionCommands.js';\r\nimport { CodeActionKind } from '../codeAction/types.js';\r\nimport { Progress } from '../../../platform/progress/common/progress.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { textLinkActiveForeground, textLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nconst $ = dom.$;\r\nexport class MarkerHover {\r\n    constructor(owner, range, marker) {\r\n        this.owner = owner;\r\n        this.range = range;\r\n        this.marker = marker;\r\n    }\r\n    isValidForHoverAnchor(anchor) {\r\n        return (anchor.type === 1 /* Range */\r\n            && this.range.startColumn <= anchor.range.startColumn\r\n            && this.range.endColumn >= anchor.range.endColumn);\r\n    }\r\n}\r\nconst markerCodeActionTrigger = {\r\n    type: 1 /* Invoke */,\r\n    filter: { include: CodeActionKind.QuickFix }\r\n};\r\nlet MarkerHoverParticipant = class MarkerHoverParticipant {\r\n    constructor(_editor, _hover, _markerDecorationsService, _openerService) {\r\n        this._editor = _editor;\r\n        this._hover = _hover;\r\n        this._markerDecorationsService = _markerDecorationsService;\r\n        this._openerService = _openerService;\r\n        this.recentMarkerCodeActionsInfo = undefined;\r\n    }\r\n    computeSync(anchor, lineDecorations) {\r\n        if (!this._editor.hasModel() || anchor.type !== 1 /* Range */) {\r\n            return [];\r\n        }\r\n        const model = this._editor.getModel();\r\n        const lineNumber = anchor.range.startLineNumber;\r\n        const maxColumn = model.getLineMaxColumn(lineNumber);\r\n        const result = [];\r\n        for (const d of lineDecorations) {\r\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\r\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\r\n            const marker = this._markerDecorationsService.getMarker(model.uri, d);\r\n            if (!marker) {\r\n                continue;\r\n            }\r\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\r\n            result.push(new MarkerHover(this, range, marker));\r\n        }\r\n        return result;\r\n    }\r\n    renderHoverParts(hoverParts, fragment, statusBar) {\r\n        if (!hoverParts.length) {\r\n            return Disposable.None;\r\n        }\r\n        const disposables = new DisposableStore();\r\n        hoverParts.forEach(msg => fragment.appendChild(this.renderMarkerHover(msg, disposables)));\r\n        const markerHoverForStatusbar = hoverParts.length === 1 ? hoverParts[0] : hoverParts.sort((a, b) => MarkerSeverity.compare(a.marker.severity, b.marker.severity))[0];\r\n        this.renderMarkerStatusbar(markerHoverForStatusbar, statusBar, disposables);\r\n        return disposables;\r\n    }\r\n    renderMarkerHover(markerHover, disposables) {\r\n        const hoverElement = $('div.hover-row');\r\n        const markerElement = dom.append(hoverElement, $('div.marker.hover-contents'));\r\n        const { source, message, code, relatedInformation } = markerHover.marker;\r\n        this._editor.applyFontInfo(markerElement);\r\n        const messageElement = dom.append(markerElement, $('span'));\r\n        messageElement.style.whiteSpace = 'pre-wrap';\r\n        messageElement.innerText = message;\r\n        if (source || code) {\r\n            // Code has link\r\n            if (code && typeof code !== 'string') {\r\n                const sourceAndCodeElement = $('span');\r\n                if (source) {\r\n                    const sourceElement = dom.append(sourceAndCodeElement, $('span'));\r\n                    sourceElement.innerText = source;\r\n                }\r\n                const codeLink = dom.append(sourceAndCodeElement, $('a.code-link'));\r\n                codeLink.setAttribute('href', code.target.toString());\r\n                disposables.add(dom.addDisposableListener(codeLink, 'click', (e) => {\r\n                    this._openerService.open(code.target, { allowCommands: true });\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                }));\r\n                const codeElement = dom.append(codeLink, $('span'));\r\n                codeElement.innerText = code.value;\r\n                const detailsElement = dom.append(markerElement, sourceAndCodeElement);\r\n                detailsElement.style.opacity = '0.6';\r\n                detailsElement.style.paddingLeft = '6px';\r\n            }\r\n            else {\r\n                const detailsElement = dom.append(markerElement, $('span'));\r\n                detailsElement.style.opacity = '0.6';\r\n                detailsElement.style.paddingLeft = '6px';\r\n                detailsElement.innerText = source && code ? `${source}(${code})` : source ? source : `(${code})`;\r\n            }\r\n        }\r\n        if (isNonEmptyArray(relatedInformation)) {\r\n            for (const { message, resource, startLineNumber, startColumn } of relatedInformation) {\r\n                const relatedInfoContainer = dom.append(markerElement, $('div'));\r\n                relatedInfoContainer.style.marginTop = '8px';\r\n                const a = dom.append(relatedInfoContainer, $('a'));\r\n                a.innerText = `${basename(resource)}(${startLineNumber}, ${startColumn}): `;\r\n                a.style.cursor = 'pointer';\r\n                disposables.add(dom.addDisposableListener(a, 'click', (e) => {\r\n                    e.stopPropagation();\r\n                    e.preventDefault();\r\n                    if (this._openerService) {\r\n                        this._openerService.open(resource, {\r\n                            fromUserGesture: true,\r\n                            editorOptions: { selection: { startLineNumber, startColumn } }\r\n                        }).catch(onUnexpectedError);\r\n                    }\r\n                }));\r\n                const messageElement = dom.append(relatedInfoContainer, $('span'));\r\n                messageElement.innerText = message;\r\n                this._editor.applyFontInfo(messageElement);\r\n            }\r\n        }\r\n        return hoverElement;\r\n    }\r\n    renderMarkerStatusbar(markerHover, statusBar, disposables) {\r\n        if (markerHover.marker.severity === MarkerSeverity.Error || markerHover.marker.severity === MarkerSeverity.Warning || markerHover.marker.severity === MarkerSeverity.Info) {\r\n            statusBar.addAction({\r\n                label: nls.localize('view problem', \"View Problem\"),\r\n                commandId: NextMarkerAction.ID,\r\n                run: () => {\r\n                    this._hover.hide();\r\n                    MarkerController.get(this._editor).showAtMarker(markerHover.marker);\r\n                    this._editor.focus();\r\n                }\r\n            });\r\n        }\r\n        if (!this._editor.getOption(79 /* readOnly */)) {\r\n            const quickfixPlaceholderElement = statusBar.append($('div'));\r\n            if (this.recentMarkerCodeActionsInfo) {\r\n                if (IMarkerData.makeKey(this.recentMarkerCodeActionsInfo.marker) === IMarkerData.makeKey(markerHover.marker)) {\r\n                    if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\r\n                        quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\r\n                    }\r\n                }\r\n                else {\r\n                    this.recentMarkerCodeActionsInfo = undefined;\r\n                }\r\n            }\r\n            const updatePlaceholderDisposable = this.recentMarkerCodeActionsInfo && !this.recentMarkerCodeActionsInfo.hasCodeActions ? Disposable.None : disposables.add(disposableTimeout(() => quickfixPlaceholderElement.textContent = nls.localize('checkingForQuickFixes', \"Checking for quick fixes...\"), 200));\r\n            if (!quickfixPlaceholderElement.textContent) {\r\n                // Have some content in here to avoid flickering\r\n                quickfixPlaceholderElement.textContent = String.fromCharCode(0xA0); // &nbsp;\r\n            }\r\n            const codeActionsPromise = this.getCodeActions(markerHover.marker);\r\n            disposables.add(toDisposable(() => codeActionsPromise.cancel()));\r\n            codeActionsPromise.then(actions => {\r\n                updatePlaceholderDisposable.dispose();\r\n                this.recentMarkerCodeActionsInfo = { marker: markerHover.marker, hasCodeActions: actions.validActions.length > 0 };\r\n                if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\r\n                    actions.dispose();\r\n                    quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\r\n                    return;\r\n                }\r\n                quickfixPlaceholderElement.style.display = 'none';\r\n                let showing = false;\r\n                disposables.add(toDisposable(() => {\r\n                    if (!showing) {\r\n                        actions.dispose();\r\n                    }\r\n                }));\r\n                statusBar.addAction({\r\n                    label: nls.localize('quick fixes', \"Quick Fix...\"),\r\n                    commandId: QuickFixAction.Id,\r\n                    run: (target) => {\r\n                        showing = true;\r\n                        const controller = QuickFixController.get(this._editor);\r\n                        const elementPosition = dom.getDomNodePagePosition(target);\r\n                        // Hide the hover pre-emptively, otherwise the editor can close the code actions\r\n                        // context menu as well when using keyboard navigation\r\n                        this._hover.hide();\r\n                        controller.showCodeActions(markerCodeActionTrigger, actions, {\r\n                            x: elementPosition.left + 6,\r\n                            y: elementPosition.top + elementPosition.height + 6\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }\r\n    getCodeActions(marker) {\r\n        return createCancelablePromise(cancellationToken => {\r\n            return getCodeActions(this._editor.getModel(), new Range(marker.startLineNumber, marker.startColumn, marker.endLineNumber, marker.endColumn), markerCodeActionTrigger, Progress.None, cancellationToken);\r\n        });\r\n    }\r\n};\r\nMarkerHoverParticipant = __decorate([\r\n    __param(2, IMarkerDecorationsService),\r\n    __param(3, IOpenerService)\r\n], MarkerHoverParticipant);\r\nexport { MarkerHoverParticipant };\r\nregisterThemingParticipant((theme, collector) => {\r\n    const linkFg = theme.getColor(textLinkForeground);\r\n    if (linkFg) {\r\n        collector.addRule(`.monaco-hover .hover-contents a.code-link span { color: ${linkFg}; }`);\r\n    }\r\n    const activeLinkFg = theme.getColor(textLinkActiveForeground);\r\n    if (activeLinkFg) {\r\n        collector.addRule(`.monaco-hover .hover-contents a.code-link span:hover { color: ${activeLinkFg}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar _a;\r\nimport * as DOM from './dom.js';\r\nimport { createElement } from './formattedTextRenderer.js';\r\nimport { onUnexpectedError } from '../common/errors.js';\r\nimport { parseHrefAndDimensions, removeMarkdownEscapes } from '../common/htmlContent.js';\r\nimport { defaultGenerator } from '../common/idGenerator.js';\r\nimport * as marked from '../common/marked/marked.js';\r\nimport { insane } from '../common/insane/insane.js';\r\nimport { parse } from '../common/marshalling.js';\r\nimport { cloneAndChange } from '../common/objects.js';\r\nimport { escape } from '../common/strings.js';\r\nimport { URI } from '../common/uri.js';\r\nimport { FileAccess, Schemas } from '../common/network.js';\r\nimport { markdownEscapeEscapedIcons } from '../common/iconLabels.js';\r\nimport { resolvePath } from '../common/resources.js';\r\nimport { StandardMouseEvent } from './mouseEvent.js';\r\nimport { renderLabelWithIcons } from './ui/iconLabel/iconLabels.js';\r\nimport { Event } from '../common/event.js';\r\nimport { DomEmitter } from './event.js';\r\nconst _ttpInsane = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy('insane', {\r\n    createHTML(value, options) {\r\n        return insane(value, options);\r\n    }\r\n});\r\n/**\r\n * Low-level way create a html element from a markdown string.\r\n *\r\n * **Note** that for most cases you should be using [`MarkdownRenderer`](./src/vs/editor/browser/core/markdownRenderer.ts)\r\n * which comes with support for pretty code block rendering and which uses the default way of handling links.\r\n */\r\nexport function renderMarkdown(markdown, options = {}, markedOptions = {}) {\r\n    var _a;\r\n    const element = createElement(options);\r\n    const _uriMassage = function (part) {\r\n        let data;\r\n        try {\r\n            data = parse(decodeURIComponent(part));\r\n        }\r\n        catch (e) {\r\n            // ignore\r\n        }\r\n        if (!data) {\r\n            return part;\r\n        }\r\n        data = cloneAndChange(data, value => {\r\n            if (markdown.uris && markdown.uris[value]) {\r\n                return URI.revive(markdown.uris[value]);\r\n            }\r\n            else {\r\n                return undefined;\r\n            }\r\n        });\r\n        return encodeURIComponent(JSON.stringify(data));\r\n    };\r\n    const _href = function (href, isDomUri) {\r\n        const data = markdown.uris && markdown.uris[href];\r\n        if (!data) {\r\n            return href; // no uri exists\r\n        }\r\n        let uri = URI.revive(data);\r\n        if (URI.parse(href).toString() === uri.toString()) {\r\n            return href; // no tranformation performed\r\n        }\r\n        if (isDomUri) {\r\n            // this URI will end up as \"src\"-attribute of a dom node\r\n            // and because of that special rewriting needs to be done\r\n            // so that the URI uses a protocol that's understood by\r\n            // browsers (like http or https)\r\n            return FileAccess.asBrowserUri(uri).toString(true);\r\n        }\r\n        if (uri.query) {\r\n            uri = uri.with({ query: _uriMassage(uri.query) });\r\n        }\r\n        return uri.toString();\r\n    };\r\n    // signal to code-block render that the\r\n    // element has been created\r\n    let signalInnerHTML;\r\n    const withInnerHTML = new Promise(c => signalInnerHTML = c);\r\n    const renderer = new marked.Renderer();\r\n    renderer.image = (href, title, text) => {\r\n        let dimensions = [];\r\n        let attributes = [];\r\n        if (href) {\r\n            ({ href, dimensions } = parseHrefAndDimensions(href));\r\n            href = _href(href, true);\r\n            try {\r\n                const hrefAsUri = URI.parse(href);\r\n                if (options.baseUrl && hrefAsUri.scheme === Schemas.file) { // absolute or relative local path, or file: uri\r\n                    href = resolvePath(options.baseUrl, href).toString();\r\n                }\r\n            }\r\n            catch (err) { }\r\n            attributes.push(`src=\"${href}\"`);\r\n        }\r\n        if (text) {\r\n            attributes.push(`alt=\"${text}\"`);\r\n        }\r\n        if (title) {\r\n            attributes.push(`title=\"${title}\"`);\r\n        }\r\n        if (dimensions.length) {\r\n            attributes = attributes.concat(dimensions);\r\n        }\r\n        return '<img ' + attributes.join(' ') + '>';\r\n    };\r\n    renderer.link = (href, title, text) => {\r\n        // Remove markdown escapes. Workaround for https://github.com/chjj/marked/issues/829\r\n        if (href === text) { // raw link case\r\n            text = removeMarkdownEscapes(text);\r\n        }\r\n        href = _href(href, false);\r\n        if (options.baseUrl) {\r\n            const hasScheme = /^\\w[\\w\\d+.-]*:/.test(href);\r\n            if (!hasScheme) {\r\n                href = resolvePath(options.baseUrl, href).toString();\r\n            }\r\n        }\r\n        title = removeMarkdownEscapes(title);\r\n        href = removeMarkdownEscapes(href);\r\n        if (!href\r\n            || href.match(/^data:|javascript:/i)\r\n            || (href.match(/^command:/i) && !markdown.isTrusted)\r\n            || href.match(/^command:(\\/\\/\\/)?_workbench\\.downloadResource/i)) {\r\n            // drop the link\r\n            return text;\r\n        }\r\n        else {\r\n            // HTML Encode href\r\n            href = href.replace(/&/g, '&amp;')\r\n                .replace(/</g, '&lt;')\r\n                .replace(/>/g, '&gt;')\r\n                .replace(/\"/g, '&quot;')\r\n                .replace(/'/g, '&#39;');\r\n            return `<a href=\"#\" data-href=\"${href}\" title=\"${title || href}\">${text}</a>`;\r\n        }\r\n    };\r\n    renderer.paragraph = (text) => {\r\n        if (markdown.supportThemeIcons) {\r\n            const elements = renderLabelWithIcons(text);\r\n            text = elements.map(e => typeof e === 'string' ? e : e.outerHTML).join('');\r\n        }\r\n        return `<p>${text}</p>`;\r\n    };\r\n    if (options.codeBlockRenderer) {\r\n        renderer.code = (code, lang) => {\r\n            const value = options.codeBlockRenderer(lang, code);\r\n            // when code-block rendering is async we return sync\r\n            // but update the node with the real result later.\r\n            const id = defaultGenerator.nextId();\r\n            const promise = Promise.all([value, withInnerHTML]).then(values => {\r\n                const span = element.querySelector(`div[data-code=\"${id}\"]`);\r\n                if (span) {\r\n                    DOM.reset(span, values[0]);\r\n                }\r\n            }).catch(_err => {\r\n                // ignore\r\n            });\r\n            if (options.asyncRenderCallback) {\r\n                promise.then(options.asyncRenderCallback);\r\n            }\r\n            return `<div class=\"code\" data-code=\"${id}\">${escape(code)}</div>`;\r\n        };\r\n    }\r\n    if (options.actionHandler) {\r\n        const onClick = options.actionHandler.disposeables.add(new DomEmitter(element, 'click'));\r\n        const onAuxClick = options.actionHandler.disposeables.add(new DomEmitter(element, 'auxclick'));\r\n        options.actionHandler.disposeables.add(Event.any(onClick.event, onAuxClick.event)(e => {\r\n            const mouseEvent = new StandardMouseEvent(e);\r\n            if (!mouseEvent.leftButton && !mouseEvent.middleButton) {\r\n                return;\r\n            }\r\n            let target = mouseEvent.target;\r\n            if (target.tagName !== 'A') {\r\n                target = target.parentElement;\r\n                if (!target || target.tagName !== 'A') {\r\n                    return;\r\n                }\r\n            }\r\n            try {\r\n                const href = target.dataset['href'];\r\n                if (href) {\r\n                    options.actionHandler.callback(href, mouseEvent);\r\n                }\r\n            }\r\n            catch (err) {\r\n                onUnexpectedError(err);\r\n            }\r\n            finally {\r\n                mouseEvent.preventDefault();\r\n            }\r\n        }));\r\n    }\r\n    // Use our own sanitizer so that we can let through only spans.\r\n    // Otherwise, we'd be letting all html be rendered.\r\n    // If we want to allow markdown permitted tags, then we can delete sanitizer and sanitize.\r\n    // We always pass the output through insane after this so that we don't rely on\r\n    // marked for sanitization.\r\n    markedOptions.sanitizer = (html) => {\r\n        const match = markdown.isTrusted ? html.match(/^(<span[^>]+>)|(<\\/\\s*span>)$/) : undefined;\r\n        return match ? html : '';\r\n    };\r\n    markedOptions.sanitize = true;\r\n    markedOptions.silent = true;\r\n    markedOptions.renderer = renderer;\r\n    // values that are too long will freeze the UI\r\n    let value = (_a = markdown.value) !== null && _a !== void 0 ? _a : '';\r\n    if (value.length > 100000) {\r\n        value = `${value.substr(0, 100000)}\u2026`;\r\n    }\r\n    // escape theme icons\r\n    if (markdown.supportThemeIcons) {\r\n        value = markdownEscapeEscapedIcons(value);\r\n    }\r\n    const renderedMarkdown = marked.parse(value, markedOptions);\r\n    // sanitize with insane\r\n    element.innerHTML = sanitizeRenderedMarkdown(markdown, renderedMarkdown);\r\n    // signal that async code blocks can be now be inserted\r\n    signalInnerHTML();\r\n    // signal size changes for image tags\r\n    if (options.asyncRenderCallback) {\r\n        for (const img of element.getElementsByTagName('img')) {\r\n            const listener = DOM.addDisposableListener(img, 'load', () => {\r\n                listener.dispose();\r\n                options.asyncRenderCallback();\r\n            });\r\n        }\r\n    }\r\n    return element;\r\n}\r\nfunction sanitizeRenderedMarkdown(options, renderedMarkdown) {\r\n    var _a;\r\n    const insaneOptions = getInsaneOptions(options);\r\n    return (_a = _ttpInsane === null || _ttpInsane === void 0 ? void 0 : _ttpInsane.createHTML(renderedMarkdown, insaneOptions)) !== null && _a !== void 0 ? _a : insane(renderedMarkdown, insaneOptions);\r\n}\r\nfunction getInsaneOptions(options) {\r\n    const allowedSchemes = [\r\n        Schemas.http,\r\n        Schemas.https,\r\n        Schemas.mailto,\r\n        Schemas.data,\r\n        Schemas.file,\r\n        Schemas.vscodeRemote,\r\n        Schemas.vscodeRemoteResource,\r\n    ];\r\n    if (options.isTrusted) {\r\n        allowedSchemes.push(Schemas.command);\r\n    }\r\n    return {\r\n        allowedSchemes,\r\n        // allowedTags should included everything that markdown renders to.\r\n        // Since we have our own sanitize function for marked, it's possible we missed some tag so let insane make sure.\r\n        // HTML tags that can result from markdown are from reading https://spec.commonmark.org/0.29/\r\n        // HTML table tags that can result from markdown are from https://github.github.com/gfm/#tables-extension-\r\n        allowedTags: ['ul', 'li', 'p', 'code', 'blockquote', 'ol', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'em', 'pre', 'table', 'thead', 'tbody', 'tr', 'th', 'td', 'div', 'del', 'a', 'strong', 'br', 'img', 'span'],\r\n        allowedAttributes: {\r\n            'a': ['href', 'name', 'target', 'data-href'],\r\n            'img': ['src', 'title', 'alt', 'width', 'height'],\r\n            'div': ['class', 'data-code'],\r\n            'span': ['class', 'style'],\r\n            // https://github.com/microsoft/vscode/issues/95937\r\n            'th': ['align'],\r\n            'td': ['align']\r\n        },\r\n        filter(token) {\r\n            if (token.tag === 'span' && options.isTrusted) {\r\n                if (token.attrs['style'] && (Object.keys(token.attrs).length === 1)) {\r\n                    return !!token.attrs['style'].match(/^(color\\:#[0-9a-fA-F]+;)?(background-color\\:#[0-9a-fA-F]+;)?$/);\r\n                }\r\n                else if (token.attrs['class']) {\r\n                    // The class should match codicon rendering in src\\vs\\base\\common\\codicons.ts\r\n                    return !!token.attrs['class'].match(/^codicon codicon-[a-z\\-]+( codicon-modifier-[a-z\\-]+)?$/);\r\n                }\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n    };\r\n}\r\n", "/*\nThe MIT License (MIT)\n\nCopyright \u00A9 2015 Nicolas Bevacqua\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n*/\n\nlet __insane_func;\n\n(function () { function r(e, n, t) { function o(i, f) { if (!n[i]) { if (!e[i]) { var c = \"function\" == typeof require && require; if (!f && c) return c(i, !0); if (u) return u(i, !0); var a = new Error(\"Cannot find module '\" + i + \"'\"); throw a.code = \"MODULE_NOT_FOUND\", a } var p = n[i] = { exports: {} }; e[i][0].call(p.exports, function (r) { var n = e[i][1][r]; return o(n || r) }, p, p.exports, r, e, n, t) } return n[i].exports } for (var u = \"function\" == typeof require && require, i = 0; i < t.length; i++)o(t[i]); return o } return r })()({\n\t1: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar toMap = require('./toMap');\n\t\tvar uris = ['background', 'base', 'cite', 'href', 'longdesc', 'src', 'usemap'];\n\n\t\tmodule.exports = {\n\t\t\turis: toMap(uris) // attributes that have an href and hence need to be sanitized\n\t\t};\n\n\t}, { \"./toMap\": 10 }], 2: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar defaults = {\n\t\t\tallowedAttributes: {\n\t\t\t\t'*': ['title', 'accesskey'],\n\t\t\t\ta: ['href', 'name', 'target', 'aria-label'],\n\t\t\t\tiframe: ['allowfullscreen', 'frameborder', 'src'],\n\t\t\t\timg: ['src', 'alt', 'title', 'aria-label']\n\t\t\t},\n\t\t\tallowedClasses: {},\n\t\t\tallowedSchemes: ['http', 'https', 'mailto'],\n\t\t\tallowedTags: [\n\t\t\t\t'a', 'abbr', 'article', 'b', 'blockquote', 'br', 'caption', 'code', 'del', 'details', 'div', 'em',\n\t\t\t\t'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'main', 'mark',\n\t\t\t\t'ol', 'p', 'pre', 'section', 'span', 'strike', 'strong', 'sub', 'summary', 'sup', 'table',\n\t\t\t\t'tbody', 'td', 'th', 'thead', 'tr', 'u', 'ul'\n\t\t\t],\n\t\t\tfilter: null\n\t\t};\n\n\t\tmodule.exports = defaults;\n\n\t}, {}], 3: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar toMap = require('./toMap');\n\t\tvar voids = ['area', 'br', 'col', 'hr', 'img', 'wbr', 'input', 'base', 'basefont', 'link', 'meta'];\n\n\t\tmodule.exports = {\n\t\t\tvoids: toMap(voids)\n\t\t};\n\n\t}, { \"./toMap\": 10 }], 4: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar he = require('he');\n\t\tvar assign = require('assignment');\n\t\tvar parser = require('./parser');\n\t\tvar sanitizer = require('./sanitizer');\n\t\tvar defaults = require('./defaults');\n\n\t\tfunction insane(html, options, strict) {\n\t\t\tvar buffer = [];\n\t\t\tvar configuration = strict === true ? options : assign({}, defaults, options);\n\t\t\tvar handler = sanitizer(buffer, configuration);\n\n\t\t\tparser(html, handler);\n\n\t\t\treturn buffer.join('');\n\t\t}\n\n\t\tinsane.defaults = defaults;\n\t\tmodule.exports = insane;\n\t\t__insane_func = insane;\n\n\t}, { \"./defaults\": 2, \"./parser\": 7, \"./sanitizer\": 8, \"assignment\": 6, \"he\": 9 }], 5: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tmodule.exports = function lowercase(string) {\n\t\t\treturn typeof string === 'string' ? string.toLowerCase() : string;\n\t\t};\n\n\t}, {}], 6: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tfunction assignment(result) {\n\t\t\tvar stack = Array.prototype.slice.call(arguments, 1);\n\t\t\tvar item;\n\t\t\tvar key;\n\t\t\twhile (stack.length) {\n\t\t\t\titem = stack.shift();\n\t\t\t\tfor (key in item) {\n\t\t\t\t\tif (item.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (Object.prototype.toString.call(result[key]) === '[object Object]') {\n\t\t\t\t\t\t\tresult[key] = assignment(result[key], item[key]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult[key] = item[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\n\t\tmodule.exports = assignment;\n\n\t}, {}], 7: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar he = require('he');\n\t\tvar lowercase = require('./lowercase');\n\t\tvar attributes = require('./attributes');\n\t\tvar elements = require('./elements');\n\t\tvar rstart = /^<\\s*([\\w:-]+)((?:\\s+[\\w:-]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)\\s*>/;\n\t\tvar rend = /^<\\s*\\/\\s*([\\w:-]+)[^>]*>/;\n\t\tvar rattrs = /([\\w:-]+)(?:\\s*=\\s*(?:(?:\"((?:[^\"])*)\")|(?:'((?:[^'])*)')|([^>\\s]+)))?/g;\n\t\tvar rtag = /^</;\n\t\tvar rtagend = /^<\\s*\\//;\n\n\t\tfunction createStack() {\n\t\t\tvar stack = [];\n\t\t\tstack.lastItem = function lastItem() {\n\t\t\t\treturn stack[stack.length - 1];\n\t\t\t};\n\t\t\treturn stack;\n\t\t}\n\n\t\tfunction parser(html, handler) {\n\t\t\tvar stack = createStack();\n\t\t\tvar last = html;\n\t\t\tvar chars;\n\n\t\t\twhile (html) {\n\t\t\t\tparsePart();\n\t\t\t}\n\t\t\tparseEndTag(); // clean up any remaining tags\n\n\t\t\tfunction parsePart() {\n\t\t\t\tchars = true;\n\t\t\t\tparseTag();\n\n\t\t\t\tvar same = html === last;\n\t\t\t\tlast = html;\n\n\t\t\t\tif (same) { // discard, because it's invalid\n\t\t\t\t\thtml = '';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseTag() {\n\t\t\t\tif (html.substr(0, 4) === '<!--') { // comments\n\t\t\t\t\tparseComment();\n\t\t\t\t} else if (rtagend.test(html)) {\n\t\t\t\t\tparseEdge(rend, parseEndTag);\n\t\t\t\t} else if (rtag.test(html)) {\n\t\t\t\t\tparseEdge(rstart, parseStartTag);\n\t\t\t\t}\n\t\t\t\tparseTagDecode();\n\t\t\t}\n\n\t\t\tfunction parseEdge(regex, parser) {\n\t\t\t\tvar match = html.match(regex);\n\t\t\t\tif (match) {\n\t\t\t\t\thtml = html.substring(match[0].length);\n\t\t\t\t\tmatch[0].replace(regex, parser);\n\t\t\t\t\tchars = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseComment() {\n\t\t\t\tvar index = html.indexOf('-->');\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\tif (handler.comment) {\n\t\t\t\t\t\thandler.comment(html.substring(4, index));\n\t\t\t\t\t}\n\t\t\t\t\thtml = html.substring(index + 3);\n\t\t\t\t\tchars = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseTagDecode() {\n\t\t\t\tif (!chars) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar text;\n\t\t\t\tvar index = html.indexOf('<');\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\ttext = html.substring(0, index);\n\t\t\t\t\thtml = html.substring(index);\n\t\t\t\t} else {\n\t\t\t\t\ttext = html;\n\t\t\t\t\thtml = '';\n\t\t\t\t}\n\t\t\t\tif (handler.chars) {\n\t\t\t\t\thandler.chars(text);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseStartTag(tag, tagName, rest, unary) {\n\t\t\t\tvar attrs = {};\n\t\t\t\tvar low = lowercase(tagName);\n\t\t\t\tvar u = elements.voids[low] || !!unary;\n\n\t\t\t\trest.replace(rattrs, attrReplacer);\n\n\t\t\t\tif (!u) {\n\t\t\t\t\tstack.push(low);\n\t\t\t\t}\n\t\t\t\tif (handler.start) {\n\t\t\t\t\thandler.start(low, attrs, u);\n\t\t\t\t}\n\n\t\t\t\tfunction attrReplacer(match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {\n\t\t\t\t\tif (doubleQuotedValue === void 0 && singleQuotedValue === void 0 && unquotedValue === void 0) {\n\t\t\t\t\t\tattrs[name] = void 0; // attribute is like <button disabled></button>\n\t\t\t\t\t} else {\n\t\t\t\t\t\tattrs[name] = he.decode(doubleQuotedValue || singleQuotedValue || unquotedValue || '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction parseEndTag(tag, tagName) {\n\t\t\t\tvar i;\n\t\t\t\tvar pos = 0;\n\t\t\t\tvar low = lowercase(tagName);\n\t\t\t\tif (low) {\n\t\t\t\t\tfor (pos = stack.length - 1; pos >= 0; pos--) {\n\t\t\t\t\t\tif (stack[pos] === low) {\n\t\t\t\t\t\t\tbreak; // find the closest opened tag of the same type\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pos >= 0) {\n\t\t\t\t\tfor (i = stack.length - 1; i >= pos; i--) {\n\t\t\t\t\t\tif (handler.end) { // close all the open elements, up the stack\n\t\t\t\t\t\t\thandler.end(stack[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstack.length = pos;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmodule.exports = parser;\n\n\t}, { \"./attributes\": 1, \"./elements\": 3, \"./lowercase\": 5, \"he\": 9 }], 8: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar he = require('he');\n\t\tvar lowercase = require('./lowercase');\n\t\tvar attributes = require('./attributes');\n\t\tvar elements = require('./elements');\n\n\t\tfunction sanitizer(buffer, options) {\n\t\t\tvar last;\n\t\t\tvar context;\n\t\t\tvar o = options || {};\n\n\t\t\treset();\n\n\t\t\treturn {\n\t\t\t\tstart: start,\n\t\t\t\tend: end,\n\t\t\t\tchars: chars\n\t\t\t};\n\n\t\t\tfunction out(value) {\n\t\t\t\tbuffer.push(value);\n\t\t\t}\n\n\t\t\tfunction start(tag, attrs, unary) {\n\t\t\t\tvar low = lowercase(tag);\n\n\t\t\t\tif (context.ignoring) {\n\t\t\t\t\tignore(low); return;\n\t\t\t\t}\n\t\t\t\tif ((o.allowedTags || []).indexOf(low) === -1) {\n\t\t\t\t\tignore(low); return;\n\t\t\t\t}\n\t\t\t\tif (o.filter && !o.filter({ tag: low, attrs: attrs })) {\n\t\t\t\t\tignore(low); return;\n\t\t\t\t}\n\n\t\t\t\tout('<');\n\t\t\t\tout(low);\n\t\t\t\tObject.keys(attrs).forEach(parse);\n\t\t\t\tout(unary ? '/>' : '>');\n\n\t\t\t\tfunction parse(key) {\n\t\t\t\t\tvar value = attrs[key];\n\t\t\t\t\tvar classesOk = (o.allowedClasses || {})[low] || [];\n\t\t\t\t\tvar attrsOk = (o.allowedAttributes || {})[low] || [];\n\t\t\t\t\tattrsOk = attrsOk.concat((o.allowedAttributes || {})['*'] || []);\n\t\t\t\t\tvar valid;\n\t\t\t\t\tvar lkey = lowercase(key);\n\t\t\t\t\tif (lkey === 'class' && attrsOk.indexOf(lkey) === -1) {\n\t\t\t\t\t\tvalue = value.split(' ').filter(isValidClass).join(' ').trim();\n\t\t\t\t\t\tvalid = value.length;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalid = attrsOk.indexOf(lkey) !== -1 && (attributes.uris[lkey] !== true || testUrl(value));\n\t\t\t\t\t}\n\t\t\t\t\tif (valid) {\n\t\t\t\t\t\tout(' ');\n\t\t\t\t\t\tout(key);\n\t\t\t\t\t\tif (typeof value === 'string') {\n\t\t\t\t\t\t\tout('=\"');\n\t\t\t\t\t\t\tout(he.encode(value));\n\t\t\t\t\t\t\tout('\"');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfunction isValidClass(className) {\n\t\t\t\t\t\treturn classesOk && classesOk.indexOf(className) !== -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction end(tag) {\n\t\t\t\tvar low = lowercase(tag);\n\t\t\t\tvar allowed = (o.allowedTags || []).indexOf(low) !== -1;\n\t\t\t\tif (allowed) {\n\t\t\t\t\tif (context.ignoring === false) {\n\t\t\t\t\t\tout('</');\n\t\t\t\t\t\tout(low);\n\t\t\t\t\t\tout('>');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tunignore(low);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tunignore(low);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction testUrl(text) {\n\t\t\t\tvar start = text[0];\n\t\t\t\tif (start === '#' || start === '/') {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar colon = text.indexOf(':');\n\t\t\t\tif (colon === -1) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar questionmark = text.indexOf('?');\n\t\t\t\tif (questionmark !== -1 && colon > questionmark) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tvar hash = text.indexOf('#');\n\t\t\t\tif (hash !== -1 && colon > hash) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn o.allowedSchemes.some(matches);\n\n\t\t\t\tfunction matches(scheme) {\n\t\t\t\t\treturn text.indexOf(scheme + ':') === 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction chars(text) {\n\t\t\t\tif (context.ignoring === false) {\n\t\t\t\t\tout(o.transformText ? o.transformText(text) : text);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction ignore(tag) {\n\t\t\t\tif (elements.voids[tag]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (context.ignoring === false) {\n\t\t\t\t\tcontext = { ignoring: tag, depth: 1 };\n\t\t\t\t} else if (context.ignoring === tag) {\n\t\t\t\t\tcontext.depth++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction unignore(tag) {\n\t\t\t\tif (context.ignoring === tag) {\n\t\t\t\t\tif (--context.depth <= 0) {\n\t\t\t\t\t\treset();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction reset() {\n\t\t\t\tcontext = { ignoring: false, depth: 0 };\n\t\t\t}\n\t\t}\n\n\t\tmodule.exports = sanitizer;\n\n\t}, { \"./attributes\": 1, \"./elements\": 3, \"./lowercase\": 5, \"he\": 9 }], 9: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tvar escapes = {\n\t\t\t'&': '&amp;',\n\t\t\t'<': '&lt;',\n\t\t\t'>': '&gt;',\n\t\t\t'\"': '&quot;',\n\t\t\t\"'\": '&#39;'\n\t\t};\n\t\tvar unescapes = {\n\t\t\t'&amp;': '&',\n\t\t\t'&lt;': '<',\n\t\t\t'&gt;': '>',\n\t\t\t'&quot;': '\"',\n\t\t\t'&#39;': \"'\"\n\t\t};\n\t\tvar rescaped = /(&amp;|&lt;|&gt;|&quot;|&#39;)/g;\n\t\tvar runescaped = /[&<>\"']/g;\n\n\t\tfunction escapeHtmlChar(match) {\n\t\t\treturn escapes[match];\n\t\t}\n\t\tfunction unescapeHtmlChar(match) {\n\t\t\treturn unescapes[match];\n\t\t}\n\n\t\tfunction escapeHtml(text) {\n\t\t\treturn text == null ? '' : String(text).replace(runescaped, escapeHtmlChar);\n\t\t}\n\n\t\tfunction unescapeHtml(html) {\n\t\t\treturn html == null ? '' : String(html).replace(rescaped, unescapeHtmlChar);\n\t\t}\n\n\t\tescapeHtml.options = unescapeHtml.options = {};\n\n\t\tmodule.exports = {\n\t\t\tencode: escapeHtml,\n\t\t\tescape: escapeHtml,\n\t\t\tdecode: unescapeHtml,\n\t\t\tunescape: unescapeHtml,\n\t\t\tversion: '1.0.0-browser'\n\t\t};\n\n\t}, {}], 10: [function (require, module, exports) {\n\t\t'use strict';\n\n\t\tfunction toMap(list) {\n\t\t\treturn list.reduce(asKey, {});\n\t\t}\n\n\t\tfunction asKey(accumulator, item) {\n\t\t\taccumulator[item] = true;\n\t\t\treturn accumulator;\n\t\t}\n\n\t\tmodule.exports = toMap;\n\n\t}, {}]\n}, {}, [4]);\n\n// ESM-comment-begin\n// define(function() { return { insane: __insane_func }; });\n// ESM-comment-end\n\n// ESM-uncomment-begin\nexport var insane = __insane_func;\n// ESM-uncomment-end\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar _a;\r\nimport { renderMarkdown } from '../../../base/browser/markdownRenderer.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { tokenizeToString } from '../../common/modes/textToHtmlTokenizer.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { TokenizationRegistry } from '../../common/modes.js';\r\n/**\r\n * Markdown renderer that can render codeblocks with the editor mechanics. This\r\n * renderer should always be preferred.\r\n */\r\nlet MarkdownRenderer = class MarkdownRenderer {\r\n    constructor(_options, _modeService, _openerService) {\r\n        this._options = _options;\r\n        this._modeService = _modeService;\r\n        this._openerService = _openerService;\r\n        this._onDidRenderAsync = new Emitter();\r\n        this.onDidRenderAsync = this._onDidRenderAsync.event;\r\n    }\r\n    dispose() {\r\n        this._onDidRenderAsync.dispose();\r\n    }\r\n    render(markdown, options, markedOptions) {\r\n        const disposables = new DisposableStore();\r\n        let element;\r\n        if (!markdown) {\r\n            element = document.createElement('span');\r\n        }\r\n        else {\r\n            element = renderMarkdown(markdown, Object.assign(Object.assign({}, this._getRenderOptions(markdown, disposables)), options), markedOptions);\r\n        }\r\n        return {\r\n            element,\r\n            dispose: () => disposables.dispose()\r\n        };\r\n    }\r\n    _getRenderOptions(markdown, disposeables) {\r\n        return {\r\n            baseUrl: this._options.baseUrl,\r\n            codeBlockRenderer: (languageAlias, value) => __awaiter(this, void 0, void 0, function* () {\r\n                var _a, _b, _c, _d;\r\n                // In markdown,\r\n                // it is possible that we stumble upon language aliases (e.g.js instead of javascript)\r\n                // it is possible no alias is given in which case we fall back to the current editor lang\r\n                let modeId;\r\n                if (languageAlias) {\r\n                    modeId = this._modeService.getModeIdForLanguageName(languageAlias);\r\n                }\r\n                else if (this._options.editor) {\r\n                    modeId = (_a = this._options.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLanguageIdentifier().language;\r\n                }\r\n                if (!modeId) {\r\n                    modeId = 'plaintext';\r\n                }\r\n                this._modeService.triggerMode(modeId);\r\n                const tokenization = (_b = yield TokenizationRegistry.getPromise(modeId)) !== null && _b !== void 0 ? _b : undefined;\r\n                const element = document.createElement('span');\r\n                element.innerHTML = ((_d = (_c = MarkdownRenderer._ttpTokenizer) === null || _c === void 0 ? void 0 : _c.createHTML(value, tokenization)) !== null && _d !== void 0 ? _d : tokenizeToString(value, tokenization));\r\n                // use \"good\" font\r\n                let fontFamily = this._options.codeBlockFontFamily;\r\n                if (this._options.editor) {\r\n                    fontFamily = this._options.editor.getOption(41 /* fontInfo */).fontFamily;\r\n                }\r\n                if (fontFamily) {\r\n                    element.style.fontFamily = fontFamily;\r\n                }\r\n                return element;\r\n            }),\r\n            asyncRenderCallback: () => this._onDidRenderAsync.fire(),\r\n            actionHandler: {\r\n                callback: (content) => this._openerService.open(content, { fromUserGesture: true, allowContributedOpeners: true, allowCommands: markdown.isTrusted }).catch(onUnexpectedError),\r\n                disposeables\r\n            }\r\n        };\r\n    }\r\n};\r\nMarkdownRenderer._ttpTokenizer = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy('tokenizeToString', {\r\n    createHTML(value, tokenizer) {\r\n        return tokenizeToString(value, tokenizer);\r\n    }\r\n});\r\nMarkdownRenderer = __decorate([\r\n    __param(1, IModeService),\r\n    __param(2, IOpenerService)\r\n], MarkdownRenderer);\r\nexport { MarkdownRenderer };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { coalesce } from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { registerModelAndPositionCommand } from '../../browser/editorExtensions.js';\r\nimport { HoverProviderRegistry } from '../../common/modes.js';\r\nexport function getHover(model, position, token) {\r\n    const supports = HoverProviderRegistry.ordered(model);\r\n    const promises = supports.map(support => {\r\n        return Promise.resolve(support.provideHover(model, position, token)).then(hover => {\r\n            return hover && isValid(hover) ? hover : undefined;\r\n        }, err => {\r\n            onUnexpectedExternalError(err);\r\n            return undefined;\r\n        });\r\n    });\r\n    return Promise.all(promises).then(coalesce);\r\n}\r\nregisterModelAndPositionCommand('_executeHoverProvider', (model, position) => getHover(model, position, CancellationToken.None));\r\nfunction isValid(result) {\r\n    const hasRange = (typeof result.range !== 'undefined');\r\n    const hasHtmlContent = typeof result.contents !== 'undefined' && result.contents && result.contents.length > 0;\r\n    return hasRange && hasHtmlContent;\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { MarkdownString, isEmptyMarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { MarkdownRenderer } from '../../browser/core/markdownRenderer.js';\r\nimport { asArray } from '../../../base/common/arrays.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { HoverProviderRegistry } from '../../common/modes.js';\r\nimport { getHover } from './getHover.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nconst $ = dom.$;\r\nexport class MarkdownHover {\r\n    constructor(owner, range, contents) {\r\n        this.owner = owner;\r\n        this.range = range;\r\n        this.contents = contents;\r\n    }\r\n    isValidForHoverAnchor(anchor) {\r\n        return (anchor.type === 1 /* Range */\r\n            && this.range.startColumn <= anchor.range.startColumn\r\n            && this.range.endColumn >= anchor.range.endColumn);\r\n    }\r\n}\r\nlet MarkdownHoverParticipant = class MarkdownHoverParticipant {\r\n    constructor(_editor, _hover, _modeService, _openerService, _configurationService) {\r\n        this._editor = _editor;\r\n        this._hover = _hover;\r\n        this._modeService = _modeService;\r\n        this._openerService = _openerService;\r\n        this._configurationService = _configurationService;\r\n    }\r\n    createLoadingMessage(anchor) {\r\n        return new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))]);\r\n    }\r\n    computeSync(anchor, lineDecorations) {\r\n        if (!this._editor.hasModel() || anchor.type !== 1 /* Range */) {\r\n            return [];\r\n        }\r\n        const model = this._editor.getModel();\r\n        const lineNumber = anchor.range.startLineNumber;\r\n        const maxColumn = model.getLineMaxColumn(lineNumber);\r\n        const result = [];\r\n        for (const d of lineDecorations) {\r\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\r\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\r\n            const hoverMessage = d.options.hoverMessage;\r\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\r\n                continue;\r\n            }\r\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\r\n            result.push(new MarkdownHover(this, range, asArray(hoverMessage)));\r\n        }\r\n        const lineLength = this._editor.getModel().getLineLength(lineNumber);\r\n        const maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength');\r\n        if (typeof maxTokenizationLineLength === 'number' && lineLength >= maxTokenizationLineLength) {\r\n            result.push(new MarkdownHover(this, new Range(lineNumber, 1, lineNumber, lineLength + 1), [{\r\n                    value: nls.localize('too many characters', \"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.\")\r\n                }]));\r\n        }\r\n        return result;\r\n    }\r\n    computeAsync(anchor, lineDecorations, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this._editor.hasModel() || anchor.type !== 1 /* Range */) {\r\n                return Promise.resolve([]);\r\n            }\r\n            const model = this._editor.getModel();\r\n            if (!HoverProviderRegistry.has(model)) {\r\n                return Promise.resolve([]);\r\n            }\r\n            const hovers = yield getHover(model, new Position(anchor.range.startLineNumber, anchor.range.startColumn), token);\r\n            const result = [];\r\n            for (const hover of hovers) {\r\n                if (isEmptyMarkdownString(hover.contents)) {\r\n                    continue;\r\n                }\r\n                const rng = hover.range ? Range.lift(hover.range) : anchor.range;\r\n                result.push(new MarkdownHover(this, rng, hover.contents));\r\n            }\r\n            return result;\r\n        });\r\n    }\r\n    renderHoverParts(hoverParts, fragment, statusBar) {\r\n        const disposables = new DisposableStore();\r\n        for (const hoverPart of hoverParts) {\r\n            for (const contents of hoverPart.contents) {\r\n                if (isEmptyMarkdownString(contents)) {\r\n                    continue;\r\n                }\r\n                const markdownHoverElement = $('div.hover-row.markdown-hover');\r\n                const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\r\n                const renderer = disposables.add(new MarkdownRenderer({ editor: this._editor }, this._modeService, this._openerService));\r\n                disposables.add(renderer.onDidRenderAsync(() => {\r\n                    hoverContentsElement.className = 'hover-contents code-hover-contents';\r\n                    this._hover.onContentsChanged();\r\n                }));\r\n                const renderedContents = disposables.add(renderer.render(contents));\r\n                hoverContentsElement.appendChild(renderedContents.element);\r\n                fragment.appendChild(markdownHoverElement);\r\n            }\r\n        }\r\n        return disposables;\r\n    }\r\n};\r\nMarkdownHoverParticipant = __decorate([\r\n    __param(2, IModeService),\r\n    __param(3, IOpenerService),\r\n    __param(4, IConfigurationService)\r\n], MarkdownHoverParticipant);\r\nexport { MarkdownHoverParticipant };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport class HoverRangeAnchor {\r\n    constructor(priority, range) {\r\n        this.priority = priority;\r\n        this.range = range;\r\n        this.type = 1 /* Range */;\r\n    }\r\n    equals(other) {\r\n        return (other.type === 1 /* Range */ && this.range.equalsRange(other.range));\r\n    }\r\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\r\n        return (lastAnchor.type === 1 /* Range */ && showAtPosition.lineNumber === this.range.startLineNumber);\r\n    }\r\n}\r\nexport class HoverForeignElementAnchor {\r\n    constructor(priority, owner, range) {\r\n        this.priority = priority;\r\n        this.owner = owner;\r\n        this.range = range;\r\n        this.type = 2 /* ForeignElement */;\r\n    }\r\n    equals(other) {\r\n        return (other.type === 2 /* ForeignElement */ && this.owner === other.owner);\r\n    }\r\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\r\n        return (lastAnchor.type === 2 /* ForeignElement */ && this.owner === lastAnchor.owner);\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar _a;\r\nimport './ghostText.css';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { Disposable, DisposableStore, toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { RenderLineInput, renderViewLine } from '../../common/viewLayout/viewLineRenderer.js';\r\nimport { EditorFontLigatures } from '../../common/config/editorOptions.js';\r\nimport { createStringBuilder } from '../../common/core/stringBuilder.js';\r\nimport { Configuration } from '../../browser/config/configuration.js';\r\nimport { LineTokens } from '../../common/core/lineTokens.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { ghostTextBorder, ghostTextForeground } from '../../common/view/editorColorRegistry.js';\r\nimport { RGBA, Color } from '../../../base/common/color.js';\r\nimport { CursorColumns } from '../../common/controller/cursorCommon.js';\r\nimport { LineDecoration } from '../../common/viewLayout/lineDecorations.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nconst ttPolicy = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy('editorGhostText', { createHTML: value => value });\r\nlet GhostTextWidget = class GhostTextWidget extends Disposable {\r\n    constructor(editor, model, instantiationService) {\r\n        super();\r\n        this.editor = editor;\r\n        this.model = model;\r\n        this.instantiationService = instantiationService;\r\n        this.disposed = false;\r\n        this.partsWidget = this._register(this.instantiationService.createInstance(DecorationsWidget, this.editor));\r\n        this.additionalLinesWidget = this._register(new AdditionalLinesWidget(this.editor));\r\n        this.viewMoreContentWidget = undefined;\r\n        this._register(this.editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(27 /* disableMonospaceOptimizations */)\r\n                || e.hasChanged(104 /* stopRenderingLineAfter */)\r\n                || e.hasChanged(87 /* renderWhitespace */)\r\n                || e.hasChanged(81 /* renderControlCharacters */)\r\n                || e.hasChanged(42 /* fontLigatures */)\r\n                || e.hasChanged(41 /* fontInfo */)\r\n                || e.hasChanged(57 /* lineHeight */)) {\r\n                this.update();\r\n            }\r\n        }));\r\n        this._register(toDisposable(() => {\r\n            var _a;\r\n            this.disposed = true;\r\n            this.update();\r\n            (_a = this.viewMoreContentWidget) === null || _a === void 0 ? void 0 : _a.dispose();\r\n            this.viewMoreContentWidget = undefined;\r\n        }));\r\n        this._register(model.onDidChange(() => {\r\n            this.update();\r\n        }));\r\n        this.update();\r\n    }\r\n    shouldShowHoverAtViewZone(viewZoneId) {\r\n        return (this.additionalLinesWidget.viewZoneId === viewZoneId);\r\n    }\r\n    update() {\r\n        var _a;\r\n        const ghostText = this.model.ghostText;\r\n        if (!this.editor.hasModel() || !ghostText || this.disposed) {\r\n            this.partsWidget.clear();\r\n            this.additionalLinesWidget.clear();\r\n            return;\r\n        }\r\n        const inlineTexts = new Array();\r\n        const additionalLines = new Array();\r\n        function addToAdditionalLines(lines, className) {\r\n            if (additionalLines.length > 0) {\r\n                const lastLine = additionalLines[additionalLines.length - 1];\r\n                if (className) {\r\n                    lastLine.decorations.push(new LineDecoration(lastLine.content.length + 1, lastLine.content.length + 1 + lines[0].length, className, 0 /* Regular */));\r\n                }\r\n                lastLine.content += lines[0];\r\n                lines = lines.slice(1);\r\n            }\r\n            for (const line of lines) {\r\n                additionalLines.push({\r\n                    content: line,\r\n                    decorations: className ? [new LineDecoration(1, line.length + 1, className, 0 /* Regular */)] : []\r\n                });\r\n            }\r\n        }\r\n        const textBufferLine = this.editor.getModel().getLineContent(ghostText.lineNumber);\r\n        this.editor.getModel().getLineTokens(ghostText.lineNumber);\r\n        let hiddenTextStartColumn = undefined;\r\n        let lastIdx = 0;\r\n        for (const part of ghostText.parts) {\r\n            let lines = part.lines;\r\n            if (hiddenTextStartColumn === undefined) {\r\n                inlineTexts.push({\r\n                    column: part.column,\r\n                    text: lines[0],\r\n                });\r\n                lines = lines.slice(1);\r\n            }\r\n            else {\r\n                addToAdditionalLines([textBufferLine.substring(lastIdx, part.column - 1)], undefined);\r\n            }\r\n            if (lines.length > 0) {\r\n                addToAdditionalLines(lines, 'ghost-text');\r\n                if (hiddenTextStartColumn === undefined && part.column <= textBufferLine.length) {\r\n                    hiddenTextStartColumn = part.column;\r\n                }\r\n            }\r\n            lastIdx = part.column - 1;\r\n        }\r\n        if (hiddenTextStartColumn !== undefined) {\r\n            addToAdditionalLines([textBufferLine.substring(lastIdx)], undefined);\r\n        }\r\n        this.partsWidget.setParts(ghostText.lineNumber, inlineTexts, hiddenTextStartColumn !== undefined ? { column: hiddenTextStartColumn, length: textBufferLine.length + 1 - hiddenTextStartColumn } : undefined);\r\n        this.additionalLinesWidget.updateLines(ghostText.lineNumber, additionalLines, ghostText.additionalReservedLineCount);\r\n        if (ghostText.parts.some(p => p.lines.length < 0)) {\r\n            // Not supported at the moment, condition is always false.\r\n            this.viewMoreContentWidget = this.renderViewMoreLines(new Position(ghostText.lineNumber, this.editor.getModel().getLineMaxColumn(ghostText.lineNumber)), '', 0);\r\n        }\r\n        else {\r\n            (_a = this.viewMoreContentWidget) === null || _a === void 0 ? void 0 : _a.dispose();\r\n            this.viewMoreContentWidget = undefined;\r\n        }\r\n    }\r\n    renderViewMoreLines(position, firstLineText, remainingLinesLength) {\r\n        const fontInfo = this.editor.getOption(41 /* fontInfo */);\r\n        const domNode = document.createElement('div');\r\n        domNode.className = 'suggest-preview-additional-widget';\r\n        Configuration.applyFontInfoSlow(domNode, fontInfo);\r\n        const spacer = document.createElement('span');\r\n        spacer.className = 'content-spacer';\r\n        spacer.append(firstLineText);\r\n        domNode.append(spacer);\r\n        const newline = document.createElement('span');\r\n        newline.className = 'content-newline suggest-preview-text';\r\n        newline.append('\u23CE  ');\r\n        domNode.append(newline);\r\n        const disposableStore = new DisposableStore();\r\n        const button = document.createElement('div');\r\n        button.className = 'button suggest-preview-text';\r\n        button.append(`+${remainingLinesLength} lines\u2026`);\r\n        disposableStore.add(dom.addStandardDisposableListener(button, 'mousedown', (e) => {\r\n            var _a;\r\n            (_a = this.model) === null || _a === void 0 ? void 0 : _a.setExpanded(true);\r\n            e.preventDefault();\r\n            this.editor.focus();\r\n        }));\r\n        domNode.append(button);\r\n        return new ViewMoreLinesContentWidget(this.editor, position, domNode, disposableStore);\r\n    }\r\n};\r\nGhostTextWidget = __decorate([\r\n    __param(2, IInstantiationService)\r\n], GhostTextWidget);\r\nexport { GhostTextWidget };\r\nlet DecorationsWidget = class DecorationsWidget {\r\n    constructor(editor, codeEditorService, themeService, contextKeyService) {\r\n        this.editor = editor;\r\n        this.codeEditorService = codeEditorService;\r\n        this.themeService = themeService;\r\n        this.contextKeyService = contextKeyService;\r\n        this.decorationIds = [];\r\n        this.disposableStore = new DisposableStore();\r\n    }\r\n    dispose() {\r\n        this.clear();\r\n        this.disposableStore.dispose();\r\n    }\r\n    clear() {\r\n        this.editor.deltaDecorations(this.decorationIds, []);\r\n        this.disposableStore.clear();\r\n    }\r\n    setParts(lineNumber, parts, hiddenText) {\r\n        this.disposableStore.clear();\r\n        const colorTheme = this.themeService.getColorTheme();\r\n        const foreground = colorTheme.getColor(ghostTextForeground);\r\n        let opacity = undefined;\r\n        let color = undefined;\r\n        if (foreground) {\r\n            opacity = String(foreground.rgba.a);\r\n            color = Color.Format.CSS.format(opaque(foreground));\r\n        }\r\n        const borderColor = colorTheme.getColor(ghostTextBorder);\r\n        let border = undefined;\r\n        if (borderColor) {\r\n            border = `2px dashed ${borderColor}`;\r\n        }\r\n        const textModel = this.editor.getModel();\r\n        if (!textModel) {\r\n            return;\r\n        }\r\n        const { tabSize } = textModel.getOptions();\r\n        const line = textModel.getLineContent(lineNumber) || '';\r\n        let lastIndex = 0;\r\n        let currentLinePrefix = '';\r\n        const hiddenTextDecorations = new Array();\r\n        if (hiddenText) {\r\n            hiddenTextDecorations.push({\r\n                range: Range.fromPositions(new Position(lineNumber, hiddenText.column), new Position(lineNumber, hiddenText.column + hiddenText.length)),\r\n                options: {\r\n                    inlineClassName: 'ghost-text-hidden',\r\n                    description: 'ghost-text-hidden'\r\n                }\r\n            });\r\n        }\r\n        const key = this.contextKeyService.getContextKeyValue('config.editor.useInjectedText');\r\n        const shouldUseInjectedText = key === undefined ? true : !!key;\r\n        this.decorationIds = this.editor.deltaDecorations(this.decorationIds, parts.map(p => {\r\n            currentLinePrefix += line.substring(lastIndex, p.column - 1);\r\n            lastIndex = p.column - 1;\r\n            // To avoid visual confusion, we don't want to render visible whitespace\r\n            const contentText = shouldUseInjectedText ? p.text : this.renderSingleLineText(p.text, currentLinePrefix, tabSize, false);\r\n            const decorationType = this.disposableStore.add(registerDecorationType(this.codeEditorService, 'ghost-text', '0-ghost-text-', {\r\n                after: {\r\n                    // TODO: escape?\r\n                    contentText,\r\n                    opacity,\r\n                    color,\r\n                    border,\r\n                },\r\n            }));\r\n            return ({\r\n                range: Range.fromPositions(new Position(lineNumber, p.column)),\r\n                options: shouldUseInjectedText ? {\r\n                    description: 'ghost-text',\r\n                    after: { content: contentText, inlineClassName: 'ghost-text-decoration' }\r\n                } : Object.assign({}, decorationType.resolve())\r\n            });\r\n        }).concat(hiddenTextDecorations));\r\n    }\r\n    renderSingleLineText(text, lineStart, tabSize, renderWhitespace) {\r\n        const newLine = lineStart + text;\r\n        const visibleColumnsByColumns = CursorColumns.visibleColumnsByColumns(newLine, tabSize);\r\n        let contentText = '';\r\n        let curCol = lineStart.length + 1;\r\n        for (const c of text) {\r\n            if (c === '\\t') {\r\n                const width = visibleColumnsByColumns[curCol + 1] - visibleColumnsByColumns[curCol];\r\n                if (renderWhitespace) {\r\n                    contentText += '\u2192';\r\n                    for (let i = 1; i < width; i++) {\r\n                        contentText += '\\xa0';\r\n                    }\r\n                }\r\n                else {\r\n                    for (let i = 0; i < width; i++) {\r\n                        contentText += '\\xa0';\r\n                    }\r\n                }\r\n            }\r\n            else if (c === ' ') {\r\n                if (renderWhitespace) {\r\n                    contentText += '\u00B7';\r\n                }\r\n                else {\r\n                    contentText += '\\xa0';\r\n                }\r\n            }\r\n            else {\r\n                contentText += c;\r\n            }\r\n            curCol += 1;\r\n        }\r\n        return contentText;\r\n    }\r\n};\r\nDecorationsWidget = __decorate([\r\n    __param(1, ICodeEditorService),\r\n    __param(2, IThemeService),\r\n    __param(3, IContextKeyService)\r\n], DecorationsWidget);\r\nfunction opaque(color) {\r\n    const { r, b, g } = color.rgba;\r\n    return new Color(new RGBA(r, g, b, 255));\r\n}\r\nclass AdditionalLinesWidget {\r\n    constructor(editor) {\r\n        this.editor = editor;\r\n        this._viewZoneId = undefined;\r\n    }\r\n    get viewZoneId() { return this._viewZoneId; }\r\n    dispose() {\r\n        this.clear();\r\n    }\r\n    clear() {\r\n        this.editor.changeViewZones((changeAccessor) => {\r\n            if (this._viewZoneId) {\r\n                changeAccessor.removeZone(this._viewZoneId);\r\n                this._viewZoneId = undefined;\r\n            }\r\n        });\r\n    }\r\n    updateLines(lineNumber, additionalLines, minReservedLineCount) {\r\n        const textModel = this.editor.getModel();\r\n        if (!textModel) {\r\n            return;\r\n        }\r\n        const { tabSize } = textModel.getOptions();\r\n        this.editor.changeViewZones((changeAccessor) => {\r\n            if (this._viewZoneId) {\r\n                changeAccessor.removeZone(this._viewZoneId);\r\n                this._viewZoneId = undefined;\r\n            }\r\n            const heightInLines = Math.max(additionalLines.length, minReservedLineCount);\r\n            if (heightInLines > 0) {\r\n                const domNode = document.createElement('div');\r\n                renderLines(domNode, tabSize, additionalLines, this.editor.getOptions());\r\n                this._viewZoneId = changeAccessor.addZone({\r\n                    afterLineNumber: lineNumber,\r\n                    heightInLines: heightInLines,\r\n                    domNode,\r\n                });\r\n            }\r\n        });\r\n    }\r\n}\r\nfunction renderLines(domNode, tabSize, lines, opts) {\r\n    const disableMonospaceOptimizations = opts.get(27 /* disableMonospaceOptimizations */);\r\n    const stopRenderingLineAfter = opts.get(104 /* stopRenderingLineAfter */);\r\n    // To avoid visual confusion, we don't want to render visible whitespace\r\n    const renderWhitespace = 'none';\r\n    const renderControlCharacters = opts.get(81 /* renderControlCharacters */);\r\n    const fontLigatures = opts.get(42 /* fontLigatures */);\r\n    const fontInfo = opts.get(41 /* fontInfo */);\r\n    const lineHeight = opts.get(57 /* lineHeight */);\r\n    const sb = createStringBuilder(10000);\r\n    sb.appendASCIIString('<div class=\"suggest-preview-text\">');\r\n    for (let i = 0, len = lines.length; i < len; i++) {\r\n        const lineData = lines[i];\r\n        const line = lineData.content;\r\n        sb.appendASCIIString('<div class=\"view-line');\r\n        sb.appendASCIIString('\" style=\"top:');\r\n        sb.appendASCIIString(String(i * lineHeight));\r\n        sb.appendASCIIString('px;width:1000000px;\">');\r\n        const isBasicASCII = strings.isBasicASCII(line);\r\n        const containsRTL = strings.containsRTL(line);\r\n        const lineTokens = LineTokens.createEmpty(line);\r\n        renderViewLine(new RenderLineInput((fontInfo.isMonospace && !disableMonospaceOptimizations), fontInfo.canUseHalfwidthRightwardsArrow, line, false, isBasicASCII, containsRTL, 0, lineTokens, lineData.decorations, tabSize, 0, fontInfo.spaceWidth, fontInfo.middotWidth, fontInfo.wsmiddotWidth, stopRenderingLineAfter, renderWhitespace, renderControlCharacters, fontLigatures !== EditorFontLigatures.OFF, null), sb);\r\n        sb.appendASCIIString('</div>');\r\n    }\r\n    sb.appendASCIIString('</div>');\r\n    Configuration.applyFontInfoSlow(domNode, fontInfo);\r\n    const html = sb.build();\r\n    const trustedhtml = ttPolicy ? ttPolicy.createHTML(html) : html;\r\n    domNode.innerHTML = trustedhtml;\r\n}\r\nlet keyCounter = 0;\r\nfunction registerDecorationType(service, description, keyPrefix, options) {\r\n    const key = keyPrefix + (keyCounter++);\r\n    service.registerDecorationType(description, key, options);\r\n    return {\r\n        dispose() {\r\n            service.removeDecorationType(key);\r\n        },\r\n        resolve() {\r\n            return service.resolveDecorationOptions(key, true);\r\n        }\r\n    };\r\n}\r\nclass ViewMoreLinesContentWidget extends Disposable {\r\n    constructor(editor, position, domNode, disposableStore) {\r\n        super();\r\n        this.editor = editor;\r\n        this.position = position;\r\n        this.domNode = domNode;\r\n        this.allowEditorOverflow = false;\r\n        this.suppressMouseDown = false;\r\n        this._register(disposableStore);\r\n        this._register(toDisposable(() => {\r\n            this.editor.removeContentWidget(this);\r\n        }));\r\n        this.editor.addContentWidget(this);\r\n    }\r\n    getId() {\r\n        return 'editor.widget.viewMoreLinesWidget';\r\n    }\r\n    getDomNode() {\r\n        return this.domNode;\r\n    }\r\n    getPosition() {\r\n        return {\r\n            position: this.position,\r\n            preference: [0 /* EXACT */]\r\n        };\r\n    }\r\n}\r\nregisterThemingParticipant((theme, collector) => {\r\n    const foreground = theme.getColor(ghostTextForeground);\r\n    if (foreground) {\r\n        const opacity = String(foreground.rgba.a);\r\n        const color = Color.Format.CSS.format(opaque(foreground));\r\n        collector.addRule(`.monaco-editor .ghost-text-decoration { opacity: ${opacity}; color: ${color}; }`);\r\n        collector.addRule(`.monaco-editor .suggest-preview-text .ghost-text { opacity: ${opacity}; color: ${color}; }`);\r\n    }\r\n    const border = theme.getColor(ghostTextBorder);\r\n    if (border) {\r\n        collector.addRule(`.monaco-editor .suggest-preview-text .ghost-text { border: 2px dashed ${border}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nexport class GhostText {\r\n    constructor(lineNumber, parts, additionalReservedLineCount = 0) {\r\n        this.lineNumber = lineNumber;\r\n        this.parts = parts;\r\n        this.additionalReservedLineCount = additionalReservedLineCount;\r\n    }\r\n    static equals(a, b) {\r\n        return a === b || (!!a && !!b && a.equals(b));\r\n    }\r\n    equals(other) {\r\n        return this.lineNumber === other.lineNumber &&\r\n            this.parts.length === other.parts.length &&\r\n            this.parts.every((part, index) => part.equals(other.parts[index]));\r\n    }\r\n}\r\nexport class GhostTextPart {\r\n    constructor(column, lines) {\r\n        this.column = column;\r\n        this.lines = lines;\r\n    }\r\n    equals(other) {\r\n        return this.column === other.column &&\r\n            this.lines.length === other.lines.length &&\r\n            this.lines.every((line, index) => line === other.lines[index]);\r\n    }\r\n}\r\nexport class BaseGhostTextWidgetModel extends Disposable {\r\n    constructor(editor) {\r\n        super();\r\n        this.editor = editor;\r\n        this._expanded = undefined;\r\n        this.onDidChangeEmitter = new Emitter();\r\n        this.onDidChange = this.onDidChangeEmitter.event;\r\n        this._register(editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(105 /* suggest */) && this._expanded === undefined) {\r\n                this.onDidChangeEmitter.fire();\r\n            }\r\n        }));\r\n    }\r\n    get expanded() {\r\n        if (this._expanded === undefined) {\r\n            // TODO this should use a global hidden setting.\r\n            // See https://github.com/microsoft/vscode/issues/125037.\r\n            return true;\r\n        }\r\n        return this._expanded;\r\n    }\r\n    setExpanded(expanded) {\r\n        this._expanded = true;\r\n        this.onDidChangeEmitter.fire();\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { createCancelablePromise, RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, MutableDisposable, toDisposable } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { InlineCompletionsProviderRegistry, InlineCompletionTriggerKind } from '../../common/modes.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { RedoCommand, UndoCommand } from '../../browser/editorExtensions.js';\r\nimport { CoreEditingCommands } from '../../browser/controller/coreCommands.js';\r\nimport { LcsDiff } from '../../../base/common/diff/diff.js';\r\nimport { GhostText, BaseGhostTextWidgetModel, GhostTextPart } from './ghostText.js';\r\nlet InlineCompletionsModel = class InlineCompletionsModel extends Disposable {\r\n    constructor(editor, commandService) {\r\n        super();\r\n        this.editor = editor;\r\n        this.commandService = commandService;\r\n        this.onDidChangeEmitter = new Emitter();\r\n        this.onDidChange = this.onDidChangeEmitter.event;\r\n        this.completionSession = this._register(new MutableDisposable());\r\n        this.active = false;\r\n        this._register(commandService.onDidExecuteCommand(e => {\r\n            // These commands don't trigger onDidType.\r\n            const commands = new Set([\r\n                UndoCommand.id,\r\n                RedoCommand.id,\r\n                CoreEditingCommands.Tab.id,\r\n                CoreEditingCommands.DeleteLeft.id,\r\n                CoreEditingCommands.DeleteRight.id\r\n            ]);\r\n            if (commands.has(e.commandId) && editor.hasTextFocus()) {\r\n                this.handleUserInput();\r\n            }\r\n        }));\r\n        this._register(this.editor.onDidType((e) => {\r\n            this.handleUserInput();\r\n        }));\r\n        this._register(this.editor.onDidChangeCursorPosition((e) => {\r\n            if (this.session && !this.session.isValid) {\r\n                this.hide();\r\n            }\r\n        }));\r\n    }\r\n    handleUserInput() {\r\n        if (this.session && !this.session.isValid) {\r\n            this.hide();\r\n        }\r\n        setTimeout(() => {\r\n            // Wait for the cursor update that happens in the same iteration loop iteration\r\n            this.startSessionIfTriggered();\r\n        }, 0);\r\n    }\r\n    get session() {\r\n        return this.completionSession.value;\r\n    }\r\n    get ghostText() {\r\n        var _a;\r\n        return (_a = this.session) === null || _a === void 0 ? void 0 : _a.ghostText;\r\n    }\r\n    get minReservedLineCount() {\r\n        return this.session ? this.session.minReservedLineCount : 0;\r\n    }\r\n    get expanded() {\r\n        return this.session ? this.session.expanded : false;\r\n    }\r\n    setExpanded(expanded) {\r\n        var _a;\r\n        (_a = this.session) === null || _a === void 0 ? void 0 : _a.setExpanded(expanded);\r\n    }\r\n    setActive(active) {\r\n        var _a;\r\n        this.active = active;\r\n        if (active) {\r\n            (_a = this.session) === null || _a === void 0 ? void 0 : _a.scheduleAutomaticUpdate();\r\n        }\r\n    }\r\n    startSessionIfTriggered() {\r\n        const suggestOptions = this.editor.getOption(53 /* inlineSuggest */);\r\n        if (!suggestOptions.enabled) {\r\n            return;\r\n        }\r\n        if (this.session && this.session.isValid) {\r\n            return;\r\n        }\r\n        this.trigger();\r\n    }\r\n    trigger() {\r\n        if (this.completionSession.value) {\r\n            return;\r\n        }\r\n        this.completionSession.value = new InlineCompletionsSession(this.editor, this.editor.getPosition(), () => this.active, this.commandService);\r\n        this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange(() => {\r\n            this.onDidChangeEmitter.fire();\r\n        }));\r\n    }\r\n    hide() {\r\n        this.completionSession.clear();\r\n        this.onDidChangeEmitter.fire();\r\n    }\r\n    commitCurrentSuggestion() {\r\n        var _a;\r\n        // Don't dispose the session, so that after committing, more suggestions are shown.\r\n        (_a = this.session) === null || _a === void 0 ? void 0 : _a.commitCurrentCompletion();\r\n    }\r\n    showNext() {\r\n        var _a;\r\n        (_a = this.session) === null || _a === void 0 ? void 0 : _a.showNextInlineCompletion();\r\n    }\r\n    showPrevious() {\r\n        var _a;\r\n        (_a = this.session) === null || _a === void 0 ? void 0 : _a.showPreviousInlineCompletion();\r\n    }\r\n    hasMultipleInlineCompletions() {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const result = yield ((_a = this.session) === null || _a === void 0 ? void 0 : _a.hasMultipleInlineCompletions());\r\n            return result !== undefined ? result : false;\r\n        });\r\n    }\r\n};\r\nInlineCompletionsModel = __decorate([\r\n    __param(1, ICommandService)\r\n], InlineCompletionsModel);\r\nexport { InlineCompletionsModel };\r\nexport class InlineCompletionsSession extends BaseGhostTextWidgetModel {\r\n    constructor(editor, triggerPosition, shouldUpdate, commandService) {\r\n        super(editor);\r\n        this.triggerPosition = triggerPosition;\r\n        this.shouldUpdate = shouldUpdate;\r\n        this.commandService = commandService;\r\n        this.minReservedLineCount = 0;\r\n        this.updateOperation = this._register(new MutableDisposable());\r\n        this.cache = this._register(new MutableDisposable());\r\n        this.updateSoon = this._register(new RunOnceScheduler(() => this.update(InlineCompletionTriggerKind.Automatic), 50));\r\n        this.textModel = this.editor.getModel();\r\n        //#region Selection\r\n        // We use a semantic id to track the selection even if the cache changes.\r\n        this.currentlySelectedCompletionId = undefined;\r\n        let lastCompletionItem = undefined;\r\n        this._register(this.onDidChange(() => {\r\n            const currentCompletion = this.currentCompletion;\r\n            if (currentCompletion && currentCompletion.sourceInlineCompletion !== lastCompletionItem) {\r\n                lastCompletionItem = currentCompletion.sourceInlineCompletion;\r\n                const provider = currentCompletion.sourceProvider;\r\n                if (provider.handleItemDidShow) {\r\n                    provider.handleItemDidShow(currentCompletion.sourceInlineCompletions, lastCompletionItem);\r\n                }\r\n            }\r\n        }));\r\n        this._register(this.editor.onDidChangeCursorPosition((e) => {\r\n            if (this.cache.value) {\r\n                this.onDidChangeEmitter.fire();\r\n            }\r\n        }));\r\n        this._register(this.editor.onDidChangeModelContent((e) => {\r\n            if (this.cache.value) {\r\n                let hasChanged = false;\r\n                for (const c of this.cache.value.completions) {\r\n                    const newRange = this.textModel.getDecorationRange(c.decorationId);\r\n                    if (!newRange) {\r\n                        onUnexpectedError(new Error('Decoration has no range'));\r\n                        continue;\r\n                    }\r\n                    if (!c.synchronizedRange.equalsRange(newRange)) {\r\n                        hasChanged = true;\r\n                        c.synchronizedRange = newRange;\r\n                    }\r\n                }\r\n                if (hasChanged) {\r\n                    this.onDidChangeEmitter.fire();\r\n                }\r\n            }\r\n            this.scheduleAutomaticUpdate();\r\n        }));\r\n        this._register(InlineCompletionsProviderRegistry.onDidChange(() => {\r\n            this.updateSoon.schedule();\r\n        }));\r\n        this.scheduleAutomaticUpdate();\r\n    }\r\n    fixAndGetIndexOfCurrentSelection() {\r\n        if (!this.currentlySelectedCompletionId || !this.cache.value) {\r\n            return 0;\r\n        }\r\n        if (this.cache.value.completions.length === 0) {\r\n            // don't reset the selection in this case\r\n            return 0;\r\n        }\r\n        const idx = this.cache.value.completions.findIndex(v => v.semanticId === this.currentlySelectedCompletionId);\r\n        if (idx === -1) {\r\n            // Reset the selection so that the selection does not jump back when it appears again\r\n            this.currentlySelectedCompletionId = undefined;\r\n            return 0;\r\n        }\r\n        return idx;\r\n    }\r\n    get currentCachedCompletion() {\r\n        if (!this.cache.value) {\r\n            return undefined;\r\n        }\r\n        return this.cache.value.completions[this.fixAndGetIndexOfCurrentSelection()];\r\n    }\r\n    showNextInlineCompletion() {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            yield this.ensureUpdateWithExplicitContext();\r\n            const completions = ((_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.completions) || [];\r\n            if (completions.length > 0) {\r\n                const newIdx = (this.fixAndGetIndexOfCurrentSelection() + 1) % completions.length;\r\n                this.currentlySelectedCompletionId = completions[newIdx].semanticId;\r\n            }\r\n            else {\r\n                this.currentlySelectedCompletionId = undefined;\r\n            }\r\n            this.onDidChangeEmitter.fire();\r\n        });\r\n    }\r\n    showPreviousInlineCompletion() {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            yield this.ensureUpdateWithExplicitContext();\r\n            const completions = ((_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.completions) || [];\r\n            if (completions.length > 0) {\r\n                const newIdx = (this.fixAndGetIndexOfCurrentSelection() + completions.length - 1) % completions.length;\r\n                this.currentlySelectedCompletionId = completions[newIdx].semanticId;\r\n            }\r\n            else {\r\n                this.currentlySelectedCompletionId = undefined;\r\n            }\r\n            this.onDidChangeEmitter.fire();\r\n        });\r\n    }\r\n    ensureUpdateWithExplicitContext() {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this.updateOperation.value) {\r\n                // Restart or wait for current update operation\r\n                if (this.updateOperation.value.triggerKind === InlineCompletionTriggerKind.Explicit) {\r\n                    yield this.updateOperation.value.promise;\r\n                }\r\n                else {\r\n                    yield this.update(InlineCompletionTriggerKind.Explicit);\r\n                }\r\n            }\r\n            else if (((_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.triggerKind) !== InlineCompletionTriggerKind.Explicit) {\r\n                // Refresh cache\r\n                yield this.update(InlineCompletionTriggerKind.Explicit);\r\n            }\r\n        });\r\n    }\r\n    hasMultipleInlineCompletions() {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            yield this.ensureUpdateWithExplicitContext();\r\n            return (((_a = this.cache.value) === null || _a === void 0 ? void 0 : _a.completions.length) || 0) > 1;\r\n        });\r\n    }\r\n    //#endregion\r\n    get ghostText() {\r\n        const currentCompletion = this.currentCompletion;\r\n        const mode = this.editor.getOptions().get(53 /* inlineSuggest */).mode;\r\n        return currentCompletion ? inlineCompletionToGhostText(currentCompletion, this.editor.getModel(), mode, this.editor.getPosition()) : undefined;\r\n    }\r\n    get currentCompletion() {\r\n        const completion = this.currentCachedCompletion;\r\n        if (!completion) {\r\n            return undefined;\r\n        }\r\n        return {\r\n            text: completion.inlineCompletion.text,\r\n            range: completion.synchronizedRange,\r\n            command: completion.inlineCompletion.command,\r\n            sourceProvider: completion.inlineCompletion.sourceProvider,\r\n            sourceInlineCompletions: completion.inlineCompletion.sourceInlineCompletions,\r\n            sourceInlineCompletion: completion.inlineCompletion.sourceInlineCompletion,\r\n        };\r\n    }\r\n    get isValid() {\r\n        return this.editor.getPosition().lineNumber === this.triggerPosition.lineNumber;\r\n    }\r\n    scheduleAutomaticUpdate() {\r\n        // Since updateSoon debounces, starvation can happen.\r\n        // To prevent stale cache, we clear the current update operation.\r\n        this.updateOperation.clear();\r\n        this.updateSoon.schedule();\r\n    }\r\n    update(triggerKind) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this.shouldUpdate()) {\r\n                return;\r\n            }\r\n            const position = this.editor.getPosition();\r\n            const promise = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\r\n                let result;\r\n                try {\r\n                    result = yield provideInlineCompletions(position, this.editor.getModel(), { triggerKind }, token);\r\n                }\r\n                catch (e) {\r\n                    onUnexpectedError(e);\r\n                    return;\r\n                }\r\n                if (token.isCancellationRequested) {\r\n                    return;\r\n                }\r\n                this.cache.value = new SynchronizedInlineCompletionsCache(this.editor, result, () => this.onDidChangeEmitter.fire(), triggerKind);\r\n                this.onDidChangeEmitter.fire();\r\n            }));\r\n            const operation = new UpdateOperation(promise, triggerKind);\r\n            this.updateOperation.value = operation;\r\n            yield promise;\r\n            if (this.updateOperation.value === operation) {\r\n                this.updateOperation.clear();\r\n            }\r\n        });\r\n    }\r\n    takeOwnership(disposable) {\r\n        this._register(disposable);\r\n    }\r\n    commitCurrentCompletion() {\r\n        if (!this.ghostText) {\r\n            // No ghost text was shown for this completion.\r\n            // Thus, we don't want to commit anything.\r\n            return;\r\n        }\r\n        const completion = this.currentCompletion;\r\n        if (completion) {\r\n            this.commit(completion);\r\n        }\r\n    }\r\n    commit(completion) {\r\n        // Mark the cache as stale, but don't dispose it yet,\r\n        // otherwise command args might get disposed.\r\n        const cache = this.cache.clearAndLeak();\r\n        this.editor.executeEdits('inlineSuggestion.accept', [\r\n            EditOperation.replaceMove(completion.range, completion.text)\r\n        ]);\r\n        if (completion.command) {\r\n            this.commandService\r\n                .executeCommand(completion.command.id, ...(completion.command.arguments || []))\r\n                .finally(() => {\r\n                cache === null || cache === void 0 ? void 0 : cache.dispose();\r\n            })\r\n                .then(undefined, onUnexpectedExternalError);\r\n        }\r\n        else {\r\n            cache === null || cache === void 0 ? void 0 : cache.dispose();\r\n        }\r\n        this.onDidChangeEmitter.fire();\r\n    }\r\n}\r\nclass UpdateOperation {\r\n    constructor(promise, triggerKind) {\r\n        this.promise = promise;\r\n        this.triggerKind = triggerKind;\r\n    }\r\n    dispose() {\r\n        this.promise.cancel();\r\n    }\r\n}\r\n/**\r\n * The cache keeps itself in sync with the editor.\r\n * It also owns the completions result and disposes it when the cache is diposed.\r\n*/\r\nclass SynchronizedInlineCompletionsCache extends Disposable {\r\n    constructor(editor, completionsSource, onChange, triggerKind) {\r\n        super();\r\n        this.triggerKind = triggerKind;\r\n        const decorationIds = editor.deltaDecorations([], completionsSource.items.map(i => ({\r\n            range: i.range,\r\n            options: {\r\n                description: 'inline-completion-tracking-range'\r\n            },\r\n        })));\r\n        this._register(toDisposable(() => {\r\n            editor.deltaDecorations(decorationIds, []);\r\n        }));\r\n        this.completions = completionsSource.items.map((c, idx) => new CachedInlineCompletion(c, decorationIds[idx]));\r\n        this._register(editor.onDidChangeModelContent(() => {\r\n            let hasChanged = false;\r\n            const model = editor.getModel();\r\n            for (const c of this.completions) {\r\n                const newRange = model.getDecorationRange(c.decorationId);\r\n                if (!newRange) {\r\n                    onUnexpectedError(new Error('Decoration has no range'));\r\n                    continue;\r\n                }\r\n                if (!c.synchronizedRange.equalsRange(newRange)) {\r\n                    hasChanged = true;\r\n                    c.synchronizedRange = newRange;\r\n                }\r\n            }\r\n            if (hasChanged) {\r\n                onChange();\r\n            }\r\n        }));\r\n        this._register(completionsSource);\r\n    }\r\n}\r\nclass CachedInlineCompletion {\r\n    constructor(inlineCompletion, decorationId) {\r\n        this.inlineCompletion = inlineCompletion;\r\n        this.decorationId = decorationId;\r\n        this.semanticId = JSON.stringify({\r\n            text: this.inlineCompletion.text,\r\n            startLine: this.inlineCompletion.range.startLineNumber,\r\n            startColumn: this.inlineCompletion.range.startColumn,\r\n            command: this.inlineCompletion.command\r\n        });\r\n        this.synchronizedRange = inlineCompletion.range;\r\n    }\r\n}\r\nexport function inlineCompletionToGhostText(inlineCompletion, textModel, mode, cursorPosition) {\r\n    if (inlineCompletion.range.startLineNumber !== inlineCompletion.range.endLineNumber) {\r\n        // Only single line replacements are supported.\r\n        return undefined;\r\n    }\r\n    // This is a single line string\r\n    const valueToBeReplaced = textModel.getValueInRange(inlineCompletion.range);\r\n    const changes = cachingDiff(valueToBeReplaced, inlineCompletion.text);\r\n    const lineNumber = inlineCompletion.range.startLineNumber;\r\n    const parts = new Array();\r\n    if (mode === 'prefix') {\r\n        const filteredChanges = changes.filter(c => c.originalLength === 0);\r\n        if (filteredChanges.length > 1 || filteredChanges.length === 1 && filteredChanges[0].originalStart !== valueToBeReplaced.length) {\r\n            // Prefixes only have a single change.\r\n            return undefined;\r\n        }\r\n    }\r\n    for (const c of changes) {\r\n        const insertColumn = inlineCompletion.range.startColumn + c.originalStart + c.originalLength;\r\n        if (mode === 'subwordSmart' && cursorPosition && cursorPosition.lineNumber === inlineCompletion.range.startLineNumber && insertColumn < cursorPosition.column) {\r\n            // No ghost text before cursor\r\n            return undefined;\r\n        }\r\n        if (c.originalLength > 0) {\r\n            const originalText = valueToBeReplaced.substr(c.originalStart, c.originalLength);\r\n            const firstNonWsCol = textModel.getLineFirstNonWhitespaceColumn(lineNumber);\r\n            if (!(/^(\\t| )*$/.test(originalText) && (firstNonWsCol === 0 || insertColumn <= firstNonWsCol))) {\r\n                return undefined;\r\n            }\r\n        }\r\n        if (c.modifiedLength === 0) {\r\n            continue;\r\n        }\r\n        const text = inlineCompletion.text.substr(c.modifiedStart, c.modifiedLength);\r\n        const lines = strings.splitLines(text);\r\n        parts.push(new GhostTextPart(insertColumn, lines));\r\n    }\r\n    return new GhostText(lineNumber, parts, 0);\r\n}\r\nlet lastRequest = undefined;\r\nfunction cachingDiff(originalValue, newValue) {\r\n    if ((lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.originalValue) === originalValue && (lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.newValue) === newValue) {\r\n        return lastRequest === null || lastRequest === void 0 ? void 0 : lastRequest.changes;\r\n    }\r\n    else {\r\n        const changes = smartDiff(originalValue, newValue);\r\n        lastRequest = {\r\n            originalValue,\r\n            newValue,\r\n            changes\r\n        };\r\n        return changes;\r\n    }\r\n}\r\n/**\r\n * When matching `if ()` with `if (f() = 1) { g(); }`,\r\n * align it like this:        `if (       )`\r\n * Not like this:\t\t\t  `if (  )`\r\n * Also not like this:\t\t  `if (             )`.\r\n *\r\n * The parenthesis are preprocessed to ensure that they match correctly.\r\n */\r\nfunction smartDiff(originalValue, newValue) {\r\n    function getMaxCharCode(val) {\r\n        let maxCharCode = 0;\r\n        for (let i = 0, len = val.length; i < len; i++) {\r\n            const charCode = val.charCodeAt(i);\r\n            if (charCode > maxCharCode) {\r\n                maxCharCode = charCode;\r\n            }\r\n        }\r\n        return maxCharCode;\r\n    }\r\n    const maxCharCode = Math.max(getMaxCharCode(originalValue), getMaxCharCode(newValue));\r\n    function getUniqueCharCode(id) {\r\n        if (id < 0) {\r\n            throw new Error('unexpected');\r\n        }\r\n        return maxCharCode + id + 1;\r\n    }\r\n    function getElements(source) {\r\n        let level = 0;\r\n        let group = 0;\r\n        const characters = new Int32Array(source.length);\r\n        for (let i = 0, len = source.length; i < len; i++) {\r\n            const id = group * 100 + level;\r\n            // TODO support more brackets\r\n            if (source[i] === '(') {\r\n                characters[i] = getUniqueCharCode(2 * id);\r\n                level++;\r\n            }\r\n            else if (source[i] === ')') {\r\n                characters[i] = getUniqueCharCode(2 * id + 1);\r\n                if (level === 1) {\r\n                    group++;\r\n                }\r\n                level = Math.max(level - 1, 0);\r\n            }\r\n            else {\r\n                characters[i] = source.charCodeAt(i);\r\n            }\r\n        }\r\n        return characters;\r\n    }\r\n    const elements1 = getElements(originalValue);\r\n    const elements2 = getElements(newValue);\r\n    return new LcsDiff({ getElements: () => elements1 }, { getElements: () => elements2 }).ComputeDiff(false).changes;\r\n}\r\nfunction getDefaultRange(position, model) {\r\n    const word = model.getWordAtPosition(position);\r\n    const maxColumn = model.getLineMaxColumn(position.lineNumber);\r\n    // By default, always replace up until the end of the current line.\r\n    // This default might be subject to change!\r\n    return word\r\n        ? new Range(position.lineNumber, word.startColumn, position.lineNumber, maxColumn)\r\n        : Range.fromPositions(position, position.with(undefined, maxColumn));\r\n}\r\nfunction provideInlineCompletions(position, model, context, token = CancellationToken.None) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const defaultReplaceRange = getDefaultRange(position, model);\r\n        const providers = InlineCompletionsProviderRegistry.all(model);\r\n        const results = yield Promise.all(providers.map((provider) => __awaiter(this, void 0, void 0, function* () {\r\n            const completions = yield provider.provideInlineCompletions(model, position, context, token);\r\n            return ({\r\n                completions,\r\n                provider,\r\n                dispose: () => {\r\n                    if (completions) {\r\n                        provider.freeInlineCompletions(completions);\r\n                    }\r\n                }\r\n            });\r\n        })));\r\n        const itemsByHash = new Map();\r\n        for (const result of results) {\r\n            const completions = result.completions;\r\n            if (completions) {\r\n                for (const item of completions.items.map(item => ({\r\n                    text: item.text,\r\n                    range: item.range ? Range.lift(item.range) : defaultReplaceRange,\r\n                    command: item.command,\r\n                    sourceProvider: result.provider,\r\n                    sourceInlineCompletions: completions,\r\n                    sourceInlineCompletion: item\r\n                }))) {\r\n                    if (item.range.startLineNumber !== item.range.endLineNumber) {\r\n                        // Ignore invalid ranges.\r\n                        continue;\r\n                    }\r\n                    itemsByHash.set(JSON.stringify({ text: item.text, range: item.range }), item);\r\n                }\r\n            }\r\n        }\r\n        return {\r\n            items: [...itemsByHash.values()],\r\n            dispose: () => {\r\n                for (const result of results) {\r\n                    result.dispose();\r\n                }\r\n            },\r\n        };\r\n    });\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport class Scanner {\r\n    constructor() {\r\n        this.value = '';\r\n        this.pos = 0;\r\n    }\r\n    static isDigitCharacter(ch) {\r\n        return ch >= 48 /* Digit0 */ && ch <= 57 /* Digit9 */;\r\n    }\r\n    static isVariableCharacter(ch) {\r\n        return ch === 95 /* Underline */\r\n            || (ch >= 97 /* a */ && ch <= 122 /* z */)\r\n            || (ch >= 65 /* A */ && ch <= 90 /* Z */);\r\n    }\r\n    text(value) {\r\n        this.value = value;\r\n        this.pos = 0;\r\n    }\r\n    tokenText(token) {\r\n        return this.value.substr(token.pos, token.len);\r\n    }\r\n    next() {\r\n        if (this.pos >= this.value.length) {\r\n            return { type: 14 /* EOF */, pos: this.pos, len: 0 };\r\n        }\r\n        let pos = this.pos;\r\n        let len = 0;\r\n        let ch = this.value.charCodeAt(pos);\r\n        let type;\r\n        // static types\r\n        type = Scanner._table[ch];\r\n        if (typeof type === 'number') {\r\n            this.pos += 1;\r\n            return { type, pos, len: 1 };\r\n        }\r\n        // number\r\n        if (Scanner.isDigitCharacter(ch)) {\r\n            type = 8 /* Int */;\r\n            do {\r\n                len += 1;\r\n                ch = this.value.charCodeAt(pos + len);\r\n            } while (Scanner.isDigitCharacter(ch));\r\n            this.pos += len;\r\n            return { type, pos, len };\r\n        }\r\n        // variable name\r\n        if (Scanner.isVariableCharacter(ch)) {\r\n            type = 9 /* VariableName */;\r\n            do {\r\n                ch = this.value.charCodeAt(pos + (++len));\r\n            } while (Scanner.isVariableCharacter(ch) || Scanner.isDigitCharacter(ch));\r\n            this.pos += len;\r\n            return { type, pos, len };\r\n        }\r\n        // format\r\n        type = 10 /* Format */;\r\n        do {\r\n            len += 1;\r\n            ch = this.value.charCodeAt(pos + len);\r\n        } while (!isNaN(ch)\r\n            && typeof Scanner._table[ch] === 'undefined' // not static token\r\n            && !Scanner.isDigitCharacter(ch) // not number\r\n            && !Scanner.isVariableCharacter(ch) // not variable\r\n        );\r\n        this.pos += len;\r\n        return { type, pos, len };\r\n    }\r\n}\r\nScanner._table = {\r\n    [36 /* DollarSign */]: 0 /* Dollar */,\r\n    [58 /* Colon */]: 1 /* Colon */,\r\n    [44 /* Comma */]: 2 /* Comma */,\r\n    [123 /* OpenCurlyBrace */]: 3 /* CurlyOpen */,\r\n    [125 /* CloseCurlyBrace */]: 4 /* CurlyClose */,\r\n    [92 /* Backslash */]: 5 /* Backslash */,\r\n    [47 /* Slash */]: 6 /* Forwardslash */,\r\n    [124 /* Pipe */]: 7 /* Pipe */,\r\n    [43 /* Plus */]: 11 /* Plus */,\r\n    [45 /* Dash */]: 12 /* Dash */,\r\n    [63 /* QuestionMark */]: 13 /* QuestionMark */,\r\n};\r\nexport class Marker {\r\n    constructor() {\r\n        this._children = [];\r\n    }\r\n    appendChild(child) {\r\n        if (child instanceof Text && this._children[this._children.length - 1] instanceof Text) {\r\n            // this and previous child are text -> merge them\r\n            this._children[this._children.length - 1].value += child.value;\r\n        }\r\n        else {\r\n            // normal adoption of child\r\n            child.parent = this;\r\n            this._children.push(child);\r\n        }\r\n        return this;\r\n    }\r\n    replace(child, others) {\r\n        const { parent } = child;\r\n        const idx = parent.children.indexOf(child);\r\n        const newChildren = parent.children.slice(0);\r\n        newChildren.splice(idx, 1, ...others);\r\n        parent._children = newChildren;\r\n        (function _fixParent(children, parent) {\r\n            for (const child of children) {\r\n                child.parent = parent;\r\n                _fixParent(child.children, child);\r\n            }\r\n        })(others, parent);\r\n    }\r\n    get children() {\r\n        return this._children;\r\n    }\r\n    get snippet() {\r\n        let candidate = this;\r\n        while (true) {\r\n            if (!candidate) {\r\n                return undefined;\r\n            }\r\n            if (candidate instanceof TextmateSnippet) {\r\n                return candidate;\r\n            }\r\n            candidate = candidate.parent;\r\n        }\r\n    }\r\n    toString() {\r\n        return this.children.reduce((prev, cur) => prev + cur.toString(), '');\r\n    }\r\n    len() {\r\n        return 0;\r\n    }\r\n}\r\nexport class Text extends Marker {\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n    toString() {\r\n        return this.value;\r\n    }\r\n    len() {\r\n        return this.value.length;\r\n    }\r\n    clone() {\r\n        return new Text(this.value);\r\n    }\r\n}\r\nexport class TransformableMarker extends Marker {\r\n}\r\nexport class Placeholder extends TransformableMarker {\r\n    constructor(index) {\r\n        super();\r\n        this.index = index;\r\n    }\r\n    static compareByIndex(a, b) {\r\n        if (a.index === b.index) {\r\n            return 0;\r\n        }\r\n        else if (a.isFinalTabstop) {\r\n            return 1;\r\n        }\r\n        else if (b.isFinalTabstop) {\r\n            return -1;\r\n        }\r\n        else if (a.index < b.index) {\r\n            return -1;\r\n        }\r\n        else if (a.index > b.index) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    }\r\n    get isFinalTabstop() {\r\n        return this.index === 0;\r\n    }\r\n    get choice() {\r\n        return this._children.length === 1 && this._children[0] instanceof Choice\r\n            ? this._children[0]\r\n            : undefined;\r\n    }\r\n    clone() {\r\n        let ret = new Placeholder(this.index);\r\n        if (this.transform) {\r\n            ret.transform = this.transform.clone();\r\n        }\r\n        ret._children = this.children.map(child => child.clone());\r\n        return ret;\r\n    }\r\n}\r\nexport class Choice extends Marker {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.options = [];\r\n    }\r\n    appendChild(marker) {\r\n        if (marker instanceof Text) {\r\n            marker.parent = this;\r\n            this.options.push(marker);\r\n        }\r\n        return this;\r\n    }\r\n    toString() {\r\n        return this.options[0].value;\r\n    }\r\n    len() {\r\n        return this.options[0].len();\r\n    }\r\n    clone() {\r\n        let ret = new Choice();\r\n        this.options.forEach(ret.appendChild, ret);\r\n        return ret;\r\n    }\r\n}\r\nexport class Transform extends Marker {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.regexp = new RegExp('');\r\n    }\r\n    resolve(value) {\r\n        const _this = this;\r\n        let didMatch = false;\r\n        let ret = value.replace(this.regexp, function () {\r\n            didMatch = true;\r\n            return _this._replace(Array.prototype.slice.call(arguments, 0, -2));\r\n        });\r\n        // when the regex didn't match and when the transform has\r\n        // else branches, then run those\r\n        if (!didMatch && this._children.some(child => child instanceof FormatString && Boolean(child.elseValue))) {\r\n            ret = this._replace([]);\r\n        }\r\n        return ret;\r\n    }\r\n    _replace(groups) {\r\n        let ret = '';\r\n        for (const marker of this._children) {\r\n            if (marker instanceof FormatString) {\r\n                let value = groups[marker.index] || '';\r\n                value = marker.resolve(value);\r\n                ret += value;\r\n            }\r\n            else {\r\n                ret += marker.toString();\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    toString() {\r\n        return '';\r\n    }\r\n    clone() {\r\n        let ret = new Transform();\r\n        ret.regexp = new RegExp(this.regexp.source, '' + (this.regexp.ignoreCase ? 'i' : '') + (this.regexp.global ? 'g' : ''));\r\n        ret._children = this.children.map(child => child.clone());\r\n        return ret;\r\n    }\r\n}\r\nexport class FormatString extends Marker {\r\n    constructor(index, shorthandName, ifValue, elseValue) {\r\n        super();\r\n        this.index = index;\r\n        this.shorthandName = shorthandName;\r\n        this.ifValue = ifValue;\r\n        this.elseValue = elseValue;\r\n    }\r\n    resolve(value) {\r\n        if (this.shorthandName === 'upcase') {\r\n            return !value ? '' : value.toLocaleUpperCase();\r\n        }\r\n        else if (this.shorthandName === 'downcase') {\r\n            return !value ? '' : value.toLocaleLowerCase();\r\n        }\r\n        else if (this.shorthandName === 'capitalize') {\r\n            return !value ? '' : (value[0].toLocaleUpperCase() + value.substr(1));\r\n        }\r\n        else if (this.shorthandName === 'pascalcase') {\r\n            return !value ? '' : this._toPascalCase(value);\r\n        }\r\n        else if (this.shorthandName === 'camelcase') {\r\n            return !value ? '' : this._toCamelCase(value);\r\n        }\r\n        else if (Boolean(value) && typeof this.ifValue === 'string') {\r\n            return this.ifValue;\r\n        }\r\n        else if (!Boolean(value) && typeof this.elseValue === 'string') {\r\n            return this.elseValue;\r\n        }\r\n        else {\r\n            return value || '';\r\n        }\r\n    }\r\n    _toPascalCase(value) {\r\n        const match = value.match(/[a-z0-9]+/gi);\r\n        if (!match) {\r\n            return value;\r\n        }\r\n        return match.map(word => {\r\n            return word.charAt(0).toUpperCase()\r\n                + word.substr(1).toLowerCase();\r\n        })\r\n            .join('');\r\n    }\r\n    _toCamelCase(value) {\r\n        const match = value.match(/[a-z0-9]+/gi);\r\n        if (!match) {\r\n            return value;\r\n        }\r\n        return match.map((word, index) => {\r\n            if (index === 0) {\r\n                return word.toLowerCase();\r\n            }\r\n            else {\r\n                return word.charAt(0).toUpperCase()\r\n                    + word.substr(1).toLowerCase();\r\n            }\r\n        })\r\n            .join('');\r\n    }\r\n    clone() {\r\n        let ret = new FormatString(this.index, this.shorthandName, this.ifValue, this.elseValue);\r\n        return ret;\r\n    }\r\n}\r\nexport class Variable extends TransformableMarker {\r\n    constructor(name) {\r\n        super();\r\n        this.name = name;\r\n    }\r\n    resolve(resolver) {\r\n        let value = resolver.resolve(this);\r\n        if (this.transform) {\r\n            value = this.transform.resolve(value || '');\r\n        }\r\n        if (value !== undefined) {\r\n            this._children = [new Text(value)];\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    clone() {\r\n        const ret = new Variable(this.name);\r\n        if (this.transform) {\r\n            ret.transform = this.transform.clone();\r\n        }\r\n        ret._children = this.children.map(child => child.clone());\r\n        return ret;\r\n    }\r\n}\r\nfunction walk(marker, visitor) {\r\n    const stack = [...marker];\r\n    while (stack.length > 0) {\r\n        const marker = stack.shift();\r\n        const recurse = visitor(marker);\r\n        if (!recurse) {\r\n            break;\r\n        }\r\n        stack.unshift(...marker.children);\r\n    }\r\n}\r\nexport class TextmateSnippet extends Marker {\r\n    get placeholderInfo() {\r\n        if (!this._placeholders) {\r\n            // fill in placeholders\r\n            let all = [];\r\n            let last;\r\n            this.walk(function (candidate) {\r\n                if (candidate instanceof Placeholder) {\r\n                    all.push(candidate);\r\n                    last = !last || last.index < candidate.index ? candidate : last;\r\n                }\r\n                return true;\r\n            });\r\n            this._placeholders = { all, last };\r\n        }\r\n        return this._placeholders;\r\n    }\r\n    get placeholders() {\r\n        const { all } = this.placeholderInfo;\r\n        return all;\r\n    }\r\n    offset(marker) {\r\n        let pos = 0;\r\n        let found = false;\r\n        this.walk(candidate => {\r\n            if (candidate === marker) {\r\n                found = true;\r\n                return false;\r\n            }\r\n            pos += candidate.len();\r\n            return true;\r\n        });\r\n        if (!found) {\r\n            return -1;\r\n        }\r\n        return pos;\r\n    }\r\n    fullLen(marker) {\r\n        let ret = 0;\r\n        walk([marker], marker => {\r\n            ret += marker.len();\r\n            return true;\r\n        });\r\n        return ret;\r\n    }\r\n    enclosingPlaceholders(placeholder) {\r\n        let ret = [];\r\n        let { parent } = placeholder;\r\n        while (parent) {\r\n            if (parent instanceof Placeholder) {\r\n                ret.push(parent);\r\n            }\r\n            parent = parent.parent;\r\n        }\r\n        return ret;\r\n    }\r\n    resolveVariables(resolver) {\r\n        this.walk(candidate => {\r\n            if (candidate instanceof Variable) {\r\n                if (candidate.resolve(resolver)) {\r\n                    this._placeholders = undefined;\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n        return this;\r\n    }\r\n    appendChild(child) {\r\n        this._placeholders = undefined;\r\n        return super.appendChild(child);\r\n    }\r\n    replace(child, others) {\r\n        this._placeholders = undefined;\r\n        return super.replace(child, others);\r\n    }\r\n    clone() {\r\n        let ret = new TextmateSnippet();\r\n        this._children = this.children.map(child => child.clone());\r\n        return ret;\r\n    }\r\n    walk(visitor) {\r\n        walk(this.children, visitor);\r\n    }\r\n}\r\nexport class SnippetParser {\r\n    constructor() {\r\n        this._scanner = new Scanner();\r\n        this._token = { type: 14 /* EOF */, pos: 0, len: 0 };\r\n    }\r\n    static escape(value) {\r\n        return value.replace(/\\$|}|\\\\/g, '\\\\$&');\r\n    }\r\n    static guessNeedsClipboard(template) {\r\n        return /\\${?CLIPBOARD/.test(template);\r\n    }\r\n    parse(value, insertFinalTabstop, enforceFinalTabstop) {\r\n        this._scanner.text(value);\r\n        this._token = this._scanner.next();\r\n        const snippet = new TextmateSnippet();\r\n        while (this._parse(snippet)) {\r\n            // nothing\r\n        }\r\n        // fill in values for placeholders. the first placeholder of an index\r\n        // that has a value defines the value for all placeholders with that index\r\n        const placeholderDefaultValues = new Map();\r\n        const incompletePlaceholders = [];\r\n        let placeholderCount = 0;\r\n        snippet.walk(marker => {\r\n            if (marker instanceof Placeholder) {\r\n                placeholderCount += 1;\r\n                if (marker.isFinalTabstop) {\r\n                    placeholderDefaultValues.set(0, undefined);\r\n                }\r\n                else if (!placeholderDefaultValues.has(marker.index) && marker.children.length > 0) {\r\n                    placeholderDefaultValues.set(marker.index, marker.children);\r\n                }\r\n                else {\r\n                    incompletePlaceholders.push(marker);\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n        for (const placeholder of incompletePlaceholders) {\r\n            const defaultValues = placeholderDefaultValues.get(placeholder.index);\r\n            if (defaultValues) {\r\n                const clone = new Placeholder(placeholder.index);\r\n                clone.transform = placeholder.transform;\r\n                for (const child of defaultValues) {\r\n                    clone.appendChild(child.clone());\r\n                }\r\n                snippet.replace(placeholder, [clone]);\r\n            }\r\n        }\r\n        if (!enforceFinalTabstop) {\r\n            enforceFinalTabstop = placeholderCount > 0 && insertFinalTabstop;\r\n        }\r\n        if (!placeholderDefaultValues.has(0) && enforceFinalTabstop) {\r\n            // the snippet uses placeholders but has no\r\n            // final tabstop defined -> insert at the end\r\n            snippet.appendChild(new Placeholder(0));\r\n        }\r\n        return snippet;\r\n    }\r\n    _accept(type, value) {\r\n        if (type === undefined || this._token.type === type) {\r\n            let ret = !value ? true : this._scanner.tokenText(this._token);\r\n            this._token = this._scanner.next();\r\n            return ret;\r\n        }\r\n        return false;\r\n    }\r\n    _backTo(token) {\r\n        this._scanner.pos = token.pos + token.len;\r\n        this._token = token;\r\n        return false;\r\n    }\r\n    _until(type) {\r\n        const start = this._token;\r\n        while (this._token.type !== type) {\r\n            if (this._token.type === 14 /* EOF */) {\r\n                return false;\r\n            }\r\n            else if (this._token.type === 5 /* Backslash */) {\r\n                const nextToken = this._scanner.next();\r\n                if (nextToken.type !== 0 /* Dollar */\r\n                    && nextToken.type !== 4 /* CurlyClose */\r\n                    && nextToken.type !== 5 /* Backslash */) {\r\n                    return false;\r\n                }\r\n            }\r\n            this._token = this._scanner.next();\r\n        }\r\n        const value = this._scanner.value.substring(start.pos, this._token.pos).replace(/\\\\(\\$|}|\\\\)/g, '$1');\r\n        this._token = this._scanner.next();\r\n        return value;\r\n    }\r\n    _parse(marker) {\r\n        return this._parseEscaped(marker)\r\n            || this._parseTabstopOrVariableName(marker)\r\n            || this._parseComplexPlaceholder(marker)\r\n            || this._parseComplexVariable(marker)\r\n            || this._parseAnything(marker);\r\n    }\r\n    // \\$, \\\\, \\} -> just text\r\n    _parseEscaped(marker) {\r\n        let value;\r\n        if (value = this._accept(5 /* Backslash */, true)) {\r\n            // saw a backslash, append escaped token or that backslash\r\n            value = this._accept(0 /* Dollar */, true)\r\n                || this._accept(4 /* CurlyClose */, true)\r\n                || this._accept(5 /* Backslash */, true)\r\n                || value;\r\n            marker.appendChild(new Text(value));\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    // $foo -> variable, $1 -> tabstop\r\n    _parseTabstopOrVariableName(parent) {\r\n        let value;\r\n        const token = this._token;\r\n        const match = this._accept(0 /* Dollar */)\r\n            && (value = this._accept(9 /* VariableName */, true) || this._accept(8 /* Int */, true));\r\n        if (!match) {\r\n            return this._backTo(token);\r\n        }\r\n        parent.appendChild(/^\\d+$/.test(value)\r\n            ? new Placeholder(Number(value))\r\n            : new Variable(value));\r\n        return true;\r\n    }\r\n    // ${1:<children>}, ${1} -> placeholder\r\n    _parseComplexPlaceholder(parent) {\r\n        let index;\r\n        const token = this._token;\r\n        const match = this._accept(0 /* Dollar */)\r\n            && this._accept(3 /* CurlyOpen */)\r\n            && (index = this._accept(8 /* Int */, true));\r\n        if (!match) {\r\n            return this._backTo(token);\r\n        }\r\n        const placeholder = new Placeholder(Number(index));\r\n        if (this._accept(1 /* Colon */)) {\r\n            // ${1:<children>}\r\n            while (true) {\r\n                // ...} -> done\r\n                if (this._accept(4 /* CurlyClose */)) {\r\n                    parent.appendChild(placeholder);\r\n                    return true;\r\n                }\r\n                if (this._parse(placeholder)) {\r\n                    continue;\r\n                }\r\n                // fallback\r\n                parent.appendChild(new Text('${' + index + ':'));\r\n                placeholder.children.forEach(parent.appendChild, parent);\r\n                return true;\r\n            }\r\n        }\r\n        else if (placeholder.index > 0 && this._accept(7 /* Pipe */)) {\r\n            // ${1|one,two,three|}\r\n            const choice = new Choice();\r\n            while (true) {\r\n                if (this._parseChoiceElement(choice)) {\r\n                    if (this._accept(2 /* Comma */)) {\r\n                        // opt, -> more\r\n                        continue;\r\n                    }\r\n                    if (this._accept(7 /* Pipe */)) {\r\n                        placeholder.appendChild(choice);\r\n                        if (this._accept(4 /* CurlyClose */)) {\r\n                            // ..|} -> done\r\n                            parent.appendChild(placeholder);\r\n                            return true;\r\n                        }\r\n                    }\r\n                }\r\n                this._backTo(token);\r\n                return false;\r\n            }\r\n        }\r\n        else if (this._accept(6 /* Forwardslash */)) {\r\n            // ${1/<regex>/<format>/<options>}\r\n            if (this._parseTransform(placeholder)) {\r\n                parent.appendChild(placeholder);\r\n                return true;\r\n            }\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        else if (this._accept(4 /* CurlyClose */)) {\r\n            // ${1}\r\n            parent.appendChild(placeholder);\r\n            return true;\r\n        }\r\n        else {\r\n            // ${1 <- missing curly or colon\r\n            return this._backTo(token);\r\n        }\r\n    }\r\n    _parseChoiceElement(parent) {\r\n        const token = this._token;\r\n        const values = [];\r\n        while (true) {\r\n            if (this._token.type === 2 /* Comma */ || this._token.type === 7 /* Pipe */) {\r\n                break;\r\n            }\r\n            let value;\r\n            if (value = this._accept(5 /* Backslash */, true)) {\r\n                // \\, \\|, or \\\\\r\n                value = this._accept(2 /* Comma */, true)\r\n                    || this._accept(7 /* Pipe */, true)\r\n                    || this._accept(5 /* Backslash */, true)\r\n                    || value;\r\n            }\r\n            else {\r\n                value = this._accept(undefined, true);\r\n            }\r\n            if (!value) {\r\n                // EOF\r\n                this._backTo(token);\r\n                return false;\r\n            }\r\n            values.push(value);\r\n        }\r\n        if (values.length === 0) {\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        parent.appendChild(new Text(values.join('')));\r\n        return true;\r\n    }\r\n    // ${foo:<children>}, ${foo} -> variable\r\n    _parseComplexVariable(parent) {\r\n        let name;\r\n        const token = this._token;\r\n        const match = this._accept(0 /* Dollar */)\r\n            && this._accept(3 /* CurlyOpen */)\r\n            && (name = this._accept(9 /* VariableName */, true));\r\n        if (!match) {\r\n            return this._backTo(token);\r\n        }\r\n        const variable = new Variable(name);\r\n        if (this._accept(1 /* Colon */)) {\r\n            // ${foo:<children>}\r\n            while (true) {\r\n                // ...} -> done\r\n                if (this._accept(4 /* CurlyClose */)) {\r\n                    parent.appendChild(variable);\r\n                    return true;\r\n                }\r\n                if (this._parse(variable)) {\r\n                    continue;\r\n                }\r\n                // fallback\r\n                parent.appendChild(new Text('${' + name + ':'));\r\n                variable.children.forEach(parent.appendChild, parent);\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(6 /* Forwardslash */)) {\r\n            // ${foo/<regex>/<format>/<options>}\r\n            if (this._parseTransform(variable)) {\r\n                parent.appendChild(variable);\r\n                return true;\r\n            }\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        else if (this._accept(4 /* CurlyClose */)) {\r\n            // ${foo}\r\n            parent.appendChild(variable);\r\n            return true;\r\n        }\r\n        else {\r\n            // ${foo <- missing curly or colon\r\n            return this._backTo(token);\r\n        }\r\n    }\r\n    _parseTransform(parent) {\r\n        // ...<regex>/<format>/<options>}\r\n        let transform = new Transform();\r\n        let regexValue = '';\r\n        let regexOptions = '';\r\n        // (1) /regex\r\n        while (true) {\r\n            if (this._accept(6 /* Forwardslash */)) {\r\n                break;\r\n            }\r\n            let escaped;\r\n            if (escaped = this._accept(5 /* Backslash */, true)) {\r\n                escaped = this._accept(6 /* Forwardslash */, true) || escaped;\r\n                regexValue += escaped;\r\n                continue;\r\n            }\r\n            if (this._token.type !== 14 /* EOF */) {\r\n                regexValue += this._accept(undefined, true);\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        // (2) /format\r\n        while (true) {\r\n            if (this._accept(6 /* Forwardslash */)) {\r\n                break;\r\n            }\r\n            let escaped;\r\n            if (escaped = this._accept(5 /* Backslash */, true)) {\r\n                escaped = this._accept(5 /* Backslash */, true) || this._accept(6 /* Forwardslash */, true) || escaped;\r\n                transform.appendChild(new Text(escaped));\r\n                continue;\r\n            }\r\n            if (this._parseFormatString(transform) || this._parseAnything(transform)) {\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        // (3) /option\r\n        while (true) {\r\n            if (this._accept(4 /* CurlyClose */)) {\r\n                break;\r\n            }\r\n            if (this._token.type !== 14 /* EOF */) {\r\n                regexOptions += this._accept(undefined, true);\r\n                continue;\r\n            }\r\n            return false;\r\n        }\r\n        try {\r\n            transform.regexp = new RegExp(regexValue, regexOptions);\r\n        }\r\n        catch (e) {\r\n            // invalid regexp\r\n            return false;\r\n        }\r\n        parent.transform = transform;\r\n        return true;\r\n    }\r\n    _parseFormatString(parent) {\r\n        const token = this._token;\r\n        if (!this._accept(0 /* Dollar */)) {\r\n            return false;\r\n        }\r\n        let complex = false;\r\n        if (this._accept(3 /* CurlyOpen */)) {\r\n            complex = true;\r\n        }\r\n        let index = this._accept(8 /* Int */, true);\r\n        if (!index) {\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        else if (!complex) {\r\n            // $1\r\n            parent.appendChild(new FormatString(Number(index)));\r\n            return true;\r\n        }\r\n        else if (this._accept(4 /* CurlyClose */)) {\r\n            // ${1}\r\n            parent.appendChild(new FormatString(Number(index)));\r\n            return true;\r\n        }\r\n        else if (!this._accept(1 /* Colon */)) {\r\n            this._backTo(token);\r\n            return false;\r\n        }\r\n        if (this._accept(6 /* Forwardslash */)) {\r\n            // ${1:/upcase}\r\n            let shorthand = this._accept(9 /* VariableName */, true);\r\n            if (!shorthand || !this._accept(4 /* CurlyClose */)) {\r\n                this._backTo(token);\r\n                return false;\r\n            }\r\n            else {\r\n                parent.appendChild(new FormatString(Number(index), shorthand));\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(11 /* Plus */)) {\r\n            // ${1:+<if>}\r\n            let ifValue = this._until(4 /* CurlyClose */);\r\n            if (ifValue) {\r\n                parent.appendChild(new FormatString(Number(index), undefined, ifValue, undefined));\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(12 /* Dash */)) {\r\n            // ${2:-<else>}\r\n            let elseValue = this._until(4 /* CurlyClose */);\r\n            if (elseValue) {\r\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\r\n                return true;\r\n            }\r\n        }\r\n        else if (this._accept(13 /* QuestionMark */)) {\r\n            // ${2:?<if>:<else>}\r\n            let ifValue = this._until(1 /* Colon */);\r\n            if (ifValue) {\r\n                let elseValue = this._until(4 /* CurlyClose */);\r\n                if (elseValue) {\r\n                    parent.appendChild(new FormatString(Number(index), undefined, ifValue, elseValue));\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // ${1:<else>}\r\n            let elseValue = this._until(4 /* CurlyClose */);\r\n            if (elseValue) {\r\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\r\n                return true;\r\n            }\r\n        }\r\n        this._backTo(token);\r\n        return false;\r\n    }\r\n    _parseAnything(marker) {\r\n        if (this._token.type !== 14 /* EOF */) {\r\n            marker.appendChild(new Text(this._scanner.tokenText(this._token)));\r\n            this._accept(undefined);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\n", "import { URI } from '../../../base/common/uri.js';\r\nexport const WORKSPACE_EXTENSION = 'code-workspace';\r\nexport function isSingleFolderWorkspaceIdentifier(obj) {\r\n    const singleFolderIdentifier = obj;\r\n    return typeof (singleFolderIdentifier === null || singleFolderIdentifier === void 0 ? void 0 : singleFolderIdentifier.id) === 'string' && URI.isUri(singleFolderIdentifier.uri);\r\n}\r\nexport function toWorkspaceIdentifier(workspace) {\r\n    // Multi root\r\n    if (workspace.configuration) {\r\n        return {\r\n            id: workspace.id,\r\n            configPath: workspace.configuration\r\n        };\r\n    }\r\n    // Single folder\r\n    if (workspace.folders.length === 1) {\r\n        return {\r\n            id: workspace.id,\r\n            uri: workspace.folders[0].uri\r\n        };\r\n    }\r\n    // Empty workspace\r\n    return undefined;\r\n}\r\n//#endregion\r\n", "// prep-work\r\nconst _data = new Uint8Array(16);\r\nconst _hex = [];\r\nfor (let i = 0; i < 256; i++) {\r\n    _hex.push(i.toString(16).padStart(2, '0'));\r\n}\r\n// todo@jrieken - with node@15 crypto#getRandomBytes is available everywhere, https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues#browser_compatibility\r\nlet _fillRandomValues;\r\nif (typeof crypto === 'object' && typeof crypto.getRandomValues === 'function') {\r\n    // browser\r\n    _fillRandomValues = crypto.getRandomValues.bind(crypto);\r\n}\r\nelse {\r\n    _fillRandomValues = function (bucket) {\r\n        for (let i = 0; i < bucket.length; i++) {\r\n            bucket[i] = Math.floor(Math.random() * 256);\r\n        }\r\n        return bucket;\r\n    };\r\n}\r\nexport function generateUuid() {\r\n    // get data\r\n    _fillRandomValues(_data);\r\n    // set version bits\r\n    _data[6] = (_data[6] & 0x0f) | 0x40;\r\n    _data[8] = (_data[8] & 0x3f) | 0x80;\r\n    // print as string\r\n    let i = 0;\r\n    let result = '';\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += '-';\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += '-';\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += '-';\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += '-';\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    result += _hex[_data[i++]];\r\n    return result;\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport * as path from '../../../base/common/path.js';\r\nimport { dirname } from '../../../base/common/resources.js';\r\nimport { Text } from './snippetParser.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { getLeadingWhitespace, commonPrefixLength, isFalsyOrWhitespace, splitLines } from '../../../base/common/strings.js';\r\nimport { toWorkspaceIdentifier, WORKSPACE_EXTENSION, isSingleFolderWorkspaceIdentifier } from '../../../platform/workspaces/common/workspaces.js';\r\nimport { normalizeDriveLetter } from '../../../base/common/labels.js';\r\nimport { generateUuid } from '../../../base/common/uuid.js';\r\nexport class CompositeSnippetVariableResolver {\r\n    constructor(_delegates) {\r\n        this._delegates = _delegates;\r\n        //\r\n    }\r\n    resolve(variable) {\r\n        for (const delegate of this._delegates) {\r\n            let value = delegate.resolve(variable);\r\n            if (value !== undefined) {\r\n                return value;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\nexport class SelectionBasedVariableResolver {\r\n    constructor(_model, _selection, _selectionIdx, _overtypingCapturer) {\r\n        this._model = _model;\r\n        this._selection = _selection;\r\n        this._selectionIdx = _selectionIdx;\r\n        this._overtypingCapturer = _overtypingCapturer;\r\n        //\r\n    }\r\n    resolve(variable) {\r\n        const { name } = variable;\r\n        if (name === 'SELECTION' || name === 'TM_SELECTED_TEXT') {\r\n            let value = this._model.getValueInRange(this._selection) || undefined;\r\n            let isMultiline = this._selection.startLineNumber !== this._selection.endLineNumber;\r\n            // If there was no selected text, try to get last overtyped text\r\n            if (!value && this._overtypingCapturer) {\r\n                const info = this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);\r\n                if (info) {\r\n                    value = info.value;\r\n                    isMultiline = info.multiline;\r\n                }\r\n            }\r\n            if (value && isMultiline && variable.snippet) {\r\n                // Selection is a multiline string which we indentation we now\r\n                // need to adjust. We compare the indentation of this variable\r\n                // with the indentation at the editor position and add potential\r\n                // extra indentation to the value\r\n                const line = this._model.getLineContent(this._selection.startLineNumber);\r\n                const lineLeadingWhitespace = getLeadingWhitespace(line, 0, this._selection.startColumn - 1);\r\n                let varLeadingWhitespace = lineLeadingWhitespace;\r\n                variable.snippet.walk(marker => {\r\n                    if (marker === variable) {\r\n                        return false;\r\n                    }\r\n                    if (marker instanceof Text) {\r\n                        varLeadingWhitespace = getLeadingWhitespace(splitLines(marker.value).pop());\r\n                    }\r\n                    return true;\r\n                });\r\n                const whitespaceCommonLength = commonPrefixLength(varLeadingWhitespace, lineLeadingWhitespace);\r\n                value = value.replace(/(\\r\\n|\\r|\\n)(.*)/g, (m, newline, rest) => `${newline}${varLeadingWhitespace.substr(whitespaceCommonLength)}${rest}`);\r\n            }\r\n            return value;\r\n        }\r\n        else if (name === 'TM_CURRENT_LINE') {\r\n            return this._model.getLineContent(this._selection.positionLineNumber);\r\n        }\r\n        else if (name === 'TM_CURRENT_WORD') {\r\n            const info = this._model.getWordAtPosition({\r\n                lineNumber: this._selection.positionLineNumber,\r\n                column: this._selection.positionColumn\r\n            });\r\n            return info && info.word || undefined;\r\n        }\r\n        else if (name === 'TM_LINE_INDEX') {\r\n            return String(this._selection.positionLineNumber - 1);\r\n        }\r\n        else if (name === 'TM_LINE_NUMBER') {\r\n            return String(this._selection.positionLineNumber);\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\nexport class ModelBasedVariableResolver {\r\n    constructor(_labelService, _model) {\r\n        this._labelService = _labelService;\r\n        this._model = _model;\r\n        //\r\n    }\r\n    resolve(variable) {\r\n        const { name } = variable;\r\n        if (name === 'TM_FILENAME') {\r\n            return path.basename(this._model.uri.fsPath);\r\n        }\r\n        else if (name === 'TM_FILENAME_BASE') {\r\n            const name = path.basename(this._model.uri.fsPath);\r\n            const idx = name.lastIndexOf('.');\r\n            if (idx <= 0) {\r\n                return name;\r\n            }\r\n            else {\r\n                return name.slice(0, idx);\r\n            }\r\n        }\r\n        else if (name === 'TM_DIRECTORY' && this._labelService) {\r\n            if (path.dirname(this._model.uri.fsPath) === '.') {\r\n                return '';\r\n            }\r\n            return this._labelService.getUriLabel(dirname(this._model.uri));\r\n        }\r\n        else if (name === 'TM_FILEPATH' && this._labelService) {\r\n            return this._labelService.getUriLabel(this._model.uri);\r\n        }\r\n        else if (name === 'RELATIVE_FILEPATH' && this._labelService) {\r\n            return this._labelService.getUriLabel(this._model.uri, { relative: true, noPrefix: true });\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\nexport class ClipboardBasedVariableResolver {\r\n    constructor(_readClipboardText, _selectionIdx, _selectionCount, _spread) {\r\n        this._readClipboardText = _readClipboardText;\r\n        this._selectionIdx = _selectionIdx;\r\n        this._selectionCount = _selectionCount;\r\n        this._spread = _spread;\r\n        //\r\n    }\r\n    resolve(variable) {\r\n        if (variable.name !== 'CLIPBOARD') {\r\n            return undefined;\r\n        }\r\n        const clipboardText = this._readClipboardText();\r\n        if (!clipboardText) {\r\n            return undefined;\r\n        }\r\n        // `spread` is assigning each cursor a line of the clipboard\r\n        // text whenever there the line count equals the cursor count\r\n        // and when enabled\r\n        if (this._spread) {\r\n            const lines = clipboardText.split(/\\r\\n|\\n|\\r/).filter(s => !isFalsyOrWhitespace(s));\r\n            if (lines.length === this._selectionCount) {\r\n                return lines[this._selectionIdx];\r\n            }\r\n        }\r\n        return clipboardText;\r\n    }\r\n}\r\nexport class CommentBasedVariableResolver {\r\n    constructor(_model, _selection) {\r\n        this._model = _model;\r\n        this._selection = _selection;\r\n        //\r\n    }\r\n    resolve(variable) {\r\n        const { name } = variable;\r\n        const langId = this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber, this._selection.selectionStartColumn);\r\n        const config = LanguageConfigurationRegistry.getComments(langId);\r\n        if (!config) {\r\n            return undefined;\r\n        }\r\n        if (name === 'LINE_COMMENT') {\r\n            return config.lineCommentToken || undefined;\r\n        }\r\n        else if (name === 'BLOCK_COMMENT_START') {\r\n            return config.blockCommentStartToken || undefined;\r\n        }\r\n        else if (name === 'BLOCK_COMMENT_END') {\r\n            return config.blockCommentEndToken || undefined;\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\nexport class TimeBasedVariableResolver {\r\n    constructor() {\r\n        this._date = new Date();\r\n    }\r\n    resolve(variable) {\r\n        const { name } = variable;\r\n        if (name === 'CURRENT_YEAR') {\r\n            return String(this._date.getFullYear());\r\n        }\r\n        else if (name === 'CURRENT_YEAR_SHORT') {\r\n            return String(this._date.getFullYear()).slice(-2);\r\n        }\r\n        else if (name === 'CURRENT_MONTH') {\r\n            return String(this._date.getMonth().valueOf() + 1).padStart(2, '0');\r\n        }\r\n        else if (name === 'CURRENT_DATE') {\r\n            return String(this._date.getDate().valueOf()).padStart(2, '0');\r\n        }\r\n        else if (name === 'CURRENT_HOUR') {\r\n            return String(this._date.getHours().valueOf()).padStart(2, '0');\r\n        }\r\n        else if (name === 'CURRENT_MINUTE') {\r\n            return String(this._date.getMinutes().valueOf()).padStart(2, '0');\r\n        }\r\n        else if (name === 'CURRENT_SECOND') {\r\n            return String(this._date.getSeconds().valueOf()).padStart(2, '0');\r\n        }\r\n        else if (name === 'CURRENT_DAY_NAME') {\r\n            return TimeBasedVariableResolver.dayNames[this._date.getDay()];\r\n        }\r\n        else if (name === 'CURRENT_DAY_NAME_SHORT') {\r\n            return TimeBasedVariableResolver.dayNamesShort[this._date.getDay()];\r\n        }\r\n        else if (name === 'CURRENT_MONTH_NAME') {\r\n            return TimeBasedVariableResolver.monthNames[this._date.getMonth()];\r\n        }\r\n        else if (name === 'CURRENT_MONTH_NAME_SHORT') {\r\n            return TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()];\r\n        }\r\n        else if (name === 'CURRENT_SECONDS_UNIX') {\r\n            return String(Math.floor(this._date.getTime() / 1000));\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\nTimeBasedVariableResolver.dayNames = [nls.localize('Sunday', \"Sunday\"), nls.localize('Monday', \"Monday\"), nls.localize('Tuesday', \"Tuesday\"), nls.localize('Wednesday', \"Wednesday\"), nls.localize('Thursday', \"Thursday\"), nls.localize('Friday', \"Friday\"), nls.localize('Saturday', \"Saturday\")];\r\nTimeBasedVariableResolver.dayNamesShort = [nls.localize('SundayShort', \"Sun\"), nls.localize('MondayShort', \"Mon\"), nls.localize('TuesdayShort', \"Tue\"), nls.localize('WednesdayShort', \"Wed\"), nls.localize('ThursdayShort', \"Thu\"), nls.localize('FridayShort', \"Fri\"), nls.localize('SaturdayShort', \"Sat\")];\r\nTimeBasedVariableResolver.monthNames = [nls.localize('January', \"January\"), nls.localize('February', \"February\"), nls.localize('March', \"March\"), nls.localize('April', \"April\"), nls.localize('May', \"May\"), nls.localize('June', \"June\"), nls.localize('July', \"July\"), nls.localize('August', \"August\"), nls.localize('September', \"September\"), nls.localize('October', \"October\"), nls.localize('November', \"November\"), nls.localize('December', \"December\")];\r\nTimeBasedVariableResolver.monthNamesShort = [nls.localize('JanuaryShort', \"Jan\"), nls.localize('FebruaryShort', \"Feb\"), nls.localize('MarchShort', \"Mar\"), nls.localize('AprilShort', \"Apr\"), nls.localize('MayShort', \"May\"), nls.localize('JuneShort', \"Jun\"), nls.localize('JulyShort', \"Jul\"), nls.localize('AugustShort', \"Aug\"), nls.localize('SeptemberShort', \"Sep\"), nls.localize('OctoberShort', \"Oct\"), nls.localize('NovemberShort', \"Nov\"), nls.localize('DecemberShort', \"Dec\")];\r\nexport class WorkspaceBasedVariableResolver {\r\n    constructor(_workspaceService) {\r\n        this._workspaceService = _workspaceService;\r\n        //\r\n    }\r\n    resolve(variable) {\r\n        if (!this._workspaceService) {\r\n            return undefined;\r\n        }\r\n        const workspaceIdentifier = toWorkspaceIdentifier(this._workspaceService.getWorkspace());\r\n        if (!workspaceIdentifier) {\r\n            return undefined;\r\n        }\r\n        if (variable.name === 'WORKSPACE_NAME') {\r\n            return this._resolveWorkspaceName(workspaceIdentifier);\r\n        }\r\n        else if (variable.name === 'WORKSPACE_FOLDER') {\r\n            return this._resoveWorkspacePath(workspaceIdentifier);\r\n        }\r\n        return undefined;\r\n    }\r\n    _resolveWorkspaceName(workspaceIdentifier) {\r\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\r\n            return path.basename(workspaceIdentifier.uri.path);\r\n        }\r\n        let filename = path.basename(workspaceIdentifier.configPath.path);\r\n        if (filename.endsWith(WORKSPACE_EXTENSION)) {\r\n            filename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\r\n        }\r\n        return filename;\r\n    }\r\n    _resoveWorkspacePath(workspaceIdentifier) {\r\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\r\n            return normalizeDriveLetter(workspaceIdentifier.uri.fsPath);\r\n        }\r\n        let filename = path.basename(workspaceIdentifier.configPath.path);\r\n        let folderpath = workspaceIdentifier.configPath.fsPath;\r\n        if (folderpath.endsWith(filename)) {\r\n            folderpath = folderpath.substr(0, folderpath.length - filename.length - 1);\r\n        }\r\n        return (folderpath ? normalizeDriveLetter(folderpath) : '/');\r\n    }\r\n}\r\nexport class RandomBasedVariableResolver {\r\n    resolve(variable) {\r\n        const { name } = variable;\r\n        if (name === 'RANDOM') {\r\n            return Math.random().toString().slice(-6);\r\n        }\r\n        else if (name === 'RANDOM_HEX') {\r\n            return Math.random().toString(16).slice(-6);\r\n        }\r\n        else if (name === 'UUID') {\r\n            return generateUuid();\r\n        }\r\n        return undefined;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { groupBy } from '../../../base/common/arrays.js';\r\nimport { dispose } from '../../../base/common/lifecycle.js';\r\nimport { getLeadingWhitespace } from '../../../base/common/strings.js';\r\nimport './snippetSession.css';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { IWorkspaceContextService } from '../../../platform/workspace/common/workspace.js';\r\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { Choice, Placeholder, SnippetParser, Text } from './snippetParser.js';\r\nimport { ClipboardBasedVariableResolver, CompositeSnippetVariableResolver, ModelBasedVariableResolver, SelectionBasedVariableResolver, TimeBasedVariableResolver, CommentBasedVariableResolver, WorkspaceBasedVariableResolver, RandomBasedVariableResolver } from './snippetVariables.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport * as colors from '../../../platform/theme/common/colorRegistry.js';\r\nimport { ILabelService } from '../../../platform/label/common/label.js';\r\nregisterThemingParticipant((theme, collector) => {\r\n    function getColorGraceful(name) {\r\n        const color = theme.getColor(name);\r\n        return color ? color.toString() : 'transparent';\r\n    }\r\n    collector.addRule(`.monaco-editor .snippet-placeholder { background-color: ${getColorGraceful(colors.snippetTabstopHighlightBackground)}; outline-color: ${getColorGraceful(colors.snippetTabstopHighlightBorder)}; }`);\r\n    collector.addRule(`.monaco-editor .finish-snippet-placeholder { background-color: ${getColorGraceful(colors.snippetFinalTabstopHighlightBackground)}; outline-color: ${getColorGraceful(colors.snippetFinalTabstopHighlightBorder)}; }`);\r\n});\r\nexport class OneSnippet {\r\n    constructor(_editor, _snippet, _offset, _snippetLineLeadingWhitespace) {\r\n        this._editor = _editor;\r\n        this._snippet = _snippet;\r\n        this._offset = _offset;\r\n        this._snippetLineLeadingWhitespace = _snippetLineLeadingWhitespace;\r\n        this._nestingLevel = 1;\r\n        this._placeholderGroups = groupBy(_snippet.placeholders, Placeholder.compareByIndex);\r\n        this._placeholderGroupsIdx = -1;\r\n    }\r\n    dispose() {\r\n        if (this._placeholderDecorations) {\r\n            this._editor.deltaDecorations([...this._placeholderDecorations.values()], []);\r\n        }\r\n        this._placeholderGroups.length = 0;\r\n    }\r\n    _initDecorations() {\r\n        if (this._placeholderDecorations) {\r\n            // already initialized\r\n            return;\r\n        }\r\n        this._placeholderDecorations = new Map();\r\n        const model = this._editor.getModel();\r\n        this._editor.changeDecorations(accessor => {\r\n            // create a decoration for each placeholder\r\n            for (const placeholder of this._snippet.placeholders) {\r\n                const placeholderOffset = this._snippet.offset(placeholder);\r\n                const placeholderLen = this._snippet.fullLen(placeholder);\r\n                const range = Range.fromPositions(model.getPositionAt(this._offset + placeholderOffset), model.getPositionAt(this._offset + placeholderOffset + placeholderLen));\r\n                const options = placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive;\r\n                const handle = accessor.addDecoration(range, options);\r\n                this._placeholderDecorations.set(placeholder, handle);\r\n            }\r\n        });\r\n    }\r\n    move(fwd) {\r\n        if (!this._editor.hasModel()) {\r\n            return [];\r\n        }\r\n        this._initDecorations();\r\n        // Transform placeholder text if necessary\r\n        if (this._placeholderGroupsIdx >= 0) {\r\n            let operations = [];\r\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\r\n                // Check if the placeholder has a transformation\r\n                if (placeholder.transform) {\r\n                    const id = this._placeholderDecorations.get(placeholder);\r\n                    const range = this._editor.getModel().getDecorationRange(id);\r\n                    const currentValue = this._editor.getModel().getValueInRange(range);\r\n                    const transformedValueLines = placeholder.transform.resolve(currentValue).split(/\\r\\n|\\r|\\n/);\r\n                    // fix indentation for transformed lines\r\n                    for (let i = 1; i < transformedValueLines.length; i++) {\r\n                        transformedValueLines[i] = this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace + transformedValueLines[i]);\r\n                    }\r\n                    operations.push(EditOperation.replace(range, transformedValueLines.join(this._editor.getModel().getEOL())));\r\n                }\r\n            }\r\n            if (operations.length > 0) {\r\n                this._editor.executeEdits('snippet.placeholderTransform', operations);\r\n            }\r\n        }\r\n        let couldSkipThisPlaceholder = false;\r\n        if (fwd === true && this._placeholderGroupsIdx < this._placeholderGroups.length - 1) {\r\n            this._placeholderGroupsIdx += 1;\r\n            couldSkipThisPlaceholder = true;\r\n        }\r\n        else if (fwd === false && this._placeholderGroupsIdx > 0) {\r\n            this._placeholderGroupsIdx -= 1;\r\n            couldSkipThisPlaceholder = true;\r\n        }\r\n        else {\r\n            // the selection of the current placeholder might\r\n            // not acurate any more -> simply restore it\r\n        }\r\n        const newSelections = this._editor.getModel().changeDecorations(accessor => {\r\n            const activePlaceholders = new Set();\r\n            // change stickiness to always grow when typing at its edges\r\n            // because these decorations represent the currently active\r\n            // tabstop.\r\n            // Special case #1: reaching the final tabstop\r\n            // Special case #2: placeholders enclosing active placeholders\r\n            const selections = [];\r\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\r\n                const id = this._placeholderDecorations.get(placeholder);\r\n                const range = this._editor.getModel().getDecorationRange(id);\r\n                selections.push(new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn));\r\n                // consider to skip this placeholder index when the decoration\r\n                // range is empty but when the placeholder wasn't. that's a strong\r\n                // hint that the placeholder has been deleted. (all placeholder must match this)\r\n                couldSkipThisPlaceholder = couldSkipThisPlaceholder && this._hasPlaceholderBeenCollapsed(placeholder);\r\n                accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\r\n                activePlaceholders.add(placeholder);\r\n                for (const enclosingPlaceholder of this._snippet.enclosingPlaceholders(placeholder)) {\r\n                    const id = this._placeholderDecorations.get(enclosingPlaceholder);\r\n                    accessor.changeDecorationOptions(id, enclosingPlaceholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\r\n                    activePlaceholders.add(enclosingPlaceholder);\r\n                }\r\n            }\r\n            // change stickness to never grow when typing at its edges\r\n            // so that in-active tabstops never grow\r\n            for (const [placeholder, id] of this._placeholderDecorations) {\r\n                if (!activePlaceholders.has(placeholder)) {\r\n                    accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive);\r\n                }\r\n            }\r\n            return selections;\r\n        });\r\n        return !couldSkipThisPlaceholder ? newSelections !== null && newSelections !== void 0 ? newSelections : [] : this.move(fwd);\r\n    }\r\n    _hasPlaceholderBeenCollapsed(placeholder) {\r\n        // A placeholder is empty when it wasn't empty when authored but\r\n        // when its tracking decoration is empty. This also applies to all\r\n        // potential parent placeholders\r\n        let marker = placeholder;\r\n        while (marker) {\r\n            if (marker instanceof Placeholder) {\r\n                const id = this._placeholderDecorations.get(marker);\r\n                const range = this._editor.getModel().getDecorationRange(id);\r\n                if (range.isEmpty() && marker.toString().length > 0) {\r\n                    return true;\r\n                }\r\n            }\r\n            marker = marker.parent;\r\n        }\r\n        return false;\r\n    }\r\n    get isAtFirstPlaceholder() {\r\n        return this._placeholderGroupsIdx <= 0 || this._placeholderGroups.length === 0;\r\n    }\r\n    get isAtLastPlaceholder() {\r\n        return this._placeholderGroupsIdx === this._placeholderGroups.length - 1;\r\n    }\r\n    get hasPlaceholder() {\r\n        return this._snippet.placeholders.length > 0;\r\n    }\r\n    computePossibleSelections() {\r\n        const result = new Map();\r\n        for (const placeholdersWithEqualIndex of this._placeholderGroups) {\r\n            let ranges;\r\n            for (const placeholder of placeholdersWithEqualIndex) {\r\n                if (placeholder.isFinalTabstop) {\r\n                    // ignore those\r\n                    break;\r\n                }\r\n                if (!ranges) {\r\n                    ranges = [];\r\n                    result.set(placeholder.index, ranges);\r\n                }\r\n                const id = this._placeholderDecorations.get(placeholder);\r\n                const range = this._editor.getModel().getDecorationRange(id);\r\n                if (!range) {\r\n                    // one of the placeholder lost its decoration and\r\n                    // therefore we bail out and pretend the placeholder\r\n                    // (with its mirrors) doesn't exist anymore.\r\n                    result.delete(placeholder.index);\r\n                    break;\r\n                }\r\n                ranges.push(range);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    get choice() {\r\n        return this._placeholderGroups[this._placeholderGroupsIdx][0].choice;\r\n    }\r\n    merge(others) {\r\n        const model = this._editor.getModel();\r\n        this._nestingLevel *= 10;\r\n        this._editor.changeDecorations(accessor => {\r\n            // For each active placeholder take one snippet and merge it\r\n            // in that the placeholder (can be many for `$1foo$1foo`). Because\r\n            // everything is sorted by editor selection we can simply remove\r\n            // elements from the beginning of the array\r\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\r\n                const nested = others.shift();\r\n                console.assert(!nested._placeholderDecorations);\r\n                // Massage placeholder-indicies of the nested snippet to be\r\n                // sorted right after the insertion point. This ensures we move\r\n                // through the placeholders in the correct order\r\n                const indexLastPlaceholder = nested._snippet.placeholderInfo.last.index;\r\n                for (const nestedPlaceholder of nested._snippet.placeholderInfo.all) {\r\n                    if (nestedPlaceholder.isFinalTabstop) {\r\n                        nestedPlaceholder.index = placeholder.index + ((indexLastPlaceholder + 1) / this._nestingLevel);\r\n                    }\r\n                    else {\r\n                        nestedPlaceholder.index = placeholder.index + (nestedPlaceholder.index / this._nestingLevel);\r\n                    }\r\n                }\r\n                this._snippet.replace(placeholder, nested._snippet.children);\r\n                // Remove the placeholder at which position are inserting\r\n                // the snippet and also remove its decoration.\r\n                const id = this._placeholderDecorations.get(placeholder);\r\n                accessor.removeDecoration(id);\r\n                this._placeholderDecorations.delete(placeholder);\r\n                // For each *new* placeholder we create decoration to monitor\r\n                // how and if it grows/shrinks.\r\n                for (const placeholder of nested._snippet.placeholders) {\r\n                    const placeholderOffset = nested._snippet.offset(placeholder);\r\n                    const placeholderLen = nested._snippet.fullLen(placeholder);\r\n                    const range = Range.fromPositions(model.getPositionAt(nested._offset + placeholderOffset), model.getPositionAt(nested._offset + placeholderOffset + placeholderLen));\r\n                    const handle = accessor.addDecoration(range, OneSnippet._decor.inactive);\r\n                    this._placeholderDecorations.set(placeholder, handle);\r\n                }\r\n            }\r\n            // Last, re-create the placeholder groups by sorting placeholders by their index.\r\n            this._placeholderGroups = groupBy(this._snippet.placeholders, Placeholder.compareByIndex);\r\n        });\r\n    }\r\n}\r\nOneSnippet._decor = {\r\n    active: ModelDecorationOptions.register({ description: 'snippet-placeholder-1', stickiness: 0 /* AlwaysGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\r\n    inactive: ModelDecorationOptions.register({ description: 'snippet-placeholder-2', stickiness: 1 /* NeverGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\r\n    activeFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-3', stickiness: 1 /* NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\r\n    inactiveFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-4', stickiness: 1 /* NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\r\n};\r\nconst _defaultOptions = {\r\n    overwriteBefore: 0,\r\n    overwriteAfter: 0,\r\n    adjustWhitespace: true,\r\n    clipboardText: undefined,\r\n    overtypingCapturer: undefined\r\n};\r\nexport class SnippetSession {\r\n    constructor(editor, template, options = _defaultOptions) {\r\n        this._templateMerges = [];\r\n        this._snippets = [];\r\n        this._editor = editor;\r\n        this._template = template;\r\n        this._options = options;\r\n    }\r\n    static adjustWhitespace(model, position, snippet, adjustIndentation, adjustNewlines) {\r\n        const line = model.getLineContent(position.lineNumber);\r\n        const lineLeadingWhitespace = getLeadingWhitespace(line, 0, position.column - 1);\r\n        // the snippet as inserted\r\n        let snippetTextString;\r\n        snippet.walk(marker => {\r\n            // all text elements that are not inside choice\r\n            if (!(marker instanceof Text) || marker.parent instanceof Choice) {\r\n                return true;\r\n            }\r\n            const lines = marker.value.split(/\\r\\n|\\r|\\n/);\r\n            if (adjustIndentation) {\r\n                // adjust indentation of snippet test\r\n                // -the snippet-start doesn't get extra-indented (lineLeadingWhitespace), only normalized\r\n                // -all N+1 lines get extra-indented and normalized\r\n                // -the text start get extra-indented and normalized when following a linebreak\r\n                const offset = snippet.offset(marker);\r\n                if (offset === 0) {\r\n                    // snippet start\r\n                    lines[0] = model.normalizeIndentation(lines[0]);\r\n                }\r\n                else {\r\n                    // check if text start is after a linebreak\r\n                    snippetTextString = snippetTextString !== null && snippetTextString !== void 0 ? snippetTextString : snippet.toString();\r\n                    let prevChar = snippetTextString.charCodeAt(offset - 1);\r\n                    if (prevChar === 10 /* LineFeed */ || prevChar === 13 /* CarriageReturn */) {\r\n                        lines[0] = model.normalizeIndentation(lineLeadingWhitespace + lines[0]);\r\n                    }\r\n                }\r\n                for (let i = 1; i < lines.length; i++) {\r\n                    lines[i] = model.normalizeIndentation(lineLeadingWhitespace + lines[i]);\r\n                }\r\n            }\r\n            const newValue = lines.join(model.getEOL());\r\n            if (newValue !== marker.value) {\r\n                marker.parent.replace(marker, [new Text(newValue)]);\r\n                snippetTextString = undefined;\r\n            }\r\n            return true;\r\n        });\r\n        return lineLeadingWhitespace;\r\n    }\r\n    static adjustSelection(model, selection, overwriteBefore, overwriteAfter) {\r\n        if (overwriteBefore !== 0 || overwriteAfter !== 0) {\r\n            // overwrite[Before|After] is compute using the position, not the whole\r\n            // selection. therefore we adjust the selection around that position\r\n            const { positionLineNumber, positionColumn } = selection;\r\n            const positionColumnBefore = positionColumn - overwriteBefore;\r\n            const positionColumnAfter = positionColumn + overwriteAfter;\r\n            const range = model.validateRange({\r\n                startLineNumber: positionLineNumber,\r\n                startColumn: positionColumnBefore,\r\n                endLineNumber: positionLineNumber,\r\n                endColumn: positionColumnAfter\r\n            });\r\n            selection = Selection.createWithDirection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn, selection.getDirection());\r\n        }\r\n        return selection;\r\n    }\r\n    static createEditsAndSnippets(editor, template, overwriteBefore, overwriteAfter, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer) {\r\n        const edits = [];\r\n        const snippets = [];\r\n        if (!editor.hasModel()) {\r\n            return { edits, snippets };\r\n        }\r\n        const model = editor.getModel();\r\n        const workspaceService = editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService, optional));\r\n        const modelBasedVariableResolver = editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService, optional), model));\r\n        const readClipboardText = () => clipboardText;\r\n        let delta = 0;\r\n        // know what text the overwrite[Before|After] extensions\r\n        // of the primary curser have selected because only when\r\n        // secondary selections extend to the same text we can grow them\r\n        let firstBeforeText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), overwriteBefore, 0));\r\n        let firstAfterText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), 0, overwriteAfter));\r\n        // remember the first non-whitespace column to decide if\r\n        // `keepWhitespace` should be overruled for secondary selections\r\n        let firstLineFirstNonWhitespace = model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);\r\n        // sort selections by their start position but remeber\r\n        // the original index. that allows you to create correct\r\n        // offset-based selection logic without changing the\r\n        // primary selection\r\n        const indexedSelections = editor.getSelections()\r\n            .map((selection, idx) => ({ selection, idx }))\r\n            .sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\r\n        for (const { selection, idx } of indexedSelections) {\r\n            // extend selection with the `overwriteBefore` and `overwriteAfter` and then\r\n            // compare if this matches the extensions of the primary selection\r\n            let extensionBefore = SnippetSession.adjustSelection(model, selection, overwriteBefore, 0);\r\n            let extensionAfter = SnippetSession.adjustSelection(model, selection, 0, overwriteAfter);\r\n            if (firstBeforeText !== model.getValueInRange(extensionBefore)) {\r\n                extensionBefore = selection;\r\n            }\r\n            if (firstAfterText !== model.getValueInRange(extensionAfter)) {\r\n                extensionAfter = selection;\r\n            }\r\n            // merge the before and after selection into one\r\n            const snippetSelection = selection\r\n                .setStartPosition(extensionBefore.startLineNumber, extensionBefore.startColumn)\r\n                .setEndPosition(extensionAfter.endLineNumber, extensionAfter.endColumn);\r\n            const snippet = new SnippetParser().parse(template, true, enforceFinalTabstop);\r\n            // adjust the template string to match the indentation and\r\n            // whitespace rules of this insert location (can be different for each cursor)\r\n            // happens when being asked for (default) or when this is a secondary\r\n            // cursor and the leading whitespace is different\r\n            const start = snippetSelection.getStartPosition();\r\n            const snippetLineLeadingWhitespace = SnippetSession.adjustWhitespace(model, start, snippet, adjustWhitespace || (idx > 0 && firstLineFirstNonWhitespace !== model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber)), true);\r\n            snippet.resolveVariables(new CompositeSnippetVariableResolver([\r\n                modelBasedVariableResolver,\r\n                new ClipboardBasedVariableResolver(readClipboardText, idx, indexedSelections.length, editor.getOption(69 /* multiCursorPaste */) === 'spread'),\r\n                new SelectionBasedVariableResolver(model, selection, idx, overtypingCapturer),\r\n                new CommentBasedVariableResolver(model, selection),\r\n                new TimeBasedVariableResolver,\r\n                new WorkspaceBasedVariableResolver(workspaceService),\r\n                new RandomBasedVariableResolver,\r\n            ]));\r\n            const offset = model.getOffsetAt(start) + delta;\r\n            delta += snippet.toString().length - model.getValueLengthInRange(snippetSelection);\r\n            // store snippets with the index of their originating selection.\r\n            // that ensures the primiary cursor stays primary despite not being\r\n            // the one with lowest start position\r\n            edits[idx] = EditOperation.replace(snippetSelection, snippet.toString());\r\n            edits[idx].identifier = { major: idx, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\r\n            snippets[idx] = new OneSnippet(editor, snippet, offset, snippetLineLeadingWhitespace);\r\n        }\r\n        return { edits, snippets };\r\n    }\r\n    dispose() {\r\n        dispose(this._snippets);\r\n    }\r\n    _logInfo() {\r\n        return `template=\"${this._template}\", merged_templates=\"${this._templateMerges.join(' -> ')}\"`;\r\n    }\r\n    insert() {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        // make insert edit and start with first selections\r\n        const { edits, snippets } = SnippetSession.createEditsAndSnippets(this._editor, this._template, this._options.overwriteBefore, this._options.overwriteAfter, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer);\r\n        this._snippets = snippets;\r\n        this._editor.executeEdits('snippet', edits, undoEdits => {\r\n            if (this._snippets[0].hasPlaceholder) {\r\n                return this._move(true);\r\n            }\r\n            else {\r\n                return undoEdits\r\n                    .filter(edit => !!edit.identifier) // only use our undo edits\r\n                    .map(edit => Selection.fromPositions(edit.range.getEndPosition()));\r\n            }\r\n        });\r\n        this._editor.revealRange(this._editor.getSelections()[0]);\r\n    }\r\n    merge(template, options = _defaultOptions) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        this._templateMerges.push([this._snippets[0]._nestingLevel, this._snippets[0]._placeholderGroupsIdx, template]);\r\n        const { edits, snippets } = SnippetSession.createEditsAndSnippets(this._editor, template, options.overwriteBefore, options.overwriteAfter, true, options.adjustWhitespace, options.clipboardText, options.overtypingCapturer);\r\n        this._editor.executeEdits('snippet', edits, undoEdits => {\r\n            for (const snippet of this._snippets) {\r\n                snippet.merge(snippets);\r\n            }\r\n            console.assert(snippets.length === 0);\r\n            if (this._snippets[0].hasPlaceholder) {\r\n                return this._move(undefined);\r\n            }\r\n            else {\r\n                return (undoEdits\r\n                    .filter(edit => !!edit.identifier) // only use our undo edits\r\n                    .map(edit => Selection.fromPositions(edit.range.getEndPosition())));\r\n            }\r\n        });\r\n    }\r\n    next() {\r\n        const newSelections = this._move(true);\r\n        this._editor.setSelections(newSelections);\r\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\r\n    }\r\n    prev() {\r\n        const newSelections = this._move(false);\r\n        this._editor.setSelections(newSelections);\r\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\r\n    }\r\n    _move(fwd) {\r\n        const selections = [];\r\n        for (const snippet of this._snippets) {\r\n            const oneSelection = snippet.move(fwd);\r\n            selections.push(...oneSelection);\r\n        }\r\n        return selections;\r\n    }\r\n    get isAtFirstPlaceholder() {\r\n        return this._snippets[0].isAtFirstPlaceholder;\r\n    }\r\n    get isAtLastPlaceholder() {\r\n        return this._snippets[0].isAtLastPlaceholder;\r\n    }\r\n    get hasPlaceholder() {\r\n        return this._snippets[0].hasPlaceholder;\r\n    }\r\n    get choice() {\r\n        return this._snippets[0].choice;\r\n    }\r\n    isSelectionWithinPlaceholders() {\r\n        if (!this.hasPlaceholder) {\r\n            return false;\r\n        }\r\n        const selections = this._editor.getSelections();\r\n        if (selections.length < this._snippets.length) {\r\n            // this means we started snippet mode with N\r\n            // selections and have M (N > M) selections.\r\n            // So one snippet is without selection -> cancel\r\n            return false;\r\n        }\r\n        let allPossibleSelections = new Map();\r\n        for (const snippet of this._snippets) {\r\n            const possibleSelections = snippet.computePossibleSelections();\r\n            // for the first snippet find the placeholder (and its ranges)\r\n            // that contain at least one selection. for all remaining snippets\r\n            // the same placeholder (and their ranges) must be used.\r\n            if (allPossibleSelections.size === 0) {\r\n                for (const [index, ranges] of possibleSelections) {\r\n                    ranges.sort(Range.compareRangesUsingStarts);\r\n                    for (const selection of selections) {\r\n                        if (ranges[0].containsRange(selection)) {\r\n                            allPossibleSelections.set(index, []);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (allPossibleSelections.size === 0) {\r\n                // return false if we couldn't associate a selection to\r\n                // this (the first) snippet\r\n                return false;\r\n            }\r\n            // add selections from 'this' snippet so that we know all\r\n            // selections for this placeholder\r\n            allPossibleSelections.forEach((array, index) => {\r\n                array.push(...possibleSelections.get(index));\r\n            });\r\n        }\r\n        // sort selections (and later placeholder-ranges). then walk both\r\n        // arrays and make sure the placeholder-ranges contain the corresponding\r\n        // selection\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        for (let [index, ranges] of allPossibleSelections) {\r\n            if (ranges.length !== selections.length) {\r\n                allPossibleSelections.delete(index);\r\n                continue;\r\n            }\r\n            ranges.sort(Range.compareRangesUsingStarts);\r\n            for (let i = 0; i < ranges.length; i++) {\r\n                if (!ranges[i].containsRange(selections[i])) {\r\n                    allPossibleSelections.delete(index);\r\n                    continue;\r\n                }\r\n            }\r\n        }\r\n        // from all possible selections we have deleted those\r\n        // that don't match with the current selection. if we don't\r\n        // have any left, we don't have a selection anymore\r\n        return allPossibleSelections.size > 0;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { onUnexpectedExternalError, canceled, isPromiseCanceledError } from '../../../base/common/errors.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { FuzzyScore } from '../../../base/common/filters.js';\r\nimport { isDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { MenuId } from '../../../platform/actions/common/actions.js';\r\nimport { SnippetParser } from '../snippet/snippetParser.js';\r\nimport { StopWatch } from '../../../base/common/stopwatch.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { ITextModelService } from '../../common/services/resolverService.js';\r\nimport { localize } from '../../../nls.js';\r\nexport const Context = {\r\n    Visible: new RawContextKey('suggestWidgetVisible', false, localize('suggestWidgetVisible', \"Whether suggestion are visible\")),\r\n    DetailsVisible: new RawContextKey('suggestWidgetDetailsVisible', false, localize('suggestWidgetDetailsVisible', \"Whether suggestion details are visible\")),\r\n    MultipleSuggestions: new RawContextKey('suggestWidgetMultipleSuggestions', false, localize('suggestWidgetMultipleSuggestions', \"Whether there are multiple suggestions to pick from\")),\r\n    MakesTextEdit: new RawContextKey('suggestionMakesTextEdit', true, localize('suggestionMakesTextEdit', \"Whether inserting the current suggestion yields in a change or has everything already been typed\")),\r\n    AcceptSuggestionsOnEnter: new RawContextKey('acceptSuggestionOnEnter', true, localize('acceptSuggestionOnEnter', \"Whether suggestions are inserted when pressing Enter\")),\r\n    HasInsertAndReplaceRange: new RawContextKey('suggestionHasInsertAndReplaceRange', false, localize('suggestionHasInsertAndReplaceRange', \"Whether the current suggestion has insert and replace behaviour\")),\r\n    InsertMode: new RawContextKey('suggestionInsertMode', undefined, { type: 'string', description: localize('suggestionInsertMode', \"Whether the default behaviour is to insert or replace\") }),\r\n    CanResolve: new RawContextKey('suggestionCanResolve', false, localize('suggestionCanResolve', \"Whether the current suggestion supports to resolve further details\")),\r\n};\r\nexport const suggestWidgetStatusbarMenu = new MenuId('suggestWidgetStatusBar');\r\nexport class CompletionItem {\r\n    constructor(position, completion, container, provider) {\r\n        this.position = position;\r\n        this.completion = completion;\r\n        this.container = container;\r\n        this.provider = provider;\r\n        // validation\r\n        this.isInvalid = false;\r\n        // sorting, filtering\r\n        this.score = FuzzyScore.Default;\r\n        this.distance = 0;\r\n        this.textLabel = typeof completion.label === 'string'\r\n            ? completion.label\r\n            : completion.label.label;\r\n        // ensure lower-variants (perf)\r\n        this.labelLow = this.textLabel.toLowerCase();\r\n        // validate label\r\n        this.isInvalid = !this.textLabel;\r\n        this.sortTextLow = completion.sortText && completion.sortText.toLowerCase();\r\n        this.filterTextLow = completion.filterText && completion.filterText.toLowerCase();\r\n        // normalize ranges\r\n        if (Range.isIRange(completion.range)) {\r\n            this.editStart = new Position(completion.range.startLineNumber, completion.range.startColumn);\r\n            this.editInsertEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\r\n            this.editReplaceEnd = new Position(completion.range.endLineNumber, completion.range.endColumn);\r\n            // validate range\r\n            this.isInvalid = this.isInvalid\r\n                || Range.spansMultipleLines(completion.range) || completion.range.startLineNumber !== position.lineNumber;\r\n        }\r\n        else {\r\n            this.editStart = new Position(completion.range.insert.startLineNumber, completion.range.insert.startColumn);\r\n            this.editInsertEnd = new Position(completion.range.insert.endLineNumber, completion.range.insert.endColumn);\r\n            this.editReplaceEnd = new Position(completion.range.replace.endLineNumber, completion.range.replace.endColumn);\r\n            // validate ranges\r\n            this.isInvalid = this.isInvalid\r\n                || Range.spansMultipleLines(completion.range.insert) || Range.spansMultipleLines(completion.range.replace)\r\n                || completion.range.insert.startLineNumber !== position.lineNumber || completion.range.replace.startLineNumber !== position.lineNumber\r\n                || completion.range.insert.startColumn !== completion.range.replace.startColumn;\r\n        }\r\n        // create the suggestion resolver\r\n        if (typeof provider.resolveCompletionItem !== 'function') {\r\n            this._resolveCache = Promise.resolve();\r\n            this._isResolved = true;\r\n        }\r\n    }\r\n    // ---- resolving\r\n    get isResolved() {\r\n        return !!this._isResolved;\r\n    }\r\n    resolve(token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this._resolveCache) {\r\n                const sub = token.onCancellationRequested(() => {\r\n                    this._resolveCache = undefined;\r\n                    this._isResolved = false;\r\n                });\r\n                this._resolveCache = Promise.resolve(this.provider.resolveCompletionItem(this.completion, token)).then(value => {\r\n                    Object.assign(this.completion, value);\r\n                    this._isResolved = true;\r\n                    sub.dispose();\r\n                }, err => {\r\n                    if (isPromiseCanceledError(err)) {\r\n                        // the IPC queue will reject the request with the\r\n                        // cancellation error -> reset cached\r\n                        this._resolveCache = undefined;\r\n                        this._isResolved = false;\r\n                    }\r\n                });\r\n            }\r\n            return this._resolveCache;\r\n        });\r\n    }\r\n}\r\nexport class CompletionOptions {\r\n    constructor(snippetSortOrder = 2 /* Bottom */, kindFilter = new Set(), providerFilter = new Set(), showDeprecated = true) {\r\n        this.snippetSortOrder = snippetSortOrder;\r\n        this.kindFilter = kindFilter;\r\n        this.providerFilter = providerFilter;\r\n        this.showDeprecated = showDeprecated;\r\n    }\r\n}\r\nCompletionOptions.default = new CompletionOptions();\r\nlet _snippetSuggestSupport;\r\nexport function getSnippetSuggestSupport() {\r\n    return _snippetSuggestSupport;\r\n}\r\nexport class CompletionItemModel {\r\n    constructor(items, needsClipboard, durations, disposable) {\r\n        this.items = items;\r\n        this.needsClipboard = needsClipboard;\r\n        this.durations = durations;\r\n        this.disposable = disposable;\r\n    }\r\n}\r\nexport function provideSuggestionItems(model, position, options = CompletionOptions.default, context = { triggerKind: 0 /* Invoke */ }, token = CancellationToken.None) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const sw = new StopWatch(true);\r\n        position = position.clone();\r\n        const word = model.getWordAtPosition(position);\r\n        const defaultReplaceRange = word ? new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn) : Range.fromPositions(position);\r\n        const defaultRange = { replace: defaultReplaceRange, insert: defaultReplaceRange.setEndPosition(position.lineNumber, position.column) };\r\n        const result = [];\r\n        const disposables = new DisposableStore();\r\n        const durations = [];\r\n        let needsClipboard = false;\r\n        const onCompletionList = (provider, container, sw) => {\r\n            var _a, _b, _c;\r\n            if (!container) {\r\n                return;\r\n            }\r\n            for (let suggestion of container.suggestions) {\r\n                if (!options.kindFilter.has(suggestion.kind)) {\r\n                    // skip if not showing deprecated suggestions\r\n                    if (!options.showDeprecated && ((_a = suggestion === null || suggestion === void 0 ? void 0 : suggestion.tags) === null || _a === void 0 ? void 0 : _a.includes(1 /* Deprecated */))) {\r\n                        continue;\r\n                    }\r\n                    // fill in default range when missing\r\n                    if (!suggestion.range) {\r\n                        suggestion.range = defaultRange;\r\n                    }\r\n                    // fill in default sortText when missing\r\n                    if (!suggestion.sortText) {\r\n                        suggestion.sortText = typeof suggestion.label === 'string' ? suggestion.label : suggestion.label.label;\r\n                    }\r\n                    if (!needsClipboard && suggestion.insertTextRules && suggestion.insertTextRules & 4 /* InsertAsSnippet */) {\r\n                        needsClipboard = SnippetParser.guessNeedsClipboard(suggestion.insertText);\r\n                    }\r\n                    result.push(new CompletionItem(position, suggestion, container, provider));\r\n                }\r\n            }\r\n            if (isDisposable(container)) {\r\n                disposables.add(container);\r\n            }\r\n            durations.push({\r\n                providerName: (_b = provider._debugDisplayName) !== null && _b !== void 0 ? _b : 'unkown_provider', elapsedProvider: (_c = container.duration) !== null && _c !== void 0 ? _c : -1, elapsedOverall: sw.elapsed()\r\n            });\r\n        };\r\n        // ask for snippets in parallel to asking \"real\" providers. Only do something if configured to\r\n        // do so - no snippet filter, no special-providers-only request\r\n        const snippetCompletions = (() => __awaiter(this, void 0, void 0, function* () {\r\n            if (!_snippetSuggestSupport || options.kindFilter.has(27 /* Snippet */)) {\r\n                return;\r\n            }\r\n            if (options.providerFilter.size > 0 && !options.providerFilter.has(_snippetSuggestSupport)) {\r\n                return;\r\n            }\r\n            const sw = new StopWatch(true);\r\n            const list = yield _snippetSuggestSupport.provideCompletionItems(model, position, context, token);\r\n            onCompletionList(_snippetSuggestSupport, list, sw);\r\n        }))();\r\n        // add suggestions from contributed providers - providers are ordered in groups of\r\n        // equal score and once a group produces a result the process stops\r\n        // get provider groups, always add snippet suggestion provider\r\n        for (let providerGroup of modes.CompletionProviderRegistry.orderedGroups(model)) {\r\n            // for each support in the group ask for suggestions\r\n            let lenBefore = result.length;\r\n            yield Promise.all(providerGroup.map((provider) => __awaiter(this, void 0, void 0, function* () {\r\n                if (options.providerFilter.size > 0 && !options.providerFilter.has(provider)) {\r\n                    return;\r\n                }\r\n                try {\r\n                    const sw = new StopWatch(true);\r\n                    const list = yield provider.provideCompletionItems(model, position, context, token);\r\n                    onCompletionList(provider, list, sw);\r\n                }\r\n                catch (err) {\r\n                    onUnexpectedExternalError(err);\r\n                }\r\n            })));\r\n            if (lenBefore !== result.length || token.isCancellationRequested) {\r\n                break;\r\n            }\r\n        }\r\n        yield snippetCompletions;\r\n        if (token.isCancellationRequested) {\r\n            disposables.dispose();\r\n            return Promise.reject(canceled());\r\n        }\r\n        return new CompletionItemModel(result.sort(getSuggestionComparator(options.snippetSortOrder)), needsClipboard, { entries: durations, elapsed: sw.elapsed() }, disposables);\r\n    });\r\n}\r\nfunction defaultComparator(a, b) {\r\n    // check with 'sortText'\r\n    if (a.sortTextLow && b.sortTextLow) {\r\n        if (a.sortTextLow < b.sortTextLow) {\r\n            return -1;\r\n        }\r\n        else if (a.sortTextLow > b.sortTextLow) {\r\n            return 1;\r\n        }\r\n    }\r\n    // check with 'label'\r\n    if (a.completion.label < b.completion.label) {\r\n        return -1;\r\n    }\r\n    else if (a.completion.label > b.completion.label) {\r\n        return 1;\r\n    }\r\n    // check with 'type'\r\n    return a.completion.kind - b.completion.kind;\r\n}\r\nfunction snippetUpComparator(a, b) {\r\n    if (a.completion.kind !== b.completion.kind) {\r\n        if (a.completion.kind === 27 /* Snippet */) {\r\n            return -1;\r\n        }\r\n        else if (b.completion.kind === 27 /* Snippet */) {\r\n            return 1;\r\n        }\r\n    }\r\n    return defaultComparator(a, b);\r\n}\r\nfunction snippetDownComparator(a, b) {\r\n    if (a.completion.kind !== b.completion.kind) {\r\n        if (a.completion.kind === 27 /* Snippet */) {\r\n            return 1;\r\n        }\r\n        else if (b.completion.kind === 27 /* Snippet */) {\r\n            return -1;\r\n        }\r\n    }\r\n    return defaultComparator(a, b);\r\n}\r\nconst _snippetComparators = new Map();\r\n_snippetComparators.set(0 /* Top */, snippetUpComparator);\r\n_snippetComparators.set(2 /* Bottom */, snippetDownComparator);\r\n_snippetComparators.set(1 /* Inline */, defaultComparator);\r\nexport function getSuggestionComparator(snippetConfig) {\r\n    return _snippetComparators.get(snippetConfig);\r\n}\r\nCommandsRegistry.registerCommand('_executeCompletionItemProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const [uri, position, triggerCharacter, maxItemsToResolve] = args;\r\n    assertType(URI.isUri(uri));\r\n    assertType(Position.isIPosition(position));\r\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\r\n    assertType(typeof maxItemsToResolve === 'number' || !maxItemsToResolve);\r\n    const ref = yield accessor.get(ITextModelService).createModelReference(uri);\r\n    try {\r\n        const result = {\r\n            incomplete: false,\r\n            suggestions: []\r\n        };\r\n        const resolving = [];\r\n        const completions = yield provideSuggestionItems(ref.object.textEditorModel, Position.lift(position), undefined, { triggerCharacter, triggerKind: triggerCharacter ? 1 /* TriggerCharacter */ : 0 /* Invoke */ });\r\n        for (const item of completions.items) {\r\n            if (resolving.length < (maxItemsToResolve !== null && maxItemsToResolve !== void 0 ? maxItemsToResolve : 0)) {\r\n                resolving.push(item.resolve(CancellationToken.None));\r\n            }\r\n            result.incomplete = result.incomplete || item.container.incomplete;\r\n            result.suggestions.push(item.completion);\r\n        }\r\n        try {\r\n            yield Promise.all(resolving);\r\n            return result;\r\n        }\r\n        finally {\r\n            setTimeout(() => completions.disposable.dispose(), 100);\r\n        }\r\n    }\r\n    finally {\r\n        ref.dispose();\r\n    }\r\n}));\r\nconst _provider = new class {\r\n    constructor() {\r\n        this.onlyOnceSuggestions = [];\r\n    }\r\n    provideCompletionItems() {\r\n        let suggestions = this.onlyOnceSuggestions.slice(0);\r\n        let result = { suggestions };\r\n        this.onlyOnceSuggestions.length = 0;\r\n        return result;\r\n    }\r\n};\r\nmodes.CompletionProviderRegistry.register('*', _provider);\r\nexport function showSimpleSuggestions(editor, suggestions) {\r\n    setTimeout(() => {\r\n        _provider.onlyOnceSuggestions.push(...suggestions);\r\n        editor.getContribution('editor.contrib.suggestController').triggerSuggest(new Set().add(_provider));\r\n    }, 0);\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { showSimpleSuggestions } from '../suggest/suggest.js';\r\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { ILogService } from '../../../platform/log/common/log.js';\r\nimport { SnippetSession } from './snippetSession.js';\r\nimport { localize } from '../../../nls.js';\r\nconst _defaultOptions = {\r\n    overwriteBefore: 0,\r\n    overwriteAfter: 0,\r\n    undoStopBefore: true,\r\n    undoStopAfter: true,\r\n    adjustWhitespace: true,\r\n    clipboardText: undefined,\r\n    overtypingCapturer: undefined\r\n};\r\nlet SnippetController2 = class SnippetController2 {\r\n    constructor(_editor, _logService, contextKeyService) {\r\n        this._editor = _editor;\r\n        this._logService = _logService;\r\n        this._snippetListener = new DisposableStore();\r\n        this._modelVersionId = -1;\r\n        this._inSnippet = SnippetController2.InSnippetMode.bindTo(contextKeyService);\r\n        this._hasNextTabstop = SnippetController2.HasNextTabstop.bindTo(contextKeyService);\r\n        this._hasPrevTabstop = SnippetController2.HasPrevTabstop.bindTo(contextKeyService);\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(SnippetController2.ID);\r\n    }\r\n    dispose() {\r\n        var _a;\r\n        this._inSnippet.reset();\r\n        this._hasPrevTabstop.reset();\r\n        this._hasNextTabstop.reset();\r\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        this._snippetListener.dispose();\r\n    }\r\n    insert(template, opts) {\r\n        // this is here to find out more about the yet-not-understood\r\n        // error that sometimes happens when we fail to inserted a nested\r\n        // snippet\r\n        try {\r\n            this._doInsert(template, typeof opts === 'undefined' ? _defaultOptions : Object.assign(Object.assign({}, _defaultOptions), opts));\r\n        }\r\n        catch (e) {\r\n            this.cancel();\r\n            this._logService.error(e);\r\n            this._logService.error('snippet_error');\r\n            this._logService.error('insert_template=', template);\r\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\r\n        }\r\n    }\r\n    _doInsert(template, opts) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        // don't listen while inserting the snippet\r\n        // as that is the inflight state causing cancelation\r\n        this._snippetListener.clear();\r\n        if (opts.undoStopBefore) {\r\n            this._editor.getModel().pushStackElement();\r\n        }\r\n        if (!this._session) {\r\n            this._modelVersionId = this._editor.getModel().getAlternativeVersionId();\r\n            this._session = new SnippetSession(this._editor, template, opts);\r\n            this._session.insert();\r\n        }\r\n        else {\r\n            this._session.merge(template, opts);\r\n        }\r\n        if (opts.undoStopAfter) {\r\n            this._editor.getModel().pushStackElement();\r\n        }\r\n        this._updateState();\r\n        this._snippetListener.add(this._editor.onDidChangeModelContent(e => e.isFlush && this.cancel()));\r\n        this._snippetListener.add(this._editor.onDidChangeModel(() => this.cancel()));\r\n        this._snippetListener.add(this._editor.onDidChangeCursorSelection(() => this._updateState()));\r\n    }\r\n    _updateState() {\r\n        if (!this._session || !this._editor.hasModel()) {\r\n            // canceled in the meanwhile\r\n            return;\r\n        }\r\n        if (this._modelVersionId === this._editor.getModel().getAlternativeVersionId()) {\r\n            // undo until the 'before' state happened\r\n            // and makes use cancel snippet mode\r\n            return this.cancel();\r\n        }\r\n        if (!this._session.hasPlaceholder) {\r\n            // don't listen for selection changes and don't\r\n            // update context keys when the snippet is plain text\r\n            return this.cancel();\r\n        }\r\n        if (this._session.isAtLastPlaceholder || !this._session.isSelectionWithinPlaceholders()) {\r\n            return this.cancel();\r\n        }\r\n        this._inSnippet.set(true);\r\n        this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder);\r\n        this._hasNextTabstop.set(!this._session.isAtLastPlaceholder);\r\n        this._handleChoice();\r\n    }\r\n    _handleChoice() {\r\n        if (!this._session || !this._editor.hasModel()) {\r\n            this._currentChoice = undefined;\r\n            return;\r\n        }\r\n        const { choice } = this._session;\r\n        if (!choice) {\r\n            this._currentChoice = undefined;\r\n            return;\r\n        }\r\n        if (this._currentChoice !== choice) {\r\n            this._currentChoice = choice;\r\n            this._editor.setSelections(this._editor.getSelections()\r\n                .map(s => Selection.fromPositions(s.getStartPosition())));\r\n            const [first] = choice.options;\r\n            showSimpleSuggestions(this._editor, choice.options.map((option, i) => {\r\n                // let before = choice.options.slice(0, i);\r\n                // let after = choice.options.slice(i);\r\n                return {\r\n                    kind: 13 /* Value */,\r\n                    label: option.value,\r\n                    insertText: option.value,\r\n                    // insertText: `\\${1|${after.concat(before).join(',')}|}$0`,\r\n                    // snippetType: 'textmate',\r\n                    sortText: 'a'.repeat(i + 1),\r\n                    range: Range.fromPositions(this._editor.getPosition(), this._editor.getPosition().delta(0, first.value.length))\r\n                };\r\n            }));\r\n        }\r\n    }\r\n    finish() {\r\n        while (this._inSnippet.get()) {\r\n            this.next();\r\n        }\r\n    }\r\n    cancel(resetSelection = false) {\r\n        var _a;\r\n        this._inSnippet.reset();\r\n        this._hasPrevTabstop.reset();\r\n        this._hasNextTabstop.reset();\r\n        this._snippetListener.clear();\r\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        this._session = undefined;\r\n        this._modelVersionId = -1;\r\n        if (resetSelection) {\r\n            // reset selection to the primary cursor when being asked\r\n            // for. this happens when explicitly cancelling snippet mode,\r\n            // e.g. when pressing ESC\r\n            this._editor.setSelections([this._editor.getSelection()]);\r\n        }\r\n    }\r\n    prev() {\r\n        if (this._session) {\r\n            this._session.prev();\r\n        }\r\n        this._updateState();\r\n    }\r\n    next() {\r\n        if (this._session) {\r\n            this._session.next();\r\n        }\r\n        this._updateState();\r\n    }\r\n    isInSnippet() {\r\n        return Boolean(this._inSnippet.get());\r\n    }\r\n};\r\nSnippetController2.ID = 'snippetController2';\r\nSnippetController2.InSnippetMode = new RawContextKey('inSnippetMode', false, localize('inSnippetMode', \"Whether the editor in current in snippet mode\"));\r\nSnippetController2.HasNextTabstop = new RawContextKey('hasNextTabstop', false, localize('hasNextTabstop', \"Whether there is a next tab stop when in snippet mode\"));\r\nSnippetController2.HasPrevTabstop = new RawContextKey('hasPrevTabstop', false, localize('hasPrevTabstop', \"Whether there is a previous tab stop when in snippet mode\"));\r\nSnippetController2 = __decorate([\r\n    __param(1, ILogService),\r\n    __param(2, IContextKeyService)\r\n], SnippetController2);\r\nexport { SnippetController2 };\r\nregisterEditorContribution(SnippetController2.ID, SnippetController2);\r\nconst CommandCtor = EditorCommand.bindToContribution(SnippetController2.get);\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'jumpToNextSnippetPlaceholder',\r\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasNextTabstop),\r\n    handler: ctrl => ctrl.next(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        kbExpr: EditorContextKeys.editorTextFocus,\r\n        primary: 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'jumpToPrevSnippetPlaceholder',\r\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasPrevTabstop),\r\n    handler: ctrl => ctrl.prev(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        kbExpr: EditorContextKeys.editorTextFocus,\r\n        primary: 1024 /* Shift */ | 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'leaveSnippet',\r\n    precondition: SnippetController2.InSnippetMode,\r\n    handler: ctrl => ctrl.cancel(true),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 30,\r\n        kbExpr: EditorContextKeys.editorTextFocus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new CommandCtor({\r\n    id: 'acceptSnippet',\r\n    precondition: SnippetController2.InSnippetMode,\r\n    handler: ctrl => ctrl.finish(),\r\n    // kbOpts: {\r\n    // \tweight: KeybindingWeight.EditorContrib + 30,\r\n    // \tkbExpr: EditorContextKeys.textFocus,\r\n    // \tprimary: KeyCode.Enter,\r\n    // }\r\n}));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { LRUCache, TernarySearchTree } from '../../../base/common/map.js';\r\nimport { IStorageService, WillSaveStateReason } from '../../../platform/storage/common/storage.js';\r\nimport { completionKindFromString } from '../../common/modes.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { registerSingleton } from '../../../platform/instantiation/common/extensions.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nexport class Memory {\r\n    constructor(name) {\r\n        this.name = name;\r\n    }\r\n    select(model, pos, items) {\r\n        if (items.length === 0) {\r\n            return 0;\r\n        }\r\n        let topScore = items[0].score[0];\r\n        for (let i = 0; i < items.length; i++) {\r\n            const { score, completion: suggestion } = items[i];\r\n            if (score[0] !== topScore) {\r\n                // stop when leaving the group of top matches\r\n                break;\r\n            }\r\n            if (suggestion.preselect) {\r\n                // stop when seeing an auto-select-item\r\n                return i;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n}\r\nexport class NoMemory extends Memory {\r\n    constructor() {\r\n        super('first');\r\n    }\r\n    memorize(model, pos, item) {\r\n        // no-op\r\n    }\r\n    toJSON() {\r\n        return undefined;\r\n    }\r\n    fromJSON() {\r\n        //\r\n    }\r\n}\r\nexport class LRUMemory extends Memory {\r\n    constructor() {\r\n        super('recentlyUsed');\r\n        this._cache = new LRUCache(300, 0.66);\r\n        this._seq = 0;\r\n    }\r\n    memorize(model, pos, item) {\r\n        const key = `${model.getLanguageIdentifier().language}/${item.textLabel}`;\r\n        this._cache.set(key, {\r\n            touch: this._seq++,\r\n            type: item.completion.kind,\r\n            insertText: item.completion.insertText\r\n        });\r\n    }\r\n    select(model, pos, items) {\r\n        if (items.length === 0) {\r\n            return 0;\r\n        }\r\n        const lineSuffix = model.getLineContent(pos.lineNumber).substr(pos.column - 10, pos.column - 1);\r\n        if (/\\s$/.test(lineSuffix)) {\r\n            return super.select(model, pos, items);\r\n        }\r\n        let topScore = items[0].score[0];\r\n        let indexPreselect = -1;\r\n        let indexRecency = -1;\r\n        let seq = -1;\r\n        for (let i = 0; i < items.length; i++) {\r\n            if (items[i].score[0] !== topScore) {\r\n                // consider only top items\r\n                break;\r\n            }\r\n            const key = `${model.getLanguageIdentifier().language}/${items[i].textLabel}`;\r\n            const item = this._cache.peek(key);\r\n            if (item && item.touch > seq && item.type === items[i].completion.kind && item.insertText === items[i].completion.insertText) {\r\n                seq = item.touch;\r\n                indexRecency = i;\r\n            }\r\n            if (items[i].completion.preselect && indexPreselect === -1) {\r\n                // stop when seeing an auto-select-item\r\n                return indexPreselect = i;\r\n            }\r\n        }\r\n        if (indexRecency !== -1) {\r\n            return indexRecency;\r\n        }\r\n        else if (indexPreselect !== -1) {\r\n            return indexPreselect;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    }\r\n    toJSON() {\r\n        return this._cache.toJSON();\r\n    }\r\n    fromJSON(data) {\r\n        this._cache.clear();\r\n        let seq = 0;\r\n        for (const [key, value] of data) {\r\n            value.touch = seq;\r\n            value.type = typeof value.type === 'number' ? value.type : completionKindFromString(value.type);\r\n            this._cache.set(key, value);\r\n        }\r\n        this._seq = this._cache.size;\r\n    }\r\n}\r\nexport class PrefixMemory extends Memory {\r\n    constructor() {\r\n        super('recentlyUsedByPrefix');\r\n        this._trie = TernarySearchTree.forStrings();\r\n        this._seq = 0;\r\n    }\r\n    memorize(model, pos, item) {\r\n        const { word } = model.getWordUntilPosition(pos);\r\n        const key = `${model.getLanguageIdentifier().language}/${word}`;\r\n        this._trie.set(key, {\r\n            type: item.completion.kind,\r\n            insertText: item.completion.insertText,\r\n            touch: this._seq++\r\n        });\r\n    }\r\n    select(model, pos, items) {\r\n        let { word } = model.getWordUntilPosition(pos);\r\n        if (!word) {\r\n            return super.select(model, pos, items);\r\n        }\r\n        let key = `${model.getLanguageIdentifier().language}/${word}`;\r\n        let item = this._trie.get(key);\r\n        if (!item) {\r\n            item = this._trie.findSubstr(key);\r\n        }\r\n        if (item) {\r\n            for (let i = 0; i < items.length; i++) {\r\n                let { kind, insertText } = items[i].completion;\r\n                if (kind === item.type && insertText === item.insertText) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n        return super.select(model, pos, items);\r\n    }\r\n    toJSON() {\r\n        let entries = [];\r\n        this._trie.forEach((value, key) => entries.push([key, value]));\r\n        // sort by last recently used (touch), then\r\n        // take the top 200 item and normalize their\r\n        // touch\r\n        entries\r\n            .sort((a, b) => -(a[1].touch - b[1].touch))\r\n            .forEach((value, i) => value[1].touch = i);\r\n        return entries.slice(0, 200);\r\n    }\r\n    fromJSON(data) {\r\n        this._trie.clear();\r\n        if (data.length > 0) {\r\n            this._seq = data[0][1].touch + 1;\r\n            for (const [key, value] of data) {\r\n                value.type = typeof value.type === 'number' ? value.type : completionKindFromString(value.type);\r\n                this._trie.set(key, value);\r\n            }\r\n        }\r\n    }\r\n}\r\nlet SuggestMemoryService = class SuggestMemoryService {\r\n    constructor(_storageService, _modeService, _configService) {\r\n        this._storageService = _storageService;\r\n        this._modeService = _modeService;\r\n        this._configService = _configService;\r\n        this._disposables = new DisposableStore();\r\n        this._persistSoon = new RunOnceScheduler(() => this._saveState(), 500);\r\n        this._disposables.add(_storageService.onWillSaveState(e => {\r\n            if (e.reason === WillSaveStateReason.SHUTDOWN) {\r\n                this._saveState();\r\n            }\r\n        }));\r\n    }\r\n    dispose() {\r\n        this._disposables.dispose();\r\n        this._persistSoon.dispose();\r\n    }\r\n    memorize(model, pos, item) {\r\n        this._withStrategy(model, pos).memorize(model, pos, item);\r\n        this._persistSoon.schedule();\r\n    }\r\n    select(model, pos, items) {\r\n        return this._withStrategy(model, pos).select(model, pos, items);\r\n    }\r\n    _withStrategy(model, pos) {\r\n        var _a, _b;\r\n        const mode = this._configService.getValue('editor.suggestSelection', {\r\n            overrideIdentifier: (_a = this._modeService.getLanguageIdentifier(model.getLanguageIdAtPosition(pos.lineNumber, pos.column))) === null || _a === void 0 ? void 0 : _a.language,\r\n            resource: model.uri\r\n        });\r\n        if (((_b = this._strategy) === null || _b === void 0 ? void 0 : _b.name) !== mode) {\r\n            this._saveState();\r\n            const ctor = SuggestMemoryService._strategyCtors.get(mode) || NoMemory;\r\n            this._strategy = new ctor();\r\n            try {\r\n                const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\r\n                const scope = share ? 0 /* GLOBAL */ : 1 /* WORKSPACE */;\r\n                const raw = this._storageService.get(`${SuggestMemoryService._storagePrefix}/${mode}`, scope);\r\n                if (raw) {\r\n                    this._strategy.fromJSON(JSON.parse(raw));\r\n                }\r\n            }\r\n            catch (e) {\r\n                // things can go wrong with JSON...\r\n            }\r\n        }\r\n        return this._strategy;\r\n    }\r\n    _saveState() {\r\n        if (this._strategy) {\r\n            const share = this._configService.getValue('editor.suggest.shareSuggestSelections');\r\n            const scope = share ? 0 /* GLOBAL */ : 1 /* WORKSPACE */;\r\n            const raw = JSON.stringify(this._strategy);\r\n            this._storageService.store(`${SuggestMemoryService._storagePrefix}/${this._strategy.name}`, raw, scope, 1 /* MACHINE */);\r\n        }\r\n    }\r\n};\r\nSuggestMemoryService._strategyCtors = new Map([\r\n    ['recentlyUsedByPrefix', PrefixMemory],\r\n    ['recentlyUsed', LRUMemory],\r\n    ['first', NoMemory]\r\n]);\r\nSuggestMemoryService._storagePrefix = 'suggest/memories';\r\nSuggestMemoryService = __decorate([\r\n    __param(0, IStorageService),\r\n    __param(1, IModeService),\r\n    __param(2, IConfigurationService)\r\n], SuggestMemoryService);\r\nexport { SuggestMemoryService };\r\nexport const ISuggestMemoryService = createDecorator('ISuggestMemories');\r\nregisterSingleton(ISuggestMemoryService, SuggestMemoryService, true);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nlet SuggestAlternatives = class SuggestAlternatives {\r\n    constructor(_editor, contextKeyService) {\r\n        this._editor = _editor;\r\n        this._index = 0;\r\n        this._ckOtherSuggestions = SuggestAlternatives.OtherSuggestions.bindTo(contextKeyService);\r\n    }\r\n    dispose() {\r\n        this.reset();\r\n    }\r\n    reset() {\r\n        var _a;\r\n        this._ckOtherSuggestions.reset();\r\n        (_a = this._listener) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        this._model = undefined;\r\n        this._acceptNext = undefined;\r\n        this._ignore = false;\r\n    }\r\n    set({ model, index }, acceptNext) {\r\n        // no suggestions -> nothing to do\r\n        if (model.items.length === 0) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        // no alternative suggestions -> nothing to do\r\n        let nextIndex = SuggestAlternatives._moveIndex(true, model, index);\r\n        if (nextIndex === index) {\r\n            this.reset();\r\n            return;\r\n        }\r\n        this._acceptNext = acceptNext;\r\n        this._model = model;\r\n        this._index = index;\r\n        this._listener = this._editor.onDidChangeCursorPosition(() => {\r\n            if (!this._ignore) {\r\n                this.reset();\r\n            }\r\n        });\r\n        this._ckOtherSuggestions.set(true);\r\n    }\r\n    static _moveIndex(fwd, model, index) {\r\n        let newIndex = index;\r\n        while (true) {\r\n            newIndex = (newIndex + model.items.length + (fwd ? +1 : -1)) % model.items.length;\r\n            if (newIndex === index) {\r\n                break;\r\n            }\r\n            if (!model.items[newIndex].completion.additionalTextEdits) {\r\n                break;\r\n            }\r\n        }\r\n        return newIndex;\r\n    }\r\n    next() {\r\n        this._move(true);\r\n    }\r\n    prev() {\r\n        this._move(false);\r\n    }\r\n    _move(fwd) {\r\n        if (!this._model) {\r\n            // nothing to reason about\r\n            return;\r\n        }\r\n        try {\r\n            this._ignore = true;\r\n            this._index = SuggestAlternatives._moveIndex(fwd, this._model, this._index);\r\n            this._acceptNext({ index: this._index, item: this._model.items[this._index], model: this._model });\r\n        }\r\n        finally {\r\n            this._ignore = false;\r\n        }\r\n    }\r\n};\r\nSuggestAlternatives.OtherSuggestions = new RawContextKey('hasOtherSuggestions', false);\r\nSuggestAlternatives = __decorate([\r\n    __param(1, IContextKeyService)\r\n], SuggestAlternatives);\r\nexport { SuggestAlternatives };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { fuzzyScore, fuzzyScoreGracefulAggressive, FuzzyScore, anyScore } from '../../../base/common/filters.js';\r\nimport { compareIgnoreCase } from '../../../base/common/strings.js';\r\nimport { quickSelect } from '../../../base/common/arrays.js';\r\nexport class LineContext {\r\n    constructor(leadingLineContent, characterCountDelta) {\r\n        this.leadingLineContent = leadingLineContent;\r\n        this.characterCountDelta = characterCountDelta;\r\n    }\r\n}\r\n/**\r\n * Sorted, filtered completion view model\r\n * */\r\nexport class CompletionModel {\r\n    constructor(items, column, lineContext, wordDistance, options, snippetSuggestions, clipboardText) {\r\n        this.clipboardText = clipboardText;\r\n        this._snippetCompareFn = CompletionModel._compareCompletionItems;\r\n        this._items = items;\r\n        this._column = column;\r\n        this._wordDistance = wordDistance;\r\n        this._options = options;\r\n        this._refilterKind = 1 /* All */;\r\n        this._lineContext = lineContext;\r\n        if (snippetSuggestions === 'top') {\r\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsUp;\r\n        }\r\n        else if (snippetSuggestions === 'bottom') {\r\n            this._snippetCompareFn = CompletionModel._compareCompletionItemsSnippetsDown;\r\n        }\r\n    }\r\n    get lineContext() {\r\n        return this._lineContext;\r\n    }\r\n    set lineContext(value) {\r\n        if (this._lineContext.leadingLineContent !== value.leadingLineContent\r\n            || this._lineContext.characterCountDelta !== value.characterCountDelta) {\r\n            this._refilterKind = this._lineContext.characterCountDelta < value.characterCountDelta && this._filteredItems ? 2 /* Incr */ : 1 /* All */;\r\n            this._lineContext = value;\r\n        }\r\n    }\r\n    get items() {\r\n        this._ensureCachedState();\r\n        return this._filteredItems;\r\n    }\r\n    get allProvider() {\r\n        this._ensureCachedState();\r\n        return this._providerInfo.keys();\r\n    }\r\n    get incomplete() {\r\n        this._ensureCachedState();\r\n        const result = new Set();\r\n        for (let [provider, incomplete] of this._providerInfo) {\r\n            if (incomplete) {\r\n                result.add(provider);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    adopt(except) {\r\n        let res = [];\r\n        for (let i = 0; i < this._items.length;) {\r\n            if (!except.has(this._items[i].provider)) {\r\n                res.push(this._items[i]);\r\n                // unordered removed\r\n                this._items[i] = this._items[this._items.length - 1];\r\n                this._items.pop();\r\n            }\r\n            else {\r\n                // continue with next item\r\n                i++;\r\n            }\r\n        }\r\n        this._refilterKind = 1 /* All */;\r\n        return res;\r\n    }\r\n    get stats() {\r\n        this._ensureCachedState();\r\n        return this._stats;\r\n    }\r\n    _ensureCachedState() {\r\n        if (this._refilterKind !== 0 /* Nothing */) {\r\n            this._createCachedState();\r\n        }\r\n    }\r\n    _createCachedState() {\r\n        this._providerInfo = new Map();\r\n        const labelLengths = [];\r\n        const { leadingLineContent, characterCountDelta } = this._lineContext;\r\n        let word = '';\r\n        let wordLow = '';\r\n        // incrementally filter less\r\n        const source = this._refilterKind === 1 /* All */ ? this._items : this._filteredItems;\r\n        const target = [];\r\n        // picks a score function based on the number of\r\n        // items that we have to score/filter and based on the\r\n        // user-configuration\r\n        const scoreFn = (!this._options.filterGraceful || source.length > 2000) ? fuzzyScore : fuzzyScoreGracefulAggressive;\r\n        for (let i = 0; i < source.length; i++) {\r\n            const item = source[i];\r\n            if (item.isInvalid) {\r\n                continue; // SKIP invalid items\r\n            }\r\n            // collect all support, know if their result is incomplete\r\n            this._providerInfo.set(item.provider, Boolean(item.container.incomplete));\r\n            // 'word' is that remainder of the current line that we\r\n            // filter and score against. In theory each suggestion uses a\r\n            // different word, but in practice not - that's why we cache\r\n            const overwriteBefore = item.position.column - item.editStart.column;\r\n            const wordLen = overwriteBefore + characterCountDelta - (item.position.column - this._column);\r\n            if (word.length !== wordLen) {\r\n                word = wordLen === 0 ? '' : leadingLineContent.slice(-wordLen);\r\n                wordLow = word.toLowerCase();\r\n            }\r\n            // remember the word against which this item was\r\n            // scored\r\n            item.word = word;\r\n            if (wordLen === 0) {\r\n                // when there is nothing to score against, don't\r\n                // event try to do. Use a const rank and rely on\r\n                // the fallback-sort using the initial sort order.\r\n                // use a score of `-100` because that is out of the\r\n                // bound of values `fuzzyScore` will return\r\n                item.score = FuzzyScore.Default;\r\n            }\r\n            else {\r\n                // skip word characters that are whitespace until\r\n                // we have hit the replace range (overwriteBefore)\r\n                let wordPos = 0;\r\n                while (wordPos < overwriteBefore) {\r\n                    const ch = word.charCodeAt(wordPos);\r\n                    if (ch === 32 /* Space */ || ch === 9 /* Tab */) {\r\n                        wordPos += 1;\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n                if (wordPos >= wordLen) {\r\n                    // the wordPos at which scoring starts is the whole word\r\n                    // and therefore the same rules as not having a word apply\r\n                    item.score = FuzzyScore.Default;\r\n                }\r\n                else if (typeof item.completion.filterText === 'string') {\r\n                    // when there is a `filterText` it must match the `word`.\r\n                    // if it matches we check with the label to compute highlights\r\n                    // and if that doesn't yield a result we have no highlights,\r\n                    // despite having the match\r\n                    let match = scoreFn(word, wordLow, wordPos, item.completion.filterText, item.filterTextLow, 0, false);\r\n                    if (!match) {\r\n                        continue; // NO match\r\n                    }\r\n                    if (compareIgnoreCase(item.completion.filterText, item.textLabel) === 0) {\r\n                        // filterText and label are actually the same -> use good highlights\r\n                        item.score = match;\r\n                    }\r\n                    else {\r\n                        // re-run the scorer on the label in the hope of a result BUT use the rank\r\n                        // of the filterText-match\r\n                        item.score = anyScore(word, wordLow, wordPos, item.textLabel, item.labelLow, 0);\r\n                        item.score[0] = match[0]; // use score from filterText\r\n                    }\r\n                }\r\n                else {\r\n                    // by default match `word` against the `label`\r\n                    let match = scoreFn(word, wordLow, wordPos, item.textLabel, item.labelLow, 0, false);\r\n                    if (!match) {\r\n                        continue; // NO match\r\n                    }\r\n                    item.score = match;\r\n                }\r\n            }\r\n            item.idx = i;\r\n            item.distance = this._wordDistance.distance(item.position, item.completion);\r\n            target.push(item);\r\n            // update stats\r\n            labelLengths.push(item.textLabel.length);\r\n        }\r\n        this._filteredItems = target.sort(this._snippetCompareFn);\r\n        this._refilterKind = 0 /* Nothing */;\r\n        this._stats = {\r\n            pLabelLen: labelLengths.length ?\r\n                quickSelect(labelLengths.length - .85, labelLengths, (a, b) => a - b)\r\n                : 0\r\n        };\r\n    }\r\n    static _compareCompletionItems(a, b) {\r\n        if (a.score[0] > b.score[0]) {\r\n            return -1;\r\n        }\r\n        else if (a.score[0] < b.score[0]) {\r\n            return 1;\r\n        }\r\n        else if (a.distance < b.distance) {\r\n            return -1;\r\n        }\r\n        else if (a.distance > b.distance) {\r\n            return 1;\r\n        }\r\n        else if (a.idx < b.idx) {\r\n            return -1;\r\n        }\r\n        else if (a.idx > b.idx) {\r\n            return 1;\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    }\r\n    static _compareCompletionItemsSnippetsDown(a, b) {\r\n        if (a.completion.kind !== b.completion.kind) {\r\n            if (a.completion.kind === 27 /* Snippet */) {\r\n                return 1;\r\n            }\r\n            else if (b.completion.kind === 27 /* Snippet */) {\r\n                return -1;\r\n            }\r\n        }\r\n        return CompletionModel._compareCompletionItems(a, b);\r\n    }\r\n    static _compareCompletionItemsSnippetsUp(a, b) {\r\n        if (a.completion.kind !== b.completion.kind) {\r\n            if (a.completion.kind === 27 /* Snippet */) {\r\n                return -1;\r\n            }\r\n            else if (b.completion.kind === 27 /* Snippet */) {\r\n                return 1;\r\n            }\r\n        }\r\n        return CompletionModel._compareCompletionItems(a, b);\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { LinkedList } from '../../../base/common/linkedList.js';\r\nexport class BracketSelectionRangeProvider {\r\n    provideSelectionRanges(model, positions) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const result = [];\r\n            for (const position of positions) {\r\n                const bucket = [];\r\n                result.push(bucket);\r\n                const ranges = new Map();\r\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsRightYield(resolve, 0, model, position, ranges));\r\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsLeftYield(resolve, 0, model, position, ranges, bucket));\r\n            }\r\n            return result;\r\n        });\r\n    }\r\n    static _bracketsRightYield(resolve, round, model, pos, ranges) {\r\n        const counts = new Map();\r\n        const t1 = Date.now();\r\n        while (true) {\r\n            if (round >= BracketSelectionRangeProvider._maxRounds) {\r\n                resolve();\r\n                break;\r\n            }\r\n            if (!pos) {\r\n                resolve();\r\n                break;\r\n            }\r\n            let bracket = model.findNextBracket(pos);\r\n            if (!bracket) {\r\n                resolve();\r\n                break;\r\n            }\r\n            let d = Date.now() - t1;\r\n            if (d > BracketSelectionRangeProvider._maxDuration) {\r\n                setTimeout(() => BracketSelectionRangeProvider._bracketsRightYield(resolve, round + 1, model, pos, ranges));\r\n                break;\r\n            }\r\n            const key = bracket.close[0];\r\n            if (bracket.isOpen) {\r\n                // wait for closing\r\n                let val = counts.has(key) ? counts.get(key) : 0;\r\n                counts.set(key, val + 1);\r\n            }\r\n            else {\r\n                // process closing\r\n                let val = counts.has(key) ? counts.get(key) : 0;\r\n                val -= 1;\r\n                counts.set(key, Math.max(0, val));\r\n                if (val < 0) {\r\n                    let list = ranges.get(key);\r\n                    if (!list) {\r\n                        list = new LinkedList();\r\n                        ranges.set(key, list);\r\n                    }\r\n                    list.push(bracket.range);\r\n                }\r\n            }\r\n            pos = bracket.range.getEndPosition();\r\n        }\r\n    }\r\n    static _bracketsLeftYield(resolve, round, model, pos, ranges, bucket) {\r\n        const counts = new Map();\r\n        const t1 = Date.now();\r\n        while (true) {\r\n            if (round >= BracketSelectionRangeProvider._maxRounds && ranges.size === 0) {\r\n                resolve();\r\n                break;\r\n            }\r\n            if (!pos) {\r\n                resolve();\r\n                break;\r\n            }\r\n            let bracket = model.findPrevBracket(pos);\r\n            if (!bracket) {\r\n                resolve();\r\n                break;\r\n            }\r\n            let d = Date.now() - t1;\r\n            if (d > BracketSelectionRangeProvider._maxDuration) {\r\n                setTimeout(() => BracketSelectionRangeProvider._bracketsLeftYield(resolve, round + 1, model, pos, ranges, bucket));\r\n                break;\r\n            }\r\n            const key = bracket.close[0];\r\n            if (!bracket.isOpen) {\r\n                // wait for opening\r\n                let val = counts.has(key) ? counts.get(key) : 0;\r\n                counts.set(key, val + 1);\r\n            }\r\n            else {\r\n                // opening\r\n                let val = counts.has(key) ? counts.get(key) : 0;\r\n                val -= 1;\r\n                counts.set(key, Math.max(0, val));\r\n                if (val < 0) {\r\n                    let list = ranges.get(key);\r\n                    if (list) {\r\n                        let closing = list.shift();\r\n                        if (list.size === 0) {\r\n                            ranges.delete(key);\r\n                        }\r\n                        const innerBracket = Range.fromPositions(bracket.range.getEndPosition(), closing.getStartPosition());\r\n                        const outerBracket = Range.fromPositions(bracket.range.getStartPosition(), closing.getEndPosition());\r\n                        bucket.push({ range: innerBracket });\r\n                        bucket.push({ range: outerBracket });\r\n                        BracketSelectionRangeProvider._addBracketLeading(model, outerBracket, bucket);\r\n                    }\r\n                }\r\n            }\r\n            pos = bracket.range.getStartPosition();\r\n        }\r\n    }\r\n    static _addBracketLeading(model, bracket, bucket) {\r\n        if (bracket.startLineNumber === bracket.endLineNumber) {\r\n            return;\r\n        }\r\n        // xxxxxxxx {\r\n        //\r\n        // }\r\n        const startLine = bracket.startLineNumber;\r\n        const column = model.getLineFirstNonWhitespaceColumn(startLine);\r\n        if (column !== 0 && column !== bracket.startColumn) {\r\n            bucket.push({ range: Range.fromPositions(new Position(startLine, column), bracket.getEndPosition()) });\r\n            bucket.push({ range: Range.fromPositions(new Position(startLine, 1), bracket.getEndPosition()) });\r\n        }\r\n        // xxxxxxxx\r\n        // {\r\n        //\r\n        // }\r\n        const aboveLine = startLine - 1;\r\n        if (aboveLine > 0) {\r\n            const column = model.getLineFirstNonWhitespaceColumn(aboveLine);\r\n            if (column === bracket.startColumn && column !== model.getLineLastNonWhitespaceColumn(aboveLine)) {\r\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, column), bracket.getEndPosition()) });\r\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, 1), bracket.getEndPosition()) });\r\n            }\r\n        }\r\n    }\r\n}\r\nBracketSelectionRangeProvider._maxDuration = 30;\r\nBracketSelectionRangeProvider._maxRounds = 2;\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { binarySearch, isFalsyOrEmpty } from '../../../base/common/arrays.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { BracketSelectionRangeProvider } from '../smartSelect/bracketSelections.js';\r\nexport class WordDistance {\r\n    static create(service, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!editor.getOption(105 /* suggest */).localityBonus) {\r\n                return WordDistance.None;\r\n            }\r\n            if (!editor.hasModel()) {\r\n                return WordDistance.None;\r\n            }\r\n            const model = editor.getModel();\r\n            const position = editor.getPosition();\r\n            if (!service.canComputeWordRanges(model.uri)) {\r\n                return WordDistance.None;\r\n            }\r\n            const [ranges] = yield new BracketSelectionRangeProvider().provideSelectionRanges(model, [position]);\r\n            if (ranges.length === 0) {\r\n                return WordDistance.None;\r\n            }\r\n            const wordRanges = yield service.computeWordRanges(model.uri, ranges[0].range);\r\n            if (!wordRanges) {\r\n                return WordDistance.None;\r\n            }\r\n            // remove current word\r\n            const wordUntilPos = model.getWordUntilPosition(position);\r\n            delete wordRanges[wordUntilPos.word];\r\n            return new class extends WordDistance {\r\n                distance(anchor, item) {\r\n                    if (!position.equals(editor.getPosition())) {\r\n                        return 0;\r\n                    }\r\n                    if (item.kind === 17 /* Keyword */) {\r\n                        return 2 << 20;\r\n                    }\r\n                    let word = typeof item.label === 'string' ? item.label : item.label.label;\r\n                    let wordLines = wordRanges[word];\r\n                    if (isFalsyOrEmpty(wordLines)) {\r\n                        return 2 << 20;\r\n                    }\r\n                    let idx = binarySearch(wordLines, Range.fromPositions(anchor), Range.compareRangesUsingStarts);\r\n                    let bestWordRange = idx >= 0 ? wordLines[idx] : wordLines[Math.max(0, ~idx - 1)];\r\n                    let blockDistance = ranges.length;\r\n                    for (const range of ranges) {\r\n                        if (!Range.containsRange(range.range, bestWordRange)) {\r\n                            break;\r\n                        }\r\n                        blockDistance -= 1;\r\n                    }\r\n                    return blockDistance;\r\n                }\r\n            };\r\n        });\r\n    }\r\n}\r\nWordDistance.None = new class extends WordDistance {\r\n    distance() { return 0; }\r\n};\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { TimeoutTimer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { dispose, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { CompletionProviderRegistry } from '../../common/modes.js';\r\nimport { CompletionModel } from './completionModel.js';\r\nimport { getSuggestionComparator, provideSuggestionItems, getSnippetSuggestSupport, CompletionOptions } from './suggest.js';\r\nimport { SnippetController2 } from '../snippet/snippetController2.js';\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { IEditorWorkerService } from '../../common/services/editorWorkerService.js';\r\nimport { WordDistance } from './wordDistance.js';\r\nimport { isLowSurrogate, isHighSurrogate, getLeadingWhitespace } from '../../../base/common/strings.js';\r\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\r\nimport { ITelemetryService } from '../../../platform/telemetry/common/telemetry.js';\r\nimport { ILogService } from '../../../platform/log/common/log.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nexport class LineContext {\r\n    constructor(model, position, auto, shy) {\r\n        this.leadingLineContent = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\r\n        this.leadingWord = model.getWordUntilPosition(position);\r\n        this.lineNumber = position.lineNumber;\r\n        this.column = position.column;\r\n        this.auto = auto;\r\n        this.shy = shy;\r\n    }\r\n    static shouldAutoTrigger(editor) {\r\n        if (!editor.hasModel()) {\r\n            return false;\r\n        }\r\n        const model = editor.getModel();\r\n        const pos = editor.getPosition();\r\n        model.tokenizeIfCheap(pos.lineNumber);\r\n        const word = model.getWordAtPosition(pos);\r\n        if (!word) {\r\n            return false;\r\n        }\r\n        if (word.endColumn !== pos.column) {\r\n            return false;\r\n        }\r\n        if (!isNaN(Number(word.word))) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n}\r\nfunction shouldPreventQuickSuggest(contextKeyService, configurationService) {\r\n    return (Boolean(contextKeyService.getContextKeyValue('inlineSuggestionVisible'))\r\n        && !Boolean(configurationService.getValue('editor.inlineSuggest.allowQuickSuggestions')));\r\n}\r\nfunction shouldPreventSuggestOnTriggerCharacters(contextKeyService, configurationService) {\r\n    return (Boolean(contextKeyService.getContextKeyValue('inlineSuggestionVisible'))\r\n        && !Boolean(configurationService.getValue('editor.inlineSuggest.allowSuggestOnTriggerCharacters')));\r\n}\r\nlet SuggestModel = class SuggestModel {\r\n    constructor(_editor, _editorWorkerService, _clipboardService, _telemetryService, _logService, _contextKeyService, _configurationService) {\r\n        this._editor = _editor;\r\n        this._editorWorkerService = _editorWorkerService;\r\n        this._clipboardService = _clipboardService;\r\n        this._telemetryService = _telemetryService;\r\n        this._logService = _logService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._configurationService = _configurationService;\r\n        this._toDispose = new DisposableStore();\r\n        this._quickSuggestDelay = 10;\r\n        this._triggerCharacterListener = new DisposableStore();\r\n        this._triggerQuickSuggest = new TimeoutTimer();\r\n        this._state = 0 /* Idle */;\r\n        this._completionDisposables = new DisposableStore();\r\n        this._onDidCancel = new Emitter();\r\n        this._onDidTrigger = new Emitter();\r\n        this._onDidSuggest = new Emitter();\r\n        this.onDidCancel = this._onDidCancel.event;\r\n        this.onDidTrigger = this._onDidTrigger.event;\r\n        this.onDidSuggest = this._onDidSuggest.event;\r\n        this._telemetryGate = 0;\r\n        this._currentSelection = this._editor.getSelection() || new Selection(1, 1, 1, 1);\r\n        // wire up various listeners\r\n        this._toDispose.add(this._editor.onDidChangeModel(() => {\r\n            this._updateTriggerCharacters();\r\n            this.cancel();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeModelLanguage(() => {\r\n            this._updateTriggerCharacters();\r\n            this.cancel();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeConfiguration(() => {\r\n            this._updateTriggerCharacters();\r\n            this._updateQuickSuggest();\r\n        }));\r\n        this._toDispose.add(CompletionProviderRegistry.onDidChange(() => {\r\n            this._updateTriggerCharacters();\r\n            this._updateActiveSuggestSession();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeCursorSelection(e => {\r\n            this._onCursorChange(e);\r\n        }));\r\n        let editorIsComposing = false;\r\n        this._toDispose.add(this._editor.onDidCompositionStart(() => {\r\n            editorIsComposing = true;\r\n        }));\r\n        this._toDispose.add(this._editor.onDidCompositionEnd(() => {\r\n            // refilter when composition ends\r\n            editorIsComposing = false;\r\n            this._refilterCompletionItems();\r\n        }));\r\n        this._toDispose.add(this._editor.onDidChangeModelContent(() => {\r\n            // only filter completions when the editor isn't\r\n            // composing a character, e.g. \u00A8 + u makes \u00FC but just\r\n            // \u00A8 cannot be used for filtering\r\n            if (!editorIsComposing) {\r\n                this._refilterCompletionItems();\r\n            }\r\n        }));\r\n        this._updateTriggerCharacters();\r\n        this._updateQuickSuggest();\r\n    }\r\n    dispose() {\r\n        dispose(this._triggerCharacterListener);\r\n        dispose([this._onDidCancel, this._onDidSuggest, this._onDidTrigger, this._triggerQuickSuggest]);\r\n        this._toDispose.dispose();\r\n        this._completionDisposables.dispose();\r\n        this.cancel();\r\n    }\r\n    // --- handle configuration & precondition changes\r\n    _updateQuickSuggest() {\r\n        this._quickSuggestDelay = this._editor.getOption(78 /* quickSuggestionsDelay */);\r\n        if (isNaN(this._quickSuggestDelay) || (!this._quickSuggestDelay && this._quickSuggestDelay !== 0) || this._quickSuggestDelay < 0) {\r\n            this._quickSuggestDelay = 10;\r\n        }\r\n    }\r\n    _updateTriggerCharacters() {\r\n        this._triggerCharacterListener.clear();\r\n        if (this._editor.getOption(79 /* readOnly */)\r\n            || !this._editor.hasModel()\r\n            || !this._editor.getOption(108 /* suggestOnTriggerCharacters */)) {\r\n            return;\r\n        }\r\n        const supportsByTriggerCharacter = new Map();\r\n        for (const support of CompletionProviderRegistry.all(this._editor.getModel())) {\r\n            for (const ch of support.triggerCharacters || []) {\r\n                let set = supportsByTriggerCharacter.get(ch);\r\n                if (!set) {\r\n                    set = new Set();\r\n                    set.add(getSnippetSuggestSupport());\r\n                    supportsByTriggerCharacter.set(ch, set);\r\n                }\r\n                set.add(support);\r\n            }\r\n        }\r\n        const checkTriggerCharacter = (text) => {\r\n            if (shouldPreventSuggestOnTriggerCharacters(this._contextKeyService, this._configurationService)) {\r\n                return;\r\n            }\r\n            if (LineContext.shouldAutoTrigger(this._editor)) {\r\n                // don't trigger by trigger characters when this is a case for quick suggest\r\n                return;\r\n            }\r\n            if (!text) {\r\n                // came here from the compositionEnd-event\r\n                const position = this._editor.getPosition();\r\n                const model = this._editor.getModel();\r\n                text = model.getLineContent(position.lineNumber).substr(0, position.column - 1);\r\n            }\r\n            let lastChar = '';\r\n            if (isLowSurrogate(text.charCodeAt(text.length - 1))) {\r\n                if (isHighSurrogate(text.charCodeAt(text.length - 2))) {\r\n                    lastChar = text.substr(text.length - 2);\r\n                }\r\n            }\r\n            else {\r\n                lastChar = text.charAt(text.length - 1);\r\n            }\r\n            const supports = supportsByTriggerCharacter.get(lastChar);\r\n            if (supports) {\r\n                // keep existing items that where not computed by the\r\n                // supports/providers that want to trigger now\r\n                const existing = this._completionModel\r\n                    ? { items: this._completionModel.adopt(supports), clipboardText: this._completionModel.clipboardText }\r\n                    : undefined;\r\n                this.trigger({ auto: true, shy: false, triggerCharacter: lastChar }, Boolean(this._completionModel), supports, existing);\r\n            }\r\n        };\r\n        this._triggerCharacterListener.add(this._editor.onDidType(checkTriggerCharacter));\r\n        this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(checkTriggerCharacter));\r\n    }\r\n    // --- trigger/retrigger/cancel suggest\r\n    get state() {\r\n        return this._state;\r\n    }\r\n    cancel(retrigger = false) {\r\n        var _a;\r\n        if (this._state !== 0 /* Idle */) {\r\n            this._triggerQuickSuggest.cancel();\r\n            (_a = this._requestToken) === null || _a === void 0 ? void 0 : _a.cancel();\r\n            this._requestToken = undefined;\r\n            this._state = 0 /* Idle */;\r\n            this._completionModel = undefined;\r\n            this._context = undefined;\r\n            this._onDidCancel.fire({ retrigger });\r\n        }\r\n    }\r\n    clear() {\r\n        this._completionDisposables.clear();\r\n    }\r\n    _updateActiveSuggestSession() {\r\n        if (this._state !== 0 /* Idle */) {\r\n            if (!this._editor.hasModel() || !CompletionProviderRegistry.has(this._editor.getModel())) {\r\n                this.cancel();\r\n            }\r\n            else {\r\n                this.trigger({ auto: this._state === 2 /* Auto */, shy: false }, true);\r\n            }\r\n        }\r\n    }\r\n    _onCursorChange(e) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        const prevSelection = this._currentSelection;\r\n        this._currentSelection = this._editor.getSelection();\r\n        if (!e.selection.isEmpty()\r\n            || (e.reason !== 0 /* NotSet */ && e.reason !== 3 /* Explicit */)\r\n            || (e.source !== 'keyboard' && e.source !== 'deleteLeft')) {\r\n            // Early exit if nothing needs to be done!\r\n            // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n            this.cancel();\r\n            return;\r\n        }\r\n        if (!CompletionProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        if (this._state === 0 /* Idle */ && e.reason === 0 /* NotSet */) {\r\n            if (this._editor.getOption(77 /* quickSuggestions */) === false) {\r\n                // not enabled\r\n                return;\r\n            }\r\n            if (!prevSelection.containsRange(this._currentSelection) && !prevSelection.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition())) {\r\n                // cursor didn't move RIGHT\r\n                return;\r\n            }\r\n            if (this._editor.getOption(105 /* suggest */).snippetsPreventQuickSuggestions && SnippetController2.get(this._editor).isInSnippet()) {\r\n                // no quick suggestion when in snippet mode\r\n                return;\r\n            }\r\n            this.cancel();\r\n            this._triggerQuickSuggest.cancelAndSet(() => {\r\n                if (this._state !== 0 /* Idle */) {\r\n                    return;\r\n                }\r\n                if (!LineContext.shouldAutoTrigger(this._editor)) {\r\n                    return;\r\n                }\r\n                if (!this._editor.hasModel()) {\r\n                    return;\r\n                }\r\n                const model = this._editor.getModel();\r\n                const pos = this._editor.getPosition();\r\n                // validate enabled now\r\n                const quickSuggestions = this._editor.getOption(77 /* quickSuggestions */);\r\n                if (quickSuggestions === false) {\r\n                    return;\r\n                }\r\n                else if (quickSuggestions === true) {\r\n                    // all good\r\n                }\r\n                else {\r\n                    // Check the type of the token that triggered this\r\n                    model.tokenizeIfCheap(pos.lineNumber);\r\n                    const lineTokens = model.getLineTokens(pos.lineNumber);\r\n                    const tokenType = lineTokens.getStandardTokenType(lineTokens.findTokenIndexAtOffset(Math.max(pos.column - 1 - 1, 0)));\r\n                    const inValidScope = quickSuggestions.other && tokenType === 0 /* Other */\r\n                        || quickSuggestions.comments && tokenType === 1 /* Comment */\r\n                        || quickSuggestions.strings && tokenType === 2 /* String */;\r\n                    if (!inValidScope) {\r\n                        return;\r\n                    }\r\n                }\r\n                if (shouldPreventQuickSuggest(this._contextKeyService, this._configurationService)) {\r\n                    // do not trigger quick suggestions if inline suggestions are shown\r\n                    return;\r\n                }\r\n                // we made it till here -> trigger now\r\n                this.trigger({ auto: true, shy: false });\r\n            }, this._quickSuggestDelay);\r\n        }\r\n        else if (this._state !== 0 /* Idle */ && e.reason === 3 /* Explicit */) {\r\n            // suggest is active and something like cursor keys are used to move\r\n            // the cursor. this means we can refilter at the new position\r\n            this._refilterCompletionItems();\r\n        }\r\n    }\r\n    _refilterCompletionItems() {\r\n        // Re-filter suggestions. This MUST run async because filtering/scoring\r\n        // uses the model content AND the cursor position. The latter is NOT\r\n        // updated when the document has changed (the event which drives this method)\r\n        // and therefore a little pause (next mirco task) is needed. See:\r\n        // https://stackoverflow.com/questions/25915634/difference-between-microtask-and-macrotask-within-an-event-loop-context#25933985\r\n        Promise.resolve().then(() => {\r\n            if (this._state === 0 /* Idle */) {\r\n                return;\r\n            }\r\n            if (!this._editor.hasModel()) {\r\n                return;\r\n            }\r\n            const model = this._editor.getModel();\r\n            const position = this._editor.getPosition();\r\n            const ctx = new LineContext(model, position, this._state === 2 /* Auto */, false);\r\n            this._onNewContext(ctx);\r\n        });\r\n    }\r\n    trigger(context, retrigger = false, onlyFrom, existing) {\r\n        var _a;\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        const auto = context.auto;\r\n        const ctx = new LineContext(model, this._editor.getPosition(), auto, context.shy);\r\n        // Cancel previous requests, change state & update UI\r\n        this.cancel(retrigger);\r\n        this._state = auto ? 2 /* Auto */ : 1 /* Manual */;\r\n        this._onDidTrigger.fire({ auto, shy: context.shy, position: this._editor.getPosition() });\r\n        // Capture context when request was sent\r\n        this._context = ctx;\r\n        // Build context for request\r\n        let suggestCtx = { triggerKind: (_a = context.triggerKind) !== null && _a !== void 0 ? _a : 0 /* Invoke */ };\r\n        if (context.triggerCharacter) {\r\n            suggestCtx = {\r\n                triggerKind: 1 /* TriggerCharacter */,\r\n                triggerCharacter: context.triggerCharacter\r\n            };\r\n        }\r\n        this._requestToken = new CancellationTokenSource();\r\n        // kind filter and snippet sort rules\r\n        const snippetSuggestions = this._editor.getOption(100 /* snippetSuggestions */);\r\n        let snippetSortOrder = 1 /* Inline */;\r\n        switch (snippetSuggestions) {\r\n            case 'top':\r\n                snippetSortOrder = 0 /* Top */;\r\n                break;\r\n            // \t\u2193 that's the default anyways...\r\n            // case 'inline':\r\n            // \tsnippetSortOrder = SnippetSortOrder.Inline;\r\n            // \tbreak;\r\n            case 'bottom':\r\n                snippetSortOrder = 2 /* Bottom */;\r\n                break;\r\n        }\r\n        const { itemKind: itemKindFilter, showDeprecated } = SuggestModel._createSuggestFilter(this._editor);\r\n        const wordDistance = WordDistance.create(this._editorWorkerService, this._editor);\r\n        const completions = provideSuggestionItems(model, this._editor.getPosition(), new CompletionOptions(snippetSortOrder, itemKindFilter, onlyFrom, showDeprecated), suggestCtx, this._requestToken.token);\r\n        Promise.all([completions, wordDistance]).then(([completions, wordDistance]) => __awaiter(this, void 0, void 0, function* () {\r\n            var _b;\r\n            (_b = this._requestToken) === null || _b === void 0 ? void 0 : _b.dispose();\r\n            if (!this._editor.hasModel()) {\r\n                return;\r\n            }\r\n            let clipboardText = existing === null || existing === void 0 ? void 0 : existing.clipboardText;\r\n            if (!clipboardText && completions.needsClipboard) {\r\n                clipboardText = yield this._clipboardService.readText();\r\n            }\r\n            if (this._state === 0 /* Idle */) {\r\n                return;\r\n            }\r\n            const model = this._editor.getModel();\r\n            let items = completions.items;\r\n            if (existing) {\r\n                const cmpFn = getSuggestionComparator(snippetSortOrder);\r\n                items = items.concat(existing.items).sort(cmpFn);\r\n            }\r\n            const ctx = new LineContext(model, this._editor.getPosition(), auto, context.shy);\r\n            this._completionModel = new CompletionModel(items, this._context.column, {\r\n                leadingLineContent: ctx.leadingLineContent,\r\n                characterCountDelta: ctx.column - this._context.column\r\n            }, wordDistance, this._editor.getOption(105 /* suggest */), this._editor.getOption(100 /* snippetSuggestions */), clipboardText);\r\n            // store containers so that they can be disposed later\r\n            this._completionDisposables.add(completions.disposable);\r\n            this._onNewContext(ctx);\r\n            // finally report telemetry about durations\r\n            this._reportDurationsTelemetry(completions.durations);\r\n        })).catch(onUnexpectedError);\r\n    }\r\n    _reportDurationsTelemetry(durations) {\r\n        if (this._telemetryGate++ % 230 !== 0) {\r\n            return;\r\n        }\r\n        setTimeout(() => {\r\n            this._telemetryService.publicLog2('suggest.durations.json', { data: JSON.stringify(durations) });\r\n            this._logService.debug('suggest.durations.json', durations);\r\n        });\r\n    }\r\n    static _createSuggestFilter(editor) {\r\n        // kind filter and snippet sort rules\r\n        const result = new Set();\r\n        // snippet setting\r\n        const snippetSuggestions = editor.getOption(100 /* snippetSuggestions */);\r\n        if (snippetSuggestions === 'none') {\r\n            result.add(27 /* Snippet */);\r\n        }\r\n        // type setting\r\n        const suggestOptions = editor.getOption(105 /* suggest */);\r\n        if (!suggestOptions.showMethods) {\r\n            result.add(0 /* Method */);\r\n        }\r\n        if (!suggestOptions.showFunctions) {\r\n            result.add(1 /* Function */);\r\n        }\r\n        if (!suggestOptions.showConstructors) {\r\n            result.add(2 /* Constructor */);\r\n        }\r\n        if (!suggestOptions.showFields) {\r\n            result.add(3 /* Field */);\r\n        }\r\n        if (!suggestOptions.showVariables) {\r\n            result.add(4 /* Variable */);\r\n        }\r\n        if (!suggestOptions.showClasses) {\r\n            result.add(5 /* Class */);\r\n        }\r\n        if (!suggestOptions.showStructs) {\r\n            result.add(6 /* Struct */);\r\n        }\r\n        if (!suggestOptions.showInterfaces) {\r\n            result.add(7 /* Interface */);\r\n        }\r\n        if (!suggestOptions.showModules) {\r\n            result.add(8 /* Module */);\r\n        }\r\n        if (!suggestOptions.showProperties) {\r\n            result.add(9 /* Property */);\r\n        }\r\n        if (!suggestOptions.showEvents) {\r\n            result.add(10 /* Event */);\r\n        }\r\n        if (!suggestOptions.showOperators) {\r\n            result.add(11 /* Operator */);\r\n        }\r\n        if (!suggestOptions.showUnits) {\r\n            result.add(12 /* Unit */);\r\n        }\r\n        if (!suggestOptions.showValues) {\r\n            result.add(13 /* Value */);\r\n        }\r\n        if (!suggestOptions.showConstants) {\r\n            result.add(14 /* Constant */);\r\n        }\r\n        if (!suggestOptions.showEnums) {\r\n            result.add(15 /* Enum */);\r\n        }\r\n        if (!suggestOptions.showEnumMembers) {\r\n            result.add(16 /* EnumMember */);\r\n        }\r\n        if (!suggestOptions.showKeywords) {\r\n            result.add(17 /* Keyword */);\r\n        }\r\n        if (!suggestOptions.showWords) {\r\n            result.add(18 /* Text */);\r\n        }\r\n        if (!suggestOptions.showColors) {\r\n            result.add(19 /* Color */);\r\n        }\r\n        if (!suggestOptions.showFiles) {\r\n            result.add(20 /* File */);\r\n        }\r\n        if (!suggestOptions.showReferences) {\r\n            result.add(21 /* Reference */);\r\n        }\r\n        if (!suggestOptions.showColors) {\r\n            result.add(22 /* Customcolor */);\r\n        }\r\n        if (!suggestOptions.showFolders) {\r\n            result.add(23 /* Folder */);\r\n        }\r\n        if (!suggestOptions.showTypeParameters) {\r\n            result.add(24 /* TypeParameter */);\r\n        }\r\n        if (!suggestOptions.showSnippets) {\r\n            result.add(27 /* Snippet */);\r\n        }\r\n        if (!suggestOptions.showUsers) {\r\n            result.add(25 /* User */);\r\n        }\r\n        if (!suggestOptions.showIssues) {\r\n            result.add(26 /* Issue */);\r\n        }\r\n        return { itemKind: result, showDeprecated: suggestOptions.showDeprecated };\r\n    }\r\n    _onNewContext(ctx) {\r\n        if (!this._context) {\r\n            // happens when 24x7 IntelliSense is enabled and still in its delay\r\n            return;\r\n        }\r\n        if (ctx.lineNumber !== this._context.lineNumber) {\r\n            // e.g. happens when pressing Enter while IntelliSense is computed\r\n            this.cancel();\r\n            return;\r\n        }\r\n        if (getLeadingWhitespace(ctx.leadingLineContent) !== getLeadingWhitespace(this._context.leadingLineContent)) {\r\n            // cancel IntelliSense when line start changes\r\n            // happens when the current word gets outdented\r\n            this.cancel();\r\n            return;\r\n        }\r\n        if (ctx.column < this._context.column) {\r\n            // typed -> moved cursor LEFT -> retrigger if still on a word\r\n            if (ctx.leadingWord.word) {\r\n                this.trigger({ auto: this._context.auto, shy: false }, true);\r\n            }\r\n            else {\r\n                this.cancel();\r\n            }\r\n            return;\r\n        }\r\n        if (!this._completionModel) {\r\n            // happens when IntelliSense is not yet computed\r\n            return;\r\n        }\r\n        if (ctx.leadingWord.word.length !== 0 && ctx.leadingWord.startColumn > this._context.leadingWord.startColumn) {\r\n            // started a new word while IntelliSense shows -> retrigger\r\n            // Select those providers have not contributed to this completion model and re-trigger completions for\r\n            // them. Also adopt the existing items and merge them into the new completion model\r\n            const inactiveProvider = new Set(CompletionProviderRegistry.all(this._editor.getModel()));\r\n            for (let provider of this._completionModel.allProvider) {\r\n                inactiveProvider.delete(provider);\r\n            }\r\n            const items = this._completionModel.adopt(new Set());\r\n            this.trigger({ auto: this._context.auto, shy: false }, true, inactiveProvider, { items, clipboardText: this._completionModel.clipboardText });\r\n            return;\r\n        }\r\n        if (ctx.column > this._context.column && this._completionModel.incomplete.size > 0 && ctx.leadingWord.word.length !== 0) {\r\n            // typed -> moved cursor RIGHT & incomple model & still on a word -> retrigger\r\n            const { incomplete } = this._completionModel;\r\n            const items = this._completionModel.adopt(incomplete);\r\n            this.trigger({ auto: this._state === 2 /* Auto */, shy: false, triggerKind: 2 /* TriggerForIncompleteCompletions */ }, true, incomplete, { items, clipboardText: this._completionModel.clipboardText });\r\n        }\r\n        else {\r\n            // typed -> moved cursor RIGHT -> update UI\r\n            let oldLineContext = this._completionModel.lineContext;\r\n            let isFrozen = false;\r\n            this._completionModel.lineContext = {\r\n                leadingLineContent: ctx.leadingLineContent,\r\n                characterCountDelta: ctx.column - this._context.column\r\n            };\r\n            if (this._completionModel.items.length === 0) {\r\n                if (LineContext.shouldAutoTrigger(this._editor) && this._context.leadingWord.endColumn < ctx.leadingWord.startColumn) {\r\n                    // retrigger when heading into a new word\r\n                    this.trigger({ auto: this._context.auto, shy: false }, true);\r\n                    return;\r\n                }\r\n                if (!this._context.auto) {\r\n                    // freeze when IntelliSense was manually requested\r\n                    this._completionModel.lineContext = oldLineContext;\r\n                    isFrozen = this._completionModel.items.length > 0;\r\n                    if (isFrozen && ctx.leadingWord.word.length === 0) {\r\n                        // there were results before but now there aren't\r\n                        // and also we are not on a word anymore -> cancel\r\n                        this.cancel();\r\n                        return;\r\n                    }\r\n                }\r\n                else {\r\n                    // nothing left\r\n                    this.cancel();\r\n                    return;\r\n                }\r\n            }\r\n            this._onDidSuggest.fire({\r\n                completionModel: this._completionModel,\r\n                auto: this._context.auto,\r\n                shy: this._context.shy,\r\n                isFrozen,\r\n            });\r\n        }\r\n    }\r\n};\r\nSuggestModel = __decorate([\r\n    __param(1, IEditorWorkerService),\r\n    __param(2, IClipboardService),\r\n    __param(3, ITelemetryService),\r\n    __param(4, ILogService),\r\n    __param(5, IContextKeyService),\r\n    __param(6, IConfigurationService)\r\n], SuggestModel);\r\nexport { SuggestModel };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { localize } from '../../../nls.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { registerColor, foreground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nexport const SYMBOL_ICON_ARRAY_FOREGROUND = registerColor('symbolIcon.arrayForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.arrayForeground', 'The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_BOOLEAN_FOREGROUND = registerColor('symbolIcon.booleanForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.booleanForeground', 'The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_CLASS_FOREGROUND = registerColor('symbolIcon.classForeground', {\r\n    dark: '#EE9D28',\r\n    light: '#D67E00',\r\n    hc: '#EE9D28'\r\n}, localize('symbolIcon.classForeground', 'The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_COLOR_FOREGROUND = registerColor('symbolIcon.colorForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.colorForeground', 'The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_CONSTANT_FOREGROUND = registerColor('symbolIcon.constantForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.constantForeground', 'The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_CONSTRUCTOR_FOREGROUND = registerColor('symbolIcon.constructorForeground', {\r\n    dark: '#B180D7',\r\n    light: '#652D90',\r\n    hc: '#B180D7'\r\n}, localize('symbolIcon.constructorForeground', 'The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_ENUMERATOR_FOREGROUND = registerColor('symbolIcon.enumeratorForeground', {\r\n    dark: '#EE9D28',\r\n    light: '#D67E00',\r\n    hc: '#EE9D28'\r\n}, localize('symbolIcon.enumeratorForeground', 'The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND = registerColor('symbolIcon.enumeratorMemberForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.enumeratorMemberForeground', 'The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_EVENT_FOREGROUND = registerColor('symbolIcon.eventForeground', {\r\n    dark: '#EE9D28',\r\n    light: '#D67E00',\r\n    hc: '#EE9D28'\r\n}, localize('symbolIcon.eventForeground', 'The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_FIELD_FOREGROUND = registerColor('symbolIcon.fieldForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.fieldForeground', 'The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_FILE_FOREGROUND = registerColor('symbolIcon.fileForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.fileForeground', 'The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_FOLDER_FOREGROUND = registerColor('symbolIcon.folderForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.folderForeground', 'The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_FUNCTION_FOREGROUND = registerColor('symbolIcon.functionForeground', {\r\n    dark: '#B180D7',\r\n    light: '#652D90',\r\n    hc: '#B180D7'\r\n}, localize('symbolIcon.functionForeground', 'The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_INTERFACE_FOREGROUND = registerColor('symbolIcon.interfaceForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.interfaceForeground', 'The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_KEY_FOREGROUND = registerColor('symbolIcon.keyForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.keyForeground', 'The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_KEYWORD_FOREGROUND = registerColor('symbolIcon.keywordForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.keywordForeground', 'The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_METHOD_FOREGROUND = registerColor('symbolIcon.methodForeground', {\r\n    dark: '#B180D7',\r\n    light: '#652D90',\r\n    hc: '#B180D7'\r\n}, localize('symbolIcon.methodForeground', 'The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_MODULE_FOREGROUND = registerColor('symbolIcon.moduleForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.moduleForeground', 'The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_NAMESPACE_FOREGROUND = registerColor('symbolIcon.namespaceForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.namespaceForeground', 'The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_NULL_FOREGROUND = registerColor('symbolIcon.nullForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.nullForeground', 'The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_NUMBER_FOREGROUND = registerColor('symbolIcon.numberForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.numberForeground', 'The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_OBJECT_FOREGROUND = registerColor('symbolIcon.objectForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.objectForeground', 'The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_OPERATOR_FOREGROUND = registerColor('symbolIcon.operatorForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.operatorForeground', 'The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_PACKAGE_FOREGROUND = registerColor('symbolIcon.packageForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.packageForeground', 'The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_PROPERTY_FOREGROUND = registerColor('symbolIcon.propertyForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.propertyForeground', 'The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_REFERENCE_FOREGROUND = registerColor('symbolIcon.referenceForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.referenceForeground', 'The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_SNIPPET_FOREGROUND = registerColor('symbolIcon.snippetForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.snippetForeground', 'The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_STRING_FOREGROUND = registerColor('symbolIcon.stringForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.stringForeground', 'The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_STRUCT_FOREGROUND = registerColor('symbolIcon.structForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.structForeground', 'The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_TEXT_FOREGROUND = registerColor('symbolIcon.textForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.textForeground', 'The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_TYPEPARAMETER_FOREGROUND = registerColor('symbolIcon.typeParameterForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.typeParameterForeground', 'The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_UNIT_FOREGROUND = registerColor('symbolIcon.unitForeground', {\r\n    dark: foreground,\r\n    light: foreground,\r\n    hc: foreground\r\n}, localize('symbolIcon.unitForeground', 'The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nexport const SYMBOL_ICON_VARIABLE_FOREGROUND = registerColor('symbolIcon.variableForeground', {\r\n    dark: '#75BEFF',\r\n    light: '#007ACC',\r\n    hc: '#75BEFF'\r\n}, localize('symbolIcon.variableForeground', 'The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget.'));\r\nregisterThemingParticipant((theme, collector) => {\r\n    const symbolIconArrayColor = theme.getColor(SYMBOL_ICON_ARRAY_FOREGROUND);\r\n    if (symbolIconArrayColor) {\r\n        collector.addRule(`${Codicon.symbolArray.cssSelector} { color: ${symbolIconArrayColor}; }`);\r\n    }\r\n    const symbolIconBooleanColor = theme.getColor(SYMBOL_ICON_BOOLEAN_FOREGROUND);\r\n    if (symbolIconBooleanColor) {\r\n        collector.addRule(`${Codicon.symbolBoolean.cssSelector} { color: ${symbolIconBooleanColor}; }`);\r\n    }\r\n    const symbolIconClassColor = theme.getColor(SYMBOL_ICON_CLASS_FOREGROUND);\r\n    if (symbolIconClassColor) {\r\n        collector.addRule(`${Codicon.symbolClass.cssSelector} { color: ${symbolIconClassColor}; }`);\r\n    }\r\n    const symbolIconMethodColor = theme.getColor(SYMBOL_ICON_METHOD_FOREGROUND);\r\n    if (symbolIconMethodColor) {\r\n        collector.addRule(`${Codicon.symbolMethod.cssSelector} { color: ${symbolIconMethodColor}; }`);\r\n    }\r\n    const symbolIconColorColor = theme.getColor(SYMBOL_ICON_COLOR_FOREGROUND);\r\n    if (symbolIconColorColor) {\r\n        collector.addRule(`${Codicon.symbolColor.cssSelector} { color: ${symbolIconColorColor}; }`);\r\n    }\r\n    const symbolIconConstantColor = theme.getColor(SYMBOL_ICON_CONSTANT_FOREGROUND);\r\n    if (symbolIconConstantColor) {\r\n        collector.addRule(`${Codicon.symbolConstant.cssSelector} { color: ${symbolIconConstantColor}; }`);\r\n    }\r\n    const symbolIconConstructorColor = theme.getColor(SYMBOL_ICON_CONSTRUCTOR_FOREGROUND);\r\n    if (symbolIconConstructorColor) {\r\n        collector.addRule(`${Codicon.symbolConstructor.cssSelector} { color: ${symbolIconConstructorColor}; }`);\r\n    }\r\n    const symbolIconEnumeratorColor = theme.getColor(SYMBOL_ICON_ENUMERATOR_FOREGROUND);\r\n    if (symbolIconEnumeratorColor) {\r\n        collector.addRule(`\n\t\t\t${Codicon.symbolValue.cssSelector},${Codicon.symbolEnum.cssSelector} { color: ${symbolIconEnumeratorColor}; }`);\r\n    }\r\n    const symbolIconEnumeratorMemberColor = theme.getColor(SYMBOL_ICON_ENUMERATOR_MEMBER_FOREGROUND);\r\n    if (symbolIconEnumeratorMemberColor) {\r\n        collector.addRule(`${Codicon.symbolEnumMember.cssSelector} { color: ${symbolIconEnumeratorMemberColor}; }`);\r\n    }\r\n    const symbolIconEventColor = theme.getColor(SYMBOL_ICON_EVENT_FOREGROUND);\r\n    if (symbolIconEventColor) {\r\n        collector.addRule(`${Codicon.symbolEvent.cssSelector} { color: ${symbolIconEventColor}; }`);\r\n    }\r\n    const symbolIconFieldColor = theme.getColor(SYMBOL_ICON_FIELD_FOREGROUND);\r\n    if (symbolIconFieldColor) {\r\n        collector.addRule(`${Codicon.symbolField.cssSelector} { color: ${symbolIconFieldColor}; }`);\r\n    }\r\n    const symbolIconFileColor = theme.getColor(SYMBOL_ICON_FILE_FOREGROUND);\r\n    if (symbolIconFileColor) {\r\n        collector.addRule(`${Codicon.symbolFile.cssSelector} { color: ${symbolIconFileColor}; }`);\r\n    }\r\n    const symbolIconFolderColor = theme.getColor(SYMBOL_ICON_FOLDER_FOREGROUND);\r\n    if (symbolIconFolderColor) {\r\n        collector.addRule(`${Codicon.symbolFolder.cssSelector} { color: ${symbolIconFolderColor}; }`);\r\n    }\r\n    const symbolIconFunctionColor = theme.getColor(SYMBOL_ICON_FUNCTION_FOREGROUND);\r\n    if (symbolIconFunctionColor) {\r\n        collector.addRule(`${Codicon.symbolFunction.cssSelector} { color: ${symbolIconFunctionColor}; }`);\r\n    }\r\n    const symbolIconInterfaceColor = theme.getColor(SYMBOL_ICON_INTERFACE_FOREGROUND);\r\n    if (symbolIconInterfaceColor) {\r\n        collector.addRule(`${Codicon.symbolInterface.cssSelector} { color: ${symbolIconInterfaceColor}; }`);\r\n    }\r\n    const symbolIconKeyColor = theme.getColor(SYMBOL_ICON_KEY_FOREGROUND);\r\n    if (symbolIconKeyColor) {\r\n        collector.addRule(`${Codicon.symbolKey.cssSelector} { color: ${symbolIconKeyColor}; }`);\r\n    }\r\n    const symbolIconKeywordColor = theme.getColor(SYMBOL_ICON_KEYWORD_FOREGROUND);\r\n    if (symbolIconKeywordColor) {\r\n        collector.addRule(`${Codicon.symbolKeyword.cssSelector} { color: ${symbolIconKeywordColor}; }`);\r\n    }\r\n    const symbolIconModuleColor = theme.getColor(SYMBOL_ICON_MODULE_FOREGROUND);\r\n    if (symbolIconModuleColor) {\r\n        collector.addRule(`${Codicon.symbolModule.cssSelector} { color: ${symbolIconModuleColor}; }`);\r\n    }\r\n    const outlineNamespaceColor = theme.getColor(SYMBOL_ICON_NAMESPACE_FOREGROUND);\r\n    if (outlineNamespaceColor) {\r\n        collector.addRule(`${Codicon.symbolNamespace.cssSelector} { color: ${outlineNamespaceColor}; }`);\r\n    }\r\n    const symbolIconNullColor = theme.getColor(SYMBOL_ICON_NULL_FOREGROUND);\r\n    if (symbolIconNullColor) {\r\n        collector.addRule(`${Codicon.symbolNull.cssSelector} { color: ${symbolIconNullColor}; }`);\r\n    }\r\n    const symbolIconNumberColor = theme.getColor(SYMBOL_ICON_NUMBER_FOREGROUND);\r\n    if (symbolIconNumberColor) {\r\n        collector.addRule(`${Codicon.symbolNumber.cssSelector} { color: ${symbolIconNumberColor}; }`);\r\n    }\r\n    const symbolIconObjectColor = theme.getColor(SYMBOL_ICON_OBJECT_FOREGROUND);\r\n    if (symbolIconObjectColor) {\r\n        collector.addRule(`${Codicon.symbolObject.cssSelector} { color: ${symbolIconObjectColor}; }`);\r\n    }\r\n    const symbolIconOperatorColor = theme.getColor(SYMBOL_ICON_OPERATOR_FOREGROUND);\r\n    if (symbolIconOperatorColor) {\r\n        collector.addRule(`${Codicon.symbolOperator.cssSelector} { color: ${symbolIconOperatorColor}; }`);\r\n    }\r\n    const symbolIconPackageColor = theme.getColor(SYMBOL_ICON_PACKAGE_FOREGROUND);\r\n    if (symbolIconPackageColor) {\r\n        collector.addRule(`${Codicon.symbolPackage.cssSelector} { color: ${symbolIconPackageColor}; }`);\r\n    }\r\n    const symbolIconPropertyColor = theme.getColor(SYMBOL_ICON_PROPERTY_FOREGROUND);\r\n    if (symbolIconPropertyColor) {\r\n        collector.addRule(`${Codicon.symbolProperty.cssSelector} { color: ${symbolIconPropertyColor}; }`);\r\n    }\r\n    const symbolIconReferenceColor = theme.getColor(SYMBOL_ICON_REFERENCE_FOREGROUND);\r\n    if (symbolIconReferenceColor) {\r\n        collector.addRule(`${Codicon.symbolReference.cssSelector} { color: ${symbolIconReferenceColor}; }`);\r\n    }\r\n    const symbolIconSnippetColor = theme.getColor(SYMBOL_ICON_SNIPPET_FOREGROUND);\r\n    if (symbolIconSnippetColor) {\r\n        collector.addRule(`${Codicon.symbolSnippet.cssSelector} { color: ${symbolIconSnippetColor}; }`);\r\n    }\r\n    const symbolIconStringColor = theme.getColor(SYMBOL_ICON_STRING_FOREGROUND);\r\n    if (symbolIconStringColor) {\r\n        collector.addRule(`${Codicon.symbolString.cssSelector} { color: ${symbolIconStringColor}; }`);\r\n    }\r\n    const symbolIconStructColor = theme.getColor(SYMBOL_ICON_STRUCT_FOREGROUND);\r\n    if (symbolIconStructColor) {\r\n        collector.addRule(`${Codicon.symbolStruct.cssSelector} { color: ${symbolIconStructColor}; }`);\r\n    }\r\n    const symbolIconTextColor = theme.getColor(SYMBOL_ICON_TEXT_FOREGROUND);\r\n    if (symbolIconTextColor) {\r\n        collector.addRule(`${Codicon.symbolText.cssSelector} { color: ${symbolIconTextColor}; }`);\r\n    }\r\n    const symbolIconTypeParameterColor = theme.getColor(SYMBOL_ICON_TYPEPARAMETER_FOREGROUND);\r\n    if (symbolIconTypeParameterColor) {\r\n        collector.addRule(`${Codicon.symbolTypeParameter.cssSelector} { color: ${symbolIconTypeParameterColor}; }`);\r\n    }\r\n    const symbolIconUnitColor = theme.getColor(SYMBOL_ICON_UNIT_FOREGROUND);\r\n    if (symbolIconUnitColor) {\r\n        collector.addRule(`${Codicon.symbolUnit.cssSelector} { color: ${symbolIconUnitColor}; }`);\r\n    }\r\n    const symbolIconVariableColor = theme.getColor(SYMBOL_ICON_VARIABLE_FOREGROUND);\r\n    if (symbolIconVariableColor) {\r\n        collector.addRule(`${Codicon.symbolVariable.cssSelector} { color: ${symbolIconVariableColor}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Event, Emitter } from '../../../base/common/event.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Dimension } from '../../../base/browser/dom.js';\r\nimport { OrthogonalEdge, Sash } from '../../../base/browser/ui/sash/sash.js';\r\nexport class ResizableHTMLElement {\r\n    constructor() {\r\n        this._onDidWillResize = new Emitter();\r\n        this.onDidWillResize = this._onDidWillResize.event;\r\n        this._onDidResize = new Emitter();\r\n        this.onDidResize = this._onDidResize.event;\r\n        this._sashListener = new DisposableStore();\r\n        this._size = new Dimension(0, 0);\r\n        this._minSize = new Dimension(0, 0);\r\n        this._maxSize = new Dimension(Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER);\r\n        this.domNode = document.createElement('div');\r\n        this._eastSash = new Sash(this.domNode, { getVerticalSashLeft: () => this._size.width }, { orientation: 0 /* VERTICAL */ });\r\n        this._westSash = new Sash(this.domNode, { getVerticalSashLeft: () => 0 }, { orientation: 0 /* VERTICAL */ });\r\n        this._northSash = new Sash(this.domNode, { getHorizontalSashTop: () => 0 }, { orientation: 1 /* HORIZONTAL */, orthogonalEdge: OrthogonalEdge.North });\r\n        this._southSash = new Sash(this.domNode, { getHorizontalSashTop: () => this._size.height }, { orientation: 1 /* HORIZONTAL */, orthogonalEdge: OrthogonalEdge.South });\r\n        this._northSash.orthogonalStartSash = this._westSash;\r\n        this._northSash.orthogonalEndSash = this._eastSash;\r\n        this._southSash.orthogonalStartSash = this._westSash;\r\n        this._southSash.orthogonalEndSash = this._eastSash;\r\n        let currentSize;\r\n        let deltaY = 0;\r\n        let deltaX = 0;\r\n        this._sashListener.add(Event.any(this._northSash.onDidStart, this._eastSash.onDidStart, this._southSash.onDidStart, this._westSash.onDidStart)(() => {\r\n            if (currentSize === undefined) {\r\n                this._onDidWillResize.fire();\r\n                currentSize = this._size;\r\n                deltaY = 0;\r\n                deltaX = 0;\r\n            }\r\n        }));\r\n        this._sashListener.add(Event.any(this._northSash.onDidEnd, this._eastSash.onDidEnd, this._southSash.onDidEnd, this._westSash.onDidEnd)(() => {\r\n            if (currentSize !== undefined) {\r\n                currentSize = undefined;\r\n                deltaY = 0;\r\n                deltaX = 0;\r\n                this._onDidResize.fire({ dimension: this._size, done: true });\r\n            }\r\n        }));\r\n        this._sashListener.add(this._eastSash.onDidChange(e => {\r\n            if (currentSize) {\r\n                deltaX = e.currentX - e.startX;\r\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\r\n                this._onDidResize.fire({ dimension: this._size, done: false, east: true });\r\n            }\r\n        }));\r\n        this._sashListener.add(this._westSash.onDidChange(e => {\r\n            if (currentSize) {\r\n                deltaX = -(e.currentX - e.startX);\r\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\r\n                this._onDidResize.fire({ dimension: this._size, done: false, west: true });\r\n            }\r\n        }));\r\n        this._sashListener.add(this._northSash.onDidChange(e => {\r\n            if (currentSize) {\r\n                deltaY = -(e.currentY - e.startY);\r\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\r\n                this._onDidResize.fire({ dimension: this._size, done: false, north: true });\r\n            }\r\n        }));\r\n        this._sashListener.add(this._southSash.onDidChange(e => {\r\n            if (currentSize) {\r\n                deltaY = e.currentY - e.startY;\r\n                this.layout(currentSize.height + deltaY, currentSize.width + deltaX);\r\n                this._onDidResize.fire({ dimension: this._size, done: false, south: true });\r\n            }\r\n        }));\r\n        this._sashListener.add(Event.any(this._eastSash.onDidReset, this._westSash.onDidReset)(e => {\r\n            if (this._preferredSize) {\r\n                this.layout(this._size.height, this._preferredSize.width);\r\n                this._onDidResize.fire({ dimension: this._size, done: true });\r\n            }\r\n        }));\r\n        this._sashListener.add(Event.any(this._northSash.onDidReset, this._southSash.onDidReset)(e => {\r\n            if (this._preferredSize) {\r\n                this.layout(this._preferredSize.height, this._size.width);\r\n                this._onDidResize.fire({ dimension: this._size, done: true });\r\n            }\r\n        }));\r\n    }\r\n    dispose() {\r\n        this._northSash.dispose();\r\n        this._southSash.dispose();\r\n        this._eastSash.dispose();\r\n        this._westSash.dispose();\r\n        this._sashListener.dispose();\r\n        this._onDidResize.dispose();\r\n        this._onDidWillResize.dispose();\r\n        this.domNode.remove();\r\n    }\r\n    enableSashes(north, east, south, west) {\r\n        this._northSash.state = north ? 3 /* Enabled */ : 0 /* Disabled */;\r\n        this._eastSash.state = east ? 3 /* Enabled */ : 0 /* Disabled */;\r\n        this._southSash.state = south ? 3 /* Enabled */ : 0 /* Disabled */;\r\n        this._westSash.state = west ? 3 /* Enabled */ : 0 /* Disabled */;\r\n    }\r\n    layout(height = this.size.height, width = this.size.width) {\r\n        const { height: minHeight, width: minWidth } = this._minSize;\r\n        const { height: maxHeight, width: maxWidth } = this._maxSize;\r\n        height = Math.max(minHeight, Math.min(maxHeight, height));\r\n        width = Math.max(minWidth, Math.min(maxWidth, width));\r\n        const newSize = new Dimension(width, height);\r\n        if (!Dimension.equals(newSize, this._size)) {\r\n            this.domNode.style.height = height + 'px';\r\n            this.domNode.style.width = width + 'px';\r\n            this._size = newSize;\r\n            this._northSash.layout();\r\n            this._eastSash.layout();\r\n            this._southSash.layout();\r\n            this._westSash.layout();\r\n        }\r\n    }\r\n    clearSashHoverState() {\r\n        this._eastSash.clearSashHoverState();\r\n        this._westSash.clearSashHoverState();\r\n        this._northSash.clearSashHoverState();\r\n        this._southSash.clearSashHoverState();\r\n    }\r\n    get size() {\r\n        return this._size;\r\n    }\r\n    set maxSize(value) {\r\n        this._maxSize = value;\r\n    }\r\n    get maxSize() {\r\n        return this._maxSize;\r\n    }\r\n    set minSize(value) {\r\n        this._minSize = value;\r\n    }\r\n    get minSize() {\r\n        return this._minSize;\r\n    }\r\n    set preferredSize(value) {\r\n        this._preferredSize = value;\r\n    }\r\n    get preferredSize() {\r\n        return this._preferredSize;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { MarkdownRenderer } from '../../browser/core/markdownRenderer.js';\r\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { ResizableHTMLElement } from './resizable.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nexport function canExpandCompletionItem(item) {\r\n    return !!item && Boolean(item.completion.documentation || item.completion.detail && item.completion.detail !== item.completion.label);\r\n}\r\nlet SuggestDetailsWidget = class SuggestDetailsWidget {\r\n    constructor(_editor, instaService) {\r\n        this._editor = _editor;\r\n        this._onDidClose = new Emitter();\r\n        this.onDidClose = this._onDidClose.event;\r\n        this._onDidChangeContents = new Emitter();\r\n        this.onDidChangeContents = this._onDidChangeContents.event;\r\n        this._disposables = new DisposableStore();\r\n        this._renderDisposeable = new DisposableStore();\r\n        this._borderWidth = 1;\r\n        this._size = new dom.Dimension(330, 0);\r\n        this.domNode = dom.$('.suggest-details');\r\n        this.domNode.classList.add('no-docs');\r\n        this._markdownRenderer = instaService.createInstance(MarkdownRenderer, { editor: _editor });\r\n        this._body = dom.$('.body');\r\n        this._scrollbar = new DomScrollableElement(this._body, {});\r\n        dom.append(this.domNode, this._scrollbar.getDomNode());\r\n        this._disposables.add(this._scrollbar);\r\n        this._header = dom.append(this._body, dom.$('.header'));\r\n        this._close = dom.append(this._header, dom.$('span' + Codicon.close.cssSelector));\r\n        this._close.title = nls.localize('details.close', \"Close\");\r\n        this._type = dom.append(this._header, dom.$('p.type'));\r\n        this._docs = dom.append(this._body, dom.$('p.docs'));\r\n        this._configureFont();\r\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\r\n            if (e.hasChanged(41 /* fontInfo */)) {\r\n                this._configureFont();\r\n            }\r\n        }));\r\n    }\r\n    dispose() {\r\n        this._disposables.dispose();\r\n        this._renderDisposeable.dispose();\r\n    }\r\n    _configureFont() {\r\n        const options = this._editor.getOptions();\r\n        const fontInfo = options.get(41 /* fontInfo */);\r\n        const fontFamily = fontInfo.fontFamily;\r\n        const fontSize = options.get(106 /* suggestFontSize */) || fontInfo.fontSize;\r\n        const lineHeight = options.get(107 /* suggestLineHeight */) || fontInfo.lineHeight;\r\n        const fontWeight = fontInfo.fontWeight;\r\n        const fontSizePx = `${fontSize}px`;\r\n        const lineHeightPx = `${lineHeight}px`;\r\n        this.domNode.style.fontSize = fontSizePx;\r\n        this.domNode.style.lineHeight = lineHeightPx;\r\n        this.domNode.style.fontWeight = fontWeight;\r\n        this.domNode.style.fontFeatureSettings = fontInfo.fontFeatureSettings;\r\n        this._type.style.fontFamily = fontFamily;\r\n        this._close.style.height = lineHeightPx;\r\n        this._close.style.width = lineHeightPx;\r\n    }\r\n    getLayoutInfo() {\r\n        const lineHeight = this._editor.getOption(107 /* suggestLineHeight */) || this._editor.getOption(41 /* fontInfo */).lineHeight;\r\n        const borderWidth = this._borderWidth;\r\n        const borderHeight = borderWidth * 2;\r\n        return {\r\n            lineHeight,\r\n            borderWidth,\r\n            borderHeight,\r\n            verticalPadding: 22,\r\n            horizontalPadding: 14\r\n        };\r\n    }\r\n    renderLoading() {\r\n        this._type.textContent = nls.localize('loading', \"Loading...\");\r\n        this._docs.textContent = '';\r\n        this.domNode.classList.remove('no-docs', 'no-type');\r\n        this.layout(this.size.width, this.getLayoutInfo().lineHeight * 2);\r\n        this._onDidChangeContents.fire(this);\r\n    }\r\n    renderItem(item, explainMode) {\r\n        var _a, _b;\r\n        this._renderDisposeable.clear();\r\n        let { detail, documentation } = item.completion;\r\n        if (explainMode) {\r\n            let md = '';\r\n            md += `score: ${item.score[0]}\\n`;\r\n            md += `prefix: ${(_a = item.word) !== null && _a !== void 0 ? _a : '(no prefix)'}\\n`;\r\n            md += `word: ${item.completion.filterText ? item.completion.filterText + ' (filterText)' : item.textLabel}\\n`;\r\n            md += `distance: ${item.distance} (localityBonus-setting)\\n`;\r\n            md += `index: ${item.idx}, based on ${item.completion.sortText && `sortText: \"${item.completion.sortText}\"` || 'label'}\\n`;\r\n            md += `commit_chars: ${(_b = item.completion.commitCharacters) === null || _b === void 0 ? void 0 : _b.join('')}\\n`;\r\n            documentation = new MarkdownString().appendCodeblock('empty', md);\r\n            detail = `Provider: ${item.provider._debugDisplayName}`;\r\n        }\r\n        if (!explainMode && !canExpandCompletionItem(item)) {\r\n            this.clearContents();\r\n            return;\r\n        }\r\n        this.domNode.classList.remove('no-docs', 'no-type');\r\n        // --- details\r\n        if (detail) {\r\n            const cappedDetail = detail.length > 100000 ? `${detail.substr(0, 100000)}\u2026` : detail;\r\n            this._type.textContent = cappedDetail;\r\n            this._type.title = cappedDetail;\r\n            dom.show(this._type);\r\n            this._type.classList.toggle('auto-wrap', !/\\r?\\n^\\s+/gmi.test(cappedDetail));\r\n        }\r\n        else {\r\n            dom.clearNode(this._type);\r\n            this._type.title = '';\r\n            dom.hide(this._type);\r\n            this.domNode.classList.add('no-type');\r\n        }\r\n        // --- documentation\r\n        dom.clearNode(this._docs);\r\n        if (typeof documentation === 'string') {\r\n            this._docs.classList.remove('markdown-docs');\r\n            this._docs.textContent = documentation;\r\n        }\r\n        else if (documentation) {\r\n            this._docs.classList.add('markdown-docs');\r\n            dom.clearNode(this._docs);\r\n            const renderedContents = this._markdownRenderer.render(documentation);\r\n            this._docs.appendChild(renderedContents.element);\r\n            this._renderDisposeable.add(renderedContents);\r\n            this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(() => {\r\n                this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\r\n                this._onDidChangeContents.fire(this);\r\n            }));\r\n        }\r\n        this.domNode.style.userSelect = 'text';\r\n        this.domNode.tabIndex = -1;\r\n        this._close.onmousedown = e => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        };\r\n        this._close.onclick = e => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this._onDidClose.fire();\r\n        };\r\n        this._body.scrollTop = 0;\r\n        this.layout(this._size.width, this._type.clientHeight + this._docs.clientHeight);\r\n        this._onDidChangeContents.fire(this);\r\n    }\r\n    clearContents() {\r\n        this.domNode.classList.add('no-docs');\r\n        this._type.textContent = '';\r\n        this._docs.textContent = '';\r\n    }\r\n    get size() {\r\n        return this._size;\r\n    }\r\n    layout(width, height) {\r\n        const newSize = new dom.Dimension(width, height);\r\n        if (!dom.Dimension.equals(newSize, this._size)) {\r\n            this._size = newSize;\r\n            dom.size(this.domNode, width, height);\r\n        }\r\n        this._scrollbar.scanDomNode();\r\n    }\r\n    scrollDown(much = 8) {\r\n        this._body.scrollTop += much;\r\n    }\r\n    scrollUp(much = 8) {\r\n        this._body.scrollTop -= much;\r\n    }\r\n    scrollTop() {\r\n        this._body.scrollTop = 0;\r\n    }\r\n    scrollBottom() {\r\n        this._body.scrollTop = this._body.scrollHeight;\r\n    }\r\n    pageDown() {\r\n        this.scrollDown(80);\r\n    }\r\n    pageUp() {\r\n        this.scrollUp(80);\r\n    }\r\n    set borderWidth(width) {\r\n        this._borderWidth = width;\r\n    }\r\n    get borderWidth() {\r\n        return this._borderWidth;\r\n    }\r\n};\r\nSuggestDetailsWidget = __decorate([\r\n    __param(1, IInstantiationService)\r\n], SuggestDetailsWidget);\r\nexport { SuggestDetailsWidget };\r\nexport class SuggestDetailsOverlay {\r\n    constructor(widget, _editor) {\r\n        this.widget = widget;\r\n        this._editor = _editor;\r\n        this._disposables = new DisposableStore();\r\n        this._added = false;\r\n        this._resizable = new ResizableHTMLElement();\r\n        this._resizable.domNode.classList.add('suggest-details-container');\r\n        this._resizable.domNode.appendChild(widget.domNode);\r\n        this._resizable.enableSashes(false, true, true, false);\r\n        let topLeftNow;\r\n        let sizeNow;\r\n        let deltaTop = 0;\r\n        let deltaLeft = 0;\r\n        this._disposables.add(this._resizable.onDidWillResize(() => {\r\n            topLeftNow = this._topLeft;\r\n            sizeNow = this._resizable.size;\r\n        }));\r\n        this._disposables.add(this._resizable.onDidResize(e => {\r\n            if (topLeftNow && sizeNow) {\r\n                this.widget.layout(e.dimension.width, e.dimension.height);\r\n                let updateTopLeft = false;\r\n                if (e.west) {\r\n                    deltaLeft = sizeNow.width - e.dimension.width;\r\n                    updateTopLeft = true;\r\n                }\r\n                if (e.north) {\r\n                    deltaTop = sizeNow.height - e.dimension.height;\r\n                    updateTopLeft = true;\r\n                }\r\n                if (updateTopLeft) {\r\n                    this._applyTopLeft({\r\n                        top: topLeftNow.top + deltaTop,\r\n                        left: topLeftNow.left + deltaLeft,\r\n                    });\r\n                }\r\n            }\r\n            if (e.done) {\r\n                topLeftNow = undefined;\r\n                sizeNow = undefined;\r\n                deltaTop = 0;\r\n                deltaLeft = 0;\r\n                this._userSize = e.dimension;\r\n            }\r\n        }));\r\n        this._disposables.add(this.widget.onDidChangeContents(() => {\r\n            var _a;\r\n            if (this._anchorBox) {\r\n                this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size);\r\n            }\r\n        }));\r\n    }\r\n    dispose() {\r\n        this._resizable.dispose();\r\n        this._disposables.dispose();\r\n        this.hide();\r\n    }\r\n    getId() {\r\n        return 'suggest.details';\r\n    }\r\n    getDomNode() {\r\n        return this._resizable.domNode;\r\n    }\r\n    getPosition() {\r\n        return null;\r\n    }\r\n    show() {\r\n        if (!this._added) {\r\n            this._editor.addOverlayWidget(this);\r\n            this.getDomNode().style.position = 'fixed';\r\n            this._added = true;\r\n        }\r\n    }\r\n    hide(sessionEnded = false) {\r\n        this._resizable.clearSashHoverState();\r\n        if (this._added) {\r\n            this._editor.removeOverlayWidget(this);\r\n            this._added = false;\r\n            this._anchorBox = undefined;\r\n            this._topLeft = undefined;\r\n        }\r\n        if (sessionEnded) {\r\n            this._userSize = undefined;\r\n            this.widget.clearContents();\r\n        }\r\n    }\r\n    placeAtAnchor(anchor) {\r\n        var _a;\r\n        const anchorBox = dom.getDomNodePagePosition(anchor);\r\n        this._anchorBox = anchorBox;\r\n        this._placeAtAnchor(this._anchorBox, (_a = this._userSize) !== null && _a !== void 0 ? _a : this.widget.size);\r\n    }\r\n    _placeAtAnchor(anchorBox, size) {\r\n        const bodyBox = dom.getClientArea(document.body);\r\n        const info = this.widget.getLayoutInfo();\r\n        let maxSizeTop;\r\n        let maxSizeBottom;\r\n        let minSize = new dom.Dimension(220, 2 * info.lineHeight);\r\n        let left = 0;\r\n        let top = anchorBox.top;\r\n        let bottom = anchorBox.top + anchorBox.height - info.borderHeight;\r\n        let alignAtTop;\r\n        let alignEast;\r\n        // position: EAST, west, south\r\n        let width = bodyBox.width - (anchorBox.left + anchorBox.width + info.borderWidth + info.horizontalPadding);\r\n        left = -info.borderWidth + anchorBox.left + anchorBox.width;\r\n        alignEast = true;\r\n        maxSizeTop = new dom.Dimension(width, bodyBox.height - anchorBox.top - info.borderHeight - info.verticalPadding);\r\n        maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top + anchorBox.height - info.borderHeight - info.verticalPadding);\r\n        // find a better place if the widget is wider than there is space available\r\n        if (size.width > width) {\r\n            // position: east, WEST, south\r\n            if (anchorBox.left > width) {\r\n                // pos = SuggestDetailsPosition.West;\r\n                width = anchorBox.left - info.borderWidth - info.horizontalPadding;\r\n                alignEast = false;\r\n                left = Math.max(info.horizontalPadding, anchorBox.left - size.width - info.borderWidth);\r\n                maxSizeTop = maxSizeTop.with(width);\r\n                maxSizeBottom = maxSizeTop.with(undefined, maxSizeBottom.height);\r\n            }\r\n            // position: east, west, SOUTH\r\n            if (anchorBox.width > width * 1.3 && bodyBox.height - (anchorBox.top + anchorBox.height) > anchorBox.height) {\r\n                width = anchorBox.width;\r\n                left = anchorBox.left;\r\n                top = -info.borderWidth + anchorBox.top + anchorBox.height;\r\n                maxSizeTop = new dom.Dimension(anchorBox.width - info.borderHeight, bodyBox.height - anchorBox.top - anchorBox.height - info.verticalPadding);\r\n                maxSizeBottom = maxSizeTop.with(undefined, anchorBox.top - info.verticalPadding);\r\n                minSize = minSize.with(maxSizeTop.width);\r\n            }\r\n        }\r\n        // top/bottom placement\r\n        let height = size.height;\r\n        let maxHeight = Math.max(maxSizeTop.height, maxSizeBottom.height);\r\n        if (height > maxHeight) {\r\n            height = maxHeight;\r\n        }\r\n        let maxSize;\r\n        if (height <= maxSizeTop.height) {\r\n            alignAtTop = true;\r\n            maxSize = maxSizeTop;\r\n        }\r\n        else {\r\n            alignAtTop = false;\r\n            maxSize = maxSizeBottom;\r\n        }\r\n        this._applyTopLeft({ left, top: alignAtTop ? top : bottom - height });\r\n        this.getDomNode().style.position = 'fixed';\r\n        this._resizable.enableSashes(!alignAtTop, alignEast, alignAtTop, !alignEast);\r\n        this._resizable.minSize = minSize;\r\n        this._resizable.maxSize = maxSize;\r\n        this._resizable.layout(height, Math.min(maxSize.width, size.width));\r\n        this.widget.layout(this._resizable.size.width, this._resizable.size.height);\r\n    }\r\n    _applyTopLeft(topLeft) {\r\n        this._topLeft = topLeft;\r\n        this.getDomNode().style.left = `${this._topLeft.left}px`;\r\n        this.getDomNode().style.top = `${this._topLeft.top}px`;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { ActionBar } from '../../../base/browser/ui/actionbar/actionbar.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { suggestWidgetStatusbarMenu } from './suggest.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { MenuEntryActionViewItem } from '../../../platform/actions/browser/menuEntryActionViewItem.js';\r\nimport { IMenuService, MenuItemAction } from '../../../platform/actions/common/actions.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nclass StatusBarViewItem extends MenuEntryActionViewItem {\r\n    updateLabel() {\r\n        const kb = this._keybindingService.lookupKeybinding(this._action.id, this._contextKeyService);\r\n        if (!kb) {\r\n            return super.updateLabel();\r\n        }\r\n        if (this.label) {\r\n            this.label.textContent = localize('ddd', '{0} ({1})', this._action.label, StatusBarViewItem.symbolPrintEnter(kb));\r\n        }\r\n    }\r\n    static symbolPrintEnter(kb) {\r\n        var _a;\r\n        return (_a = kb.getLabel()) === null || _a === void 0 ? void 0 : _a.replace(/\\benter\\b/gi, '\\u23CE');\r\n    }\r\n}\r\nlet SuggestWidgetStatus = class SuggestWidgetStatus {\r\n    constructor(container, instantiationService, _menuService, _contextKeyService) {\r\n        this._menuService = _menuService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._menuDisposables = new DisposableStore();\r\n        this.element = dom.append(container, dom.$('.suggest-status-bar'));\r\n        const actionViewItemProvider = (action => {\r\n            return action instanceof MenuItemAction ? instantiationService.createInstance(StatusBarViewItem, action, undefined) : undefined;\r\n        });\r\n        this._leftActions = new ActionBar(this.element, { actionViewItemProvider });\r\n        this._rightActions = new ActionBar(this.element, { actionViewItemProvider });\r\n        this._leftActions.domNode.classList.add('left');\r\n        this._rightActions.domNode.classList.add('right');\r\n    }\r\n    dispose() {\r\n        this._menuDisposables.dispose();\r\n        this.element.remove();\r\n    }\r\n    show() {\r\n        const menu = this._menuService.createMenu(suggestWidgetStatusbarMenu, this._contextKeyService);\r\n        const renderMenu = () => {\r\n            const left = [];\r\n            const right = [];\r\n            for (let [group, actions] of menu.getActions()) {\r\n                if (group === 'left') {\r\n                    left.push(...actions);\r\n                }\r\n                else {\r\n                    right.push(...actions);\r\n                }\r\n            }\r\n            this._leftActions.clear();\r\n            this._leftActions.push(left);\r\n            this._rightActions.clear();\r\n            this._rightActions.push(right);\r\n        };\r\n        this._menuDisposables.add(menu.onDidChange(() => renderMenu()));\r\n        this._menuDisposables.add(menu);\r\n    }\r\n    hide() {\r\n        this._menuDisposables.clear();\r\n    }\r\n};\r\nSuggestWidgetStatus = __decorate([\r\n    __param(1, IInstantiationService),\r\n    __param(2, IMenuService),\r\n    __param(3, IContextKeyService)\r\n], SuggestWidgetStatus);\r\nexport { SuggestWidgetStatus };\r\n", "//#endregion\r\n//#region Utilities\r\nexport var FileKind;\r\n(function (FileKind) {\r\n    FileKind[FileKind[\"FILE\"] = 0] = \"FILE\";\r\n    FileKind[FileKind[\"FOLDER\"] = 1] = \"FOLDER\";\r\n    FileKind[FileKind[\"ROOT_FOLDER\"] = 2] = \"ROOT_FOLDER\";\r\n})(FileKind || (FileKind = {}));\r\n//#endregion\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport { DataUri, basenameOrAuthority } from '../../../base/common/resources.js';\r\nimport { PLAINTEXT_MODE_ID } from '../modes/modesRegistry.js';\r\nimport { FileKind } from '../../../platform/files/common/files.js';\r\nexport function getIconClasses(modelService, modeService, resource, fileKind) {\r\n    // we always set these base classes even if we do not have a path\r\n    const classes = fileKind === FileKind.ROOT_FOLDER ? ['rootfolder-icon'] : fileKind === FileKind.FOLDER ? ['folder-icon'] : ['file-icon'];\r\n    if (resource) {\r\n        // Get the path and name of the resource. For data-URIs, we need to parse specially\r\n        let name;\r\n        if (resource.scheme === Schemas.data) {\r\n            const metadata = DataUri.parseMetaData(resource);\r\n            name = metadata.get(DataUri.META_DATA_LABEL);\r\n        }\r\n        else {\r\n            name = cssEscape(basenameOrAuthority(resource).toLowerCase());\r\n        }\r\n        // Folders\r\n        if (fileKind === FileKind.FOLDER) {\r\n            classes.push(`${name}-name-folder-icon`);\r\n        }\r\n        // Files\r\n        else {\r\n            // Name & Extension(s)\r\n            if (name) {\r\n                classes.push(`${name}-name-file-icon`);\r\n                // Avoid doing an explosive combination of extensions for very long filenames\r\n                // (most file systems do not allow files > 255 length) with lots of `.` characters\r\n                // https://github.com/microsoft/vscode/issues/116199\r\n                if (name.length <= 255) {\r\n                    const dotSegments = name.split('.');\r\n                    for (let i = 1; i < dotSegments.length; i++) {\r\n                        classes.push(`${dotSegments.slice(i).join('.')}-ext-file-icon`); // add each combination of all found extensions if more than one\r\n                    }\r\n                }\r\n                classes.push(`ext-file-icon`); // extra segment to increase file-ext score\r\n            }\r\n            // Detected Mode\r\n            const detectedModeId = detectModeId(modelService, modeService, resource);\r\n            if (detectedModeId) {\r\n                classes.push(`${cssEscape(detectedModeId)}-lang-file-icon`);\r\n            }\r\n        }\r\n    }\r\n    return classes;\r\n}\r\nexport function detectModeId(modelService, modeService, resource) {\r\n    if (!resource) {\r\n        return null; // we need a resource at least\r\n    }\r\n    let modeId = null;\r\n    // Data URI: check for encoded metadata\r\n    if (resource.scheme === Schemas.data) {\r\n        const metadata = DataUri.parseMetaData(resource);\r\n        const mime = metadata.get(DataUri.META_DATA_MIME);\r\n        if (mime) {\r\n            modeId = modeService.getModeId(mime);\r\n        }\r\n    }\r\n    // Any other URI: check for model if existing\r\n    else {\r\n        const model = modelService.getModel(resource);\r\n        if (model) {\r\n            modeId = model.getModeId();\r\n        }\r\n    }\r\n    // only take if the mode is specific (aka no just plain text)\r\n    if (modeId && modeId !== PLAINTEXT_MODE_ID) {\r\n        return modeId;\r\n    }\r\n    // otherwise fallback to path based detection\r\n    return modeService.getModeIdByFilepathOrFirstLine(resource);\r\n}\r\nexport function cssEscape(str) {\r\n    return str.replace(/[\\11\\12\\14\\15\\40]/g, '/'); // HTML class names can not contain certain whitespace characters, use / instead, which doesn't exist in file names.\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar _a;\r\nimport * as nls from '../../../nls.js';\r\nimport { createMatches } from '../../../base/common/filters.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { append, $, hide, show } from '../../../base/browser/dom.js';\r\nimport { IThemeService, ThemeIcon } from '../../../platform/theme/common/themeService.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { completionKindToCssClass } from '../../common/modes.js';\r\nimport { IconLabel } from '../../../base/browser/ui/iconLabel/iconLabel.js';\r\nimport { getIconClasses } from '../../common/services/getIconClasses.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { FileKind } from '../../../platform/files/common/files.js';\r\nimport { flatten } from '../../../base/common/arrays.js';\r\nimport { canExpandCompletionItem } from './suggestWidgetDetails.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { registerIcon } from '../../../platform/theme/common/iconRegistry.js';\r\nexport function getAriaId(index) {\r\n    return `suggest-aria-id:${index}`;\r\n}\r\nexport const suggestMoreInfoIcon = registerIcon('suggest-more-info', Codicon.chevronRight, nls.localize('suggestMoreInfoIcon', 'Icon for more information in the suggest widget.'));\r\nconst _completionItemColor = new (_a = class ColorExtractor {\r\n        extract(item, out) {\r\n            if (item.textLabel.match(ColorExtractor._regexStrict)) {\r\n                out[0] = item.textLabel;\r\n                return true;\r\n            }\r\n            if (item.completion.detail && item.completion.detail.match(ColorExtractor._regexStrict)) {\r\n                out[0] = item.completion.detail;\r\n                return true;\r\n            }\r\n            if (typeof item.completion.documentation === 'string') {\r\n                const match = ColorExtractor._regexRelaxed.exec(item.completion.documentation);\r\n                if (match && (match.index === 0 || match.index + match[0].length === item.completion.documentation.length)) {\r\n                    out[0] = match[0];\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n    },\r\n    _a._regexRelaxed = /(#([\\da-fA-F]{3}){1,2}|(rgb|hsl)a\\(\\s*(\\d{1,3}%?\\s*,\\s*){3}(1|0?\\.\\d+)\\)|(rgb|hsl)\\(\\s*\\d{1,3}%?(\\s*,\\s*\\d{1,3}%?){2}\\s*\\))/,\r\n    _a._regexStrict = new RegExp(`^${_a._regexRelaxed.source}$`, 'i'),\r\n    _a);\r\nlet ItemRenderer = class ItemRenderer {\r\n    constructor(_editor, _modelService, _modeService, _themeService) {\r\n        this._editor = _editor;\r\n        this._modelService = _modelService;\r\n        this._modeService = _modeService;\r\n        this._themeService = _themeService;\r\n        this._onDidToggleDetails = new Emitter();\r\n        this.onDidToggleDetails = this._onDidToggleDetails.event;\r\n        this.templateId = 'suggestion';\r\n    }\r\n    dispose() {\r\n        this._onDidToggleDetails.dispose();\r\n    }\r\n    renderTemplate(container) {\r\n        const data = Object.create(null);\r\n        data.disposables = new DisposableStore();\r\n        data.root = container;\r\n        data.root.classList.add('show-file-icons');\r\n        data.icon = append(container, $('.icon'));\r\n        data.colorspan = append(data.icon, $('span.colorspan'));\r\n        const text = append(container, $('.contents'));\r\n        const main = append(text, $('.main'));\r\n        data.iconContainer = append(main, $('.icon-label.codicon'));\r\n        data.left = append(main, $('span.left'));\r\n        data.right = append(main, $('span.right'));\r\n        data.iconLabel = new IconLabel(data.left, { supportHighlights: true, supportIcons: true });\r\n        data.disposables.add(data.iconLabel);\r\n        data.parametersLabel = append(data.left, $('span.signature-label'));\r\n        data.qualifierLabel = append(data.left, $('span.qualifier-label'));\r\n        data.detailsLabel = append(data.right, $('span.details-label'));\r\n        data.readMore = append(data.right, $('span.readMore' + ThemeIcon.asCSSSelector(suggestMoreInfoIcon)));\r\n        data.readMore.title = nls.localize('readMore', \"Read More\");\r\n        const configureFont = () => {\r\n            const options = this._editor.getOptions();\r\n            const fontInfo = options.get(41 /* fontInfo */);\r\n            const fontFamily = fontInfo.fontFamily;\r\n            const fontFeatureSettings = fontInfo.fontFeatureSettings;\r\n            const fontSize = options.get(106 /* suggestFontSize */) || fontInfo.fontSize;\r\n            const lineHeight = options.get(107 /* suggestLineHeight */) || fontInfo.lineHeight;\r\n            const fontWeight = fontInfo.fontWeight;\r\n            const fontSizePx = `${fontSize}px`;\r\n            const lineHeightPx = `${lineHeight}px`;\r\n            data.root.style.fontSize = fontSizePx;\r\n            data.root.style.fontWeight = fontWeight;\r\n            main.style.fontFamily = fontFamily;\r\n            main.style.fontFeatureSettings = fontFeatureSettings;\r\n            main.style.lineHeight = lineHeightPx;\r\n            data.icon.style.height = lineHeightPx;\r\n            data.icon.style.width = lineHeightPx;\r\n            data.readMore.style.height = lineHeightPx;\r\n            data.readMore.style.width = lineHeightPx;\r\n        };\r\n        configureFont();\r\n        data.disposables.add(this._editor.onDidChangeConfiguration(e => {\r\n            if (e.hasChanged(41 /* fontInfo */) || e.hasChanged(106 /* suggestFontSize */) || e.hasChanged(107 /* suggestLineHeight */)) {\r\n                configureFont();\r\n            }\r\n        }));\r\n        return data;\r\n    }\r\n    renderElement(element, index, data) {\r\n        const { completion } = element;\r\n        data.root.id = getAriaId(index);\r\n        data.colorspan.style.backgroundColor = '';\r\n        const labelOptions = {\r\n            labelEscapeNewLines: true,\r\n            matches: createMatches(element.score)\r\n        };\r\n        let color = [];\r\n        if (completion.kind === 19 /* Color */ && _completionItemColor.extract(element, color)) {\r\n            // special logic for 'color' completion items\r\n            data.icon.className = 'icon customcolor';\r\n            data.iconContainer.className = 'icon hide';\r\n            data.colorspan.style.backgroundColor = color[0];\r\n        }\r\n        else if (completion.kind === 20 /* File */ && this._themeService.getFileIconTheme().hasFileIcons) {\r\n            // special logic for 'file' completion items\r\n            data.icon.className = 'icon hide';\r\n            data.iconContainer.className = 'icon hide';\r\n            const labelClasses = getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FILE);\r\n            const detailClasses = getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FILE);\r\n            labelOptions.extraClasses = labelClasses.length > detailClasses.length ? labelClasses : detailClasses;\r\n        }\r\n        else if (completion.kind === 23 /* Folder */ && this._themeService.getFileIconTheme().hasFolderIcons) {\r\n            // special logic for 'folder' completion items\r\n            data.icon.className = 'icon hide';\r\n            data.iconContainer.className = 'icon hide';\r\n            labelOptions.extraClasses = flatten([\r\n                getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: element.textLabel }), FileKind.FOLDER),\r\n                getIconClasses(this._modelService, this._modeService, URI.from({ scheme: 'fake', path: completion.detail }), FileKind.FOLDER)\r\n            ]);\r\n        }\r\n        else {\r\n            // normal icon\r\n            data.icon.className = 'icon hide';\r\n            data.iconContainer.className = '';\r\n            data.iconContainer.classList.add('suggest-icon', ...completionKindToCssClass(completion.kind).split(' '));\r\n        }\r\n        if (completion.tags && completion.tags.indexOf(1 /* Deprecated */) >= 0) {\r\n            labelOptions.extraClasses = (labelOptions.extraClasses || []).concat(['deprecated']);\r\n            labelOptions.matches = [];\r\n        }\r\n        data.iconLabel.setLabel(element.textLabel, undefined, labelOptions);\r\n        if (typeof completion.label === 'string') {\r\n            data.parametersLabel.textContent = '';\r\n            data.detailsLabel.textContent = stripNewLines(completion.detail || '');\r\n            data.root.classList.add('string-label');\r\n        }\r\n        else {\r\n            data.parametersLabel.textContent = stripNewLines(completion.label.detail || '');\r\n            data.detailsLabel.textContent = stripNewLines(completion.label.description || '');\r\n            data.root.classList.remove('string-label');\r\n        }\r\n        if (this._editor.getOption(105 /* suggest */).showInlineDetails) {\r\n            show(data.detailsLabel);\r\n        }\r\n        else {\r\n            hide(data.detailsLabel);\r\n        }\r\n        if (canExpandCompletionItem(element)) {\r\n            data.right.classList.add('can-expand-details');\r\n            show(data.readMore);\r\n            data.readMore.onmousedown = e => {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n            };\r\n            data.readMore.onclick = e => {\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n                this._onDidToggleDetails.fire();\r\n            };\r\n        }\r\n        else {\r\n            data.right.classList.remove('can-expand-details');\r\n            hide(data.readMore);\r\n            data.readMore.onmousedown = null;\r\n            data.readMore.onclick = null;\r\n        }\r\n    }\r\n    disposeTemplate(templateData) {\r\n        templateData.disposables.dispose();\r\n    }\r\n};\r\nItemRenderer = __decorate([\r\n    __param(1, IModelService),\r\n    __param(2, IModeService),\r\n    __param(3, IThemeService)\r\n], ItemRenderer);\r\nexport { ItemRenderer };\r\nfunction stripNewLines(str) {\r\n    return str.replace(/\\r\\n|\\r|\\n/g, '');\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport './media/suggest.css';\r\nimport '../../../base/browser/ui/codicons/codiconStyles.js'; // The codicon symbol styles are defined here and must be loaded\r\nimport '../symbolIcons/symbolIcons.js'; // The codicon symbol colors are defined here and must be loaded to get colors\r\nimport * as nls from '../../../nls.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { List } from '../../../base/browser/ui/list/listWidget.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { Context as SuggestContext } from './suggest.js';\r\nimport { attachListStyler } from '../../../platform/theme/common/styler.js';\r\nimport { IThemeService, registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { registerColor, editorWidgetBackground, quickInputListFocusBackground, activeContrastBorder, listHighlightForeground, editorForeground, editorWidgetBorder, focusBorder, textLinkForeground, textCodeBlockBackground, quickInputListFocusForeground, listFocusHighlightForeground, quickInputListFocusIconForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IStorageService } from '../../../platform/storage/common/storage.js';\r\nimport { TimeoutTimer, createCancelablePromise, disposableTimeout } from '../../../base/common/async.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { SuggestDetailsWidget, canExpandCompletionItem, SuggestDetailsOverlay } from './suggestWidgetDetails.js';\r\nimport { SuggestWidgetStatus } from './suggestWidgetStatus.js';\r\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer.js';\r\nimport { ResizableHTMLElement } from './resizable.js';\r\nimport { EmbeddedCodeEditorWidget } from '../../browser/widget/embeddedCodeEditorWidget.js';\r\nimport { clamp } from '../../../base/common/numbers.js';\r\n/**\r\n * Suggest widget colors\r\n */\r\nexport const editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hc: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\r\nexport const editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hc: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\r\nexport const editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hc: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\r\nexport const editorSuggestWidgetSelectedForeground = registerColor('editorSuggestWidget.selectedForeground', { dark: quickInputListFocusForeground, light: quickInputListFocusForeground, hc: quickInputListFocusForeground }, nls.localize('editorSuggestWidgetSelectedForeground', 'Foreground color of the selected entry in the suggest widget.'));\r\nexport const editorSuggestWidgetSelectedIconForeground = registerColor('editorSuggestWidget.selectedIconForeground', { dark: quickInputListFocusIconForeground, light: quickInputListFocusIconForeground, hc: quickInputListFocusIconForeground }, nls.localize('editorSuggestWidgetSelectedIconForeground', 'Icon foreground color of the selected entry in the suggest widget.'));\r\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: quickInputListFocusBackground, light: quickInputListFocusBackground, hc: quickInputListFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\r\nexport const editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hc: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\r\nexport const editorSuggestWidgetHighlightFocusForeground = registerColor('editorSuggestWidget.focusHighlightForeground', { dark: listFocusHighlightForeground, light: listFocusHighlightForeground, hc: listFocusHighlightForeground }, nls.localize('editorSuggestWidgetFocusHighlightForeground', 'Color of the match highlights in the suggest widget when an item is focused.'));\r\nclass PersistedWidgetSize {\r\n    constructor(_service, editor) {\r\n        this._service = _service;\r\n        this._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\r\n    }\r\n    restore() {\r\n        var _a;\r\n        const raw = (_a = this._service.get(this._key, 0 /* GLOBAL */)) !== null && _a !== void 0 ? _a : '';\r\n        try {\r\n            const obj = JSON.parse(raw);\r\n            if (dom.Dimension.is(obj)) {\r\n                return dom.Dimension.lift(obj);\r\n            }\r\n        }\r\n        catch (_b) {\r\n            // ignore\r\n        }\r\n        return undefined;\r\n    }\r\n    store(size) {\r\n        this._service.store(this._key, JSON.stringify(size), 0 /* GLOBAL */, 1 /* MACHINE */);\r\n    }\r\n    reset() {\r\n        this._service.remove(this._key, 0 /* GLOBAL */);\r\n    }\r\n}\r\nlet SuggestWidget = class SuggestWidget {\r\n    constructor(editor, _storageService, _contextKeyService, _themeService, instantiationService) {\r\n        this.editor = editor;\r\n        this._storageService = _storageService;\r\n        this._state = 0 /* Hidden */;\r\n        this._isAuto = false;\r\n        this._ignoreFocusEvents = false;\r\n        this._forceRenderingAbove = false;\r\n        this._explainMode = false;\r\n        this._showTimeout = new TimeoutTimer();\r\n        this._disposables = new DisposableStore();\r\n        this._onDidSelect = new Emitter();\r\n        this._onDidFocus = new Emitter();\r\n        this._onDidHide = new Emitter();\r\n        this._onDidShow = new Emitter();\r\n        this.onDidSelect = this._onDidSelect.event;\r\n        this.onDidFocus = this._onDidFocus.event;\r\n        this.onDidHide = this._onDidHide.event;\r\n        this.onDidShow = this._onDidShow.event;\r\n        this._onDetailsKeydown = new Emitter();\r\n        this.onDetailsKeyDown = this._onDetailsKeydown.event;\r\n        this.element = new ResizableHTMLElement();\r\n        this.element.domNode.classList.add('editor-widget', 'suggest-widget');\r\n        this._contentWidget = new SuggestContentWidget(this, editor);\r\n        this._persistedSize = new PersistedWidgetSize(_storageService, editor);\r\n        class ResizeState {\r\n            constructor(persistedSize, currentSize, persistHeight = false, persistWidth = false) {\r\n                this.persistedSize = persistedSize;\r\n                this.currentSize = currentSize;\r\n                this.persistHeight = persistHeight;\r\n                this.persistWidth = persistWidth;\r\n            }\r\n        }\r\n        let state;\r\n        this._disposables.add(this.element.onDidWillResize(() => {\r\n            this._contentWidget.lockPreference();\r\n            state = new ResizeState(this._persistedSize.restore(), this.element.size);\r\n        }));\r\n        this._disposables.add(this.element.onDidResize(e => {\r\n            var _a, _b, _c, _d;\r\n            this._resize(e.dimension.width, e.dimension.height);\r\n            if (state) {\r\n                state.persistHeight = state.persistHeight || !!e.north || !!e.south;\r\n                state.persistWidth = state.persistWidth || !!e.east || !!e.west;\r\n            }\r\n            if (!e.done) {\r\n                return;\r\n            }\r\n            if (state) {\r\n                // only store width or height value that have changed and also\r\n                // only store changes that are above a certain threshold\r\n                const { itemHeight, defaultSize } = this.getLayoutInfo();\r\n                const threshold = Math.round(itemHeight / 2);\r\n                let { width, height } = this.element.size;\r\n                if (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\r\n                    height = (_b = (_a = state.persistedSize) === null || _a === void 0 ? void 0 : _a.height) !== null && _b !== void 0 ? _b : defaultSize.height;\r\n                }\r\n                if (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\r\n                    width = (_d = (_c = state.persistedSize) === null || _c === void 0 ? void 0 : _c.width) !== null && _d !== void 0 ? _d : defaultSize.width;\r\n                }\r\n                this._persistedSize.store(new dom.Dimension(width, height));\r\n            }\r\n            // reset working state\r\n            this._contentWidget.unlockPreference();\r\n            state = undefined;\r\n        }));\r\n        this._messageElement = dom.append(this.element.domNode, dom.$('.message'));\r\n        this._listElement = dom.append(this.element.domNode, dom.$('.tree'));\r\n        const details = instantiationService.createInstance(SuggestDetailsWidget, this.editor);\r\n        details.onDidClose(this.toggleDetails, this, this._disposables);\r\n        this._details = new SuggestDetailsOverlay(details, this.editor);\r\n        const applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(105 /* suggest */).showIcons);\r\n        applyIconStyle();\r\n        const renderer = instantiationService.createInstance(ItemRenderer, this.editor);\r\n        this._disposables.add(renderer);\r\n        this._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\r\n        this._list = new List('SuggestWidget', this._listElement, {\r\n            getHeight: (_element) => this.getLayoutInfo().itemHeight,\r\n            getTemplateId: (_element) => 'suggestion'\r\n        }, [renderer], {\r\n            alwaysConsumeMouseWheel: true,\r\n            useShadows: false,\r\n            mouseSupport: false,\r\n            accessibilityProvider: {\r\n                getRole: () => 'option',\r\n                getAriaLabel: (item) => {\r\n                    if (item.isResolved && this._isDetailsVisible()) {\r\n                        const { documentation, detail } = item.completion;\r\n                        const docs = strings.format('{0}{1}', detail || '', documentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\r\n                        return nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", item.textLabel, docs);\r\n                    }\r\n                    else {\r\n                        return item.textLabel;\r\n                    }\r\n                },\r\n                getWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\r\n                getWidgetRole: () => 'listbox'\r\n            }\r\n        });\r\n        this._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode);\r\n        const applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(105 /* suggest */).showStatusBar);\r\n        applyStatusBarStyle();\r\n        this._disposables.add(attachListStyler(this._list, _themeService, {\r\n            listInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\r\n            listInactiveFocusOutline: activeContrastBorder\r\n        }));\r\n        this._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\r\n        this._onThemeChange(_themeService.getColorTheme());\r\n        this._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\r\n        this._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\r\n        this._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\r\n        this._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\r\n        this._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\r\n        this._disposables.add(this.editor.onDidChangeConfiguration(e => {\r\n            if (e.hasChanged(105 /* suggest */)) {\r\n                applyStatusBarStyle();\r\n                applyIconStyle();\r\n            }\r\n        }));\r\n        this._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\r\n        this._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\r\n        this._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\r\n        this._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\r\n            this._onDetailsKeydown.fire(e);\r\n        }));\r\n        this._disposables.add(this.editor.onMouseDown((e) => this._onEditorMouseDown(e)));\r\n    }\r\n    dispose() {\r\n        var _a;\r\n        this._details.widget.dispose();\r\n        this._details.dispose();\r\n        this._list.dispose();\r\n        this._status.dispose();\r\n        this._disposables.dispose();\r\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        this._showTimeout.dispose();\r\n        this._contentWidget.dispose();\r\n        this.element.dispose();\r\n    }\r\n    _onEditorMouseDown(mouseEvent) {\r\n        if (this._details.widget.domNode.contains(mouseEvent.target.element)) {\r\n            // Clicking inside details\r\n            this._details.widget.domNode.focus();\r\n        }\r\n        else {\r\n            // Clicking outside details and inside suggest\r\n            if (this.element.domNode.contains(mouseEvent.target.element)) {\r\n                this.editor.focus();\r\n            }\r\n        }\r\n    }\r\n    _onCursorSelectionChanged() {\r\n        if (this._state !== 0 /* Hidden */) {\r\n            this._contentWidget.layout();\r\n        }\r\n    }\r\n    _onListMouseDownOrTap(e) {\r\n        if (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\r\n            return;\r\n        }\r\n        // prevent stealing browser focus from the editor\r\n        e.browserEvent.preventDefault();\r\n        e.browserEvent.stopPropagation();\r\n        this._select(e.element, e.index);\r\n    }\r\n    _onListSelection(e) {\r\n        if (e.elements.length) {\r\n            this._select(e.elements[0], e.indexes[0]);\r\n        }\r\n    }\r\n    _select(item, index) {\r\n        const completionModel = this._completionModel;\r\n        if (completionModel) {\r\n            this._onDidSelect.fire({ item, index, model: completionModel });\r\n            this.editor.focus();\r\n        }\r\n    }\r\n    _onThemeChange(theme) {\r\n        const backgroundColor = theme.getColor(editorSuggestWidgetBackground);\r\n        if (backgroundColor) {\r\n            this.element.domNode.style.backgroundColor = backgroundColor.toString();\r\n            this._messageElement.style.backgroundColor = backgroundColor.toString();\r\n            this._details.widget.domNode.style.backgroundColor = backgroundColor.toString();\r\n        }\r\n        const borderColor = theme.getColor(editorSuggestWidgetBorder);\r\n        if (borderColor) {\r\n            this.element.domNode.style.borderColor = borderColor.toString();\r\n            this._messageElement.style.borderColor = borderColor.toString();\r\n            this._status.element.style.borderTopColor = borderColor.toString();\r\n            this._details.widget.domNode.style.borderColor = borderColor.toString();\r\n            this._detailsBorderColor = borderColor.toString();\r\n        }\r\n        const focusBorderColor = theme.getColor(focusBorder);\r\n        if (focusBorderColor) {\r\n            this._detailsFocusBorderColor = focusBorderColor.toString();\r\n        }\r\n        this._details.widget.borderWidth = theme.type === 'hc' ? 2 : 1;\r\n    }\r\n    _onListFocus(e) {\r\n        var _a;\r\n        if (this._ignoreFocusEvents) {\r\n            return;\r\n        }\r\n        if (!e.elements.length) {\r\n            if (this._currentSuggestionDetails) {\r\n                this._currentSuggestionDetails.cancel();\r\n                this._currentSuggestionDetails = undefined;\r\n                this._focusedItem = undefined;\r\n            }\r\n            this.editor.setAriaOptions({ activeDescendant: undefined });\r\n            return;\r\n        }\r\n        if (!this._completionModel) {\r\n            return;\r\n        }\r\n        const item = e.elements[0];\r\n        const index = e.indexes[0];\r\n        if (item !== this._focusedItem) {\r\n            (_a = this._currentSuggestionDetails) === null || _a === void 0 ? void 0 : _a.cancel();\r\n            this._currentSuggestionDetails = undefined;\r\n            this._focusedItem = item;\r\n            this._list.reveal(index);\r\n            this._currentSuggestionDetails = createCancelablePromise((token) => __awaiter(this, void 0, void 0, function* () {\r\n                const loading = disposableTimeout(() => {\r\n                    if (this._isDetailsVisible()) {\r\n                        this.showDetails(true);\r\n                    }\r\n                }, 250);\r\n                token.onCancellationRequested(() => loading.dispose());\r\n                const result = yield item.resolve(token);\r\n                loading.dispose();\r\n                return result;\r\n            }));\r\n            this._currentSuggestionDetails.then(() => {\r\n                if (index >= this._list.length || item !== this._list.element(index)) {\r\n                    return;\r\n                }\r\n                // item can have extra information, so re-render\r\n                this._ignoreFocusEvents = true;\r\n                this._list.splice(index, 1, [item]);\r\n                this._list.setFocus([index]);\r\n                this._ignoreFocusEvents = false;\r\n                if (this._isDetailsVisible()) {\r\n                    this.showDetails(false);\r\n                }\r\n                else {\r\n                    this.element.domNode.classList.remove('docs-side');\r\n                }\r\n                this.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\r\n            }).catch(onUnexpectedError);\r\n        }\r\n        // emit an event\r\n        this._onDidFocus.fire({ item, index, model: this._completionModel });\r\n    }\r\n    _setState(state) {\r\n        if (this._state === state) {\r\n            return;\r\n        }\r\n        this._state = state;\r\n        this.element.domNode.classList.toggle('frozen', state === 4 /* Frozen */);\r\n        this.element.domNode.classList.remove('message');\r\n        switch (state) {\r\n            case 0 /* Hidden */:\r\n                dom.hide(this._messageElement, this._listElement, this._status.element);\r\n                this._details.hide(true);\r\n                this._status.hide();\r\n                this._contentWidget.hide();\r\n                this._ctxSuggestWidgetVisible.reset();\r\n                this._ctxSuggestWidgetMultipleSuggestions.reset();\r\n                this._showTimeout.cancel();\r\n                this.element.domNode.classList.remove('visible');\r\n                this._list.splice(0, this._list.length);\r\n                this._focusedItem = undefined;\r\n                this._cappedHeight = undefined;\r\n                this._explainMode = false;\r\n                break;\r\n            case 1 /* Loading */:\r\n                this.element.domNode.classList.add('message');\r\n                this._messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\r\n                dom.hide(this._listElement, this._status.element);\r\n                dom.show(this._messageElement);\r\n                this._details.hide();\r\n                this._show();\r\n                this._focusedItem = undefined;\r\n                break;\r\n            case 2 /* Empty */:\r\n                this.element.domNode.classList.add('message');\r\n                this._messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\r\n                dom.hide(this._listElement, this._status.element);\r\n                dom.show(this._messageElement);\r\n                this._details.hide();\r\n                this._show();\r\n                this._focusedItem = undefined;\r\n                break;\r\n            case 3 /* Open */:\r\n                dom.hide(this._messageElement);\r\n                dom.show(this._listElement, this._status.element);\r\n                this._show();\r\n                break;\r\n            case 4 /* Frozen */:\r\n                dom.hide(this._messageElement);\r\n                dom.show(this._listElement, this._status.element);\r\n                this._show();\r\n                break;\r\n            case 5 /* Details */:\r\n                dom.hide(this._messageElement);\r\n                dom.show(this._listElement, this._status.element);\r\n                this._details.show();\r\n                this._show();\r\n                break;\r\n        }\r\n    }\r\n    _show() {\r\n        this._status.show();\r\n        this._contentWidget.show();\r\n        this._layout(this._persistedSize.restore());\r\n        this._ctxSuggestWidgetVisible.set(true);\r\n        this._showTimeout.cancelAndSet(() => {\r\n            this.element.domNode.classList.add('visible');\r\n            this._onDidShow.fire(this);\r\n        }, 100);\r\n    }\r\n    showTriggered(auto, delay) {\r\n        if (this._state !== 0 /* Hidden */) {\r\n            return;\r\n        }\r\n        this._contentWidget.setPosition(this.editor.getPosition());\r\n        this._isAuto = !!auto;\r\n        if (!this._isAuto) {\r\n            this._loadingTimeout = disposableTimeout(() => this._setState(1 /* Loading */), delay);\r\n        }\r\n    }\r\n    showSuggestions(completionModel, selectionIndex, isFrozen, isAuto) {\r\n        var _a, _b;\r\n        this._contentWidget.setPosition(this.editor.getPosition());\r\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        (_b = this._currentSuggestionDetails) === null || _b === void 0 ? void 0 : _b.cancel();\r\n        this._currentSuggestionDetails = undefined;\r\n        if (this._completionModel !== completionModel) {\r\n            this._completionModel = completionModel;\r\n        }\r\n        if (isFrozen && this._state !== 2 /* Empty */ && this._state !== 0 /* Hidden */) {\r\n            this._setState(4 /* Frozen */);\r\n            return;\r\n        }\r\n        const visibleCount = this._completionModel.items.length;\r\n        const isEmpty = visibleCount === 0;\r\n        this._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\r\n        if (isEmpty) {\r\n            this._setState(isAuto ? 0 /* Hidden */ : 2 /* Empty */);\r\n            this._completionModel = undefined;\r\n            return;\r\n        }\r\n        this._focusedItem = undefined;\r\n        this._list.splice(0, this._list.length, this._completionModel.items);\r\n        this._setState(isFrozen ? 4 /* Frozen */ : 3 /* Open */);\r\n        this._list.reveal(selectionIndex, 0);\r\n        this._list.setFocus([selectionIndex]);\r\n        this._layout(this.element.size);\r\n        // Reset focus border\r\n        if (this._detailsBorderColor) {\r\n            this._details.widget.domNode.style.borderColor = this._detailsBorderColor;\r\n        }\r\n    }\r\n    selectNextPage() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this._details.widget.pageDown();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusNextPage();\r\n                return true;\r\n        }\r\n    }\r\n    selectNext() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusNext(1, true);\r\n                return true;\r\n        }\r\n    }\r\n    selectLast() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this._details.widget.scrollBottom();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusLast();\r\n                return true;\r\n        }\r\n    }\r\n    selectPreviousPage() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this._details.widget.pageUp();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusPreviousPage();\r\n                return true;\r\n        }\r\n    }\r\n    selectPrevious() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusPrevious(1, true);\r\n                return false;\r\n        }\r\n    }\r\n    selectFirst() {\r\n        switch (this._state) {\r\n            case 0 /* Hidden */:\r\n                return false;\r\n            case 5 /* Details */:\r\n                this._details.widget.scrollTop();\r\n                return true;\r\n            case 1 /* Loading */:\r\n                return !this._isAuto;\r\n            default:\r\n                this._list.focusFirst();\r\n                return true;\r\n        }\r\n    }\r\n    getFocusedItem() {\r\n        if (this._state !== 0 /* Hidden */\r\n            && this._state !== 2 /* Empty */\r\n            && this._state !== 1 /* Loading */\r\n            && this._completionModel) {\r\n            return {\r\n                item: this._list.getFocusedElements()[0],\r\n                index: this._list.getFocus()[0],\r\n                model: this._completionModel\r\n            };\r\n        }\r\n        return undefined;\r\n    }\r\n    toggleDetailsFocus() {\r\n        if (this._state === 5 /* Details */) {\r\n            this._setState(3 /* Open */);\r\n            if (this._detailsBorderColor) {\r\n                this._details.widget.domNode.style.borderColor = this._detailsBorderColor;\r\n            }\r\n        }\r\n        else if (this._state === 3 /* Open */ && this._isDetailsVisible()) {\r\n            this._setState(5 /* Details */);\r\n            if (this._detailsFocusBorderColor) {\r\n                this._details.widget.domNode.style.borderColor = this._detailsFocusBorderColor;\r\n            }\r\n        }\r\n    }\r\n    toggleDetails() {\r\n        if (this._isDetailsVisible()) {\r\n            // hide details widget\r\n            this._ctxSuggestWidgetDetailsVisible.set(false);\r\n            this._setDetailsVisible(false);\r\n            this._details.hide();\r\n            this.element.domNode.classList.remove('shows-details');\r\n        }\r\n        else if ((canExpandCompletionItem(this._list.getFocusedElements()[0]) || this._explainMode) && (this._state === 3 /* Open */ || this._state === 5 /* Details */ || this._state === 4 /* Frozen */)) {\r\n            // show details widget (iff possible)\r\n            this._ctxSuggestWidgetDetailsVisible.set(true);\r\n            this._setDetailsVisible(true);\r\n            this.showDetails(false);\r\n        }\r\n    }\r\n    showDetails(loading) {\r\n        this._details.show();\r\n        if (loading) {\r\n            this._details.widget.renderLoading();\r\n        }\r\n        else {\r\n            this._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\r\n        }\r\n        this._positionDetails();\r\n        this.editor.focus();\r\n        this.element.domNode.classList.add('shows-details');\r\n    }\r\n    toggleExplainMode() {\r\n        if (this._list.getFocusedElements()[0]) {\r\n            this._explainMode = !this._explainMode;\r\n            if (!this._isDetailsVisible()) {\r\n                this.toggleDetails();\r\n            }\r\n            else {\r\n                this.showDetails(false);\r\n            }\r\n        }\r\n    }\r\n    resetPersistedSize() {\r\n        this._persistedSize.reset();\r\n    }\r\n    hideWidget() {\r\n        var _a;\r\n        (_a = this._loadingTimeout) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        this._setState(0 /* Hidden */);\r\n        this._onDidHide.fire(this);\r\n        this.element.clearSashHoverState();\r\n        // ensure that a reasonable widget height is persisted so that\r\n        // accidential \"resize-to-single-items\" cases aren't happening\r\n        const dim = this._persistedSize.restore();\r\n        const minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\r\n        if (dim && dim.height < minPersistedHeight) {\r\n            this._persistedSize.store(dim.with(undefined, minPersistedHeight));\r\n        }\r\n    }\r\n    isFrozen() {\r\n        return this._state === 4 /* Frozen */;\r\n    }\r\n    _afterRender(position) {\r\n        if (position === null) {\r\n            if (this._isDetailsVisible()) {\r\n                this._details.hide(); //todo@jrieken soft-hide\r\n            }\r\n            return;\r\n        }\r\n        if (this._state === 2 /* Empty */ || this._state === 1 /* Loading */) {\r\n            // no special positioning when widget isn't showing list\r\n            return;\r\n        }\r\n        if (this._isDetailsVisible()) {\r\n            this._details.show();\r\n        }\r\n        this._positionDetails();\r\n    }\r\n    _layout(size) {\r\n        var _a, _b, _c;\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this.editor.getDomNode()) {\r\n            // happens when running tests\r\n            return;\r\n        }\r\n        const bodyBox = dom.getClientArea(document.body);\r\n        const info = this.getLayoutInfo();\r\n        if (!size) {\r\n            size = info.defaultSize;\r\n        }\r\n        let height = size.height;\r\n        let width = size.width;\r\n        // status bar\r\n        this._status.element.style.lineHeight = `${info.itemHeight}px`;\r\n        if (this._state === 2 /* Empty */ || this._state === 1 /* Loading */) {\r\n            // showing a message only\r\n            height = info.itemHeight + info.borderHeight;\r\n            width = info.defaultSize.width / 2;\r\n            this.element.enableSashes(false, false, false, false);\r\n            this.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\r\n            this._contentWidget.setPreference(2 /* BELOW */);\r\n        }\r\n        else {\r\n            // showing items\r\n            // width math\r\n            const maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\r\n            if (width > maxWidth) {\r\n                width = maxWidth;\r\n            }\r\n            const preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\r\n            // height math\r\n            const fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\r\n            const minHeight = info.itemHeight + info.statusBarHeight;\r\n            const editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\r\n            const cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\r\n            const cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\r\n            const maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\r\n            const maxHeightAbove = Math.min(editorBox.top + cursorBox.top - info.verticalPadding, fullHeight);\r\n            let maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\r\n            if (height === ((_a = this._cappedHeight) === null || _a === void 0 ? void 0 : _a.capped)) {\r\n                // Restore the old (wanted) height when the current\r\n                // height is capped to fit\r\n                height = this._cappedHeight.wanted;\r\n            }\r\n            if (height < minHeight) {\r\n                height = minHeight;\r\n            }\r\n            if (height > maxHeight) {\r\n                height = maxHeight;\r\n            }\r\n            const forceRenderingAboveRequiredSpace = 100;\r\n            if (height > maxHeightBelow || (this._forceRenderingAbove && maxHeightAbove > forceRenderingAboveRequiredSpace)) {\r\n                this._contentWidget.setPreference(1 /* ABOVE */);\r\n                this.element.enableSashes(true, true, false, false);\r\n                maxHeight = maxHeightAbove;\r\n            }\r\n            else {\r\n                this._contentWidget.setPreference(2 /* BELOW */);\r\n                this.element.enableSashes(false, true, true, false);\r\n                maxHeight = maxHeightBelow;\r\n            }\r\n            this.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\r\n            this.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\r\n            this.element.minSize = new dom.Dimension(220, minHeight);\r\n            // Know when the height was capped to fit and remember\r\n            // the wanted height for later. This is required when going\r\n            // left to widen suggestions.\r\n            this._cappedHeight = height === fullHeight\r\n                ? { wanted: (_c = (_b = this._cappedHeight) === null || _b === void 0 ? void 0 : _b.wanted) !== null && _c !== void 0 ? _c : size.height, capped: height }\r\n                : undefined;\r\n        }\r\n        this._resize(width, height);\r\n    }\r\n    _resize(width, height) {\r\n        const { width: maxWidth, height: maxHeight } = this.element.maxSize;\r\n        width = Math.min(maxWidth, width);\r\n        height = Math.min(maxHeight, height);\r\n        const { statusBarHeight } = this.getLayoutInfo();\r\n        this._list.layout(height - statusBarHeight, width);\r\n        this._listElement.style.height = `${height - statusBarHeight}px`;\r\n        this.element.layout(height, width);\r\n        this._contentWidget.layout();\r\n        this._positionDetails();\r\n    }\r\n    _positionDetails() {\r\n        if (this._isDetailsVisible()) {\r\n            this._details.placeAtAnchor(this.element.domNode);\r\n        }\r\n    }\r\n    getLayoutInfo() {\r\n        const fontInfo = this.editor.getOption(41 /* fontInfo */);\r\n        const itemHeight = clamp(this.editor.getOption(107 /* suggestLineHeight */) || fontInfo.lineHeight, 8, 1000);\r\n        const statusBarHeight = !this.editor.getOption(105 /* suggest */).showStatusBar || this._state === 2 /* Empty */ || this._state === 1 /* Loading */ ? 0 : itemHeight;\r\n        const borderWidth = this._details.widget.borderWidth;\r\n        const borderHeight = 2 * borderWidth;\r\n        return {\r\n            itemHeight,\r\n            statusBarHeight,\r\n            borderWidth,\r\n            borderHeight,\r\n            typicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\r\n            verticalPadding: 22,\r\n            horizontalPadding: 14,\r\n            defaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\r\n        };\r\n    }\r\n    _isDetailsVisible() {\r\n        return this._storageService.getBoolean('expandSuggestionDocs', 0 /* GLOBAL */, false);\r\n    }\r\n    _setDetailsVisible(value) {\r\n        this._storageService.store('expandSuggestionDocs', value, 0 /* GLOBAL */, 0 /* USER */);\r\n    }\r\n    forceRenderingAbove() {\r\n        if (!this._forceRenderingAbove) {\r\n            this._forceRenderingAbove = true;\r\n            this._layout(this._persistedSize.restore());\r\n        }\r\n    }\r\n    stopForceRenderingAbove() {\r\n        this._forceRenderingAbove = false;\r\n    }\r\n};\r\nSuggestWidget.LOADING_MESSAGE = nls.localize('suggestWidget.loading', \"Loading...\");\r\nSuggestWidget.NO_SUGGESTIONS_MESSAGE = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\r\nSuggestWidget = __decorate([\r\n    __param(1, IStorageService),\r\n    __param(2, IContextKeyService),\r\n    __param(3, IThemeService),\r\n    __param(4, IInstantiationService)\r\n], SuggestWidget);\r\nexport { SuggestWidget };\r\nexport class SuggestContentWidget {\r\n    constructor(_widget, _editor) {\r\n        this._widget = _widget;\r\n        this._editor = _editor;\r\n        this.allowEditorOverflow = true;\r\n        this.suppressMouseDown = false;\r\n        this._preferenceLocked = false;\r\n        this._added = false;\r\n        this._hidden = false;\r\n    }\r\n    dispose() {\r\n        if (this._added) {\r\n            this._added = false;\r\n            this._editor.removeContentWidget(this);\r\n        }\r\n    }\r\n    getId() {\r\n        return 'editor.widget.suggestWidget';\r\n    }\r\n    getDomNode() {\r\n        return this._widget.element.domNode;\r\n    }\r\n    show() {\r\n        this._hidden = false;\r\n        if (!this._added) {\r\n            this._added = true;\r\n            this._editor.addContentWidget(this);\r\n        }\r\n    }\r\n    hide() {\r\n        if (!this._hidden) {\r\n            this._hidden = true;\r\n            this.layout();\r\n        }\r\n    }\r\n    layout() {\r\n        this._editor.layoutContentWidget(this);\r\n    }\r\n    getPosition() {\r\n        if (this._hidden || !this._position || !this._preference) {\r\n            return null;\r\n        }\r\n        return {\r\n            position: this._position,\r\n            preference: [this._preference]\r\n        };\r\n    }\r\n    beforeRender() {\r\n        const { height, width } = this._widget.element.size;\r\n        const { borderWidth, horizontalPadding } = this._widget.getLayoutInfo();\r\n        return new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\r\n    }\r\n    afterRender(position) {\r\n        this._widget._afterRender(position);\r\n    }\r\n    setPreference(preference) {\r\n        if (!this._preferenceLocked) {\r\n            this._preference = preference;\r\n        }\r\n    }\r\n    lockPreference() {\r\n        this._preferenceLocked = true;\r\n    }\r\n    unlockPreference() {\r\n        this._preferenceLocked = false;\r\n    }\r\n    setPosition(position) {\r\n        this._position = position;\r\n    }\r\n}\r\nregisterThemingParticipant((theme, collector) => {\r\n    const matchHighlight = theme.getColor(editorSuggestWidgetHighlightForeground);\r\n    if (matchHighlight) {\r\n        collector.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: ${matchHighlight}; }`);\r\n    }\r\n    const matchHighlightFocus = theme.getColor(editorSuggestWidgetHighlightFocusForeground);\r\n    if (matchHighlight) {\r\n        collector.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused .monaco-highlighted-label .highlight { color: ${matchHighlightFocus}; }`);\r\n    }\r\n    const foreground = theme.getColor(editorSuggestWidgetForeground);\r\n    if (foreground) {\r\n        collector.addRule(`.monaco-editor .suggest-widget, .monaco-editor .suggest-details { color: ${foreground}; }`);\r\n    }\r\n    const selectedForeground = theme.getColor(editorSuggestWidgetSelectedForeground);\r\n    if (selectedForeground) {\r\n        collector.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused { color: ${selectedForeground}; }`);\r\n    }\r\n    const selectedIconForeground = theme.getColor(editorSuggestWidgetSelectedIconForeground);\r\n    if (selectedIconForeground) {\r\n        collector.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row.focused .codicon { color: ${selectedIconForeground}; }`);\r\n    }\r\n    const link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(`.monaco-editor .suggest-details a { color: ${link}; }`);\r\n    }\r\n    const codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(`.monaco-editor .suggest-details code { background-color: ${codeBackground}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { RawContextKey, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nlet WordContextKey = class WordContextKey {\r\n    constructor(_editor, contextKeyService) {\r\n        this._editor = _editor;\r\n        this._enabled = false;\r\n        this._ckAtEnd = WordContextKey.AtEnd.bindTo(contextKeyService);\r\n        this._configListener = this._editor.onDidChangeConfiguration(e => e.hasChanged(110 /* tabCompletion */) && this._update());\r\n        this._update();\r\n    }\r\n    dispose() {\r\n        var _a;\r\n        this._configListener.dispose();\r\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        this._ckAtEnd.reset();\r\n    }\r\n    _update() {\r\n        // only update this when tab completions are enabled\r\n        const enabled = this._editor.getOption(110 /* tabCompletion */) === 'on';\r\n        if (this._enabled === enabled) {\r\n            return;\r\n        }\r\n        this._enabled = enabled;\r\n        if (this._enabled) {\r\n            const checkForWordEnd = () => {\r\n                if (!this._editor.hasModel()) {\r\n                    this._ckAtEnd.set(false);\r\n                    return;\r\n                }\r\n                const model = this._editor.getModel();\r\n                const selection = this._editor.getSelection();\r\n                const word = model.getWordAtPosition(selection.getStartPosition());\r\n                if (!word) {\r\n                    this._ckAtEnd.set(false);\r\n                    return;\r\n                }\r\n                this._ckAtEnd.set(word.endColumn === selection.getStartPosition().column);\r\n            };\r\n            this._selectionListener = this._editor.onDidChangeCursorSelection(checkForWordEnd);\r\n            checkForWordEnd();\r\n        }\r\n        else if (this._selectionListener) {\r\n            this._ckAtEnd.reset();\r\n            this._selectionListener.dispose();\r\n            this._selectionListener = undefined;\r\n        }\r\n    }\r\n};\r\nWordContextKey.AtEnd = new RawContextKey('atEndOfWord', false);\r\nWordContextKey = __decorate([\r\n    __param(1, IContextKeyService)\r\n], WordContextKey);\r\nexport { WordContextKey };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nexport class CommitCharacterController {\r\n    constructor(editor, widget, accept) {\r\n        this._disposables = new DisposableStore();\r\n        this._disposables.add(widget.onDidShow(() => this._onItem(widget.getFocusedItem())));\r\n        this._disposables.add(widget.onDidFocus(this._onItem, this));\r\n        this._disposables.add(widget.onDidHide(this.reset, this));\r\n        this._disposables.add(editor.onWillType(text => {\r\n            if (this._active && !widget.isFrozen()) {\r\n                const ch = text.charCodeAt(text.length - 1);\r\n                if (this._active.acceptCharacters.has(ch) && editor.getOption(0 /* acceptSuggestionOnCommitCharacter */)) {\r\n                    accept(this._active.item);\r\n                }\r\n            }\r\n        }));\r\n    }\r\n    _onItem(selected) {\r\n        if (!selected || !isNonEmptyArray(selected.item.completion.commitCharacters)) {\r\n            // no item or no commit characters\r\n            this.reset();\r\n            return;\r\n        }\r\n        if (this._active && this._active.item.item === selected.item) {\r\n            // still the same item\r\n            return;\r\n        }\r\n        // keep item and its commit characters\r\n        const acceptCharacters = new CharacterSet();\r\n        for (const ch of selected.item.completion.commitCharacters) {\r\n            if (ch.length > 0) {\r\n                acceptCharacters.add(ch.charCodeAt(0));\r\n            }\r\n        }\r\n        this._active = { acceptCharacters, item: selected };\r\n    }\r\n    reset() {\r\n        this._active = undefined;\r\n    }\r\n    dispose() {\r\n        this._disposables.dispose();\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nexport class OvertypingCapturer {\r\n    constructor(editor, suggestModel) {\r\n        this._disposables = new DisposableStore();\r\n        this._lastOvertyped = [];\r\n        this._empty = true;\r\n        this._disposables.add(editor.onWillType(() => {\r\n            if (!this._empty) {\r\n                return;\r\n            }\r\n            if (!editor.hasModel()) {\r\n                return;\r\n            }\r\n            const selections = editor.getSelections();\r\n            const selectionsLength = selections.length;\r\n            // Check if it will overtype any selections\r\n            let willOvertype = false;\r\n            for (let i = 0; i < selectionsLength; i++) {\r\n                if (!selections[i].isEmpty()) {\r\n                    willOvertype = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!willOvertype) {\r\n                return;\r\n            }\r\n            this._lastOvertyped = [];\r\n            const model = editor.getModel();\r\n            for (let i = 0; i < selectionsLength; i++) {\r\n                const selection = selections[i];\r\n                // Check for overtyping capturer restrictions\r\n                if (model.getValueLengthInRange(selection) > OvertypingCapturer._maxSelectionLength) {\r\n                    return;\r\n                }\r\n                this._lastOvertyped[i] = { value: model.getValueInRange(selection), multiline: selection.startLineNumber !== selection.endLineNumber };\r\n            }\r\n            this._empty = false;\r\n        }));\r\n        this._disposables.add(suggestModel.onDidCancel(e => {\r\n            if (!this._empty && !e.retrigger) {\r\n                this._empty = true;\r\n            }\r\n        }));\r\n    }\r\n    getLastOvertypedInfo(idx) {\r\n        if (!this._empty && idx >= 0 && idx < this._lastOvertyped.length) {\r\n            return this._lastOvertyped[idx];\r\n        }\r\n        return undefined;\r\n    }\r\n    dispose() {\r\n        this._disposables.dispose();\r\n    }\r\n}\r\nOvertypingCapturer._maxSelectionLength = 51200;\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { SimpleKeybinding } from '../../../base/common/keyCodes.js';\r\nimport { dispose, DisposableStore, toDisposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { StableEditorScrollState } from '../../browser/core/editorState.js';\r\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { SnippetController2 } from '../snippet/snippetController2.js';\r\nimport { SnippetParser } from '../snippet/snippetParser.js';\r\nimport { ISuggestMemoryService } from './suggestMemory.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ICommandService, CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { ContextKeyExpr, IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { KeybindingsRegistry } from '../../../platform/keybinding/common/keybindingsRegistry.js';\r\nimport { Context as SuggestContext, suggestWidgetStatusbarMenu } from './suggest.js';\r\nimport { SuggestAlternatives } from './suggestAlternatives.js';\r\nimport { SuggestModel } from './suggestModel.js';\r\nimport { SuggestWidget } from './suggestWidget.js';\r\nimport { WordContextKey } from './wordContextKey.js';\r\nimport { Event } from '../../../base/common/event.js';\r\nimport { IdleValue } from '../../../base/common/async.js';\r\nimport { isObject, assertType } from '../../../base/common/types.js';\r\nimport { CommitCharacterController } from './suggestCommitCharacters.js';\r\nimport { OvertypingCapturer } from './suggestOvertypingCapturer.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { MenuRegistry } from '../../../platform/actions/common/actions.js';\r\nimport { CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { ILogService } from '../../../platform/log/common/log.js';\r\nimport { StopWatch } from '../../../base/common/stopwatch.js';\r\n// sticky suggest widget which doesn't disappear on focus out and such\r\nlet _sticky = false;\r\n// _sticky = Boolean(\"true\"); // done \"weirdly\" so that a lint warning prevents you from pushing this\r\nclass LineSuffix {\r\n    constructor(_model, _position) {\r\n        this._model = _model;\r\n        this._position = _position;\r\n        // spy on what's happening right of the cursor. two cases:\r\n        // 1. end of line -> check that it's still end of line\r\n        // 2. mid of line -> add a marker and compute the delta\r\n        const maxColumn = _model.getLineMaxColumn(_position.lineNumber);\r\n        if (maxColumn !== _position.column) {\r\n            const offset = _model.getOffsetAt(_position);\r\n            const end = _model.getPositionAt(offset + 1);\r\n            this._marker = _model.deltaDecorations([], [{\r\n                    range: Range.fromPositions(_position, end),\r\n                    options: { description: 'suggest-line-suffix', stickiness: 1 /* NeverGrowsWhenTypingAtEdges */ }\r\n                }]);\r\n        }\r\n    }\r\n    dispose() {\r\n        if (this._marker && !this._model.isDisposed()) {\r\n            this._model.deltaDecorations(this._marker, []);\r\n        }\r\n    }\r\n    delta(position) {\r\n        if (this._model.isDisposed() || this._position.lineNumber !== position.lineNumber) {\r\n            // bail out early if things seems fishy\r\n            return 0;\r\n        }\r\n        // read the marker (in case suggest was triggered at line end) or compare\r\n        // the cursor to the line end.\r\n        if (this._marker) {\r\n            const range = this._model.getDecorationRange(this._marker[0]);\r\n            const end = this._model.getOffsetAt(range.getStartPosition());\r\n            return end - this._model.getOffsetAt(position);\r\n        }\r\n        else {\r\n            return this._model.getLineMaxColumn(position.lineNumber) - position.column;\r\n        }\r\n    }\r\n}\r\nlet SuggestController = class SuggestController {\r\n    constructor(editor, _memoryService, _commandService, _contextKeyService, _instantiationService, _logService) {\r\n        this._memoryService = _memoryService;\r\n        this._commandService = _commandService;\r\n        this._contextKeyService = _contextKeyService;\r\n        this._instantiationService = _instantiationService;\r\n        this._logService = _logService;\r\n        this._lineSuffix = new MutableDisposable();\r\n        this._toDispose = new DisposableStore();\r\n        this.editor = editor;\r\n        this.model = _instantiationService.createInstance(SuggestModel, this.editor);\r\n        // context key: update insert/replace mode\r\n        const ctxInsertMode = SuggestContext.InsertMode.bindTo(_contextKeyService);\r\n        ctxInsertMode.set(editor.getOption(105 /* suggest */).insertMode);\r\n        this.model.onDidTrigger(() => ctxInsertMode.set(editor.getOption(105 /* suggest */).insertMode));\r\n        this.widget = this._toDispose.add(new IdleValue(() => {\r\n            const widget = this._instantiationService.createInstance(SuggestWidget, this.editor);\r\n            this._toDispose.add(widget);\r\n            this._toDispose.add(widget.onDidSelect(item => this._insertSuggestion(item, 0), this));\r\n            // Wire up logic to accept a suggestion on certain characters\r\n            const commitCharacterController = new CommitCharacterController(this.editor, widget, item => this._insertSuggestion(item, 2 /* NoAfterUndoStop */));\r\n            this._toDispose.add(commitCharacterController);\r\n            this._toDispose.add(this.model.onDidSuggest(e => {\r\n                if (e.completionModel.items.length === 0) {\r\n                    commitCharacterController.reset();\r\n                }\r\n            }));\r\n            // Wire up makes text edit context key\r\n            const ctxMakesTextEdit = SuggestContext.MakesTextEdit.bindTo(this._contextKeyService);\r\n            const ctxHasInsertAndReplace = SuggestContext.HasInsertAndReplaceRange.bindTo(this._contextKeyService);\r\n            const ctxCanResolve = SuggestContext.CanResolve.bindTo(this._contextKeyService);\r\n            this._toDispose.add(toDisposable(() => {\r\n                ctxMakesTextEdit.reset();\r\n                ctxHasInsertAndReplace.reset();\r\n                ctxCanResolve.reset();\r\n            }));\r\n            this._toDispose.add(widget.onDidFocus(({ item }) => {\r\n                // (ctx: makesTextEdit)\r\n                const position = this.editor.getPosition();\r\n                const startColumn = item.editStart.column;\r\n                const endColumn = position.column;\r\n                let value = true;\r\n                if (this.editor.getOption(1 /* acceptSuggestionOnEnter */) === 'smart'\r\n                    && this.model.state === 2 /* Auto */\r\n                    && !item.completion.command\r\n                    && !item.completion.additionalTextEdits\r\n                    && !(item.completion.insertTextRules & 4 /* InsertAsSnippet */)\r\n                    && endColumn - startColumn === item.completion.insertText.length) {\r\n                    const oldText = this.editor.getModel().getValueInRange({\r\n                        startLineNumber: position.lineNumber,\r\n                        startColumn,\r\n                        endLineNumber: position.lineNumber,\r\n                        endColumn\r\n                    });\r\n                    value = oldText !== item.completion.insertText;\r\n                }\r\n                ctxMakesTextEdit.set(value);\r\n                // (ctx: hasInsertAndReplaceRange)\r\n                ctxHasInsertAndReplace.set(!Position.equals(item.editInsertEnd, item.editReplaceEnd));\r\n                // (ctx: canResolve)\r\n                ctxCanResolve.set(Boolean(item.provider.resolveCompletionItem) || Boolean(item.completion.documentation) || item.completion.detail !== item.completion.label);\r\n            }));\r\n            this._toDispose.add(widget.onDetailsKeyDown(e => {\r\n                // cmd + c on macOS, ctrl + c on Win / Linux\r\n                if (e.toKeybinding().equals(new SimpleKeybinding(true, false, false, false, 33 /* KEY_C */)) ||\r\n                    (platform.isMacintosh && e.toKeybinding().equals(new SimpleKeybinding(false, false, false, true, 33 /* KEY_C */)))) {\r\n                    e.stopPropagation();\r\n                    return;\r\n                }\r\n                if (!e.toKeybinding().isModifierKey()) {\r\n                    this.editor.focus();\r\n                }\r\n            }));\r\n            return widget;\r\n        }));\r\n        // Wire up text overtyping capture\r\n        this._overtypingCapturer = this._toDispose.add(new IdleValue(() => {\r\n            return this._toDispose.add(new OvertypingCapturer(this.editor, this.model));\r\n        }));\r\n        this._alternatives = this._toDispose.add(new IdleValue(() => {\r\n            return this._toDispose.add(new SuggestAlternatives(this.editor, this._contextKeyService));\r\n        }));\r\n        this._toDispose.add(_instantiationService.createInstance(WordContextKey, editor));\r\n        this._toDispose.add(this.model.onDidTrigger(e => {\r\n            this.widget.value.showTriggered(e.auto, e.shy ? 250 : 50);\r\n            this._lineSuffix.value = new LineSuffix(this.editor.getModel(), e.position);\r\n        }));\r\n        this._toDispose.add(this.model.onDidSuggest(e => {\r\n            if (!e.shy) {\r\n                let index = this._memoryService.select(this.editor.getModel(), this.editor.getPosition(), e.completionModel.items);\r\n                this.widget.value.showSuggestions(e.completionModel, index, e.isFrozen, e.auto);\r\n            }\r\n        }));\r\n        this._toDispose.add(this.model.onDidCancel(e => {\r\n            if (!e.retrigger) {\r\n                this.widget.value.hideWidget();\r\n            }\r\n        }));\r\n        this._toDispose.add(this.editor.onDidBlurEditorWidget(() => {\r\n            if (!_sticky) {\r\n                this.model.cancel();\r\n                this.model.clear();\r\n            }\r\n        }));\r\n        // Manage the acceptSuggestionsOnEnter context key\r\n        let acceptSuggestionsOnEnter = SuggestContext.AcceptSuggestionsOnEnter.bindTo(_contextKeyService);\r\n        let updateFromConfig = () => {\r\n            const acceptSuggestionOnEnter = this.editor.getOption(1 /* acceptSuggestionOnEnter */);\r\n            acceptSuggestionsOnEnter.set(acceptSuggestionOnEnter === 'on' || acceptSuggestionOnEnter === 'smart');\r\n        };\r\n        this._toDispose.add(this.editor.onDidChangeConfiguration(() => updateFromConfig()));\r\n        updateFromConfig();\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(SuggestController.ID);\r\n    }\r\n    dispose() {\r\n        this._alternatives.dispose();\r\n        this._toDispose.dispose();\r\n        this.widget.dispose();\r\n        this.model.dispose();\r\n        this._lineSuffix.dispose();\r\n    }\r\n    _insertSuggestion(event, flags) {\r\n        if (!event || !event.item) {\r\n            this._alternatives.value.reset();\r\n            this.model.cancel();\r\n            this.model.clear();\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = this.editor.getModel();\r\n        const modelVersionNow = model.getAlternativeVersionId();\r\n        const { item } = event;\r\n        //\r\n        const tasks = [];\r\n        const cts = new CancellationTokenSource();\r\n        // pushing undo stops *before* additional text edits and\r\n        // *after* the main edit\r\n        if (!(flags & 1 /* NoBeforeUndoStop */)) {\r\n            this.editor.pushUndoStop();\r\n        }\r\n        // compute overwrite[Before|After] deltas BEFORE applying extra edits\r\n        const info = this.getOverwriteInfo(item, Boolean(flags & 8 /* AlternativeOverwriteConfig */));\r\n        // keep item in memory\r\n        this._memoryService.memorize(model, this.editor.getPosition(), item);\r\n        if (Array.isArray(item.completion.additionalTextEdits)) {\r\n            // sync additional edits\r\n            const scrollState = StableEditorScrollState.capture(this.editor);\r\n            this.editor.executeEdits('suggestController.additionalTextEdits.sync', item.completion.additionalTextEdits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text)));\r\n            scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\r\n        }\r\n        else if (!item.isResolved) {\r\n            // async additional edits\r\n            const sw = new StopWatch(true);\r\n            let position;\r\n            const docListener = model.onDidChangeContent(e => {\r\n                if (e.isFlush) {\r\n                    cts.cancel();\r\n                    docListener.dispose();\r\n                    return;\r\n                }\r\n                for (let change of e.changes) {\r\n                    const thisPosition = Range.getEndPosition(change.range);\r\n                    if (!position || Position.isBefore(thisPosition, position)) {\r\n                        position = thisPosition;\r\n                    }\r\n                }\r\n            });\r\n            let oldFlags = flags;\r\n            flags |= 2 /* NoAfterUndoStop */;\r\n            let didType = false;\r\n            let typeListener = this.editor.onWillType(() => {\r\n                typeListener.dispose();\r\n                didType = true;\r\n                if (!(oldFlags & 2 /* NoAfterUndoStop */)) {\r\n                    this.editor.pushUndoStop();\r\n                }\r\n            });\r\n            tasks.push(item.resolve(cts.token).then(() => {\r\n                if (!item.completion.additionalTextEdits || cts.token.isCancellationRequested) {\r\n                    return false;\r\n                }\r\n                if (position && item.completion.additionalTextEdits.some(edit => Position.isBefore(position, Range.getStartPosition(edit.range)))) {\r\n                    return false;\r\n                }\r\n                if (didType) {\r\n                    this.editor.pushUndoStop();\r\n                }\r\n                const scrollState = StableEditorScrollState.capture(this.editor);\r\n                this.editor.executeEdits('suggestController.additionalTextEdits.async', item.completion.additionalTextEdits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text)));\r\n                scrollState.restoreRelativeVerticalPositionOfCursor(this.editor);\r\n                if (didType || !(oldFlags & 2 /* NoAfterUndoStop */)) {\r\n                    this.editor.pushUndoStop();\r\n                }\r\n                return true;\r\n            }).then(applied => {\r\n                this._logService.trace('[suggest] async resolving of edits DONE (ms, applied?)', sw.elapsed(), applied);\r\n                docListener.dispose();\r\n                typeListener.dispose();\r\n            }));\r\n        }\r\n        let { insertText } = item.completion;\r\n        if (!(item.completion.insertTextRules & 4 /* InsertAsSnippet */)) {\r\n            insertText = SnippetParser.escape(insertText);\r\n        }\r\n        SnippetController2.get(this.editor).insert(insertText, {\r\n            overwriteBefore: info.overwriteBefore,\r\n            overwriteAfter: info.overwriteAfter,\r\n            undoStopBefore: false,\r\n            undoStopAfter: false,\r\n            adjustWhitespace: !(item.completion.insertTextRules & 1 /* KeepWhitespace */),\r\n            clipboardText: event.model.clipboardText,\r\n            overtypingCapturer: this._overtypingCapturer.value\r\n        });\r\n        if (!(flags & 2 /* NoAfterUndoStop */)) {\r\n            this.editor.pushUndoStop();\r\n        }\r\n        if (!item.completion.command) {\r\n            // done\r\n            this.model.cancel();\r\n        }\r\n        else if (item.completion.command.id === TriggerSuggestAction.id) {\r\n            // retigger\r\n            this.model.trigger({ auto: true, shy: false }, true);\r\n        }\r\n        else {\r\n            // exec command, done\r\n            tasks.push(this._commandService.executeCommand(item.completion.command.id, ...(item.completion.command.arguments ? [...item.completion.command.arguments] : [])).catch(onUnexpectedError));\r\n            this.model.cancel();\r\n        }\r\n        if (flags & 4 /* KeepAlternativeSuggestions */) {\r\n            this._alternatives.value.set(event, next => {\r\n                // cancel resolving of additional edits\r\n                cts.cancel();\r\n                // this is not so pretty. when inserting the 'next'\r\n                // suggestion we undo until we are at the state at\r\n                // which we were before inserting the previous suggestion...\r\n                while (model.canUndo()) {\r\n                    if (modelVersionNow !== model.getAlternativeVersionId()) {\r\n                        model.undo();\r\n                    }\r\n                    this._insertSuggestion(next, 1 /* NoBeforeUndoStop */ | 2 /* NoAfterUndoStop */ | (flags & 8 /* AlternativeOverwriteConfig */ ? 8 /* AlternativeOverwriteConfig */ : 0));\r\n                    break;\r\n                }\r\n            });\r\n        }\r\n        this._alertCompletionItem(item);\r\n        // clear only now - after all tasks are done\r\n        Promise.all(tasks).finally(() => {\r\n            this.model.clear();\r\n            cts.dispose();\r\n        });\r\n    }\r\n    getOverwriteInfo(item, toggleMode) {\r\n        assertType(this.editor.hasModel());\r\n        let replace = this.editor.getOption(105 /* suggest */).insertMode === 'replace';\r\n        if (toggleMode) {\r\n            replace = !replace;\r\n        }\r\n        const overwriteBefore = item.position.column - item.editStart.column;\r\n        const overwriteAfter = (replace ? item.editReplaceEnd.column : item.editInsertEnd.column) - item.position.column;\r\n        const columnDelta = this.editor.getPosition().column - item.position.column;\r\n        const suffixDelta = this._lineSuffix.value ? this._lineSuffix.value.delta(this.editor.getPosition()) : 0;\r\n        return {\r\n            overwriteBefore: overwriteBefore + columnDelta,\r\n            overwriteAfter: overwriteAfter + suffixDelta\r\n        };\r\n    }\r\n    _alertCompletionItem(item) {\r\n        if (isNonEmptyArray(item.completion.additionalTextEdits)) {\r\n            let msg = nls.localize('aria.alert.snippet', \"Accepting '{0}' made {1} additional edits\", item.textLabel, item.completion.additionalTextEdits.length);\r\n            alert(msg);\r\n        }\r\n    }\r\n    triggerSuggest(onlyFrom) {\r\n        if (this.editor.hasModel()) {\r\n            this.model.trigger({ auto: false, shy: false }, false, onlyFrom);\r\n            this.editor.revealLine(this.editor.getPosition().lineNumber, 0 /* Smooth */);\r\n            this.editor.focus();\r\n        }\r\n    }\r\n    triggerSuggestAndAcceptBest(arg) {\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        const positionNow = this.editor.getPosition();\r\n        const fallback = () => {\r\n            if (positionNow.equals(this.editor.getPosition())) {\r\n                this._commandService.executeCommand(arg.fallback);\r\n            }\r\n        };\r\n        const makesTextEdit = (item) => {\r\n            if (item.completion.insertTextRules & 4 /* InsertAsSnippet */ || item.completion.additionalTextEdits) {\r\n                // snippet, other editor -> makes edit\r\n                return true;\r\n            }\r\n            const position = this.editor.getPosition();\r\n            const startColumn = item.editStart.column;\r\n            const endColumn = position.column;\r\n            if (endColumn - startColumn !== item.completion.insertText.length) {\r\n                // unequal lengths -> makes edit\r\n                return true;\r\n            }\r\n            const textNow = this.editor.getModel().getValueInRange({\r\n                startLineNumber: position.lineNumber,\r\n                startColumn,\r\n                endLineNumber: position.lineNumber,\r\n                endColumn\r\n            });\r\n            // unequal text -> makes edit\r\n            return textNow !== item.completion.insertText;\r\n        };\r\n        Event.once(this.model.onDidTrigger)(_ => {\r\n            // wait for trigger because only then the cancel-event is trustworthy\r\n            let listener = [];\r\n            Event.any(this.model.onDidTrigger, this.model.onDidCancel)(() => {\r\n                // retrigger or cancel -> try to type default text\r\n                dispose(listener);\r\n                fallback();\r\n            }, undefined, listener);\r\n            this.model.onDidSuggest(({ completionModel }) => {\r\n                dispose(listener);\r\n                if (completionModel.items.length === 0) {\r\n                    fallback();\r\n                    return;\r\n                }\r\n                const index = this._memoryService.select(this.editor.getModel(), this.editor.getPosition(), completionModel.items);\r\n                const item = completionModel.items[index];\r\n                if (!makesTextEdit(item)) {\r\n                    fallback();\r\n                    return;\r\n                }\r\n                this.editor.pushUndoStop();\r\n                this._insertSuggestion({ index, item, model: completionModel }, 4 /* KeepAlternativeSuggestions */ | 1 /* NoBeforeUndoStop */ | 2 /* NoAfterUndoStop */);\r\n            }, undefined, listener);\r\n        });\r\n        this.model.trigger({ auto: false, shy: true });\r\n        this.editor.revealLine(positionNow.lineNumber, 0 /* Smooth */);\r\n        this.editor.focus();\r\n    }\r\n    acceptSelectedSuggestion(keepAlternativeSuggestions, alternativeOverwriteConfig) {\r\n        const item = this.widget.value.getFocusedItem();\r\n        let flags = 0;\r\n        if (keepAlternativeSuggestions) {\r\n            flags |= 4 /* KeepAlternativeSuggestions */;\r\n        }\r\n        if (alternativeOverwriteConfig) {\r\n            flags |= 8 /* AlternativeOverwriteConfig */;\r\n        }\r\n        this._insertSuggestion(item, flags);\r\n    }\r\n    acceptNextSuggestion() {\r\n        this._alternatives.value.next();\r\n    }\r\n    acceptPrevSuggestion() {\r\n        this._alternatives.value.prev();\r\n    }\r\n    cancelSuggestWidget() {\r\n        this.model.cancel();\r\n        this.model.clear();\r\n        this.widget.value.hideWidget();\r\n    }\r\n    selectNextSuggestion() {\r\n        this.widget.value.selectNext();\r\n    }\r\n    selectNextPageSuggestion() {\r\n        this.widget.value.selectNextPage();\r\n    }\r\n    selectLastSuggestion() {\r\n        this.widget.value.selectLast();\r\n    }\r\n    selectPrevSuggestion() {\r\n        this.widget.value.selectPrevious();\r\n    }\r\n    selectPrevPageSuggestion() {\r\n        this.widget.value.selectPreviousPage();\r\n    }\r\n    selectFirstSuggestion() {\r\n        this.widget.value.selectFirst();\r\n    }\r\n    toggleSuggestionDetails() {\r\n        this.widget.value.toggleDetails();\r\n    }\r\n    toggleExplainMode() {\r\n        this.widget.value.toggleExplainMode();\r\n    }\r\n    toggleSuggestionFocus() {\r\n        this.widget.value.toggleDetailsFocus();\r\n    }\r\n    resetWidgetSize() {\r\n        this.widget.value.resetPersistedSize();\r\n    }\r\n    forceRenderingAbove() {\r\n        this.widget.value.forceRenderingAbove();\r\n    }\r\n    stopForceRenderingAbove() {\r\n        this.widget.value.stopForceRenderingAbove();\r\n    }\r\n};\r\nSuggestController.ID = 'editor.contrib.suggestController';\r\nSuggestController = __decorate([\r\n    __param(1, ISuggestMemoryService),\r\n    __param(2, ICommandService),\r\n    __param(3, IContextKeyService),\r\n    __param(4, IInstantiationService),\r\n    __param(5, ILogService)\r\n], SuggestController);\r\nexport { SuggestController };\r\nexport class TriggerSuggestAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: TriggerSuggestAction.id,\r\n            label: nls.localize('suggest.trigger.label', \"Trigger Suggest\"),\r\n            alias: 'Trigger Suggest',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasCompletionItemProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 10 /* Space */,\r\n                secondary: [2048 /* CtrlCmd */ | 39 /* KEY_I */],\r\n                mac: { primary: 256 /* WinCtrl */ | 10 /* Space */, secondary: [512 /* Alt */ | 9 /* Escape */, 2048 /* CtrlCmd */ | 39 /* KEY_I */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        const controller = SuggestController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        controller.triggerSuggest();\r\n    }\r\n}\r\nTriggerSuggestAction.id = 'editor.action.triggerSuggest';\r\nregisterEditorContribution(SuggestController.ID, SuggestController);\r\nregisterEditorAction(TriggerSuggestAction);\r\nconst weight = 100 /* EditorContrib */ + 90;\r\nconst SuggestCommand = EditorCommand.bindToContribution(SuggestController.get);\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'acceptSelectedSuggestion',\r\n    precondition: SuggestContext.Visible,\r\n    handler(x) {\r\n        x.acceptSelectedSuggestion(true, false);\r\n    }\r\n}));\r\n// normal tab\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'acceptSelectedSuggestion',\r\n    when: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\r\n    primary: 2 /* Tab */,\r\n    weight\r\n});\r\n// accept on enter has special rules\r\nKeybindingsRegistry.registerKeybindingRule({\r\n    id: 'acceptSelectedSuggestion',\r\n    when: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus, SuggestContext.AcceptSuggestionsOnEnter, SuggestContext.MakesTextEdit),\r\n    primary: 3 /* Enter */,\r\n    weight,\r\n});\r\nMenuRegistry.appendMenuItem(suggestWidgetStatusbarMenu, {\r\n    command: { id: 'acceptSelectedSuggestion', title: nls.localize('accept.insert', \"Insert\") },\r\n    group: 'left',\r\n    order: 1,\r\n    when: SuggestContext.HasInsertAndReplaceRange.toNegated()\r\n});\r\nMenuRegistry.appendMenuItem(suggestWidgetStatusbarMenu, {\r\n    command: { id: 'acceptSelectedSuggestion', title: nls.localize('accept.insert', \"Insert\") },\r\n    group: 'left',\r\n    order: 1,\r\n    when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert'))\r\n});\r\nMenuRegistry.appendMenuItem(suggestWidgetStatusbarMenu, {\r\n    command: { id: 'acceptSelectedSuggestion', title: nls.localize('accept.replace', \"Replace\") },\r\n    group: 'left',\r\n    order: 1,\r\n    when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace'))\r\n});\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'acceptAlternativeSelectedSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, EditorContextKeys.textInputFocus),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 1024 /* Shift */ | 3 /* Enter */,\r\n        secondary: [1024 /* Shift */ | 2 /* Tab */],\r\n    },\r\n    handler(x) {\r\n        x.acceptSelectedSuggestion(false, true);\r\n    },\r\n    menuOpts: [{\r\n            menuId: suggestWidgetStatusbarMenu,\r\n            group: 'left',\r\n            order: 2,\r\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('insert')),\r\n            title: nls.localize('accept.replace', \"Replace\")\r\n        }, {\r\n            menuId: suggestWidgetStatusbarMenu,\r\n            group: 'left',\r\n            order: 2,\r\n            when: ContextKeyExpr.and(SuggestContext.HasInsertAndReplaceRange, SuggestContext.InsertMode.isEqualTo('replace')),\r\n            title: nls.localize('accept.insert', \"Insert\")\r\n        }]\r\n}));\r\n// continue to support the old command\r\nCommandsRegistry.registerCommandAlias('acceptSelectedSuggestionOnEnter', 'acceptSelectedSuggestion');\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'hideSuggestWidget',\r\n    precondition: SuggestContext.Visible,\r\n    handler: x => x.cancelSuggestWidget(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectNextSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: c => c.selectNextSuggestion(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 18 /* DownArrow */,\r\n        secondary: [2048 /* CtrlCmd */ | 18 /* DownArrow */],\r\n        mac: { primary: 18 /* DownArrow */, secondary: [2048 /* CtrlCmd */ | 18 /* DownArrow */, 256 /* WinCtrl */ | 44 /* KEY_N */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectNextPageSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: c => c.selectNextPageSuggestion(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 12 /* PageDown */,\r\n        secondary: [2048 /* CtrlCmd */ | 12 /* PageDown */]\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectLastSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: c => c.selectLastSuggestion()\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectPrevSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: c => c.selectPrevSuggestion(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 16 /* UpArrow */,\r\n        secondary: [2048 /* CtrlCmd */ | 16 /* UpArrow */],\r\n        mac: { primary: 16 /* UpArrow */, secondary: [2048 /* CtrlCmd */ | 16 /* UpArrow */, 256 /* WinCtrl */ | 46 /* KEY_P */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectPrevPageSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: c => c.selectPrevPageSuggestion(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 11 /* PageUp */,\r\n        secondary: [2048 /* CtrlCmd */ | 11 /* PageUp */]\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'selectFirstSuggestion',\r\n    precondition: ContextKeyExpr.and(SuggestContext.Visible, SuggestContext.MultipleSuggestions),\r\n    handler: c => c.selectFirstSuggestion()\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'toggleSuggestionDetails',\r\n    precondition: SuggestContext.Visible,\r\n    handler: x => x.toggleSuggestionDetails(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2048 /* CtrlCmd */ | 10 /* Space */,\r\n        mac: { primary: 256 /* WinCtrl */ | 10 /* Space */ }\r\n    },\r\n    menuOpts: [{\r\n            menuId: suggestWidgetStatusbarMenu,\r\n            group: 'right',\r\n            order: 1,\r\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible, SuggestContext.CanResolve),\r\n            title: nls.localize('detail.more', \"show less\")\r\n        }, {\r\n            menuId: suggestWidgetStatusbarMenu,\r\n            group: 'right',\r\n            order: 1,\r\n            when: ContextKeyExpr.and(SuggestContext.DetailsVisible.toNegated(), SuggestContext.CanResolve),\r\n            title: nls.localize('detail.less', \"show more\")\r\n        }]\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'toggleExplainMode',\r\n    precondition: SuggestContext.Visible,\r\n    handler: x => x.toggleExplainMode(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */,\r\n        primary: 2048 /* CtrlCmd */ | 85 /* US_SLASH */,\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'toggleSuggestionFocus',\r\n    precondition: SuggestContext.Visible,\r\n    handler: x => x.toggleSuggestionFocus(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 10 /* Space */,\r\n        mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 10 /* Space */ }\r\n    }\r\n}));\r\n//#region tab completions\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'insertBestCompletion',\r\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), WordContextKey.AtEnd, SuggestContext.Visible.toNegated(), SuggestAlternatives.OtherSuggestions.toNegated(), SnippetController2.InSnippetMode.toNegated()),\r\n    handler: (x, arg) => {\r\n        x.triggerSuggestAndAcceptBest(isObject(arg) ? Object.assign({ fallback: 'tab' }, arg) : { fallback: 'tab' });\r\n    },\r\n    kbOpts: {\r\n        weight,\r\n        primary: 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'insertNextSuggestion',\r\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\r\n    handler: x => x.acceptNextSuggestion(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorCommand(new SuggestCommand({\r\n    id: 'insertPrevSuggestion',\r\n    precondition: ContextKeyExpr.and(EditorContextKeys.textInputFocus, ContextKeyExpr.equals('config.editor.tabCompletion', 'on'), SuggestAlternatives.OtherSuggestions, SuggestContext.Visible.toNegated(), SnippetController2.InSnippetMode.toNegated()),\r\n    handler: x => x.acceptPrevSuggestion(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.textInputFocus,\r\n        primary: 1024 /* Shift */ | 2 /* Tab */\r\n    }\r\n}));\r\nregisterEditorAction(class extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.resetSuggestSize',\r\n            label: nls.localize('suggest.reset.label', \"Reset Suggest Widget Size\"),\r\n            alias: 'Reset Suggest Widget Size',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        SuggestController.get(editor).resetWidgetSize();\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { Event } from '../../../base/common/event.js';\r\nimport { toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { BaseGhostTextWidgetModel, GhostText } from './ghostText.js';\r\nimport { inlineCompletionToGhostText } from './inlineCompletionsModel.js';\r\nimport { SnippetParser } from '../snippet/snippetParser.js';\r\nimport { SnippetSession } from '../snippet/snippetSession.js';\r\nimport { SuggestController } from '../suggest/suggestController.js';\r\nexport class SuggestWidgetAdapterModel extends BaseGhostTextWidgetModel {\r\n    constructor(editor) {\r\n        super(editor);\r\n        this.isSuggestWidgetVisible = false;\r\n        this.currentGhostText = undefined;\r\n        this._isActive = false;\r\n        this.isShiftKeyPressed = false;\r\n        this.minReservedLineCount = 0;\r\n        // This delay fixes an suggest widget issue when typing \".\" immediately restarts the suggestion session.\r\n        this.setInactiveDelayed = this._register(new RunOnceScheduler(() => {\r\n            if (!this.isSuggestWidgetVisible) {\r\n                if (this.isActive) {\r\n                    this._isActive = false;\r\n                    this.onDidChangeEmitter.fire();\r\n                }\r\n            }\r\n        }, 100));\r\n        const suggestController = SuggestController.get(this.editor);\r\n        if (suggestController) {\r\n            let isBoundToSuggestWidget = false;\r\n            const bindToSuggestWidget = () => {\r\n                if (isBoundToSuggestWidget) {\r\n                    return;\r\n                }\r\n                isBoundToSuggestWidget = true;\r\n                this._register(suggestController.widget.value.onDidShow(() => {\r\n                    this.isSuggestWidgetVisible = true;\r\n                    this._isActive = true;\r\n                    this.updateFromSuggestion();\r\n                }));\r\n                this._register(suggestController.widget.value.onDidHide(() => {\r\n                    this.isSuggestWidgetVisible = false;\r\n                    this.setInactiveDelayed.schedule();\r\n                    this.minReservedLineCount = 0;\r\n                    this.updateFromSuggestion();\r\n                }));\r\n                this._register(suggestController.widget.value.onDidFocus(() => {\r\n                    this.isSuggestWidgetVisible = true;\r\n                    this._isActive = true;\r\n                    this.updateFromSuggestion();\r\n                }));\r\n            };\r\n            this._register(Event.once(suggestController.model.onDidTrigger)(e => {\r\n                bindToSuggestWidget();\r\n            }));\r\n        }\r\n        this.updateFromSuggestion();\r\n        this._register(this.editor.onDidChangeCursorPosition((e) => {\r\n            if (this.isSuggestionPreviewEnabled()) {\r\n                this.update();\r\n            }\r\n        }));\r\n        this._register(toDisposable(() => {\r\n            const suggestController = SuggestController.get(this.editor);\r\n            if (suggestController) {\r\n                suggestController.stopForceRenderingAbove();\r\n            }\r\n        }));\r\n        // See the command acceptAlternativeSelectedSuggestion that is bound to shift+tab\r\n        this._register(editor.onKeyDown(e => {\r\n            if (e.shiftKey && !this.isShiftKeyPressed) {\r\n                this.isShiftKeyPressed = true;\r\n                this.updateFromSuggestion();\r\n            }\r\n        }));\r\n        this._register(editor.onKeyUp(e => {\r\n            if (e.shiftKey && this.isShiftKeyPressed) {\r\n                this.isShiftKeyPressed = false;\r\n                this.updateFromSuggestion();\r\n            }\r\n        }));\r\n    }\r\n    get isActive() { return this._isActive; }\r\n    setExpanded(expanded) {\r\n        super.setExpanded(expanded);\r\n        this.updateFromSuggestion();\r\n    }\r\n    isSuggestionPreviewEnabled() {\r\n        const suggestOptions = this.editor.getOption(105 /* suggest */);\r\n        return suggestOptions.preview;\r\n    }\r\n    updateFromSuggestion() {\r\n        const suggestController = SuggestController.get(this.editor);\r\n        if (!suggestController) {\r\n            this.setCurrentInlineCompletion(undefined);\r\n            return;\r\n        }\r\n        if (!this.isSuggestWidgetVisible) {\r\n            this.setCurrentInlineCompletion(undefined);\r\n            return;\r\n        }\r\n        const focusedItem = suggestController.widget.value.getFocusedItem();\r\n        if (!focusedItem) {\r\n            this.setCurrentInlineCompletion(undefined);\r\n            return;\r\n        }\r\n        // TODO: item.isResolved\r\n        this.setCurrentInlineCompletion(getInlineCompletion(suggestController, this.editor.getPosition(), focusedItem, this.isShiftKeyPressed));\r\n    }\r\n    setCurrentInlineCompletion(completion) {\r\n        this.currentCompletion = completion;\r\n        this.update();\r\n    }\r\n    update() {\r\n        const completion = this.currentCompletion;\r\n        const mode = this.editor.getOptions().get(105 /* suggest */).previewMode;\r\n        this.setGhostText(completion\r\n            ? (inlineCompletionToGhostText(completion, this.editor.getModel(), mode, this.editor.getPosition()) ||\r\n                // Show an invisible ghost text to reserve space\r\n                new GhostText(completion.range.endLineNumber, [], this.minReservedLineCount))\r\n            : undefined);\r\n    }\r\n    setGhostText(newGhostText) {\r\n        if (GhostText.equals(this.currentGhostText, newGhostText)) {\r\n            return;\r\n        }\r\n        this.currentGhostText = newGhostText;\r\n        if (this.currentGhostText && this.expanded) {\r\n            this.minReservedLineCount = Math.max(this.minReservedLineCount, ...this.currentGhostText.parts.map(p => p.lines.length - 1));\r\n        }\r\n        const suggestController = SuggestController.get(this.editor);\r\n        if (suggestController) {\r\n            if (this.minReservedLineCount >= 1 && this.isSuggestionPreviewEnabled()) {\r\n                suggestController.forceRenderingAbove();\r\n            }\r\n            else {\r\n                suggestController.stopForceRenderingAbove();\r\n            }\r\n        }\r\n        this.onDidChangeEmitter.fire();\r\n    }\r\n    get ghostText() {\r\n        return this.isSuggestionPreviewEnabled()\r\n            ? this.currentGhostText\r\n            : undefined;\r\n    }\r\n}\r\nfunction getInlineCompletion(suggestController, position, suggestion, toggleMode) {\r\n    const item = suggestion.item;\r\n    if (Array.isArray(item.completion.additionalTextEdits)) {\r\n        // cannot represent additional text edits\r\n        return {\r\n            text: '',\r\n            range: Range.fromPositions(position, position),\r\n        };\r\n    }\r\n    let { insertText } = item.completion;\r\n    if (item.completion.insertTextRules & 4 /* InsertAsSnippet */) {\r\n        const snippet = new SnippetParser().parse(insertText);\r\n        const model = suggestController.editor.getModel();\r\n        SnippetSession.adjustWhitespace(model, position, snippet, true, true);\r\n        insertText = snippet.toString();\r\n    }\r\n    const info = suggestController.getOverwriteInfo(item, toggleMode);\r\n    return {\r\n        text: insertText,\r\n        range: Range.fromPositions(position.delta(0, -info.overwriteBefore), position.delta(0, Math.max(info.overwriteAfter, 0))),\r\n    };\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport function createDisposableRef(object, disposable) {\r\n    return {\r\n        object,\r\n        dispose: () => disposable === null || disposable === void 0 ? void 0 : disposable.dispose(),\r\n    };\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { InlineCompletionsModel } from './inlineCompletionsModel.js';\r\nimport { SuggestWidgetAdapterModel } from './suggestWidgetAdapterModel.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { createDisposableRef } from './utils.js';\r\nexport class DelegatingModel extends Disposable {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.onDidChangeEmitter = new Emitter();\r\n        this.onDidChange = this.onDidChangeEmitter.event;\r\n        this.hasCachedGhostText = false;\r\n        this.currentModelRef = this._register(new MutableDisposable());\r\n    }\r\n    get targetModel() {\r\n        var _a;\r\n        return (_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object;\r\n    }\r\n    setTargetModel(model) {\r\n        var _a;\r\n        if (((_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object) === model) {\r\n            return;\r\n        }\r\n        this.currentModelRef.clear();\r\n        this.currentModelRef.value = model ? createDisposableRef(model, model.onDidChange(() => {\r\n            this.hasCachedGhostText = false;\r\n            this.onDidChangeEmitter.fire();\r\n        })) : undefined;\r\n        this.hasCachedGhostText = false;\r\n        this.onDidChangeEmitter.fire();\r\n    }\r\n    get ghostText() {\r\n        var _a, _b;\r\n        if (!this.hasCachedGhostText) {\r\n            this.cachedGhostText = (_b = (_a = this.currentModelRef.value) === null || _a === void 0 ? void 0 : _a.object) === null || _b === void 0 ? void 0 : _b.ghostText;\r\n            this.hasCachedGhostText = true;\r\n        }\r\n        return this.cachedGhostText;\r\n    }\r\n    setExpanded(expanded) {\r\n        var _a;\r\n        (_a = this.targetModel) === null || _a === void 0 ? void 0 : _a.setExpanded(expanded);\r\n    }\r\n    get expanded() {\r\n        return this.targetModel ? this.targetModel.expanded : false;\r\n    }\r\n    get minReservedLineCount() {\r\n        return this.targetModel ? this.targetModel.minReservedLineCount : 0;\r\n    }\r\n}\r\n/**\r\n * A ghost text model that is both driven by inline completions and the suggest widget.\r\n*/\r\nlet GhostTextModel = class GhostTextModel extends DelegatingModel {\r\n    constructor(editor, commandService) {\r\n        super();\r\n        this.editor = editor;\r\n        this.commandService = commandService;\r\n        this.suggestWidgetAdapterModel = this._register(new SuggestWidgetAdapterModel(this.editor));\r\n        this.inlineCompletionsModel = this._register(new InlineCompletionsModel(this.editor, this.commandService));\r\n        this._register(this.suggestWidgetAdapterModel.onDidChange(() => {\r\n            this.updateModel();\r\n        }));\r\n        this.updateModel();\r\n    }\r\n    get activeInlineCompletionsModel() {\r\n        if (this.targetModel === this.inlineCompletionsModel) {\r\n            return this.inlineCompletionsModel;\r\n        }\r\n        return undefined;\r\n    }\r\n    updateModel() {\r\n        this.setTargetModel(this.suggestWidgetAdapterModel.isActive\r\n            ? this.suggestWidgetAdapterModel\r\n            : this.inlineCompletionsModel);\r\n        this.inlineCompletionsModel.setActive(this.targetModel === this.inlineCompletionsModel);\r\n    }\r\n    shouldShowHoverAt(hoverRange) {\r\n        var _a;\r\n        const ghostText = (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.ghostText;\r\n        if (ghostText) {\r\n            return ghostText.parts.some(p => hoverRange.containsPosition(new Position(ghostText.lineNumber, p.column)));\r\n        }\r\n        return false;\r\n    }\r\n    triggerInlineCompletion() {\r\n        var _a;\r\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.trigger();\r\n    }\r\n    commitInlineCompletion() {\r\n        var _a;\r\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.commitCurrentSuggestion();\r\n    }\r\n    hideInlineCompletion() {\r\n        var _a;\r\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.hide();\r\n    }\r\n    showNextInlineCompletion() {\r\n        var _a;\r\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.showNext();\r\n    }\r\n    showPreviousInlineCompletion() {\r\n        var _a;\r\n        (_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.showPrevious();\r\n    }\r\n    hasMultipleInlineCompletions() {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const result = yield ((_a = this.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.hasMultipleInlineCompletions());\r\n            return result !== undefined ? result : false;\r\n        });\r\n    }\r\n};\r\nGhostTextModel = __decorate([\r\n    __param(1, ICommandService)\r\n], GhostTextModel);\r\nexport { GhostTextModel };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { Disposable, MutableDisposable, toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { GhostTextWidget } from './ghostTextWidget.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { GhostTextModel } from './ghostTextModel.js';\r\nlet GhostTextController = class GhostTextController extends Disposable {\r\n    constructor(editor, instantiationService) {\r\n        super();\r\n        this.editor = editor;\r\n        this.instantiationService = instantiationService;\r\n        this.triggeredExplicitly = false;\r\n        this.activeController = this._register(new MutableDisposable());\r\n        this._register(this.editor.onDidChangeModel(() => {\r\n            this.updateModelController();\r\n        }));\r\n        this._register(this.editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(105 /* suggest */)) {\r\n                this.updateModelController();\r\n            }\r\n            if (e.hasChanged(53 /* inlineSuggest */)) {\r\n                this.updateModelController();\r\n            }\r\n        }));\r\n        this.updateModelController();\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(GhostTextController.ID);\r\n    }\r\n    get activeModel() {\r\n        var _a;\r\n        return (_a = this.activeController.value) === null || _a === void 0 ? void 0 : _a.model;\r\n    }\r\n    // Don't call this method when not neccessary. It will recreate the activeController.\r\n    updateModelController() {\r\n        const suggestOptions = this.editor.getOption(105 /* suggest */);\r\n        const inlineSuggestOptions = this.editor.getOption(53 /* inlineSuggest */);\r\n        this.activeController.value = undefined;\r\n        // ActiveGhostTextController is only created if one of those settings is set or if the inline completions are triggered explicitly.\r\n        this.activeController.value =\r\n            this.editor.hasModel() && (suggestOptions.preview || inlineSuggestOptions.enabled || this.triggeredExplicitly)\r\n                ? this.instantiationService.createInstance(ActiveGhostTextController, this.editor)\r\n                : undefined;\r\n    }\r\n    shouldShowHoverAt(hoverRange) {\r\n        var _a;\r\n        return ((_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.shouldShowHoverAt(hoverRange)) || false;\r\n    }\r\n    shouldShowHoverAtViewZone(viewZoneId) {\r\n        var _a, _b;\r\n        return ((_b = (_a = this.activeController.value) === null || _a === void 0 ? void 0 : _a.widget) === null || _b === void 0 ? void 0 : _b.shouldShowHoverAtViewZone(viewZoneId)) || false;\r\n    }\r\n    trigger() {\r\n        var _a;\r\n        this.triggeredExplicitly = true;\r\n        if (!this.activeController.value) {\r\n            this.updateModelController();\r\n        }\r\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.triggerInlineCompletion();\r\n    }\r\n    commit() {\r\n        var _a;\r\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.commitInlineCompletion();\r\n    }\r\n    hide() {\r\n        var _a;\r\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.hideInlineCompletion();\r\n    }\r\n    showNextInlineCompletion() {\r\n        var _a;\r\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.showNextInlineCompletion();\r\n    }\r\n    showPreviousInlineCompletion() {\r\n        var _a;\r\n        (_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.showPreviousInlineCompletion();\r\n    }\r\n    hasMultipleInlineCompletions() {\r\n        var _a;\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const result = yield ((_a = this.activeModel) === null || _a === void 0 ? void 0 : _a.hasMultipleInlineCompletions());\r\n            return result !== undefined ? result : false;\r\n        });\r\n    }\r\n};\r\nGhostTextController.inlineSuggestionVisible = new RawContextKey('inlineSuggestionVisible', false, nls.localize('inlineSuggestionVisible', \"Whether an inline suggestion is visible\"));\r\nGhostTextController.inlineSuggestionHasIndentation = new RawContextKey('inlineSuggestionHasIndentation', false, nls.localize('inlineSuggestionHasIndentation', \"Whether the inline suggestion starts with whitespace\"));\r\nGhostTextController.ID = 'editor.contrib.ghostTextController';\r\nGhostTextController = __decorate([\r\n    __param(1, IInstantiationService)\r\n], GhostTextController);\r\nexport { GhostTextController };\r\nclass GhostTextContextKeys {\r\n    constructor(contextKeyService) {\r\n        this.contextKeyService = contextKeyService;\r\n        this.inlineCompletionVisible = GhostTextController.inlineSuggestionVisible.bindTo(this.contextKeyService);\r\n        this.inlineCompletionSuggestsIndentation = GhostTextController.inlineSuggestionHasIndentation.bindTo(this.contextKeyService);\r\n    }\r\n}\r\n/**\r\n * The controller for a text editor with an initialized text model.\r\n * Must be disposed as soon as the model detaches from the editor.\r\n*/\r\nlet ActiveGhostTextController = class ActiveGhostTextController extends Disposable {\r\n    constructor(editor, instantiationService, contextKeyService) {\r\n        super();\r\n        this.editor = editor;\r\n        this.instantiationService = instantiationService;\r\n        this.contextKeyService = contextKeyService;\r\n        this.contextKeys = new GhostTextContextKeys(this.contextKeyService);\r\n        this.model = this._register(this.instantiationService.createInstance(GhostTextModel, this.editor));\r\n        this.widget = this._register(this.instantiationService.createInstance(GhostTextWidget, this.editor, this.model));\r\n        this._register(toDisposable(() => {\r\n            this.contextKeys.inlineCompletionVisible.set(false);\r\n            this.contextKeys.inlineCompletionSuggestsIndentation.set(false);\r\n        }));\r\n        this._register(this.model.onDidChange(() => {\r\n            this.updateContextKeys();\r\n        }));\r\n        this.updateContextKeys();\r\n    }\r\n    updateContextKeys() {\r\n        var _a;\r\n        this.contextKeys.inlineCompletionVisible.set(((_a = this.model.activeInlineCompletionsModel) === null || _a === void 0 ? void 0 : _a.ghostText) !== undefined);\r\n        const ghostText = this.model.inlineCompletionsModel.ghostText;\r\n        if (ghostText && ghostText.parts.length > 0) {\r\n            const { column, lines } = ghostText.parts[0];\r\n            const suggestionStartsWithWs = lines[0].startsWith(' ') || lines[0].startsWith('\\t');\r\n            const indentationEndColumn = this.editor.getModel().getLineIndentColumn(ghostText.lineNumber);\r\n            const inIndentation = column <= indentationEndColumn;\r\n            this.contextKeys.inlineCompletionSuggestsIndentation.set(!!this.model.activeInlineCompletionsModel\r\n                && suggestionStartsWithWs && inIndentation);\r\n        }\r\n        else {\r\n            this.contextKeys.inlineCompletionSuggestsIndentation.set(false);\r\n        }\r\n    }\r\n};\r\nActiveGhostTextController = __decorate([\r\n    __param(1, IInstantiationService),\r\n    __param(2, IContextKeyService)\r\n], ActiveGhostTextController);\r\nexport { ActiveGhostTextController };\r\nconst GhostTextCommand = EditorCommand.bindToContribution(GhostTextController.get);\r\nexport const commitInlineSuggestionAction = new GhostTextCommand({\r\n    id: 'editor.action.inlineSuggest.commit',\r\n    precondition: ContextKeyExpr.and(GhostTextController.inlineSuggestionVisible, GhostTextController.inlineSuggestionHasIndentation.toNegated(), EditorContextKeys.tabMovesFocus.toNegated()),\r\n    kbOpts: {\r\n        weight: 200,\r\n        primary: 2 /* Tab */,\r\n    },\r\n    handler(x) {\r\n        x.commit();\r\n        x.editor.focus();\r\n    }\r\n});\r\nregisterEditorCommand(commitInlineSuggestionAction);\r\nregisterEditorCommand(new GhostTextCommand({\r\n    id: 'editor.action.inlineSuggest.hide',\r\n    precondition: GhostTextController.inlineSuggestionVisible,\r\n    kbOpts: {\r\n        weight: 100,\r\n        primary: 9 /* Escape */,\r\n    },\r\n    handler(x) {\r\n        x.hide();\r\n    }\r\n}));\r\nexport class ShowNextInlineSuggestionAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: ShowNextInlineSuggestionAction.ID,\r\n            label: nls.localize('action.inlineSuggest.showNext', \"Show Next Inline Suggestion\"),\r\n            alias: 'Show Next Inline Suggestion',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, GhostTextController.inlineSuggestionVisible),\r\n            kbOpts: {\r\n                weight: 100,\r\n                primary: 512 /* Alt */ | 89 /* US_CLOSE_SQUARE_BRACKET */,\r\n            },\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const controller = GhostTextController.get(editor);\r\n            if (controller) {\r\n                controller.showNextInlineCompletion();\r\n                editor.focus();\r\n            }\r\n        });\r\n    }\r\n}\r\nShowNextInlineSuggestionAction.ID = 'editor.action.inlineSuggest.showNext';\r\nexport class ShowPreviousInlineSuggestionAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: ShowPreviousInlineSuggestionAction.ID,\r\n            label: nls.localize('action.inlineSuggest.showPrevious', \"Show Previous Inline Suggestion\"),\r\n            alias: 'Show Previous Inline Suggestion',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, GhostTextController.inlineSuggestionVisible),\r\n            kbOpts: {\r\n                weight: 100,\r\n                primary: 512 /* Alt */ | 87 /* US_OPEN_SQUARE_BRACKET */,\r\n            },\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const controller = GhostTextController.get(editor);\r\n            if (controller) {\r\n                controller.showPreviousInlineCompletion();\r\n                editor.focus();\r\n            }\r\n        });\r\n    }\r\n}\r\nShowPreviousInlineSuggestionAction.ID = 'editor.action.inlineSuggest.showPrevious';\r\nexport class TriggerInlineSuggestionAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.inlineSuggest.trigger',\r\n            label: nls.localize('action.inlineSuggest.trigger', \"Trigger Inline Suggestion\"),\r\n            alias: 'Trigger Inline Suggestion',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const controller = GhostTextController.get(editor);\r\n            if (controller) {\r\n                controller.trigger();\r\n            }\r\n        });\r\n    }\r\n}\r\nregisterEditorContribution(GhostTextController.ID, GhostTextController);\r\nregisterEditorAction(TriggerInlineSuggestionAction);\r\nregisterEditorAction(ShowNextInlineSuggestionAction);\r\nregisterEditorAction(ShowPreviousInlineSuggestionAction);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { HoverForeignElementAnchor } from '../hover/hoverTypes.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { commitInlineSuggestionAction, GhostTextController, ShowNextInlineSuggestionAction, ShowPreviousInlineSuggestionAction } from './ghostTextController.js';\r\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\r\nimport { IMenuService, MenuId, MenuItemAction } from '../../../platform/actions/common/actions.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nexport class InlineCompletionsHover {\r\n    constructor(owner, range, controller) {\r\n        this.owner = owner;\r\n        this.range = range;\r\n        this.controller = controller;\r\n    }\r\n    isValidForHoverAnchor(anchor) {\r\n        return (anchor.type === 1 /* Range */\r\n            && this.range.startColumn <= anchor.range.startColumn\r\n            && this.range.endColumn >= anchor.range.endColumn);\r\n    }\r\n    hasMultipleSuggestions() {\r\n        return this.controller.hasMultipleInlineCompletions();\r\n    }\r\n}\r\nlet InlineCompletionsHoverParticipant = class InlineCompletionsHoverParticipant {\r\n    constructor(_editor, hover, _commandService, _menuService, _contextKeyService) {\r\n        this._editor = _editor;\r\n        this._commandService = _commandService;\r\n        this._menuService = _menuService;\r\n        this._contextKeyService = _contextKeyService;\r\n    }\r\n    suggestHoverAnchor(mouseEvent) {\r\n        const controller = GhostTextController.get(this._editor);\r\n        if (!controller) {\r\n            return null;\r\n        }\r\n        if (mouseEvent.target.type === 8 /* CONTENT_VIEW_ZONE */) {\r\n            // handle the case where the mouse is over the view zone\r\n            const viewZoneData = mouseEvent.target.detail;\r\n            if (controller.shouldShowHoverAtViewZone(viewZoneData.viewZoneId)) {\r\n                return new HoverForeignElementAnchor(1000, this, Range.fromPositions(viewZoneData.positionBefore || viewZoneData.position, viewZoneData.positionBefore || viewZoneData.position));\r\n            }\r\n        }\r\n        if (mouseEvent.target.type === 7 /* CONTENT_EMPTY */ && mouseEvent.target.range) {\r\n            // handle the case where the mouse is over the empty portion of a line following ghost text\r\n            if (controller.shouldShowHoverAt(mouseEvent.target.range)) {\r\n                return new HoverForeignElementAnchor(1000, this, mouseEvent.target.range);\r\n            }\r\n        }\r\n        if (mouseEvent.target.type === 6 /* CONTENT_TEXT */ && mouseEvent.target.range && mouseEvent.target.detail) {\r\n            // handle the case where the mouse is directly over ghost text\r\n            const mightBeForeignElement = mouseEvent.target.detail.mightBeForeignElement;\r\n            if (mightBeForeignElement && controller.shouldShowHoverAt(mouseEvent.target.range)) {\r\n                return new HoverForeignElementAnchor(1000, this, mouseEvent.target.range);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    computeSync(anchor, lineDecorations) {\r\n        const controller = GhostTextController.get(this._editor);\r\n        if (controller && controller.shouldShowHoverAt(anchor.range)) {\r\n            return [new InlineCompletionsHover(this, anchor.range, controller)];\r\n        }\r\n        return [];\r\n    }\r\n    renderHoverParts(hoverParts, fragment, statusBar) {\r\n        const disposableStore = new DisposableStore();\r\n        const menu = disposableStore.add(this._menuService.createMenu(MenuId.InlineCompletionsActions, this._contextKeyService));\r\n        const previousAction = statusBar.addAction({\r\n            label: nls.localize('showNextInlineSuggestion', \"Next\"),\r\n            commandId: ShowNextInlineSuggestionAction.ID,\r\n            run: () => this._commandService.executeCommand(ShowNextInlineSuggestionAction.ID)\r\n        });\r\n        const nextAction = statusBar.addAction({\r\n            label: nls.localize('showPreviousInlineSuggestion', \"Previous\"),\r\n            commandId: ShowPreviousInlineSuggestionAction.ID,\r\n            run: () => this._commandService.executeCommand(ShowPreviousInlineSuggestionAction.ID)\r\n        });\r\n        statusBar.addAction({\r\n            label: nls.localize('acceptInlineSuggestion', \"Accept\"),\r\n            commandId: commitInlineSuggestionAction.id,\r\n            run: () => this._commandService.executeCommand(commitInlineSuggestionAction.id)\r\n        });\r\n        const actions = [previousAction, nextAction];\r\n        for (const action of actions) {\r\n            action.setEnabled(false);\r\n        }\r\n        hoverParts[0].hasMultipleSuggestions().then(hasMore => {\r\n            for (const action of actions) {\r\n                action.setEnabled(hasMore);\r\n            }\r\n        });\r\n        for (const [_, group] of menu.getActions()) {\r\n            for (const action of group) {\r\n                if (action instanceof MenuItemAction) {\r\n                    statusBar.addAction({\r\n                        label: action.label,\r\n                        commandId: action.item.id,\r\n                        run: () => this._commandService.executeCommand(action.item.id)\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        return disposableStore;\r\n    }\r\n};\r\nInlineCompletionsHoverParticipant = __decorate([\r\n    __param(2, ICommandService),\r\n    __param(3, IMenuService),\r\n    __param(4, IContextKeyService)\r\n], InlineCompletionsHoverParticipant);\r\nexport { InlineCompletionsHoverParticipant };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { illegalArgument } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ColorProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nexport function getColors(model, token) {\r\n    const colors = [];\r\n    const providers = ColorProviderRegistry.ordered(model).reverse();\r\n    const promises = providers.map(provider => Promise.resolve(provider.provideDocumentColors(model, token)).then(result => {\r\n        if (Array.isArray(result)) {\r\n            for (let colorInfo of result) {\r\n                colors.push({ colorInfo, provider });\r\n            }\r\n        }\r\n    }));\r\n    return Promise.all(promises).then(() => colors);\r\n}\r\nexport function getColorPresentations(model, colorInfo, provider, token) {\r\n    return Promise.resolve(provider.provideColorPresentations(model, colorInfo, token));\r\n}\r\nCommandsRegistry.registerCommand('_executeDocumentColorProvider', function (accessor, ...args) {\r\n    const [resource] = args;\r\n    if (!(resource instanceof URI)) {\r\n        throw illegalArgument();\r\n    }\r\n    const model = accessor.get(IModelService).getModel(resource);\r\n    if (!model) {\r\n        throw illegalArgument();\r\n    }\r\n    const rawCIs = [];\r\n    const providers = ColorProviderRegistry.ordered(model).reverse();\r\n    const promises = providers.map(provider => Promise.resolve(provider.provideDocumentColors(model, CancellationToken.None)).then(result => {\r\n        if (Array.isArray(result)) {\r\n            for (let ci of result) {\r\n                rawCIs.push({ range: ci.range, color: [ci.color.red, ci.color.green, ci.color.blue, ci.color.alpha] });\r\n            }\r\n        }\r\n    }));\r\n    return Promise.all(promises).then(() => rawCIs);\r\n});\r\nCommandsRegistry.registerCommand('_executeColorPresentationProvider', function (accessor, ...args) {\r\n    const [color, context] = args;\r\n    const { uri, range } = context;\r\n    if (!(uri instanceof URI) || !Array.isArray(color) || color.length !== 4 || !Range.isIRange(range)) {\r\n        throw illegalArgument();\r\n    }\r\n    const [red, green, blue, alpha] = color;\r\n    const model = accessor.get(IModelService).getModel(uri);\r\n    if (!model) {\r\n        throw illegalArgument();\r\n    }\r\n    const colorInfo = {\r\n        range,\r\n        color: { red, green, blue, alpha }\r\n    };\r\n    const presentations = [];\r\n    const providers = ColorProviderRegistry.ordered(model).reverse();\r\n    const promises = providers.map(provider => Promise.resolve(provider.provideColorPresentations(model, colorInfo, CancellationToken.None)).then(result => {\r\n        if (Array.isArray(result)) {\r\n            presentations.push(...result);\r\n        }\r\n    }));\r\n    return Promise.all(promises).then(() => presentations);\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { TimeoutTimer, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { RGBA } from '../../../base/common/color.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { hash } from '../../../base/common/hash.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { ColorProviderRegistry } from '../../common/modes.js';\r\nimport { getColors } from './color.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nconst MAX_DECORATORS = 500;\r\nlet ColorDetector = class ColorDetector extends Disposable {\r\n    constructor(_editor, _codeEditorService, _configurationService) {\r\n        super();\r\n        this._editor = _editor;\r\n        this._codeEditorService = _codeEditorService;\r\n        this._configurationService = _configurationService;\r\n        this._localToDispose = this._register(new DisposableStore());\r\n        this._decorationsIds = [];\r\n        this._colorDatas = new Map();\r\n        this._colorDecoratorIds = [];\r\n        this._decorationsTypes = new Set();\r\n        this._register(_editor.onDidChangeModel(() => {\r\n            this._isEnabled = this.isEnabled();\r\n            this.onModelChanged();\r\n        }));\r\n        this._register(_editor.onDidChangeModelLanguage(() => this.onModelChanged()));\r\n        this._register(ColorProviderRegistry.onDidChange(() => this.onModelChanged()));\r\n        this._register(_editor.onDidChangeConfiguration(() => {\r\n            let prevIsEnabled = this._isEnabled;\r\n            this._isEnabled = this.isEnabled();\r\n            if (prevIsEnabled !== this._isEnabled) {\r\n                if (this._isEnabled) {\r\n                    this.onModelChanged();\r\n                }\r\n                else {\r\n                    this.removeAllDecorations();\r\n                }\r\n            }\r\n        }));\r\n        this._timeoutTimer = null;\r\n        this._computePromise = null;\r\n        this._isEnabled = this.isEnabled();\r\n        this.onModelChanged();\r\n    }\r\n    isEnabled() {\r\n        const model = this._editor.getModel();\r\n        if (!model) {\r\n            return false;\r\n        }\r\n        const languageId = model.getLanguageIdentifier();\r\n        // handle deprecated settings. [languageId].colorDecorators.enable\r\n        const deprecatedConfig = this._configurationService.getValue(languageId.language);\r\n        if (deprecatedConfig && typeof deprecatedConfig === 'object') {\r\n            const colorDecorators = deprecatedConfig['colorDecorators']; // deprecatedConfig.valueOf('.colorDecorators.enable');\r\n            if (colorDecorators && colorDecorators['enable'] !== undefined && !colorDecorators['enable']) {\r\n                return colorDecorators['enable'];\r\n            }\r\n        }\r\n        return this._editor.getOption(15 /* colorDecorators */);\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(this.ID);\r\n    }\r\n    dispose() {\r\n        this.stop();\r\n        this.removeAllDecorations();\r\n        super.dispose();\r\n    }\r\n    onModelChanged() {\r\n        this.stop();\r\n        if (!this._isEnabled) {\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        if (!model || !ColorProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        this._localToDispose.add(this._editor.onDidChangeModelContent(() => {\r\n            if (!this._timeoutTimer) {\r\n                this._timeoutTimer = new TimeoutTimer();\r\n                this._timeoutTimer.cancelAndSet(() => {\r\n                    this._timeoutTimer = null;\r\n                    this.beginCompute();\r\n                }, ColorDetector.RECOMPUTE_TIME);\r\n            }\r\n        }));\r\n        this.beginCompute();\r\n    }\r\n    beginCompute() {\r\n        this._computePromise = createCancelablePromise(token => {\r\n            const model = this._editor.getModel();\r\n            if (!model) {\r\n                return Promise.resolve([]);\r\n            }\r\n            return getColors(model, token);\r\n        });\r\n        this._computePromise.then((colorInfos) => {\r\n            this.updateDecorations(colorInfos);\r\n            this.updateColorDecorators(colorInfos);\r\n            this._computePromise = null;\r\n        }, onUnexpectedError);\r\n    }\r\n    stop() {\r\n        if (this._timeoutTimer) {\r\n            this._timeoutTimer.cancel();\r\n            this._timeoutTimer = null;\r\n        }\r\n        if (this._computePromise) {\r\n            this._computePromise.cancel();\r\n            this._computePromise = null;\r\n        }\r\n        this._localToDispose.clear();\r\n    }\r\n    updateDecorations(colorDatas) {\r\n        const decorations = colorDatas.map(c => ({\r\n            range: {\r\n                startLineNumber: c.colorInfo.range.startLineNumber,\r\n                startColumn: c.colorInfo.range.startColumn,\r\n                endLineNumber: c.colorInfo.range.endLineNumber,\r\n                endColumn: c.colorInfo.range.endColumn\r\n            },\r\n            options: ModelDecorationOptions.EMPTY\r\n        }));\r\n        this._decorationsIds = this._editor.deltaDecorations(this._decorationsIds, decorations);\r\n        this._colorDatas = new Map();\r\n        this._decorationsIds.forEach((id, i) => this._colorDatas.set(id, colorDatas[i]));\r\n    }\r\n    updateColorDecorators(colorData) {\r\n        let decorations = [];\r\n        let newDecorationsTypes = {};\r\n        for (let i = 0; i < colorData.length && decorations.length < MAX_DECORATORS; i++) {\r\n            const { red, green, blue, alpha } = colorData[i].colorInfo.color;\r\n            const rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\r\n            let subKey = hash(`rgba(${rgba.r},${rgba.g},${rgba.b},${rgba.a})`).toString(16);\r\n            let color = `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;\r\n            let key = 'colorBox-' + subKey;\r\n            if (!this._decorationsTypes.has(key) && !newDecorationsTypes[key]) {\r\n                this._codeEditorService.registerDecorationType('color-detector-color', key, {\r\n                    before: {\r\n                        contentText: ' ',\r\n                        border: 'solid 0.1em #000',\r\n                        margin: '0.1em 0.2em 0 0.2em',\r\n                        width: '0.8em',\r\n                        height: '0.8em',\r\n                        backgroundColor: color\r\n                    },\r\n                    dark: {\r\n                        before: {\r\n                            border: 'solid 0.1em #eee'\r\n                        }\r\n                    }\r\n                }, undefined, this._editor);\r\n            }\r\n            newDecorationsTypes[key] = true;\r\n            decorations.push({\r\n                range: {\r\n                    startLineNumber: colorData[i].colorInfo.range.startLineNumber,\r\n                    startColumn: colorData[i].colorInfo.range.startColumn,\r\n                    endLineNumber: colorData[i].colorInfo.range.endLineNumber,\r\n                    endColumn: colorData[i].colorInfo.range.endColumn\r\n                },\r\n                options: this._codeEditorService.resolveDecorationOptions(key, true)\r\n            });\r\n        }\r\n        this._decorationsTypes.forEach(subType => {\r\n            if (!newDecorationsTypes[subType]) {\r\n                this._codeEditorService.removeDecorationType(subType);\r\n            }\r\n        });\r\n        this._colorDecoratorIds = this._editor.deltaDecorations(this._colorDecoratorIds, decorations);\r\n    }\r\n    removeAllDecorations() {\r\n        this._decorationsIds = this._editor.deltaDecorations(this._decorationsIds, []);\r\n        this._colorDecoratorIds = this._editor.deltaDecorations(this._colorDecoratorIds, []);\r\n        this._decorationsTypes.forEach(subType => {\r\n            this._codeEditorService.removeDecorationType(subType);\r\n        });\r\n    }\r\n    getColorData(position) {\r\n        const model = this._editor.getModel();\r\n        if (!model) {\r\n            return null;\r\n        }\r\n        const decorations = model\r\n            .getDecorationsInRange(Range.fromPositions(position, position))\r\n            .filter(d => this._colorDatas.has(d.id));\r\n        if (decorations.length === 0) {\r\n            return null;\r\n        }\r\n        return this._colorDatas.get(decorations[0].id);\r\n    }\r\n};\r\nColorDetector.ID = 'editor.contrib.colorDetector';\r\nColorDetector.RECOMPUTE_TIME = 1000; // ms\r\nColorDetector = __decorate([\r\n    __param(1, ICodeEditorService),\r\n    __param(2, IConfigurationService)\r\n], ColorDetector);\r\nexport { ColorDetector };\r\nregisterEditorContribution(ColorDetector.ID, ColorDetector);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Emitter } from '../../../base/common/event.js';\r\nexport class ColorPickerModel {\r\n    constructor(color, availableColorPresentations, presentationIndex) {\r\n        this.presentationIndex = presentationIndex;\r\n        this._onColorFlushed = new Emitter();\r\n        this.onColorFlushed = this._onColorFlushed.event;\r\n        this._onDidChangeColor = new Emitter();\r\n        this.onDidChangeColor = this._onDidChangeColor.event;\r\n        this._onDidChangePresentation = new Emitter();\r\n        this.onDidChangePresentation = this._onDidChangePresentation.event;\r\n        this.originalColor = color;\r\n        this._color = color;\r\n        this._colorPresentations = availableColorPresentations;\r\n    }\r\n    get color() {\r\n        return this._color;\r\n    }\r\n    set color(color) {\r\n        if (this._color.equals(color)) {\r\n            return;\r\n        }\r\n        this._color = color;\r\n        this._onDidChangeColor.fire(color);\r\n    }\r\n    get presentation() { return this.colorPresentations[this.presentationIndex]; }\r\n    get colorPresentations() {\r\n        return this._colorPresentations;\r\n    }\r\n    set colorPresentations(colorPresentations) {\r\n        this._colorPresentations = colorPresentations;\r\n        if (this.presentationIndex > colorPresentations.length - 1) {\r\n            this.presentationIndex = 0;\r\n        }\r\n        this._onDidChangePresentation.fire(this.presentation);\r\n    }\r\n    selectNextColorPresentation() {\r\n        this.presentationIndex = (this.presentationIndex + 1) % this.colorPresentations.length;\r\n        this.flushColor();\r\n        this._onDidChangePresentation.fire(this.presentation);\r\n    }\r\n    guessColorPresentation(color, originalText) {\r\n        for (let i = 0; i < this.colorPresentations.length; i++) {\r\n            if (originalText.toLowerCase() === this.colorPresentations[i].label) {\r\n                this.presentationIndex = i;\r\n                this._onDidChangePresentation.fire(this.presentation);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    flushColor() {\r\n        this._onColorFlushed.fire(this._color);\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport './colorPicker.css';\r\nimport { onDidChangeZoomLevel } from '../../../base/browser/browser.js';\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { GlobalMouseMoveMonitor, standardMouseMoveMerger } from '../../../base/browser/globalMouseMoveMonitor.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { Color, HSVA, RGBA } from '../../../base/common/color.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { editorHoverBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nconst $ = dom.$;\r\nexport class ColorPickerHeader extends Disposable {\r\n    constructor(container, model, themeService) {\r\n        super();\r\n        this.model = model;\r\n        this.domNode = $('.colorpicker-header');\r\n        dom.append(container, this.domNode);\r\n        this.pickedColorNode = dom.append(this.domNode, $('.picked-color'));\r\n        const colorBox = dom.append(this.domNode, $('.original-color'));\r\n        colorBox.style.backgroundColor = Color.Format.CSS.format(this.model.originalColor) || '';\r\n        this.backgroundColor = themeService.getColorTheme().getColor(editorHoverBackground) || Color.white;\r\n        this._register(registerThemingParticipant((theme, collector) => {\r\n            this.backgroundColor = theme.getColor(editorHoverBackground) || Color.white;\r\n        }));\r\n        this._register(dom.addDisposableListener(this.pickedColorNode, dom.EventType.CLICK, () => this.model.selectNextColorPresentation()));\r\n        this._register(dom.addDisposableListener(colorBox, dom.EventType.CLICK, () => {\r\n            this.model.color = this.model.originalColor;\r\n            this.model.flushColor();\r\n        }));\r\n        this._register(model.onDidChangeColor(this.onDidChangeColor, this));\r\n        this._register(model.onDidChangePresentation(this.onDidChangePresentation, this));\r\n        this.pickedColorNode.style.backgroundColor = Color.Format.CSS.format(model.color) || '';\r\n        this.pickedColorNode.classList.toggle('light', model.color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : model.color.isLighter());\r\n    }\r\n    onDidChangeColor(color) {\r\n        this.pickedColorNode.style.backgroundColor = Color.Format.CSS.format(color) || '';\r\n        this.pickedColorNode.classList.toggle('light', color.rgba.a < 0.5 ? this.backgroundColor.isLighter() : color.isLighter());\r\n        this.onDidChangePresentation();\r\n    }\r\n    onDidChangePresentation() {\r\n        this.pickedColorNode.textContent = this.model.presentation ? this.model.presentation.label : '';\r\n    }\r\n}\r\nexport class ColorPickerBody extends Disposable {\r\n    constructor(container, model, pixelRatio) {\r\n        super();\r\n        this.model = model;\r\n        this.pixelRatio = pixelRatio;\r\n        this.domNode = $('.colorpicker-body');\r\n        dom.append(container, this.domNode);\r\n        this.saturationBox = new SaturationBox(this.domNode, this.model, this.pixelRatio);\r\n        this._register(this.saturationBox);\r\n        this._register(this.saturationBox.onDidChange(this.onDidSaturationValueChange, this));\r\n        this._register(this.saturationBox.onColorFlushed(this.flushColor, this));\r\n        this.opacityStrip = new OpacityStrip(this.domNode, this.model);\r\n        this._register(this.opacityStrip);\r\n        this._register(this.opacityStrip.onDidChange(this.onDidOpacityChange, this));\r\n        this._register(this.opacityStrip.onColorFlushed(this.flushColor, this));\r\n        this.hueStrip = new HueStrip(this.domNode, this.model);\r\n        this._register(this.hueStrip);\r\n        this._register(this.hueStrip.onDidChange(this.onDidHueChange, this));\r\n        this._register(this.hueStrip.onColorFlushed(this.flushColor, this));\r\n    }\r\n    flushColor() {\r\n        this.model.flushColor();\r\n    }\r\n    onDidSaturationValueChange({ s, v }) {\r\n        const hsva = this.model.color.hsva;\r\n        this.model.color = new Color(new HSVA(hsva.h, s, v, hsva.a));\r\n    }\r\n    onDidOpacityChange(a) {\r\n        const hsva = this.model.color.hsva;\r\n        this.model.color = new Color(new HSVA(hsva.h, hsva.s, hsva.v, a));\r\n    }\r\n    onDidHueChange(value) {\r\n        const hsva = this.model.color.hsva;\r\n        const h = (1 - value) * 360;\r\n        this.model.color = new Color(new HSVA(h === 360 ? 0 : h, hsva.s, hsva.v, hsva.a));\r\n    }\r\n    layout() {\r\n        this.saturationBox.layout();\r\n        this.opacityStrip.layout();\r\n        this.hueStrip.layout();\r\n    }\r\n}\r\nclass SaturationBox extends Disposable {\r\n    constructor(container, model, pixelRatio) {\r\n        super();\r\n        this.model = model;\r\n        this.pixelRatio = pixelRatio;\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._onColorFlushed = new Emitter();\r\n        this.onColorFlushed = this._onColorFlushed.event;\r\n        this.domNode = $('.saturation-wrap');\r\n        dom.append(container, this.domNode);\r\n        // Create canvas, draw selected color\r\n        this.canvas = document.createElement('canvas');\r\n        this.canvas.className = 'saturation-box';\r\n        dom.append(this.domNode, this.canvas);\r\n        // Add selection circle\r\n        this.selection = $('.saturation-selection');\r\n        dom.append(this.domNode, this.selection);\r\n        this.layout();\r\n        this._register(dom.addDisposableGenericMouseDownListner(this.domNode, e => this.onMouseDown(e)));\r\n        this._register(this.model.onDidChangeColor(this.onDidChangeColor, this));\r\n        this.monitor = null;\r\n    }\r\n    onMouseDown(e) {\r\n        this.monitor = this._register(new GlobalMouseMoveMonitor());\r\n        const origin = dom.getDomNodePagePosition(this.domNode);\r\n        if (e.target !== this.selection) {\r\n            this.onDidChangePosition(e.offsetX, e.offsetY);\r\n        }\r\n        this.monitor.startMonitoring(e.target, e.buttons, standardMouseMoveMerger, event => this.onDidChangePosition(event.posx - origin.left, event.posy - origin.top), () => null);\r\n        const mouseUpListener = dom.addDisposableGenericMouseUpListner(document, () => {\r\n            this._onColorFlushed.fire();\r\n            mouseUpListener.dispose();\r\n            if (this.monitor) {\r\n                this.monitor.stopMonitoring(true);\r\n                this.monitor = null;\r\n            }\r\n        }, true);\r\n    }\r\n    onDidChangePosition(left, top) {\r\n        const s = Math.max(0, Math.min(1, left / this.width));\r\n        const v = Math.max(0, Math.min(1, 1 - (top / this.height)));\r\n        this.paintSelection(s, v);\r\n        this._onDidChange.fire({ s, v });\r\n    }\r\n    layout() {\r\n        this.width = this.domNode.offsetWidth;\r\n        this.height = this.domNode.offsetHeight;\r\n        this.canvas.width = this.width * this.pixelRatio;\r\n        this.canvas.height = this.height * this.pixelRatio;\r\n        this.paint();\r\n        const hsva = this.model.color.hsva;\r\n        this.paintSelection(hsva.s, hsva.v);\r\n    }\r\n    paint() {\r\n        const hsva = this.model.color.hsva;\r\n        const saturatedColor = new Color(new HSVA(hsva.h, 1, 1, 1));\r\n        const ctx = this.canvas.getContext('2d');\r\n        const whiteGradient = ctx.createLinearGradient(0, 0, this.canvas.width, 0);\r\n        whiteGradient.addColorStop(0, 'rgba(255, 255, 255, 1)');\r\n        whiteGradient.addColorStop(0.5, 'rgba(255, 255, 255, 0.5)');\r\n        whiteGradient.addColorStop(1, 'rgba(255, 255, 255, 0)');\r\n        const blackGradient = ctx.createLinearGradient(0, 0, 0, this.canvas.height);\r\n        blackGradient.addColorStop(0, 'rgba(0, 0, 0, 0)');\r\n        blackGradient.addColorStop(1, 'rgba(0, 0, 0, 1)');\r\n        ctx.rect(0, 0, this.canvas.width, this.canvas.height);\r\n        ctx.fillStyle = Color.Format.CSS.format(saturatedColor);\r\n        ctx.fill();\r\n        ctx.fillStyle = whiteGradient;\r\n        ctx.fill();\r\n        ctx.fillStyle = blackGradient;\r\n        ctx.fill();\r\n    }\r\n    paintSelection(s, v) {\r\n        this.selection.style.left = `${s * this.width}px`;\r\n        this.selection.style.top = `${this.height - v * this.height}px`;\r\n    }\r\n    onDidChangeColor() {\r\n        if (this.monitor && this.monitor.isMonitoring()) {\r\n            return;\r\n        }\r\n        this.paint();\r\n    }\r\n}\r\nclass Strip extends Disposable {\r\n    constructor(container, model) {\r\n        super();\r\n        this.model = model;\r\n        this._onDidChange = new Emitter();\r\n        this.onDidChange = this._onDidChange.event;\r\n        this._onColorFlushed = new Emitter();\r\n        this.onColorFlushed = this._onColorFlushed.event;\r\n        this.domNode = dom.append(container, $('.strip'));\r\n        this.overlay = dom.append(this.domNode, $('.overlay'));\r\n        this.slider = dom.append(this.domNode, $('.slider'));\r\n        this.slider.style.top = `0px`;\r\n        this._register(dom.addDisposableGenericMouseDownListner(this.domNode, e => this.onMouseDown(e)));\r\n        this.layout();\r\n    }\r\n    layout() {\r\n        this.height = this.domNode.offsetHeight - this.slider.offsetHeight;\r\n        const value = this.getValue(this.model.color);\r\n        this.updateSliderPosition(value);\r\n    }\r\n    onMouseDown(e) {\r\n        const monitor = this._register(new GlobalMouseMoveMonitor());\r\n        const origin = dom.getDomNodePagePosition(this.domNode);\r\n        this.domNode.classList.add('grabbing');\r\n        if (e.target !== this.slider) {\r\n            this.onDidChangeTop(e.offsetY);\r\n        }\r\n        monitor.startMonitoring(e.target, e.buttons, standardMouseMoveMerger, event => this.onDidChangeTop(event.posy - origin.top), () => null);\r\n        const mouseUpListener = dom.addDisposableGenericMouseUpListner(document, () => {\r\n            this._onColorFlushed.fire();\r\n            mouseUpListener.dispose();\r\n            monitor.stopMonitoring(true);\r\n            this.domNode.classList.remove('grabbing');\r\n        }, true);\r\n    }\r\n    onDidChangeTop(top) {\r\n        const value = Math.max(0, Math.min(1, 1 - (top / this.height)));\r\n        this.updateSliderPosition(value);\r\n        this._onDidChange.fire(value);\r\n    }\r\n    updateSliderPosition(value) {\r\n        this.slider.style.top = `${(1 - value) * this.height}px`;\r\n    }\r\n}\r\nclass OpacityStrip extends Strip {\r\n    constructor(container, model) {\r\n        super(container, model);\r\n        this.domNode.classList.add('opacity-strip');\r\n        this._register(model.onDidChangeColor(this.onDidChangeColor, this));\r\n        this.onDidChangeColor(this.model.color);\r\n    }\r\n    onDidChangeColor(color) {\r\n        const { r, g, b } = color.rgba;\r\n        const opaque = new Color(new RGBA(r, g, b, 1));\r\n        const transparent = new Color(new RGBA(r, g, b, 0));\r\n        this.overlay.style.background = `linear-gradient(to bottom, ${opaque} 0%, ${transparent} 100%)`;\r\n    }\r\n    getValue(color) {\r\n        return color.hsva.a;\r\n    }\r\n}\r\nclass HueStrip extends Strip {\r\n    constructor(container, model) {\r\n        super(container, model);\r\n        this.domNode.classList.add('hue-strip');\r\n    }\r\n    getValue(color) {\r\n        return 1 - (color.hsva.h / 360);\r\n    }\r\n}\r\nexport class ColorPickerWidget extends Widget {\r\n    constructor(container, model, pixelRatio, themeService) {\r\n        super();\r\n        this.model = model;\r\n        this.pixelRatio = pixelRatio;\r\n        this._register(onDidChangeZoomLevel(() => this.layout()));\r\n        const element = $('.colorpicker-widget');\r\n        container.appendChild(element);\r\n        const header = new ColorPickerHeader(element, this.model, themeService);\r\n        this.body = new ColorPickerBody(element, this.model, this.pixelRatio);\r\n        this._register(header);\r\n        this._register(this.body);\r\n    }\r\n    layout() {\r\n        this.body.layout();\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { getColorPresentations } from '../colorPicker/color.js';\r\nimport { ColorDetector } from '../colorPicker/colorDetector.js';\r\nimport { Color, RGBA } from '../../../base/common/color.js';\r\nimport { ColorPickerModel } from '../colorPicker/colorPickerModel.js';\r\nimport { ColorPickerWidget } from '../colorPicker/colorPickerWidget.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nexport class ColorHover {\r\n    constructor(owner, range, model, provider) {\r\n        this.owner = owner;\r\n        this.range = range;\r\n        this.model = model;\r\n        this.provider = provider;\r\n        /**\r\n         * Force the hover to always be rendered at this specific range,\r\n         * even in the case of multiple hover parts.\r\n         */\r\n        this.forceShowAtRange = true;\r\n    }\r\n    isValidForHoverAnchor(anchor) {\r\n        return (anchor.type === 1 /* Range */\r\n            && this.range.startColumn <= anchor.range.startColumn\r\n            && this.range.endColumn >= anchor.range.endColumn);\r\n    }\r\n}\r\nlet ColorHoverParticipant = class ColorHoverParticipant {\r\n    constructor(_editor, _hover, _themeService) {\r\n        this._editor = _editor;\r\n        this._hover = _hover;\r\n        this._themeService = _themeService;\r\n    }\r\n    computeSync(anchor, lineDecorations) {\r\n        return [];\r\n    }\r\n    computeAsync(anchor, lineDecorations, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this._editor.hasModel()) {\r\n                return [];\r\n            }\r\n            const colorDetector = ColorDetector.get(this._editor);\r\n            for (const d of lineDecorations) {\r\n                const colorData = colorDetector.getColorData(d.range.getStartPosition());\r\n                if (colorData) {\r\n                    const colorHover = yield this._createColorHover(this._editor.getModel(), colorData.colorInfo, colorData.provider);\r\n                    return [colorHover];\r\n                }\r\n            }\r\n            return [];\r\n        });\r\n    }\r\n    _createColorHover(editorModel, colorInfo, provider) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const originalText = editorModel.getValueInRange(colorInfo.range);\r\n            const { red, green, blue, alpha } = colorInfo.color;\r\n            const rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\r\n            const color = new Color(rgba);\r\n            const colorPresentations = yield getColorPresentations(editorModel, colorInfo, provider, CancellationToken.None);\r\n            const model = new ColorPickerModel(color, [], 0);\r\n            model.colorPresentations = colorPresentations || [];\r\n            model.guessColorPresentation(color, originalText);\r\n            return new ColorHover(this, Range.lift(colorInfo.range), model, provider);\r\n        });\r\n    }\r\n    renderHoverParts(hoverParts, fragment, statusBar) {\r\n        if (hoverParts.length === 0 || !this._editor.hasModel()) {\r\n            return Disposable.None;\r\n        }\r\n        const disposables = new DisposableStore();\r\n        const colorHover = hoverParts[0];\r\n        const editorModel = this._editor.getModel();\r\n        const model = colorHover.model;\r\n        const widget = disposables.add(new ColorPickerWidget(fragment, model, this._editor.getOption(127 /* pixelRatio */), this._themeService));\r\n        let range = new Range(colorHover.range.startLineNumber, colorHover.range.startColumn, colorHover.range.endLineNumber, colorHover.range.endColumn);\r\n        const updateEditorModel = () => {\r\n            let textEdits;\r\n            let newRange;\r\n            if (model.presentation.textEdit) {\r\n                textEdits = [model.presentation.textEdit];\r\n                newRange = new Range(model.presentation.textEdit.range.startLineNumber, model.presentation.textEdit.range.startColumn, model.presentation.textEdit.range.endLineNumber, model.presentation.textEdit.range.endColumn);\r\n                const trackedRange = this._editor.getModel()._setTrackedRange(null, newRange, 3 /* GrowsOnlyWhenTypingAfter */);\r\n                this._editor.pushUndoStop();\r\n                this._editor.executeEdits('colorpicker', textEdits);\r\n                newRange = this._editor.getModel()._getTrackedRange(trackedRange) || newRange;\r\n            }\r\n            else {\r\n                textEdits = [{ identifier: null, range, text: model.presentation.label, forceMoveMarkers: false }];\r\n                newRange = range.setEndPosition(range.endLineNumber, range.startColumn + model.presentation.label.length);\r\n                this._editor.pushUndoStop();\r\n                this._editor.executeEdits('colorpicker', textEdits);\r\n            }\r\n            if (model.presentation.additionalTextEdits) {\r\n                textEdits = [...model.presentation.additionalTextEdits];\r\n                this._editor.executeEdits('colorpicker', textEdits);\r\n                this._hover.hide();\r\n            }\r\n            this._editor.pushUndoStop();\r\n            range = newRange;\r\n        };\r\n        const updateColorPresentations = (color) => {\r\n            return getColorPresentations(editorModel, {\r\n                range: range,\r\n                color: {\r\n                    red: color.rgba.r / 255,\r\n                    green: color.rgba.g / 255,\r\n                    blue: color.rgba.b / 255,\r\n                    alpha: color.rgba.a\r\n                }\r\n            }, colorHover.provider, CancellationToken.None).then((colorPresentations) => {\r\n                model.colorPresentations = colorPresentations || [];\r\n            });\r\n        };\r\n        disposables.add(model.onColorFlushed((color) => {\r\n            updateColorPresentations(color).then(updateEditorModel);\r\n        }));\r\n        disposables.add(model.onDidChangeColor(updateColorPresentations));\r\n        this._hover.setColorPicker(widget);\r\n        return disposables;\r\n    }\r\n};\r\nColorHoverParticipant = __decorate([\r\n    __param(2, IThemeService)\r\n], ColorHoverParticipant);\r\nexport { ColorHoverParticipant };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport { DisposableStore, Disposable } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { TokenizationRegistry } from '../../common/modes.js';\r\nimport { HoverOperation } from './hoverOperation.js';\r\nimport { coalesce, flatten } from '../../../base/common/arrays.js';\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nimport { HoverWidget, HoverAction } from '../../../base/browser/ui/hover/hoverWidget.js';\r\nimport { MarkerHoverParticipant } from './markerHoverParticipant.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { MarkdownHoverParticipant } from './markdownHoverParticipant.js';\r\nimport { InlineCompletionsHoverParticipant } from '../inlineCompletions/inlineCompletionsHoverParticipant.js';\r\nimport { ColorHoverParticipant } from './colorHoverParticipant.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nimport { HoverRangeAnchor } from './hoverTypes.js';\r\nconst $ = dom.$;\r\nlet EditorHoverStatusBar = class EditorHoverStatusBar extends Disposable {\r\n    constructor(_keybindingService) {\r\n        super();\r\n        this._keybindingService = _keybindingService;\r\n        this._hasContent = false;\r\n        this.hoverElement = $('div.hover-row.status-bar');\r\n        this.actionsElement = dom.append(this.hoverElement, $('div.actions'));\r\n    }\r\n    get hasContent() {\r\n        return this._hasContent;\r\n    }\r\n    addAction(actionOptions) {\r\n        const keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\r\n        const keybindingLabel = keybinding ? keybinding.getLabel() : null;\r\n        this._hasContent = true;\r\n        return this._register(HoverAction.render(this.actionsElement, actionOptions, keybindingLabel));\r\n    }\r\n    append(element) {\r\n        const result = dom.append(this.actionsElement, element);\r\n        this._hasContent = true;\r\n        return result;\r\n    }\r\n};\r\nEditorHoverStatusBar = __decorate([\r\n    __param(0, IKeybindingService)\r\n], EditorHoverStatusBar);\r\nclass ModesContentComputer {\r\n    constructor(editor, _participants) {\r\n        this._participants = _participants;\r\n        this._editor = editor;\r\n        this._result = [];\r\n        this._anchor = null;\r\n    }\r\n    setAnchor(anchor) {\r\n        this._anchor = anchor;\r\n        this._result = [];\r\n    }\r\n    clearResult() {\r\n        this._result = [];\r\n    }\r\n    static _getLineDecorations(editor, anchor) {\r\n        if (anchor.type !== 1 /* Range */) {\r\n            return [];\r\n        }\r\n        const model = editor.getModel();\r\n        const lineNumber = anchor.range.startLineNumber;\r\n        const maxColumn = model.getLineMaxColumn(lineNumber);\r\n        return editor.getLineDecorations(lineNumber).filter((d) => {\r\n            if (d.options.isWholeLine) {\r\n                return true;\r\n            }\r\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\r\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\r\n            if (startColumn > anchor.range.startColumn || anchor.range.endColumn > endColumn) {\r\n                return false;\r\n            }\r\n            return true;\r\n        });\r\n    }\r\n    computeAsync(token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const anchor = this._anchor;\r\n            if (!this._editor.hasModel() || !anchor) {\r\n                return Promise.resolve([]);\r\n            }\r\n            const lineDecorations = ModesContentComputer._getLineDecorations(this._editor, anchor);\r\n            const allResults = yield Promise.all(this._participants.map(p => this._computeAsync(p, lineDecorations, anchor, token)));\r\n            return flatten(allResults);\r\n        });\r\n    }\r\n    _computeAsync(participant, lineDecorations, anchor, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!participant.computeAsync) {\r\n                return [];\r\n            }\r\n            return participant.computeAsync(anchor, lineDecorations, token);\r\n        });\r\n    }\r\n    computeSync() {\r\n        if (!this._editor.hasModel() || !this._anchor) {\r\n            return [];\r\n        }\r\n        const lineDecorations = ModesContentComputer._getLineDecorations(this._editor, this._anchor);\r\n        let result = [];\r\n        for (const participant of this._participants) {\r\n            result = result.concat(participant.computeSync(this._anchor, lineDecorations));\r\n        }\r\n        return coalesce(result);\r\n    }\r\n    onResult(result, isFromSynchronousComputation) {\r\n        // Always put synchronous messages before asynchronous ones\r\n        if (isFromSynchronousComputation) {\r\n            this._result = result.concat(this._result);\r\n        }\r\n        else {\r\n            this._result = this._result.concat(result);\r\n        }\r\n    }\r\n    getResult() {\r\n        return this._result.slice(0);\r\n    }\r\n    getResultWithLoadingMessage() {\r\n        if (this._anchor) {\r\n            for (const participant of this._participants) {\r\n                if (participant.createLoadingMessage) {\r\n                    const loadingMessage = participant.createLoadingMessage(this._anchor);\r\n                    if (loadingMessage) {\r\n                        return this._result.slice(0).concat([loadingMessage]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return this._result.slice(0);\r\n    }\r\n}\r\nlet ModesContentHoverWidget = class ModesContentHoverWidget extends Widget {\r\n    constructor(editor, _hoverVisibleKey, instantiationService, _keybindingService) {\r\n        super();\r\n        this._hoverVisibleKey = _hoverVisibleKey;\r\n        this._keybindingService = _keybindingService;\r\n        // IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this._participants = [\r\n            instantiationService.createInstance(ColorHoverParticipant, editor, this),\r\n            instantiationService.createInstance(MarkdownHoverParticipant, editor, this),\r\n            instantiationService.createInstance(InlineCompletionsHoverParticipant, editor, this),\r\n            instantiationService.createInstance(MarkerHoverParticipant, editor, this),\r\n        ];\r\n        this._hover = this._register(new HoverWidget());\r\n        this._id = ModesContentHoverWidget.ID;\r\n        this._editor = editor;\r\n        this._isVisible = false;\r\n        this._stoleFocus = false;\r\n        this._renderDisposable = null;\r\n        this.onkeydown(this._hover.containerDomNode, (e) => {\r\n            if (e.equals(9 /* Escape */)) {\r\n                this.hide();\r\n            }\r\n        });\r\n        this._register(this._editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(41 /* fontInfo */)) {\r\n                this._updateFont();\r\n            }\r\n        }));\r\n        this._editor.onDidLayoutChange(() => this.layout());\r\n        this.layout();\r\n        this._editor.addContentWidget(this);\r\n        this._showAtPosition = null;\r\n        this._showAtRange = null;\r\n        this._stoleFocus = false;\r\n        this._messages = [];\r\n        this._lastAnchor = null;\r\n        this._computer = new ModesContentComputer(this._editor, this._participants);\r\n        this._highlightDecorations = [];\r\n        this._isChangingDecorations = false;\r\n        this._shouldFocus = false;\r\n        this._colorPicker = null;\r\n        this._hoverOperation = new HoverOperation(this._computer, result => this._withResult(result, true), null, result => this._withResult(result, false), this._editor.getOption(51 /* hover */).delay);\r\n        this._register(dom.addStandardDisposableListener(this.getDomNode(), dom.EventType.FOCUS, () => {\r\n            if (this._colorPicker) {\r\n                this.getDomNode().classList.add('colorpicker-hover');\r\n            }\r\n        }));\r\n        this._register(dom.addStandardDisposableListener(this.getDomNode(), dom.EventType.BLUR, () => {\r\n            this.getDomNode().classList.remove('colorpicker-hover');\r\n        }));\r\n        this._register(editor.onDidChangeConfiguration(() => {\r\n            this._hoverOperation.setHoverTime(this._editor.getOption(51 /* hover */).delay);\r\n        }));\r\n        this._register(TokenizationRegistry.onDidChange(() => {\r\n            if (this._isVisible && this._lastAnchor && this._messages.length > 0) {\r\n                this._hover.contentsDomNode.textContent = '';\r\n                this._renderMessages(this._lastAnchor, this._messages);\r\n            }\r\n        }));\r\n    }\r\n    dispose() {\r\n        this._hoverOperation.cancel();\r\n        this._editor.removeContentWidget(this);\r\n        super.dispose();\r\n    }\r\n    getId() {\r\n        return this._id;\r\n    }\r\n    getDomNode() {\r\n        return this._hover.containerDomNode;\r\n    }\r\n    _shouldShowAt(mouseEvent) {\r\n        const targetType = mouseEvent.target.type;\r\n        if (targetType === 6 /* CONTENT_TEXT */) {\r\n            return true;\r\n        }\r\n        if (targetType === 7 /* CONTENT_EMPTY */) {\r\n            const epsilon = this._editor.getOption(41 /* fontInfo */).typicalHalfwidthCharacterWidth / 2;\r\n            const data = mouseEvent.target.detail;\r\n            if (data && !data.isAfterLines && typeof data.horizontalDistanceToText === 'number' && data.horizontalDistanceToText < epsilon) {\r\n                // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    maybeShowAt(mouseEvent) {\r\n        var _a;\r\n        const anchorCandidates = [];\r\n        for (const participant of this._participants) {\r\n            if (typeof participant.suggestHoverAnchor === 'function') {\r\n                const anchor = participant.suggestHoverAnchor(mouseEvent);\r\n                if (anchor) {\r\n                    anchorCandidates.push(anchor);\r\n                }\r\n            }\r\n        }\r\n        if (this._shouldShowAt(mouseEvent) && mouseEvent.target.range) {\r\n            // TODO@rebornix. This should be removed if we move Color Picker out of Hover component.\r\n            // Check if mouse is hovering on color decorator\r\n            const hoverOnColorDecorator = [...((_a = mouseEvent.target.element) === null || _a === void 0 ? void 0 : _a.classList.values()) || []].find(className => className.startsWith('ced-colorBox'))\r\n                && mouseEvent.target.range.endColumn - mouseEvent.target.range.startColumn === 1;\r\n            const showAtRange = (hoverOnColorDecorator // shift the mouse focus by one as color decorator is a `before` decoration of next character.\r\n                ? new Range(mouseEvent.target.range.startLineNumber, mouseEvent.target.range.startColumn + 1, mouseEvent.target.range.endLineNumber, mouseEvent.target.range.endColumn + 1)\r\n                : mouseEvent.target.range);\r\n            anchorCandidates.push(new HoverRangeAnchor(0, showAtRange));\r\n        }\r\n        if (anchorCandidates.length === 0) {\r\n            return false;\r\n        }\r\n        anchorCandidates.sort((a, b) => b.priority - a.priority);\r\n        this._startShowingAt(anchorCandidates[0], 0 /* Delayed */, false);\r\n        return true;\r\n    }\r\n    _showAt(position, range, focus) {\r\n        // Position has changed\r\n        this._showAtPosition = position;\r\n        this._showAtRange = range;\r\n        this._hoverVisibleKey.set(true);\r\n        this._isVisible = true;\r\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\r\n        this._editor.layoutContentWidget(this);\r\n        // Simply force a synchronous render on the editor\r\n        // such that the widget does not really render with left = '0px'\r\n        this._editor.render();\r\n        this._stoleFocus = focus;\r\n        if (focus) {\r\n            this._hover.containerDomNode.focus();\r\n        }\r\n    }\r\n    getPosition() {\r\n        if (this._isVisible) {\r\n            return {\r\n                position: this._showAtPosition,\r\n                range: this._showAtRange,\r\n                preference: [\r\n                    1 /* ABOVE */,\r\n                    2 /* BELOW */\r\n                ]\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    _updateFont() {\r\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\r\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\r\n    }\r\n    _updateContents(node) {\r\n        this._hover.contentsDomNode.textContent = '';\r\n        this._hover.contentsDomNode.appendChild(node);\r\n        this._updateFont();\r\n        this._editor.layoutContentWidget(this);\r\n        this._hover.onContentsChanged();\r\n    }\r\n    layout() {\r\n        const height = Math.max(this._editor.getLayoutInfo().height / 4, 250);\r\n        const { fontSize, lineHeight } = this._editor.getOption(41 /* fontInfo */);\r\n        this._hover.contentsDomNode.style.fontSize = `${fontSize}px`;\r\n        this._hover.contentsDomNode.style.lineHeight = `${lineHeight}px`;\r\n        this._hover.contentsDomNode.style.maxHeight = `${height}px`;\r\n        this._hover.contentsDomNode.style.maxWidth = `${Math.max(this._editor.getLayoutInfo().width * 0.66, 500)}px`;\r\n    }\r\n    onModelDecorationsChanged() {\r\n        if (this._isChangingDecorations) {\r\n            return;\r\n        }\r\n        if (this._isVisible) {\r\n            // The decorations have changed and the hover is visible,\r\n            // we need to recompute the displayed text\r\n            this._hoverOperation.cancel();\r\n            this._computer.clearResult();\r\n            if (!this._colorPicker) { // TODO@Michel ensure that displayed text for other decorations is computed even if color picker is in place\r\n                this._hoverOperation.start(0 /* Delayed */);\r\n            }\r\n        }\r\n    }\r\n    startShowingAtRange(range, mode, focus) {\r\n        this._startShowingAt(new HoverRangeAnchor(0, range), mode, focus);\r\n    }\r\n    _startShowingAt(anchor, mode, focus) {\r\n        if (this._lastAnchor && this._lastAnchor.equals(anchor)) {\r\n            // We have to show the widget at the exact same range as before, so no work is needed\r\n            return;\r\n        }\r\n        this._hoverOperation.cancel();\r\n        if (this._isVisible) {\r\n            // The range might have changed, but the hover is visible\r\n            // Instead of hiding it completely, filter out messages that are still in the new range and\r\n            // kick off a new computation\r\n            if (!this._showAtPosition || !this._lastAnchor || !anchor.canAdoptVisibleHover(this._lastAnchor, this._showAtPosition)) {\r\n                this.hide();\r\n            }\r\n            else {\r\n                const filteredMessages = this._messages.filter((m) => m.isValidForHoverAnchor(anchor));\r\n                if (filteredMessages.length === 0) {\r\n                    this.hide();\r\n                }\r\n                else if (filteredMessages.length === this._messages.length) {\r\n                    // no change\r\n                    return;\r\n                }\r\n                else {\r\n                    this._renderMessages(anchor, filteredMessages);\r\n                }\r\n            }\r\n        }\r\n        this._lastAnchor = anchor;\r\n        this._computer.setAnchor(anchor);\r\n        this._shouldFocus = focus;\r\n        this._hoverOperation.start(mode);\r\n    }\r\n    hide() {\r\n        this._lastAnchor = null;\r\n        this._hoverOperation.cancel();\r\n        if (this._isVisible) {\r\n            setTimeout(() => {\r\n                // Give commands a chance to see the key\r\n                if (!this._isVisible) {\r\n                    this._hoverVisibleKey.set(false);\r\n                }\r\n            }, 0);\r\n            this._isVisible = false;\r\n            this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\r\n            this._editor.layoutContentWidget(this);\r\n            if (this._stoleFocus) {\r\n                this._editor.focus();\r\n            }\r\n        }\r\n        this._isChangingDecorations = true;\r\n        this._highlightDecorations = this._editor.deltaDecorations(this._highlightDecorations, []);\r\n        this._isChangingDecorations = false;\r\n        if (this._renderDisposable) {\r\n            this._renderDisposable.dispose();\r\n            this._renderDisposable = null;\r\n        }\r\n        this._colorPicker = null;\r\n    }\r\n    isColorPickerVisible() {\r\n        return !!this._colorPicker;\r\n    }\r\n    setColorPicker(widget) {\r\n        this._colorPicker = widget;\r\n    }\r\n    onContentsChanged() {\r\n        this._hover.onContentsChanged();\r\n    }\r\n    _withResult(result, complete) {\r\n        this._messages = result;\r\n        if (this._lastAnchor && this._messages.length > 0) {\r\n            this._renderMessages(this._lastAnchor, this._messages);\r\n        }\r\n        else if (complete) {\r\n            this.hide();\r\n        }\r\n    }\r\n    _renderMessages(anchor, messages) {\r\n        if (this._renderDisposable) {\r\n            this._renderDisposable.dispose();\r\n            this._renderDisposable = null;\r\n        }\r\n        this._colorPicker = null; // TODO: TypeScript thinks this is always null\r\n        // update column from which to show\r\n        let renderColumn = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\r\n        let highlightRange = messages[0].range;\r\n        let forceShowAtRange = null;\r\n        let fragment = document.createDocumentFragment();\r\n        const disposables = new DisposableStore();\r\n        const hoverParts = new Map();\r\n        for (const msg of messages) {\r\n            renderColumn = Math.min(renderColumn, msg.range.startColumn);\r\n            highlightRange = Range.plusRange(highlightRange, msg.range);\r\n            if (msg.forceShowAtRange) {\r\n                forceShowAtRange = msg.range;\r\n            }\r\n            if (!hoverParts.has(msg.owner)) {\r\n                hoverParts.set(msg.owner, []);\r\n            }\r\n            const dest = hoverParts.get(msg.owner);\r\n            dest.push(msg);\r\n        }\r\n        const statusBar = disposables.add(new EditorHoverStatusBar(this._keybindingService));\r\n        for (const [participant, participantHoverParts] of hoverParts) {\r\n            disposables.add(participant.renderHoverParts(participantHoverParts, fragment, statusBar));\r\n        }\r\n        if (statusBar.hasContent) {\r\n            fragment.appendChild(statusBar.hoverElement);\r\n        }\r\n        this._renderDisposable = disposables;\r\n        // show\r\n        if (fragment.hasChildNodes()) {\r\n            if (forceShowAtRange) {\r\n                this._showAt(forceShowAtRange.getStartPosition(), forceShowAtRange, this._shouldFocus);\r\n            }\r\n            else {\r\n                this._showAt(new Position(anchor.range.startLineNumber, renderColumn), highlightRange, this._shouldFocus);\r\n            }\r\n            this._updateContents(fragment);\r\n        }\r\n        if (this._colorPicker) {\r\n            this._colorPicker.layout();\r\n        }\r\n        this._isChangingDecorations = true;\r\n        this._highlightDecorations = this._editor.deltaDecorations(this._highlightDecorations, highlightRange ? [{\r\n                range: highlightRange,\r\n                options: ModesContentHoverWidget._DECORATION_OPTIONS\r\n            }] : []);\r\n        this._isChangingDecorations = false;\r\n    }\r\n};\r\nModesContentHoverWidget.ID = 'editor.contrib.modesContentHoverWidget';\r\nModesContentHoverWidget._DECORATION_OPTIONS = ModelDecorationOptions.register({\r\n    description: 'content-hover-highlight',\r\n    className: 'hoverHighlight'\r\n});\r\nModesContentHoverWidget = __decorate([\r\n    __param(2, IInstantiationService),\r\n    __param(3, IKeybindingService)\r\n], ModesContentHoverWidget);\r\nexport { ModesContentHoverWidget };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Widget } from '../../../base/browser/ui/widget.js';\r\nexport class GlyphHoverWidget extends Widget {\r\n    constructor(id, editor) {\r\n        super();\r\n        this._id = id;\r\n        this._editor = editor;\r\n        this._isVisible = false;\r\n        this._domNode = document.createElement('div');\r\n        this._domNode.className = 'monaco-hover hidden';\r\n        this._domNode.setAttribute('aria-hidden', 'true');\r\n        this._domNode.setAttribute('role', 'tooltip');\r\n        this._showAtLineNumber = -1;\r\n        this._register(this._editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(41 /* fontInfo */)) {\r\n                this.updateFont();\r\n            }\r\n        }));\r\n        this._editor.addOverlayWidget(this);\r\n    }\r\n    get isVisible() {\r\n        return this._isVisible;\r\n    }\r\n    set isVisible(value) {\r\n        this._isVisible = value;\r\n        this._domNode.classList.toggle('hidden', !this._isVisible);\r\n    }\r\n    getId() {\r\n        return this._id;\r\n    }\r\n    getDomNode() {\r\n        return this._domNode;\r\n    }\r\n    showAt(lineNumber) {\r\n        this._showAtLineNumber = lineNumber;\r\n        if (!this.isVisible) {\r\n            this.isVisible = true;\r\n        }\r\n        const editorLayout = this._editor.getLayoutInfo();\r\n        const topForLineNumber = this._editor.getTopForLineNumber(this._showAtLineNumber);\r\n        const editorScrollTop = this._editor.getScrollTop();\r\n        const lineHeight = this._editor.getOption(57 /* lineHeight */);\r\n        const nodeHeight = this._domNode.clientHeight;\r\n        const top = topForLineNumber - editorScrollTop - ((nodeHeight - lineHeight) / 2);\r\n        this._domNode.style.left = `${editorLayout.glyphMarginLeft + editorLayout.glyphMarginWidth}px`;\r\n        this._domNode.style.top = `${Math.max(Math.round(top), 0)}px`;\r\n    }\r\n    hide() {\r\n        if (!this.isVisible) {\r\n            return;\r\n        }\r\n        this.isVisible = false;\r\n    }\r\n    getPosition() {\r\n        return null;\r\n    }\r\n    dispose() {\r\n        this._editor.removeOverlayWidget(this);\r\n        super.dispose();\r\n    }\r\n    updateFont() {\r\n        const codeTags = Array.prototype.slice.call(this._domNode.getElementsByTagName('code'));\r\n        const codeClasses = Array.prototype.slice.call(this._domNode.getElementsByClassName('code'));\r\n        [...codeTags, ...codeClasses].forEach(node => this._editor.applyFontInfo(node));\r\n    }\r\n    updateContents(node) {\r\n        this._domNode.textContent = '';\r\n        this._domNode.appendChild(node);\r\n        this.updateFont();\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { $ } from '../../../base/browser/dom.js';\r\nimport { isEmptyMarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { HoverOperation } from './hoverOperation.js';\r\nimport { GlyphHoverWidget } from './hoverWidgets.js';\r\nimport { MarkdownRenderer } from '../../browser/core/markdownRenderer.js';\r\nimport { NullOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { asArray } from '../../../base/common/arrays.js';\r\nclass MarginComputer {\r\n    constructor(editor) {\r\n        this._editor = editor;\r\n        this._lineNumber = -1;\r\n        this._result = [];\r\n    }\r\n    setLineNumber(lineNumber) {\r\n        this._lineNumber = lineNumber;\r\n        this._result = [];\r\n    }\r\n    clearResult() {\r\n        this._result = [];\r\n    }\r\n    computeSync() {\r\n        const toHoverMessage = (contents) => {\r\n            return {\r\n                value: contents\r\n            };\r\n        };\r\n        const lineDecorations = this._editor.getLineDecorations(this._lineNumber);\r\n        const result = [];\r\n        if (!lineDecorations) {\r\n            return result;\r\n        }\r\n        for (const d of lineDecorations) {\r\n            if (!d.options.glyphMarginClassName) {\r\n                continue;\r\n            }\r\n            const hoverMessage = d.options.glyphMarginHoverMessage;\r\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\r\n                continue;\r\n            }\r\n            result.push(...asArray(hoverMessage).map(toHoverMessage));\r\n        }\r\n        return result;\r\n    }\r\n    onResult(result, isFromSynchronousComputation) {\r\n        this._result = this._result.concat(result);\r\n    }\r\n    getResult() {\r\n        return this._result;\r\n    }\r\n    getResultWithLoadingMessage() {\r\n        return this.getResult();\r\n    }\r\n}\r\nexport class ModesGlyphHoverWidget extends GlyphHoverWidget {\r\n    constructor(editor, modeService, openerService = NullOpenerService) {\r\n        super(ModesGlyphHoverWidget.ID, editor);\r\n        this._renderDisposeables = this._register(new DisposableStore());\r\n        this._messages = [];\r\n        this._lastLineNumber = -1;\r\n        this._markdownRenderer = this._register(new MarkdownRenderer({ editor: this._editor }, modeService, openerService));\r\n        this._computer = new MarginComputer(this._editor);\r\n        this._hoverOperation = new HoverOperation(this._computer, (result) => this._withResult(result), undefined, (result) => this._withResult(result), 300);\r\n    }\r\n    dispose() {\r\n        this._hoverOperation.cancel();\r\n        super.dispose();\r\n    }\r\n    onModelDecorationsChanged() {\r\n        if (this.isVisible) {\r\n            // The decorations have changed and the hover is visible,\r\n            // we need to recompute the displayed text\r\n            this._hoverOperation.cancel();\r\n            this._computer.clearResult();\r\n            this._hoverOperation.start(0 /* Delayed */);\r\n        }\r\n    }\r\n    startShowingAt(lineNumber) {\r\n        if (this._lastLineNumber === lineNumber) {\r\n            // We have to show the widget at the exact same line number as before, so no work is needed\r\n            return;\r\n        }\r\n        this._hoverOperation.cancel();\r\n        this.hide();\r\n        this._lastLineNumber = lineNumber;\r\n        this._computer.setLineNumber(lineNumber);\r\n        this._hoverOperation.start(0 /* Delayed */);\r\n    }\r\n    hide() {\r\n        this._lastLineNumber = -1;\r\n        this._hoverOperation.cancel();\r\n        super.hide();\r\n    }\r\n    _withResult(result) {\r\n        this._messages = result;\r\n        if (this._messages.length > 0) {\r\n            this._renderMessages(this._lastLineNumber, this._messages);\r\n        }\r\n        else {\r\n            this.hide();\r\n        }\r\n    }\r\n    _renderMessages(lineNumber, messages) {\r\n        this._renderDisposeables.clear();\r\n        const fragment = document.createDocumentFragment();\r\n        for (const msg of messages) {\r\n            const renderedContents = this._markdownRenderer.render(msg.value);\r\n            this._renderDisposeables.add(renderedContents);\r\n            fragment.appendChild($('div.hover-row', undefined, renderedContents.element));\r\n        }\r\n        this.updateContents(fragment);\r\n        this.showAt(lineNumber);\r\n    }\r\n}\r\nModesGlyphHoverWidget.ID = 'editor.contrib.modesGlyphHoverWidget';\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { ModesContentHoverWidget } from './modesContentHover.js';\r\nimport { ModesGlyphHoverWidget } from './modesGlyphHover.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorHoverBackground, editorHoverBorder, editorHoverHighlight, textCodeBlockBackground, textLinkForeground, editorHoverStatusBarBackground, editorHoverForeground, textLinkActiveForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { GotoDefinitionAtPositionEditorContribution } from '../gotoSymbol/link/goToDefinitionAtPosition.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nlet ModesHoverController = class ModesHoverController {\r\n    constructor(_editor, _instantiationService, _openerService, _modeService, _contextKeyService) {\r\n        this._editor = _editor;\r\n        this._instantiationService = _instantiationService;\r\n        this._openerService = _openerService;\r\n        this._modeService = _modeService;\r\n        this._toUnhook = new DisposableStore();\r\n        this._isMouseDown = false;\r\n        this._hoverClicked = false;\r\n        this._contentWidget = null;\r\n        this._glyphWidget = null;\r\n        this._hookEvents();\r\n        this._didChangeConfigurationHandler = this._editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(51 /* hover */)) {\r\n                this._unhookEvents();\r\n                this._hookEvents();\r\n            }\r\n        });\r\n        this._hoverVisibleKey = EditorContextKeys.hoverVisible.bindTo(_contextKeyService);\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(ModesHoverController.ID);\r\n    }\r\n    _hookEvents() {\r\n        const hideWidgetsEventHandler = () => this._hideWidgets();\r\n        const hoverOpts = this._editor.getOption(51 /* hover */);\r\n        this._isHoverEnabled = hoverOpts.enabled;\r\n        this._isHoverSticky = hoverOpts.sticky;\r\n        if (this._isHoverEnabled) {\r\n            this._toUnhook.add(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\r\n            this._toUnhook.add(this._editor.onMouseUp((e) => this._onEditorMouseUp(e)));\r\n            this._toUnhook.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\r\n            this._toUnhook.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\r\n            this._toUnhook.add(this._editor.onDidChangeModelDecorations(() => this._onModelDecorationsChanged()));\r\n        }\r\n        else {\r\n            this._toUnhook.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\r\n            this._toUnhook.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\r\n        }\r\n        this._toUnhook.add(this._editor.onMouseLeave(hideWidgetsEventHandler));\r\n        this._toUnhook.add(this._editor.onDidChangeModel(hideWidgetsEventHandler));\r\n        this._toUnhook.add(this._editor.onDidScrollChange((e) => this._onEditorScrollChanged(e)));\r\n    }\r\n    _unhookEvents() {\r\n        this._toUnhook.clear();\r\n    }\r\n    _onModelDecorationsChanged() {\r\n        var _a, _b;\r\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.onModelDecorationsChanged();\r\n        (_b = this._glyphWidget) === null || _b === void 0 ? void 0 : _b.onModelDecorationsChanged();\r\n    }\r\n    _onEditorScrollChanged(e) {\r\n        if (e.scrollTopChanged || e.scrollLeftChanged) {\r\n            this._hideWidgets();\r\n        }\r\n    }\r\n    _onEditorMouseDown(mouseEvent) {\r\n        this._isMouseDown = true;\r\n        const targetType = mouseEvent.target.type;\r\n        if (targetType === 9 /* CONTENT_WIDGET */ && mouseEvent.target.detail === ModesContentHoverWidget.ID) {\r\n            this._hoverClicked = true;\r\n            // mouse down on top of content hover widget\r\n            return;\r\n        }\r\n        if (targetType === 12 /* OVERLAY_WIDGET */ && mouseEvent.target.detail === ModesGlyphHoverWidget.ID) {\r\n            // mouse down on top of overlay hover widget\r\n            return;\r\n        }\r\n        if (targetType !== 12 /* OVERLAY_WIDGET */ && mouseEvent.target.detail !== ModesGlyphHoverWidget.ID) {\r\n            this._hoverClicked = false;\r\n        }\r\n        this._hideWidgets();\r\n    }\r\n    _onEditorMouseUp(mouseEvent) {\r\n        this._isMouseDown = false;\r\n    }\r\n    _onEditorMouseMove(mouseEvent) {\r\n        var _a, _b, _c, _d, _e;\r\n        let targetType = mouseEvent.target.type;\r\n        if (this._isMouseDown && this._hoverClicked) {\r\n            return;\r\n        }\r\n        if (this._isHoverSticky && targetType === 9 /* CONTENT_WIDGET */ && mouseEvent.target.detail === ModesContentHoverWidget.ID) {\r\n            // mouse moved on top of content hover widget\r\n            return;\r\n        }\r\n        if (this._isHoverSticky && !((_b = (_a = mouseEvent.event.browserEvent.view) === null || _a === void 0 ? void 0 : _a.getSelection()) === null || _b === void 0 ? void 0 : _b.isCollapsed)) {\r\n            // selected text within content hover widget\r\n            return;\r\n        }\r\n        if (!this._isHoverSticky && targetType === 9 /* CONTENT_WIDGET */ && mouseEvent.target.detail === ModesContentHoverWidget.ID\r\n            && ((_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.isColorPickerVisible())) {\r\n            // though the hover is not sticky, the color picker needs to.\r\n            return;\r\n        }\r\n        if (this._isHoverSticky && targetType === 12 /* OVERLAY_WIDGET */ && mouseEvent.target.detail === ModesGlyphHoverWidget.ID) {\r\n            // mouse moved on top of overlay hover widget\r\n            return;\r\n        }\r\n        if (!this._isHoverEnabled) {\r\n            this._hideWidgets();\r\n            return;\r\n        }\r\n        const contentWidget = this._getOrCreateContentWidget();\r\n        if (contentWidget.maybeShowAt(mouseEvent)) {\r\n            (_d = this._glyphWidget) === null || _d === void 0 ? void 0 : _d.hide();\r\n            return;\r\n        }\r\n        if (targetType === 2 /* GUTTER_GLYPH_MARGIN */ && mouseEvent.target.position) {\r\n            (_e = this._contentWidget) === null || _e === void 0 ? void 0 : _e.hide();\r\n            if (!this._glyphWidget) {\r\n                this._glyphWidget = new ModesGlyphHoverWidget(this._editor, this._modeService, this._openerService);\r\n            }\r\n            this._glyphWidget.startShowingAt(mouseEvent.target.position.lineNumber);\r\n            return;\r\n        }\r\n        this._hideWidgets();\r\n    }\r\n    _onKeyDown(e) {\r\n        if (e.keyCode !== 5 /* Ctrl */ && e.keyCode !== 6 /* Alt */ && e.keyCode !== 57 /* Meta */ && e.keyCode !== 4 /* Shift */) {\r\n            // Do not hide hover when a modifier key is pressed\r\n            this._hideWidgets();\r\n        }\r\n    }\r\n    _hideWidgets() {\r\n        var _a, _b, _c;\r\n        if ((this._isMouseDown && this._hoverClicked && ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible()))) {\r\n            return;\r\n        }\r\n        this._hoverClicked = false;\r\n        (_b = this._glyphWidget) === null || _b === void 0 ? void 0 : _b.hide();\r\n        (_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.hide();\r\n    }\r\n    _getOrCreateContentWidget() {\r\n        if (!this._contentWidget) {\r\n            this._contentWidget = this._instantiationService.createInstance(ModesContentHoverWidget, this._editor, this._hoverVisibleKey);\r\n        }\r\n        return this._contentWidget;\r\n    }\r\n    isColorPickerVisible() {\r\n        var _a;\r\n        return ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible()) || false;\r\n    }\r\n    showContentHover(range, mode, focus) {\r\n        this._getOrCreateContentWidget().startShowingAtRange(range, mode, focus);\r\n    }\r\n    dispose() {\r\n        var _a, _b;\r\n        this._unhookEvents();\r\n        this._toUnhook.dispose();\r\n        this._didChangeConfigurationHandler.dispose();\r\n        (_a = this._glyphWidget) === null || _a === void 0 ? void 0 : _a.dispose();\r\n        (_b = this._contentWidget) === null || _b === void 0 ? void 0 : _b.dispose();\r\n    }\r\n};\r\nModesHoverController.ID = 'editor.contrib.hover';\r\nModesHoverController = __decorate([\r\n    __param(1, IInstantiationService),\r\n    __param(2, IOpenerService),\r\n    __param(3, IModeService),\r\n    __param(4, IContextKeyService)\r\n], ModesHoverController);\r\nexport { ModesHoverController };\r\nclass ShowHoverAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.showHover',\r\n            label: nls.localize({\r\n                key: 'showHover',\r\n                comment: [\r\n                    'Label for action that will trigger the showing of a hover in the editor.',\r\n                    'This allows for users to show the hover without using the mouse.'\r\n                ]\r\n            }, \"Show Hover\"),\r\n            alias: 'Show Hover',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 39 /* KEY_I */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        let controller = ModesHoverController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        const position = editor.getPosition();\r\n        const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        const focus = editor.getOption(2 /* accessibilitySupport */) === 2 /* Enabled */;\r\n        controller.showContentHover(range, 1 /* Immediate */, focus);\r\n    }\r\n}\r\nclass ShowDefinitionPreviewHoverAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.showDefinitionPreviewHover',\r\n            label: nls.localize({\r\n                key: 'showDefinitionPreviewHover',\r\n                comment: [\r\n                    'Label for action that will trigger the showing of definition preview hover in the editor.',\r\n                    'This allows for users to show the definition preview hover without using the mouse.'\r\n                ]\r\n            }, \"Show Definition Preview Hover\"),\r\n            alias: 'Show Definition Preview Hover',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        let controller = ModesHoverController.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        const position = editor.getPosition();\r\n        if (!position) {\r\n            return;\r\n        }\r\n        const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\r\n        const goto = GotoDefinitionAtPositionEditorContribution.get(editor);\r\n        const promise = goto.startFindDefinitionFromCursor(position);\r\n        promise.then(() => {\r\n            controller.showContentHover(range, 1 /* Immediate */, true);\r\n        });\r\n    }\r\n}\r\nregisterEditorContribution(ModesHoverController.ID, ModesHoverController);\r\nregisterEditorAction(ShowHoverAction);\r\nregisterEditorAction(ShowDefinitionPreviewHoverAction);\r\n// theming\r\nregisterThemingParticipant((theme, collector) => {\r\n    const editorHoverHighlightColor = theme.getColor(editorHoverHighlight);\r\n    if (editorHoverHighlightColor) {\r\n        collector.addRule(`.monaco-editor .hoverHighlight { background-color: ${editorHoverHighlightColor}; }`);\r\n    }\r\n    const hoverBackground = theme.getColor(editorHoverBackground);\r\n    if (hoverBackground) {\r\n        collector.addRule(`.monaco-editor .monaco-hover { background-color: ${hoverBackground}; }`);\r\n    }\r\n    const hoverBorder = theme.getColor(editorHoverBorder);\r\n    if (hoverBorder) {\r\n        collector.addRule(`.monaco-editor .monaco-hover { border: 1px solid ${hoverBorder}; }`);\r\n        collector.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\r\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\r\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${hoverBorder.transparent(0.5)}; }`);\r\n    }\r\n    const link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(`.monaco-editor .monaco-hover a { color: ${link}; }`);\r\n    }\r\n    const linkHover = theme.getColor(textLinkActiveForeground);\r\n    if (linkHover) {\r\n        collector.addRule(`.monaco-editor .monaco-hover a:hover { color: ${linkHover}; }`);\r\n    }\r\n    const hoverForeground = theme.getColor(editorHoverForeground);\r\n    if (hoverForeground) {\r\n        collector.addRule(`.monaco-editor .monaco-hover { color: ${hoverForeground}; }`);\r\n    }\r\n    const actionsBackground = theme.getColor(editorHoverStatusBarBackground);\r\n    if (actionsBackground) {\r\n        collector.addRule(`.monaco-editor .monaco-hover .hover-row .actions { background-color: ${actionsBackground}; }`);\r\n    }\r\n    const codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(`.monaco-editor .monaco-hover code { background-color: ${codeBackground}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nexport function getSpaceCnt(str, tabSize) {\r\n    let spacesCnt = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n        if (str.charAt(i) === '\\t') {\r\n            spacesCnt += tabSize;\r\n        }\r\n        else {\r\n            spacesCnt++;\r\n        }\r\n    }\r\n    return spacesCnt;\r\n}\r\nexport function generateIndent(spacesCnt, tabSize, insertSpaces) {\r\n    spacesCnt = spacesCnt < 0 ? 0 : spacesCnt;\r\n    let result = '';\r\n    if (!insertSpaces) {\r\n        let tabsCnt = Math.floor(spacesCnt / tabSize);\r\n        spacesCnt = spacesCnt % tabSize;\r\n        for (let i = 0; i < tabsCnt; i++) {\r\n            result += '\\t';\r\n        }\r\n    }\r\n    for (let i = 0; i < spacesCnt; i++) {\r\n        result += ' ';\r\n    }\r\n    return result;\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ShiftCommand } from '../../common/commands/shiftCommand.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { TextModel } from '../../common/model/textModel.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport * as indentUtils from './indentUtils.js';\r\nimport { IQuickInputService } from '../../../platform/quickinput/common/quickInput.js';\r\nexport function getReindentEditOperations(model, startLineNumber, endLineNumber, inheritedIndent) {\r\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\r\n        // Model is empty\r\n        return [];\r\n    }\r\n    let indentationRules = LanguageConfigurationRegistry.getIndentationRules(model.getLanguageIdentifier().id);\r\n    if (!indentationRules) {\r\n        return [];\r\n    }\r\n    endLineNumber = Math.min(endLineNumber, model.getLineCount());\r\n    // Skip `unIndentedLinePattern` lines\r\n    while (startLineNumber <= endLineNumber) {\r\n        if (!indentationRules.unIndentedLinePattern) {\r\n            break;\r\n        }\r\n        let text = model.getLineContent(startLineNumber);\r\n        if (!indentationRules.unIndentedLinePattern.test(text)) {\r\n            break;\r\n        }\r\n        startLineNumber++;\r\n    }\r\n    if (startLineNumber > endLineNumber - 1) {\r\n        return [];\r\n    }\r\n    const { tabSize, indentSize, insertSpaces } = model.getOptions();\r\n    const shiftIndent = (indentation, count) => {\r\n        count = count || 1;\r\n        return ShiftCommand.shiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\r\n    };\r\n    const unshiftIndent = (indentation, count) => {\r\n        count = count || 1;\r\n        return ShiftCommand.unshiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\r\n    };\r\n    let indentEdits = [];\r\n    // indentation being passed to lines below\r\n    let globalIndent;\r\n    // Calculate indentation for the first line\r\n    // If there is no passed-in indentation, we use the indentation of the first line as base.\r\n    let currentLineText = model.getLineContent(startLineNumber);\r\n    let adjustedLineContent = currentLineText;\r\n    if (inheritedIndent !== undefined && inheritedIndent !== null) {\r\n        globalIndent = inheritedIndent;\r\n        let oldIndentation = strings.getLeadingWhitespace(currentLineText);\r\n        adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\r\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\r\n            globalIndent = unshiftIndent(globalIndent);\r\n            adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\r\n        }\r\n        if (currentLineText !== adjustedLineContent) {\r\n            indentEdits.push(EditOperation.replaceMove(new Selection(startLineNumber, 1, startLineNumber, oldIndentation.length + 1), TextModel.normalizeIndentation(globalIndent, indentSize, insertSpaces)));\r\n        }\r\n    }\r\n    else {\r\n        globalIndent = strings.getLeadingWhitespace(currentLineText);\r\n    }\r\n    // idealIndentForNextLine doesn't equal globalIndent when there is a line matching `indentNextLinePattern`.\r\n    let idealIndentForNextLine = globalIndent;\r\n    if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\r\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\r\n        globalIndent = shiftIndent(globalIndent);\r\n    }\r\n    else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\r\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\r\n    }\r\n    startLineNumber++;\r\n    // Calculate indentation adjustment for all following lines\r\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n        let text = model.getLineContent(lineNumber);\r\n        let oldIndentation = strings.getLeadingWhitespace(text);\r\n        let adjustedLineContent = idealIndentForNextLine + text.substring(oldIndentation.length);\r\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\r\n            idealIndentForNextLine = unshiftIndent(idealIndentForNextLine);\r\n            globalIndent = unshiftIndent(globalIndent);\r\n        }\r\n        if (oldIndentation !== idealIndentForNextLine) {\r\n            indentEdits.push(EditOperation.replaceMove(new Selection(lineNumber, 1, lineNumber, oldIndentation.length + 1), TextModel.normalizeIndentation(idealIndentForNextLine, indentSize, insertSpaces)));\r\n        }\r\n        // calculate idealIndentForNextLine\r\n        if (indentationRules.unIndentedLinePattern && indentationRules.unIndentedLinePattern.test(text)) {\r\n            // In reindent phase, if the line matches `unIndentedLinePattern` we inherit indentation from above lines\r\n            // but don't change globalIndent and idealIndentForNextLine.\r\n            continue;\r\n        }\r\n        else if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\r\n            globalIndent = shiftIndent(globalIndent);\r\n            idealIndentForNextLine = globalIndent;\r\n        }\r\n        else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\r\n            idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\r\n        }\r\n        else {\r\n            idealIndentForNextLine = globalIndent;\r\n        }\r\n    }\r\n    return indentEdits;\r\n}\r\nexport class IndentationToSpacesAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: IndentationToSpacesAction.ID,\r\n            label: nls.localize('indentationToSpaces', \"Convert Indentation to Spaces\"),\r\n            alias: 'Convert Indentation to Spaces',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        let model = editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        let modelOpts = model.getOptions();\r\n        let selection = editor.getSelection();\r\n        if (!selection) {\r\n            return;\r\n        }\r\n        const command = new IndentationToSpacesCommand(selection, modelOpts.tabSize);\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, [command]);\r\n        editor.pushUndoStop();\r\n        model.updateOptions({\r\n            insertSpaces: true\r\n        });\r\n    }\r\n}\r\nIndentationToSpacesAction.ID = 'editor.action.indentationToSpaces';\r\nexport class IndentationToTabsAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: IndentationToTabsAction.ID,\r\n            label: nls.localize('indentationToTabs', \"Convert Indentation to Tabs\"),\r\n            alias: 'Convert Indentation to Tabs',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        let model = editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        let modelOpts = model.getOptions();\r\n        let selection = editor.getSelection();\r\n        if (!selection) {\r\n            return;\r\n        }\r\n        const command = new IndentationToTabsCommand(selection, modelOpts.tabSize);\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, [command]);\r\n        editor.pushUndoStop();\r\n        model.updateOptions({\r\n            insertSpaces: false\r\n        });\r\n    }\r\n}\r\nIndentationToTabsAction.ID = 'editor.action.indentationToTabs';\r\nexport class ChangeIndentationSizeAction extends EditorAction {\r\n    constructor(insertSpaces, opts) {\r\n        super(opts);\r\n        this.insertSpaces = insertSpaces;\r\n    }\r\n    run(accessor, editor) {\r\n        const quickInputService = accessor.get(IQuickInputService);\r\n        const modelService = accessor.get(IModelService);\r\n        let model = editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        let creationOpts = modelService.getCreationOptions(model.getLanguageIdentifier().language, model.uri, model.isForSimpleWidget);\r\n        const picks = [1, 2, 3, 4, 5, 6, 7, 8].map(n => ({\r\n            id: n.toString(),\r\n            label: n.toString(),\r\n            // add description for tabSize value set in the configuration\r\n            description: n === creationOpts.tabSize ? nls.localize('configuredTabSize', \"Configured Tab Size\") : undefined\r\n        }));\r\n        // auto focus the tabSize set for the current editor\r\n        const autoFocusIndex = Math.min(model.getOptions().tabSize - 1, 7);\r\n        setTimeout(() => {\r\n            quickInputService.pick(picks, { placeHolder: nls.localize({ key: 'selectTabWidth', comment: ['Tab corresponds to the tab key'] }, \"Select Tab Size for Current File\"), activeItem: picks[autoFocusIndex] }).then(pick => {\r\n                if (pick) {\r\n                    if (model && !model.isDisposed()) {\r\n                        model.updateOptions({\r\n                            tabSize: parseInt(pick.label, 10),\r\n                            insertSpaces: this.insertSpaces\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        }, 50 /* quick input is sensitive to being opened so soon after another */);\r\n    }\r\n}\r\nexport class IndentUsingTabs extends ChangeIndentationSizeAction {\r\n    constructor() {\r\n        super(false, {\r\n            id: IndentUsingTabs.ID,\r\n            label: nls.localize('indentUsingTabs', \"Indent Using Tabs\"),\r\n            alias: 'Indent Using Tabs',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nIndentUsingTabs.ID = 'editor.action.indentUsingTabs';\r\nexport class IndentUsingSpaces extends ChangeIndentationSizeAction {\r\n    constructor() {\r\n        super(true, {\r\n            id: IndentUsingSpaces.ID,\r\n            label: nls.localize('indentUsingSpaces', \"Indent Using Spaces\"),\r\n            alias: 'Indent Using Spaces',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nIndentUsingSpaces.ID = 'editor.action.indentUsingSpaces';\r\nexport class DetectIndentation extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: DetectIndentation.ID,\r\n            label: nls.localize('detectIndentation', \"Detect Indentation from Content\"),\r\n            alias: 'Detect Indentation from Content',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        const modelService = accessor.get(IModelService);\r\n        let model = editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        let creationOpts = modelService.getCreationOptions(model.getLanguageIdentifier().language, model.uri, model.isForSimpleWidget);\r\n        model.detectIndentation(creationOpts.insertSpaces, creationOpts.tabSize);\r\n    }\r\n}\r\nDetectIndentation.ID = 'editor.action.detectIndentation';\r\nexport class ReindentLinesAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.reindentlines',\r\n            label: nls.localize('editor.reindentlines', \"Reindent Lines\"),\r\n            alias: 'Reindent Lines',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        let model = editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        let edits = getReindentEditOperations(model, 1, model.getLineCount());\r\n        if (edits.length > 0) {\r\n            editor.pushUndoStop();\r\n            editor.executeEdits(this.id, edits);\r\n            editor.pushUndoStop();\r\n        }\r\n    }\r\n}\r\nexport class ReindentSelectedLinesAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.reindentselectedlines',\r\n            label: nls.localize('editor.reindentselectedlines', \"Reindent Selected Lines\"),\r\n            alias: 'Reindent Selected Lines',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        let model = editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        let selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        let edits = [];\r\n        for (let selection of selections) {\r\n            let startLineNumber = selection.startLineNumber;\r\n            let endLineNumber = selection.endLineNumber;\r\n            if (startLineNumber !== endLineNumber && selection.endColumn === 1) {\r\n                endLineNumber--;\r\n            }\r\n            if (startLineNumber === 1) {\r\n                if (startLineNumber === endLineNumber) {\r\n                    continue;\r\n                }\r\n            }\r\n            else {\r\n                startLineNumber--;\r\n            }\r\n            let editOperations = getReindentEditOperations(model, startLineNumber, endLineNumber);\r\n            edits.push(...editOperations);\r\n        }\r\n        if (edits.length > 0) {\r\n            editor.pushUndoStop();\r\n            editor.executeEdits(this.id, edits);\r\n            editor.pushUndoStop();\r\n        }\r\n    }\r\n}\r\nexport class AutoIndentOnPasteCommand {\r\n    constructor(edits, initialSelection) {\r\n        this._initialSelection = initialSelection;\r\n        this._edits = [];\r\n        this._selectionId = null;\r\n        for (let edit of edits) {\r\n            if (edit.range && typeof edit.text === 'string') {\r\n                this._edits.push(edit);\r\n            }\r\n        }\r\n    }\r\n    getEditOperations(model, builder) {\r\n        for (let edit of this._edits) {\r\n            builder.addEditOperation(Range.lift(edit.range), edit.text);\r\n        }\r\n        let selectionIsSet = false;\r\n        if (Array.isArray(this._edits) && this._edits.length === 1 && this._initialSelection.isEmpty()) {\r\n            if (this._edits[0].range.startColumn === this._initialSelection.endColumn &&\r\n                this._edits[0].range.startLineNumber === this._initialSelection.endLineNumber) {\r\n                selectionIsSet = true;\r\n                this._selectionId = builder.trackSelection(this._initialSelection, true);\r\n            }\r\n            else if (this._edits[0].range.endColumn === this._initialSelection.startColumn &&\r\n                this._edits[0].range.endLineNumber === this._initialSelection.startLineNumber) {\r\n                selectionIsSet = true;\r\n                this._selectionId = builder.trackSelection(this._initialSelection, false);\r\n            }\r\n        }\r\n        if (!selectionIsSet) {\r\n            this._selectionId = builder.trackSelection(this._initialSelection);\r\n        }\r\n    }\r\n    computeCursorState(model, helper) {\r\n        return helper.getTrackedSelection(this._selectionId);\r\n    }\r\n}\r\nexport class AutoIndentOnPaste {\r\n    constructor(editor) {\r\n        this.callOnDispose = new DisposableStore();\r\n        this.callOnModel = new DisposableStore();\r\n        this.editor = editor;\r\n        this.callOnDispose.add(editor.onDidChangeConfiguration(() => this.update()));\r\n        this.callOnDispose.add(editor.onDidChangeModel(() => this.update()));\r\n        this.callOnDispose.add(editor.onDidChangeModelLanguage(() => this.update()));\r\n    }\r\n    update() {\r\n        // clean up\r\n        this.callOnModel.clear();\r\n        // we are disabled\r\n        if (this.editor.getOption(9 /* autoIndent */) < 4 /* Full */ || this.editor.getOption(45 /* formatOnPaste */)) {\r\n            return;\r\n        }\r\n        // no model\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        this.callOnModel.add(this.editor.onDidPaste(({ range }) => {\r\n            this.trigger(range);\r\n        }));\r\n    }\r\n    trigger(range) {\r\n        let selections = this.editor.getSelections();\r\n        if (selections === null || selections.length > 1) {\r\n            return;\r\n        }\r\n        const model = this.editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        if (!model.isCheapToTokenize(range.getStartPosition().lineNumber)) {\r\n            return;\r\n        }\r\n        const autoIndent = this.editor.getOption(9 /* autoIndent */);\r\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\r\n        let textEdits = [];\r\n        let indentConverter = {\r\n            shiftIndent: (indentation) => {\r\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            },\r\n            unshiftIndent: (indentation) => {\r\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            }\r\n        };\r\n        let startLineNumber = range.startLineNumber;\r\n        while (startLineNumber <= range.endLineNumber) {\r\n            if (this.shouldIgnoreLine(model, startLineNumber)) {\r\n                startLineNumber++;\r\n                continue;\r\n            }\r\n            break;\r\n        }\r\n        if (startLineNumber > range.endLineNumber) {\r\n            return;\r\n        }\r\n        let firstLineText = model.getLineContent(startLineNumber);\r\n        if (!/\\S/.test(firstLineText.substring(0, range.startColumn - 1))) {\r\n            let indentOfFirstLine = LanguageConfigurationRegistry.getGoodIndentForLine(autoIndent, model, model.getLanguageIdentifier().id, startLineNumber, indentConverter);\r\n            if (indentOfFirstLine !== null) {\r\n                let oldIndentation = strings.getLeadingWhitespace(firstLineText);\r\n                let newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\r\n                let oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                if (newSpaceCnt !== oldSpaceCnt) {\r\n                    let newIndent = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\r\n                    textEdits.push({\r\n                        range: new Range(startLineNumber, 1, startLineNumber, oldIndentation.length + 1),\r\n                        text: newIndent\r\n                    });\r\n                    firstLineText = newIndent + firstLineText.substr(oldIndentation.length);\r\n                }\r\n                else {\r\n                    let indentMetadata = LanguageConfigurationRegistry.getIndentMetadata(model, startLineNumber);\r\n                    if (indentMetadata === 0 || indentMetadata === 8 /* UNINDENT_MASK */) {\r\n                        // we paste content into a line where only contains whitespaces\r\n                        // after pasting, the indentation of the first line is already correct\r\n                        // the first line doesn't match any indentation rule\r\n                        // then no-op.\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        const firstLineNumber = startLineNumber;\r\n        // ignore empty or ignored lines\r\n        while (startLineNumber < range.endLineNumber) {\r\n            if (!/\\S/.test(model.getLineContent(startLineNumber + 1))) {\r\n                startLineNumber++;\r\n                continue;\r\n            }\r\n            break;\r\n        }\r\n        if (startLineNumber !== range.endLineNumber) {\r\n            let virtualModel = {\r\n                getLineTokens: (lineNumber) => {\r\n                    return model.getLineTokens(lineNumber);\r\n                },\r\n                getLanguageIdentifier: () => {\r\n                    return model.getLanguageIdentifier();\r\n                },\r\n                getLanguageIdAtPosition: (lineNumber, column) => {\r\n                    return model.getLanguageIdAtPosition(lineNumber, column);\r\n                },\r\n                getLineContent: (lineNumber) => {\r\n                    if (lineNumber === firstLineNumber) {\r\n                        return firstLineText;\r\n                    }\r\n                    else {\r\n                        return model.getLineContent(lineNumber);\r\n                    }\r\n                }\r\n            };\r\n            let indentOfSecondLine = LanguageConfigurationRegistry.getGoodIndentForLine(autoIndent, virtualModel, model.getLanguageIdentifier().id, startLineNumber + 1, indentConverter);\r\n            if (indentOfSecondLine !== null) {\r\n                let newSpaceCntOfSecondLine = indentUtils.getSpaceCnt(indentOfSecondLine, tabSize);\r\n                let oldSpaceCntOfSecondLine = indentUtils.getSpaceCnt(strings.getLeadingWhitespace(model.getLineContent(startLineNumber + 1)), tabSize);\r\n                if (newSpaceCntOfSecondLine !== oldSpaceCntOfSecondLine) {\r\n                    let spaceCntOffset = newSpaceCntOfSecondLine - oldSpaceCntOfSecondLine;\r\n                    for (let i = startLineNumber + 1; i <= range.endLineNumber; i++) {\r\n                        let lineContent = model.getLineContent(i);\r\n                        let originalIndent = strings.getLeadingWhitespace(lineContent);\r\n                        let originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\r\n                        let newSpacesCnt = originalSpacesCnt + spaceCntOffset;\r\n                        let newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\r\n                        if (newIndent !== originalIndent) {\r\n                            textEdits.push({\r\n                                range: new Range(i, 1, i, originalIndent.length + 1),\r\n                                text: newIndent\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (textEdits.length > 0) {\r\n            this.editor.pushUndoStop();\r\n            let cmd = new AutoIndentOnPasteCommand(textEdits, this.editor.getSelection());\r\n            this.editor.executeCommand('autoIndentOnPaste', cmd);\r\n            this.editor.pushUndoStop();\r\n        }\r\n    }\r\n    shouldIgnoreLine(model, lineNumber) {\r\n        model.forceTokenization(lineNumber);\r\n        let nonWhitespaceColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\r\n        if (nonWhitespaceColumn === 0) {\r\n            return true;\r\n        }\r\n        let tokens = model.getLineTokens(lineNumber);\r\n        if (tokens.getCount() > 0) {\r\n            let firstNonWhitespaceTokenIndex = tokens.findTokenIndexAtOffset(nonWhitespaceColumn);\r\n            if (firstNonWhitespaceTokenIndex >= 0 && tokens.getStandardTokenType(firstNonWhitespaceTokenIndex) === 1 /* Comment */) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    dispose() {\r\n        this.callOnDispose.dispose();\r\n        this.callOnModel.dispose();\r\n    }\r\n}\r\nAutoIndentOnPaste.ID = 'editor.contrib.autoIndentOnPaste';\r\nfunction getIndentationEditOperations(model, builder, tabSize, tabsToSpaces) {\r\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\r\n        // Model is empty\r\n        return;\r\n    }\r\n    let spaces = '';\r\n    for (let i = 0; i < tabSize; i++) {\r\n        spaces += ' ';\r\n    }\r\n    let spacesRegExp = new RegExp(spaces, 'gi');\r\n    for (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\r\n        let lastIndentationColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\r\n        if (lastIndentationColumn === 0) {\r\n            lastIndentationColumn = model.getLineMaxColumn(lineNumber);\r\n        }\r\n        if (lastIndentationColumn === 1) {\r\n            continue;\r\n        }\r\n        const originalIndentationRange = new Range(lineNumber, 1, lineNumber, lastIndentationColumn);\r\n        const originalIndentation = model.getValueInRange(originalIndentationRange);\r\n        const newIndentation = (tabsToSpaces\r\n            ? originalIndentation.replace(/\\t/ig, spaces)\r\n            : originalIndentation.replace(spacesRegExp, '\\t'));\r\n        builder.addEditOperation(originalIndentationRange, newIndentation);\r\n    }\r\n}\r\nexport class IndentationToSpacesCommand {\r\n    constructor(selection, tabSize) {\r\n        this.selection = selection;\r\n        this.tabSize = tabSize;\r\n        this.selectionId = null;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        this.selectionId = builder.trackSelection(this.selection);\r\n        getIndentationEditOperations(model, builder, this.tabSize, true);\r\n    }\r\n    computeCursorState(model, helper) {\r\n        return helper.getTrackedSelection(this.selectionId);\r\n    }\r\n}\r\nexport class IndentationToTabsCommand {\r\n    constructor(selection, tabSize) {\r\n        this.selection = selection;\r\n        this.tabSize = tabSize;\r\n        this.selectionId = null;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        this.selectionId = builder.trackSelection(this.selection);\r\n        getIndentationEditOperations(model, builder, this.tabSize, false);\r\n    }\r\n    computeCursorState(model, helper) {\r\n        return helper.getTrackedSelection(this.selectionId);\r\n    }\r\n}\r\nregisterEditorContribution(AutoIndentOnPaste.ID, AutoIndentOnPaste);\r\nregisterEditorAction(IndentationToSpacesAction);\r\nregisterEditorAction(IndentationToTabsAction);\r\nregisterEditorAction(IndentUsingTabs);\r\nregisterEditorAction(IndentUsingSpaces);\r\nregisterEditorAction(DetectIndentation);\r\nregisterEditorAction(ReindentLinesAction);\r\nregisterEditorAction(ReindentSelectedLinesAction);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { hash } from '../../../base/common/hash.js';\r\nimport { DisposableStore, toDisposable } from '../../../base/common/lifecycle.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { InlayHintsProviderRegistry } from '../../common/modes.js';\r\nimport { flatten } from '../../../base/common/arrays.js';\r\nimport { editorInlayHintForeground, editorInlayHintBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { CancellationToken, CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { LanguageFeatureRequestDelays } from '../../common/modes/languageFeatureRegistry.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nimport { ITextModelService } from '../../common/services/resolverService.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nconst MAX_DECORATORS = 500;\r\nexport function getInlayHints(model, ranges, token) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const datas = [];\r\n        const providers = InlayHintsProviderRegistry.ordered(model).reverse();\r\n        const promises = flatten(providers.map(provider => ranges.map(range => Promise.resolve(provider.provideInlayHints(model, range, token)).then(result => {\r\n            if (result) {\r\n                datas.push({ list: result, provider });\r\n            }\r\n        }, err => {\r\n            onUnexpectedExternalError(err);\r\n        }))));\r\n        yield Promise.all(promises);\r\n        return datas;\r\n    });\r\n}\r\nlet InlayHintsController = class InlayHintsController {\r\n    constructor(_editor, _codeEditorService, _themeService, _configurationService) {\r\n        this._editor = _editor;\r\n        this._codeEditorService = _codeEditorService;\r\n        this._themeService = _themeService;\r\n        this._configurationService = _configurationService;\r\n        this._disposables = new DisposableStore();\r\n        this._sessionDisposables = new DisposableStore();\r\n        this._getInlayHintsDelays = new LanguageFeatureRequestDelays(InlayHintsProviderRegistry, 25, 2500);\r\n        this._decorationsTypeIds = [];\r\n        this._decorationIds = [];\r\n        this._disposables.add(InlayHintsProviderRegistry.onDidChange(() => this._update()));\r\n        this._disposables.add(_themeService.onDidColorThemeChange(() => this._update()));\r\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\r\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\r\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\r\n            if (e.hasChanged(125 /* inlayHints */)) {\r\n                this._update();\r\n            }\r\n        }));\r\n        this._update();\r\n    }\r\n    dispose() {\r\n        this._sessionDisposables.dispose();\r\n        this._removeAllDecorations();\r\n        this._disposables.dispose();\r\n    }\r\n    _update() {\r\n        this._sessionDisposables.clear();\r\n        if (!this._editor.getOption(125 /* inlayHints */).enabled) {\r\n            this._removeAllDecorations();\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        if (!model || !InlayHintsProviderRegistry.has(model)) {\r\n            this._removeAllDecorations();\r\n            return;\r\n        }\r\n        const scheduler = new RunOnceScheduler(() => __awaiter(this, void 0, void 0, function* () {\r\n            const t1 = Date.now();\r\n            const cts = new CancellationTokenSource();\r\n            this._sessionDisposables.add(toDisposable(() => cts.dispose(true)));\r\n            const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\r\n            const result = yield getInlayHints(model, visibleRanges, cts.token);\r\n            // update moving average\r\n            const newDelay = this._getInlayHintsDelays.update(model, Date.now() - t1);\r\n            scheduler.delay = newDelay;\r\n            // render hints\r\n            this._updateHintsDecorators(result);\r\n        }), this._getInlayHintsDelays.get(model));\r\n        this._sessionDisposables.add(scheduler);\r\n        // update inline hints when content or scroll position changes\r\n        this._sessionDisposables.add(this._editor.onDidChangeModelContent(() => scheduler.schedule()));\r\n        this._disposables.add(this._editor.onDidScrollChange(() => scheduler.schedule()));\r\n        scheduler.schedule();\r\n        // update inline hints when any any provider fires an event\r\n        const providerListener = new DisposableStore();\r\n        this._sessionDisposables.add(providerListener);\r\n        for (const provider of InlayHintsProviderRegistry.all(model)) {\r\n            if (typeof provider.onDidChangeInlayHints === 'function') {\r\n                providerListener.add(provider.onDidChangeInlayHints(() => scheduler.schedule()));\r\n            }\r\n        }\r\n    }\r\n    _updateHintsDecorators(hintsData) {\r\n        const { fontSize, fontFamily } = this._getLayoutInfo();\r\n        const backgroundColor = this._themeService.getColorTheme().getColor(editorInlayHintBackground);\r\n        const fontColor = this._themeService.getColorTheme().getColor(editorInlayHintForeground);\r\n        const newDecorationsTypeIds = [];\r\n        const newDecorationsData = [];\r\n        const fontFamilyVar = '--inlayHintsFontFamily';\r\n        this._editor.getContainerDomNode().style.setProperty(fontFamilyVar, fontFamily);\r\n        const key = this._configurationService.getValue('editor.useInjectedText');\r\n        const shouldUseInjectedText = key === undefined ? true : !!key;\r\n        for (const { list: hints } of hintsData) {\r\n            for (let j = 0; j < hints.length && newDecorationsData.length < MAX_DECORATORS; j++) {\r\n                const { text, position, whitespaceBefore, whitespaceAfter } = hints[j];\r\n                const marginBefore = whitespaceBefore ? (fontSize / 3) | 0 : 0;\r\n                const marginAfter = whitespaceAfter ? (fontSize / 3) | 0 : 0;\r\n                const massagedText = fixSpace(text);\r\n                const before = {\r\n                    contentText: massagedText,\r\n                    backgroundColor: `${backgroundColor}`,\r\n                    color: `${fontColor}`,\r\n                    margin: `0px ${marginAfter}px 0px ${marginBefore}px`,\r\n                    fontSize: `${fontSize}px`,\r\n                    fontFamily: `var(${fontFamilyVar})`,\r\n                    padding: `0px ${(fontSize / 4) | 0}px`,\r\n                    borderRadius: `${(fontSize / 4) | 0}px`,\r\n                };\r\n                const key = 'inlayHints-' + hash(before).toString(16);\r\n                this._codeEditorService.registerDecorationType('inlay-hints-controller', key, shouldUseInjectedText ? { beforeInjectedText: Object.assign(Object.assign({}, before), { affectsLetterSpacing: true }) } : { before }, undefined, this._editor);\r\n                // decoration types are ref-counted which means we only need to\r\n                // call register und remove equally often\r\n                newDecorationsTypeIds.push(key);\r\n                const options = this._codeEditorService.resolveDecorationOptions(key, true);\r\n                newDecorationsData.push({\r\n                    range: Range.fromPositions(position),\r\n                    options\r\n                });\r\n            }\r\n        }\r\n        this._decorationsTypeIds.forEach(this._codeEditorService.removeDecorationType, this._codeEditorService);\r\n        this._decorationsTypeIds = newDecorationsTypeIds;\r\n        this._decorationIds = this._editor.deltaDecorations(this._decorationIds, newDecorationsData);\r\n    }\r\n    _getLayoutInfo() {\r\n        const options = this._editor.getOption(125 /* inlayHints */);\r\n        const editorFontSize = this._editor.getOption(43 /* fontSize */);\r\n        let fontSize = options.fontSize;\r\n        if (!fontSize || fontSize < 5 || fontSize > editorFontSize) {\r\n            fontSize = (editorFontSize * .9) | 0;\r\n        }\r\n        const fontFamily = options.fontFamily || this._editor.getOption(40 /* fontFamily */);\r\n        return { fontSize, fontFamily };\r\n    }\r\n    _removeAllDecorations() {\r\n        this._decorationIds = this._editor.deltaDecorations(this._decorationIds, []);\r\n        this._decorationsTypeIds.forEach(this._codeEditorService.removeDecorationType, this._codeEditorService);\r\n        this._decorationsTypeIds = [];\r\n    }\r\n};\r\nInlayHintsController.ID = 'editor.contrib.InlayHints';\r\nInlayHintsController = __decorate([\r\n    __param(1, ICodeEditorService),\r\n    __param(2, IThemeService),\r\n    __param(3, IConfigurationService)\r\n], InlayHintsController);\r\nexport { InlayHintsController };\r\nfunction fixSpace(str) {\r\n    const noBreakWhitespace = '\\xa0';\r\n    return str.replace(/[ \\t]/g, noBreakWhitespace);\r\n}\r\nregisterEditorContribution(InlayHintsController.ID, InlayHintsController);\r\nCommandsRegistry.registerCommand('_executeInlayHintProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const [uri, range] = args;\r\n    assertType(URI.isUri(uri));\r\n    assertType(Range.isIRange(range));\r\n    const ref = yield accessor.get(ITextModelService).createModelReference(uri);\r\n    try {\r\n        const data = yield getInlayHints(ref.object.textEditorModel, [Range.lift(range)], CancellationToken.None);\r\n        return flatten(data.map(item => item.list)).sort((a, b) => Position.compare(a.position, b.position));\r\n    }\r\n    finally {\r\n        ref.dispose();\r\n    }\r\n}));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { EditOperation } from '../core/editOperation.js';\r\nimport { Range } from '../core/range.js';\r\nexport class TrimTrailingWhitespaceCommand {\r\n    constructor(selection, cursors) {\r\n        this._selection = selection;\r\n        this._cursors = cursors;\r\n        this._selectionId = null;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        let ops = trimTrailingWhitespace(model, this._cursors);\r\n        for (let i = 0, len = ops.length; i < len; i++) {\r\n            let op = ops[i];\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n        this._selectionId = builder.trackSelection(this._selection);\r\n    }\r\n    computeCursorState(model, helper) {\r\n        return helper.getTrackedSelection(this._selectionId);\r\n    }\r\n}\r\n/**\r\n * Generate commands for trimming trailing whitespace on a model and ignore lines on which cursors are sitting.\r\n */\r\nexport function trimTrailingWhitespace(model, cursors) {\r\n    // Sort cursors ascending\r\n    cursors.sort((a, b) => {\r\n        if (a.lineNumber === b.lineNumber) {\r\n            return a.column - b.column;\r\n        }\r\n        return a.lineNumber - b.lineNumber;\r\n    });\r\n    // Reduce multiple cursors on the same line and only keep the last one on the line\r\n    for (let i = cursors.length - 2; i >= 0; i--) {\r\n        if (cursors[i].lineNumber === cursors[i + 1].lineNumber) {\r\n            // Remove cursor at `i`\r\n            cursors.splice(i, 1);\r\n        }\r\n    }\r\n    let r = [];\r\n    let rLen = 0;\r\n    let cursorIndex = 0;\r\n    let cursorLen = cursors.length;\r\n    for (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\r\n        let lineContent = model.getLineContent(lineNumber);\r\n        let maxLineColumn = lineContent.length + 1;\r\n        let minEditColumn = 0;\r\n        if (cursorIndex < cursorLen && cursors[cursorIndex].lineNumber === lineNumber) {\r\n            minEditColumn = cursors[cursorIndex].column;\r\n            cursorIndex++;\r\n            if (minEditColumn === maxLineColumn) {\r\n                // The cursor is at the end of the line => no edits for sure on this line\r\n                continue;\r\n            }\r\n        }\r\n        if (lineContent.length === 0) {\r\n            continue;\r\n        }\r\n        let lastNonWhitespaceIndex = strings.lastNonWhitespaceIndex(lineContent);\r\n        let fromColumn = 0;\r\n        if (lastNonWhitespaceIndex === -1) {\r\n            // Entire line is whitespace\r\n            fromColumn = 1;\r\n        }\r\n        else if (lastNonWhitespaceIndex !== lineContent.length - 1) {\r\n            // There is trailing whitespace\r\n            fromColumn = lastNonWhitespaceIndex + 2;\r\n        }\r\n        else {\r\n            // There is no trailing whitespace\r\n            continue;\r\n        }\r\n        fromColumn = Math.max(minEditColumn, fromColumn);\r\n        r[rLen++] = EditOperation.delete(new Range(lineNumber, fromColumn, lineNumber, maxLineColumn));\r\n    }\r\n    return r;\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nexport class CopyLinesCommand {\r\n    constructor(selection, isCopyingDown, noop) {\r\n        this._selection = selection;\r\n        this._isCopyingDown = isCopyingDown;\r\n        this._noop = noop || false;\r\n        this._selectionDirection = 0 /* LTR */;\r\n        this._selectionId = null;\r\n        this._startLineNumberDelta = 0;\r\n        this._endLineNumberDelta = 0;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        let s = this._selection;\r\n        this._startLineNumberDelta = 0;\r\n        this._endLineNumberDelta = 0;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._endLineNumberDelta = 1;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        let sourceLines = [];\r\n        for (let i = s.startLineNumber; i <= s.endLineNumber; i++) {\r\n            sourceLines.push(model.getLineContent(i));\r\n        }\r\n        const sourceText = sourceLines.join('\\n');\r\n        if (sourceText === '') {\r\n            // Duplicating empty line\r\n            if (this._isCopyingDown) {\r\n                this._startLineNumberDelta++;\r\n                this._endLineNumberDelta++;\r\n            }\r\n        }\r\n        if (this._noop) {\r\n            builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber + 1, 1), s.endLineNumber === model.getLineCount() ? '' : '\\n');\r\n        }\r\n        else {\r\n            if (!this._isCopyingDown) {\r\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + sourceText);\r\n            }\r\n            else {\r\n                builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), sourceText + '\\n');\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n        this._selectionDirection = this._selection.getDirection();\r\n    }\r\n    computeCursorState(model, helper) {\r\n        let result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._startLineNumberDelta !== 0 || this._endLineNumberDelta !== 0) {\r\n            let startLineNumber = result.startLineNumber;\r\n            let startColumn = result.startColumn;\r\n            let endLineNumber = result.endLineNumber;\r\n            let endColumn = result.endColumn;\r\n            if (this._startLineNumberDelta !== 0) {\r\n                startLineNumber = startLineNumber + this._startLineNumberDelta;\r\n                startColumn = 1;\r\n            }\r\n            if (this._endLineNumberDelta !== 0) {\r\n                endLineNumber = endLineNumber + this._endLineNumberDelta;\r\n                endColumn = 1;\r\n            }\r\n            result = Selection.createWithDirection(startLineNumber, startColumn, endLineNumber, endColumn, this._selectionDirection);\r\n        }\r\n        return result;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as strings from '../../../base/common/strings.js';\r\nimport { ShiftCommand } from '../../common/commands/shiftCommand.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { IndentAction } from '../../common/modes/languageConfiguration.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport * as indentUtils from '../indentation/indentUtils.js';\r\nexport class MoveLinesCommand {\r\n    constructor(selection, isMovingDown, autoIndent) {\r\n        this._selection = selection;\r\n        this._isMovingDown = isMovingDown;\r\n        this._autoIndent = autoIndent;\r\n        this._selectionId = null;\r\n        this._moveEndLineSelectionShrink = false;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        let modelLineCount = model.getLineCount();\r\n        if (this._isMovingDown && this._selection.endLineNumber === modelLineCount) {\r\n            this._selectionId = builder.trackSelection(this._selection);\r\n            return;\r\n        }\r\n        if (!this._isMovingDown && this._selection.startLineNumber === 1) {\r\n            this._selectionId = builder.trackSelection(this._selection);\r\n            return;\r\n        }\r\n        this._moveEndPositionDown = false;\r\n        let s = this._selection;\r\n        if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n            this._moveEndPositionDown = true;\r\n            s = s.setEndPosition(s.endLineNumber - 1, model.getLineMaxColumn(s.endLineNumber - 1));\r\n        }\r\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\r\n        let indentConverter = this.buildIndentConverter(tabSize, indentSize, insertSpaces);\r\n        let virtualModel = {\r\n            getLineTokens: (lineNumber) => {\r\n                return model.getLineTokens(lineNumber);\r\n            },\r\n            getLanguageIdentifier: () => {\r\n                return model.getLanguageIdentifier();\r\n            },\r\n            getLanguageIdAtPosition: (lineNumber, column) => {\r\n                return model.getLanguageIdAtPosition(lineNumber, column);\r\n            },\r\n            getLineContent: null,\r\n        };\r\n        if (s.startLineNumber === s.endLineNumber && model.getLineMaxColumn(s.startLineNumber) === 1) {\r\n            // Current line is empty\r\n            let lineNumber = s.startLineNumber;\r\n            let otherLineNumber = (this._isMovingDown ? lineNumber + 1 : lineNumber - 1);\r\n            if (model.getLineMaxColumn(otherLineNumber) === 1) {\r\n                // Other line number is empty too, so no editing is needed\r\n                // Add a no-op to force running by the model\r\n                builder.addEditOperation(new Range(1, 1, 1, 1), null);\r\n            }\r\n            else {\r\n                // Type content from other line number on line number\r\n                builder.addEditOperation(new Range(lineNumber, 1, lineNumber, 1), model.getLineContent(otherLineNumber));\r\n                // Remove content from other line number\r\n                builder.addEditOperation(new Range(otherLineNumber, 1, otherLineNumber, model.getLineMaxColumn(otherLineNumber)), null);\r\n            }\r\n            // Track selection at the other line number\r\n            s = new Selection(otherLineNumber, 1, otherLineNumber, 1);\r\n        }\r\n        else {\r\n            let movingLineNumber;\r\n            let movingLineText;\r\n            if (this._isMovingDown) {\r\n                movingLineNumber = s.endLineNumber + 1;\r\n                movingLineText = model.getLineContent(movingLineNumber);\r\n                // Delete line that needs to be moved\r\n                builder.addEditOperation(new Range(movingLineNumber - 1, model.getLineMaxColumn(movingLineNumber - 1), movingLineNumber, model.getLineMaxColumn(movingLineNumber)), null);\r\n                let insertingText = movingLineText;\r\n                if (this.shouldAutoIndent(model, s)) {\r\n                    let movingLineMatchResult = this.matchEnterRule(model, indentConverter, tabSize, movingLineNumber, s.startLineNumber - 1);\r\n                    // if s.startLineNumber - 1 matches onEnter rule, we still honor that.\r\n                    if (movingLineMatchResult !== null) {\r\n                        let oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber));\r\n                        let newSpaceCnt = movingLineMatchResult + indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                        let newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\r\n                        insertingText = newIndentation + this.trimLeft(movingLineText);\r\n                    }\r\n                    else {\r\n                        // no enter rule matches, let's check indentatin rules then.\r\n                        virtualModel.getLineContent = (lineNumber) => {\r\n                            if (lineNumber === s.startLineNumber) {\r\n                                return model.getLineContent(movingLineNumber);\r\n                            }\r\n                            else {\r\n                                return model.getLineContent(lineNumber);\r\n                            }\r\n                        };\r\n                        let indentOfMovingLine = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber, 1), s.startLineNumber, indentConverter);\r\n                        if (indentOfMovingLine !== null) {\r\n                            let oldIndentation = strings.getLeadingWhitespace(model.getLineContent(movingLineNumber));\r\n                            let newSpaceCnt = indentUtils.getSpaceCnt(indentOfMovingLine, tabSize);\r\n                            let oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                let newIndentation = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\r\n                                insertingText = newIndentation + this.trimLeft(movingLineText);\r\n                            }\r\n                        }\r\n                    }\r\n                    // add edit operations for moving line first to make sure it's executed after we make indentation change\r\n                    // to s.startLineNumber\r\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText + '\\n');\r\n                    let ret = this.matchEnterRuleMovingDown(model, indentConverter, tabSize, s.startLineNumber, movingLineNumber, insertingText);\r\n                    // check if the line being moved before matches onEnter rules, if so let's adjust the indentation by onEnter rules.\r\n                    if (ret !== null) {\r\n                        if (ret !== 0) {\r\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // it doesn't match onEnter rules, let's check indentation rules then.\r\n                        virtualModel.getLineContent = (lineNumber) => {\r\n                            if (lineNumber === s.startLineNumber) {\r\n                                return insertingText;\r\n                            }\r\n                            else if (lineNumber >= s.startLineNumber + 1 && lineNumber <= s.endLineNumber + 1) {\r\n                                return model.getLineContent(lineNumber - 1);\r\n                            }\r\n                            else {\r\n                                return model.getLineContent(lineNumber);\r\n                            }\r\n                        };\r\n                        let newIndentatOfMovingBlock = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(movingLineNumber, 1), s.startLineNumber + 1, indentConverter);\r\n                        if (newIndentatOfMovingBlock !== null) {\r\n                            const oldIndentation = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\r\n                            const newSpaceCnt = indentUtils.getSpaceCnt(newIndentatOfMovingBlock, tabSize);\r\n                            const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                const spaceCntOffset = newSpaceCnt - oldSpaceCnt;\r\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Insert line that needs to be moved before\r\n                    builder.addEditOperation(new Range(s.startLineNumber, 1, s.startLineNumber, 1), insertingText + '\\n');\r\n                }\r\n            }\r\n            else {\r\n                movingLineNumber = s.startLineNumber - 1;\r\n                movingLineText = model.getLineContent(movingLineNumber);\r\n                // Delete line that needs to be moved\r\n                builder.addEditOperation(new Range(movingLineNumber, 1, movingLineNumber + 1, 1), null);\r\n                // Insert line that needs to be moved after\r\n                builder.addEditOperation(new Range(s.endLineNumber, model.getLineMaxColumn(s.endLineNumber), s.endLineNumber, model.getLineMaxColumn(s.endLineNumber)), '\\n' + movingLineText);\r\n                if (this.shouldAutoIndent(model, s)) {\r\n                    virtualModel.getLineContent = (lineNumber) => {\r\n                        if (lineNumber === movingLineNumber) {\r\n                            return model.getLineContent(s.startLineNumber);\r\n                        }\r\n                        else {\r\n                            return model.getLineContent(lineNumber);\r\n                        }\r\n                    };\r\n                    let ret = this.matchEnterRule(model, indentConverter, tabSize, s.startLineNumber, s.startLineNumber - 2);\r\n                    // check if s.startLineNumber - 2 matches onEnter rules, if so adjust the moving block by onEnter rules.\r\n                    if (ret !== null) {\r\n                        if (ret !== 0) {\r\n                            this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, ret);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // it doesn't match any onEnter rule, let's check indentation rules then.\r\n                        let indentOfFirstLine = LanguageConfigurationRegistry.getGoodIndentForLine(this._autoIndent, virtualModel, model.getLanguageIdAtPosition(s.startLineNumber, 1), movingLineNumber, indentConverter);\r\n                        if (indentOfFirstLine !== null) {\r\n                            // adjust the indentation of the moving block\r\n                            let oldIndent = strings.getLeadingWhitespace(model.getLineContent(s.startLineNumber));\r\n                            let newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\r\n                            let oldSpaceCnt = indentUtils.getSpaceCnt(oldIndent, tabSize);\r\n                            if (newSpaceCnt !== oldSpaceCnt) {\r\n                                let spaceCntOffset = newSpaceCnt - oldSpaceCnt;\r\n                                this.getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, spaceCntOffset);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._selectionId = builder.trackSelection(s);\r\n    }\r\n    buildIndentConverter(tabSize, indentSize, insertSpaces) {\r\n        return {\r\n            shiftIndent: (indentation) => {\r\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            },\r\n            unshiftIndent: (indentation) => {\r\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\r\n            }\r\n        };\r\n    }\r\n    parseEnterResult(model, indentConverter, tabSize, line, enter) {\r\n        if (enter) {\r\n            let enterPrefix = enter.indentation;\r\n            if (enter.indentAction === IndentAction.None) {\r\n                enterPrefix = enter.indentation + enter.appendText;\r\n            }\r\n            else if (enter.indentAction === IndentAction.Indent) {\r\n                enterPrefix = enter.indentation + enter.appendText;\r\n            }\r\n            else if (enter.indentAction === IndentAction.IndentOutdent) {\r\n                enterPrefix = enter.indentation;\r\n            }\r\n            else if (enter.indentAction === IndentAction.Outdent) {\r\n                enterPrefix = indentConverter.unshiftIndent(enter.indentation) + enter.appendText;\r\n            }\r\n            let movingLineText = model.getLineContent(line);\r\n            if (this.trimLeft(movingLineText).indexOf(this.trimLeft(enterPrefix)) >= 0) {\r\n                let oldIndentation = strings.getLeadingWhitespace(model.getLineContent(line));\r\n                let newIndentation = strings.getLeadingWhitespace(enterPrefix);\r\n                let indentMetadataOfMovelingLine = LanguageConfigurationRegistry.getIndentMetadata(model, line);\r\n                if (indentMetadataOfMovelingLine !== null && indentMetadataOfMovelingLine & 2 /* DECREASE_MASK */) {\r\n                    newIndentation = indentConverter.unshiftIndent(newIndentation);\r\n                }\r\n                let newSpaceCnt = indentUtils.getSpaceCnt(newIndentation, tabSize);\r\n                let oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\r\n                return newSpaceCnt - oldSpaceCnt;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     *\r\n     * @param model\r\n     * @param indentConverter\r\n     * @param tabSize\r\n     * @param line the line moving down\r\n     * @param futureAboveLineNumber the line which will be at the `line` position\r\n     * @param futureAboveLineText\r\n     */\r\n    matchEnterRuleMovingDown(model, indentConverter, tabSize, line, futureAboveLineNumber, futureAboveLineText) {\r\n        if (strings.lastNonWhitespaceIndex(futureAboveLineText) >= 0) {\r\n            // break\r\n            let maxColumn = model.getLineMaxColumn(futureAboveLineNumber);\r\n            let enter = LanguageConfigurationRegistry.getEnterAction(this._autoIndent, model, new Range(futureAboveLineNumber, maxColumn, futureAboveLineNumber, maxColumn));\r\n            return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\r\n        }\r\n        else {\r\n            // go upwards, starting from `line - 1`\r\n            let validPrecedingLine = line - 1;\r\n            while (validPrecedingLine >= 1) {\r\n                let lineContent = model.getLineContent(validPrecedingLine);\r\n                let nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\r\n                if (nonWhitespaceIdx >= 0) {\r\n                    break;\r\n                }\r\n                validPrecedingLine--;\r\n            }\r\n            if (validPrecedingLine < 1 || line > model.getLineCount()) {\r\n                return null;\r\n            }\r\n            let maxColumn = model.getLineMaxColumn(validPrecedingLine);\r\n            let enter = LanguageConfigurationRegistry.getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn));\r\n            return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\r\n        }\r\n    }\r\n    matchEnterRule(model, indentConverter, tabSize, line, oneLineAbove, previousLineText) {\r\n        let validPrecedingLine = oneLineAbove;\r\n        while (validPrecedingLine >= 1) {\r\n            // ship empty lines as empty lines just inherit indentation\r\n            let lineContent;\r\n            if (validPrecedingLine === oneLineAbove && previousLineText !== undefined) {\r\n                lineContent = previousLineText;\r\n            }\r\n            else {\r\n                lineContent = model.getLineContent(validPrecedingLine);\r\n            }\r\n            let nonWhitespaceIdx = strings.lastNonWhitespaceIndex(lineContent);\r\n            if (nonWhitespaceIdx >= 0) {\r\n                break;\r\n            }\r\n            validPrecedingLine--;\r\n        }\r\n        if (validPrecedingLine < 1 || line > model.getLineCount()) {\r\n            return null;\r\n        }\r\n        let maxColumn = model.getLineMaxColumn(validPrecedingLine);\r\n        let enter = LanguageConfigurationRegistry.getEnterAction(this._autoIndent, model, new Range(validPrecedingLine, maxColumn, validPrecedingLine, maxColumn));\r\n        return this.parseEnterResult(model, indentConverter, tabSize, line, enter);\r\n    }\r\n    trimLeft(str) {\r\n        return str.replace(/^\\s+/, '');\r\n    }\r\n    shouldAutoIndent(model, selection) {\r\n        if (this._autoIndent < 4 /* Full */) {\r\n            return false;\r\n        }\r\n        // if it's not easy to tokenize, we stop auto indent.\r\n        if (!model.isCheapToTokenize(selection.startLineNumber)) {\r\n            return false;\r\n        }\r\n        let languageAtSelectionStart = model.getLanguageIdAtPosition(selection.startLineNumber, 1);\r\n        let languageAtSelectionEnd = model.getLanguageIdAtPosition(selection.endLineNumber, 1);\r\n        if (languageAtSelectionStart !== languageAtSelectionEnd) {\r\n            return false;\r\n        }\r\n        if (LanguageConfigurationRegistry.getIndentRulesSupport(languageAtSelectionStart) === null) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    getIndentEditsOfMovingBlock(model, builder, s, tabSize, insertSpaces, offset) {\r\n        for (let i = s.startLineNumber; i <= s.endLineNumber; i++) {\r\n            let lineContent = model.getLineContent(i);\r\n            let originalIndent = strings.getLeadingWhitespace(lineContent);\r\n            let originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\r\n            let newSpacesCnt = originalSpacesCnt + offset;\r\n            let newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\r\n            if (newIndent !== originalIndent) {\r\n                builder.addEditOperation(new Range(i, 1, i, originalIndent.length + 1), newIndent);\r\n                if (i === s.endLineNumber && s.endColumn <= originalIndent.length + 1 && newIndent === '') {\r\n                    // as users select part of the original indent white spaces\r\n                    // when we adjust the indentation of endLine, we should adjust the cursor position as well.\r\n                    this._moveEndLineSelectionShrink = true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    computeCursorState(model, helper) {\r\n        let result = helper.getTrackedSelection(this._selectionId);\r\n        if (this._moveEndPositionDown) {\r\n            result = result.setEndPosition(result.endLineNumber + 1, 1);\r\n        }\r\n        if (this._moveEndLineSelectionShrink && result.startLineNumber < result.endLineNumber) {\r\n            result = result.setEndPosition(result.endLineNumber, 2);\r\n        }\r\n        return result;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Range } from '../../common/core/range.js';\r\nexport class SortLinesCommand {\r\n    constructor(selection, descending) {\r\n        this.selection = selection;\r\n        this.descending = descending;\r\n        this.selectionId = null;\r\n    }\r\n    static getCollator() {\r\n        if (!SortLinesCommand._COLLATOR) {\r\n            SortLinesCommand._COLLATOR = new Intl.Collator();\r\n        }\r\n        return SortLinesCommand._COLLATOR;\r\n    }\r\n    getEditOperations(model, builder) {\r\n        let op = sortLines(model, this.selection, this.descending);\r\n        if (op) {\r\n            builder.addEditOperation(op.range, op.text);\r\n        }\r\n        this.selectionId = builder.trackSelection(this.selection);\r\n    }\r\n    computeCursorState(model, helper) {\r\n        return helper.getTrackedSelection(this.selectionId);\r\n    }\r\n    static canRun(model, selection, descending) {\r\n        if (model === null) {\r\n            return false;\r\n        }\r\n        let data = getSortData(model, selection, descending);\r\n        if (!data) {\r\n            return false;\r\n        }\r\n        for (let i = 0, len = data.before.length; i < len; i++) {\r\n            if (data.before[i] !== data.after[i]) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\nSortLinesCommand._COLLATOR = null;\r\nfunction getSortData(model, selection, descending) {\r\n    let startLineNumber = selection.startLineNumber;\r\n    let endLineNumber = selection.endLineNumber;\r\n    if (selection.endColumn === 1) {\r\n        endLineNumber--;\r\n    }\r\n    // Nothing to sort if user didn't select anything.\r\n    if (startLineNumber >= endLineNumber) {\r\n        return null;\r\n    }\r\n    let linesToSort = [];\r\n    // Get the contents of the selection to be sorted.\r\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\r\n        linesToSort.push(model.getLineContent(lineNumber));\r\n    }\r\n    let sorted = linesToSort.slice(0);\r\n    sorted.sort(SortLinesCommand.getCollator().compare);\r\n    // If descending, reverse the order.\r\n    if (descending === true) {\r\n        sorted = sorted.reverse();\r\n    }\r\n    return {\r\n        startLineNumber: startLineNumber,\r\n        endLineNumber: endLineNumber,\r\n        before: linesToSort,\r\n        after: sorted\r\n    };\r\n}\r\n/**\r\n * Generate commands for sorting lines on a model.\r\n */\r\nfunction sortLines(model, selection, descending) {\r\n    let data = getSortData(model, selection, descending);\r\n    if (!data) {\r\n        return null;\r\n    }\r\n    return EditOperation.replace(new Range(data.startLineNumber, 1, data.endLineNumber, model.getLineMaxColumn(data.endLineNumber)), data.after.join('\\n'));\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { CoreEditingCommands } from '../../browser/controller/coreCommands.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ReplaceCommand, ReplaceCommandThatPreservesSelection, ReplaceCommandThatSelectsText } from '../../common/commands/replaceCommand.js';\r\nimport { TrimTrailingWhitespaceCommand } from '../../common/commands/trimTrailingWhitespaceCommand.js';\r\nimport { TypeOperations } from '../../common/controller/cursorTypeOperations.js';\r\nimport { EditOperation } from '../../common/core/editOperation.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CopyLinesCommand } from './copyLinesCommand.js';\r\nimport { MoveLinesCommand } from './moveLinesCommand.js';\r\nimport { SortLinesCommand } from './sortLinesCommand.js';\r\nimport { MenuId } from '../../../platform/actions/common/actions.js';\r\n// copy lines\r\nclass AbstractCopyLinesAction extends EditorAction {\r\n    constructor(down, opts) {\r\n        super(opts);\r\n        this.down = down;\r\n    }\r\n    run(_accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const selections = editor.getSelections().map((selection, index) => ({ selection, index, ignore: false }));\r\n        selections.sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\r\n        // Remove selections that would result in copying the same line\r\n        let prev = selections[0];\r\n        for (let i = 1; i < selections.length; i++) {\r\n            const curr = selections[i];\r\n            if (prev.selection.endLineNumber === curr.selection.startLineNumber) {\r\n                // these two selections would copy the same line\r\n                if (prev.index < curr.index) {\r\n                    // prev wins\r\n                    curr.ignore = true;\r\n                }\r\n                else {\r\n                    // curr wins\r\n                    prev.ignore = true;\r\n                    prev = curr;\r\n                }\r\n            }\r\n        }\r\n        const commands = [];\r\n        for (const selection of selections) {\r\n            commands.push(new CopyLinesCommand(selection.selection, this.down, selection.ignore));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nclass CopyLinesUpAction extends AbstractCopyLinesAction {\r\n    constructor() {\r\n        super(false, {\r\n            id: 'editor.action.copyLinesUpAction',\r\n            label: nls.localize('lines.copyUp', \"Copy Line Up\"),\r\n            alias: 'Copy Line Up',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 16 /* UpArrow */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 1024 /* Shift */ | 16 /* UpArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miCopyLinesUp', comment: ['&& denotes a mnemonic'] }, \"&&Copy Line Up\"),\r\n                order: 1\r\n            }\r\n        });\r\n    }\r\n}\r\nclass CopyLinesDownAction extends AbstractCopyLinesAction {\r\n    constructor() {\r\n        super(true, {\r\n            id: 'editor.action.copyLinesDownAction',\r\n            label: nls.localize('lines.copyDown', \"Copy Line Down\"),\r\n            alias: 'Copy Line Down',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 1024 /* Shift */ | 18 /* DownArrow */,\r\n                linux: { primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 1024 /* Shift */ | 18 /* DownArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miCopyLinesDown', comment: ['&& denotes a mnemonic'] }, \"Co&&py Line Down\"),\r\n                order: 2\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class DuplicateSelectionAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.duplicateSelection',\r\n            label: nls.localize('duplicateSelection', \"Duplicate Selection\"),\r\n            alias: 'Duplicate Selection',\r\n            precondition: EditorContextKeys.writable,\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miDuplicateSelection', comment: ['&& denotes a mnemonic'] }, \"&&Duplicate Selection\"),\r\n                order: 5\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const commands = [];\r\n        const selections = editor.getSelections();\r\n        const model = editor.getModel();\r\n        for (const selection of selections) {\r\n            if (selection.isEmpty()) {\r\n                commands.push(new CopyLinesCommand(selection, true));\r\n            }\r\n            else {\r\n                const insertSelection = new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn);\r\n                commands.push(new ReplaceCommandThatSelectsText(insertSelection, model.getValueInRange(selection)));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\n// move lines\r\nclass AbstractMoveLinesAction extends EditorAction {\r\n    constructor(down, opts) {\r\n        super(opts);\r\n        this.down = down;\r\n    }\r\n    run(_accessor, editor) {\r\n        let commands = [];\r\n        let selections = editor.getSelections() || [];\r\n        const autoIndent = editor.getOption(9 /* autoIndent */);\r\n        for (const selection of selections) {\r\n            commands.push(new MoveLinesCommand(selection, this.down, autoIndent));\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nclass MoveLinesUpAction extends AbstractMoveLinesAction {\r\n    constructor() {\r\n        super(false, {\r\n            id: 'editor.action.moveLinesUpAction',\r\n            label: nls.localize('lines.moveUp', \"Move Line Up\"),\r\n            alias: 'Move Line Up',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 16 /* UpArrow */,\r\n                linux: { primary: 512 /* Alt */ | 16 /* UpArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miMoveLinesUp', comment: ['&& denotes a mnemonic'] }, \"Mo&&ve Line Up\"),\r\n                order: 3\r\n            }\r\n        });\r\n    }\r\n}\r\nclass MoveLinesDownAction extends AbstractMoveLinesAction {\r\n    constructor() {\r\n        super(true, {\r\n            id: 'editor.action.moveLinesDownAction',\r\n            label: nls.localize('lines.moveDown', \"Move Line Down\"),\r\n            alias: 'Move Line Down',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 512 /* Alt */ | 18 /* DownArrow */,\r\n                linux: { primary: 512 /* Alt */ | 18 /* DownArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '2_line',\r\n                title: nls.localize({ key: 'miMoveLinesDown', comment: ['&& denotes a mnemonic'] }, \"Move &&Line Down\"),\r\n                order: 4\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class AbstractSortLinesAction extends EditorAction {\r\n    constructor(descending, opts) {\r\n        super(opts);\r\n        this.descending = descending;\r\n    }\r\n    run(_accessor, editor) {\r\n        const selections = editor.getSelections() || [];\r\n        for (const selection of selections) {\r\n            if (!SortLinesCommand.canRun(editor.getModel(), selection, this.descending)) {\r\n                return;\r\n            }\r\n        }\r\n        let commands = [];\r\n        for (let i = 0, len = selections.length; i < len; i++) {\r\n            commands[i] = new SortLinesCommand(selections[i], this.descending);\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nexport class SortLinesAscendingAction extends AbstractSortLinesAction {\r\n    constructor() {\r\n        super(false, {\r\n            id: 'editor.action.sortLinesAscending',\r\n            label: nls.localize('lines.sortAscending', \"Sort Lines Ascending\"),\r\n            alias: 'Sort Lines Ascending',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n}\r\nexport class SortLinesDescendingAction extends AbstractSortLinesAction {\r\n    constructor() {\r\n        super(true, {\r\n            id: 'editor.action.sortLinesDescending',\r\n            label: nls.localize('lines.sortDescending', \"Sort Lines Descending\"),\r\n            alias: 'Sort Lines Descending',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n}\r\nexport class TrimTrailingWhitespaceAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: TrimTrailingWhitespaceAction.ID,\r\n            label: nls.localize('lines.trimTrailingWhitespace', \"Trim Trailing Whitespace\"),\r\n            alias: 'Trim Trailing Whitespace',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 54 /* KEY_X */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor, args) {\r\n        let cursors = [];\r\n        if (args.reason === 'auto-save') {\r\n            // See https://github.com/editorconfig/editorconfig-vscode/issues/47\r\n            // It is very convenient for the editor config extension to invoke this action.\r\n            // So, if we get a reason:'auto-save' passed in, let's preserve cursor positions.\r\n            cursors = (editor.getSelections() || []).map(s => new Position(s.positionLineNumber, s.positionColumn));\r\n        }\r\n        let selection = editor.getSelection();\r\n        if (selection === null) {\r\n            return;\r\n        }\r\n        let command = new TrimTrailingWhitespaceCommand(selection, cursors);\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, [command]);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nTrimTrailingWhitespaceAction.ID = 'editor.action.trimTrailingWhitespace';\r\nexport class DeleteLinesAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.deleteLines',\r\n            label: nls.localize('lines.delete', \"Delete Line\"),\r\n            alias: 'Delete Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 41 /* KEY_K */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        let ops = this._getLinesToRemove(editor);\r\n        let model = editor.getModel();\r\n        if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\r\n            // Model is empty\r\n            return;\r\n        }\r\n        let linesDeleted = 0;\r\n        let edits = [];\r\n        let cursorState = [];\r\n        for (let i = 0, len = ops.length; i < len; i++) {\r\n            const op = ops[i];\r\n            let startLineNumber = op.startLineNumber;\r\n            let endLineNumber = op.endLineNumber;\r\n            let startColumn = 1;\r\n            let endColumn = model.getLineMaxColumn(endLineNumber);\r\n            if (endLineNumber < model.getLineCount()) {\r\n                endLineNumber += 1;\r\n                endColumn = 1;\r\n            }\r\n            else if (startLineNumber > 1) {\r\n                startLineNumber -= 1;\r\n                startColumn = model.getLineMaxColumn(startLineNumber);\r\n            }\r\n            edits.push(EditOperation.replace(new Selection(startLineNumber, startColumn, endLineNumber, endColumn), ''));\r\n            cursorState.push(new Selection(startLineNumber - linesDeleted, op.positionColumn, startLineNumber - linesDeleted, op.positionColumn));\r\n            linesDeleted += (op.endLineNumber - op.startLineNumber + 1);\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, cursorState);\r\n        editor.pushUndoStop();\r\n    }\r\n    _getLinesToRemove(editor) {\r\n        // Construct delete operations\r\n        let operations = editor.getSelections().map((s) => {\r\n            let endLineNumber = s.endLineNumber;\r\n            if (s.startLineNumber < s.endLineNumber && s.endColumn === 1) {\r\n                endLineNumber -= 1;\r\n            }\r\n            return {\r\n                startLineNumber: s.startLineNumber,\r\n                selectionStartColumn: s.selectionStartColumn,\r\n                endLineNumber: endLineNumber,\r\n                positionColumn: s.positionColumn\r\n            };\r\n        });\r\n        // Sort delete operations\r\n        operations.sort((a, b) => {\r\n            if (a.startLineNumber === b.startLineNumber) {\r\n                return a.endLineNumber - b.endLineNumber;\r\n            }\r\n            return a.startLineNumber - b.startLineNumber;\r\n        });\r\n        // Merge delete operations which are adjacent or overlapping\r\n        let mergedOperations = [];\r\n        let previousOperation = operations[0];\r\n        for (let i = 1; i < operations.length; i++) {\r\n            if (previousOperation.endLineNumber + 1 >= operations[i].startLineNumber) {\r\n                // Merge current operations into the previous one\r\n                previousOperation.endLineNumber = operations[i].endLineNumber;\r\n            }\r\n            else {\r\n                // Push previous operation\r\n                mergedOperations.push(previousOperation);\r\n                previousOperation = operations[i];\r\n            }\r\n        }\r\n        // Push the last operation\r\n        mergedOperations.push(previousOperation);\r\n        return mergedOperations;\r\n    }\r\n}\r\nexport class IndentLinesAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.indentLines',\r\n            label: nls.localize('lines.indent', \"Indent Line\"),\r\n            alias: 'Indent Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 89 /* US_CLOSE_SQUARE_BRACKET */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        const viewModel = editor._getViewModel();\r\n        if (!viewModel) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.indent(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nclass OutdentLinesAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.outdentLines',\r\n            label: nls.localize('lines.outdent', \"Outdent Line\"),\r\n            alias: 'Outdent Line',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 87 /* US_OPEN_SQUARE_BRACKET */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        CoreEditingCommands.Outdent.runEditorCommand(_accessor, editor, null);\r\n    }\r\n}\r\nexport class InsertLineBeforeAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.insertLineBefore',\r\n            label: nls.localize('lines.insertBefore', \"Insert Line Above\"),\r\n            alias: 'Insert Line Above',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        const viewModel = editor._getViewModel();\r\n        if (!viewModel) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.lineInsertBefore(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\r\n    }\r\n}\r\nexport class InsertLineAfterAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.insertLineAfter',\r\n            label: nls.localize('lines.insertAfter', \"Insert Line Below\"),\r\n            alias: 'Insert Line Below',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        const viewModel = editor._getViewModel();\r\n        if (!viewModel) {\r\n            return;\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, TypeOperations.lineInsertAfter(viewModel.cursorConfig, editor.getModel(), editor.getSelections()));\r\n    }\r\n}\r\nexport class AbstractDeleteAllToBoundaryAction extends EditorAction {\r\n    run(_accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const primaryCursor = editor.getSelection();\r\n        let rangesToDelete = this._getRangesToDelete(editor);\r\n        // merge overlapping selections\r\n        let effectiveRanges = [];\r\n        for (let i = 0, count = rangesToDelete.length - 1; i < count; i++) {\r\n            let range = rangesToDelete[i];\r\n            let nextRange = rangesToDelete[i + 1];\r\n            if (Range.intersectRanges(range, nextRange) === null) {\r\n                effectiveRanges.push(range);\r\n            }\r\n            else {\r\n                rangesToDelete[i + 1] = Range.plusRange(range, nextRange);\r\n            }\r\n        }\r\n        effectiveRanges.push(rangesToDelete[rangesToDelete.length - 1]);\r\n        let endCursorState = this._getEndCursorState(primaryCursor, effectiveRanges);\r\n        let edits = effectiveRanges.map(range => {\r\n            return EditOperation.replace(range, '');\r\n        });\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, endCursorState);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nexport class DeleteAllLeftAction extends AbstractDeleteAllToBoundaryAction {\r\n    constructor() {\r\n        super({\r\n            id: 'deleteAllLeft',\r\n            label: nls.localize('lines.deleteAllLeft', \"Delete All Left\"),\r\n            alias: 'Delete All Left',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 2048 /* CtrlCmd */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    _getEndCursorState(primaryCursor, rangesToDelete) {\r\n        let endPrimaryCursor = null;\r\n        let endCursorState = [];\r\n        let deletedLines = 0;\r\n        rangesToDelete.forEach(range => {\r\n            let endCursor;\r\n            if (range.endColumn === 1 && deletedLines > 0) {\r\n                let newStartLine = range.startLineNumber - deletedLines;\r\n                endCursor = new Selection(newStartLine, range.startColumn, newStartLine, range.startColumn);\r\n            }\r\n            else {\r\n                endCursor = new Selection(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\r\n            }\r\n            deletedLines += range.endLineNumber - range.startLineNumber;\r\n            if (range.intersectRanges(primaryCursor)) {\r\n                endPrimaryCursor = endCursor;\r\n            }\r\n            else {\r\n                endCursorState.push(endCursor);\r\n            }\r\n        });\r\n        if (endPrimaryCursor) {\r\n            endCursorState.unshift(endPrimaryCursor);\r\n        }\r\n        return endCursorState;\r\n    }\r\n    _getRangesToDelete(editor) {\r\n        let selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return [];\r\n        }\r\n        let rangesToDelete = selections;\r\n        let model = editor.getModel();\r\n        if (model === null) {\r\n            return [];\r\n        }\r\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\r\n        rangesToDelete = rangesToDelete.map(selection => {\r\n            if (selection.isEmpty()) {\r\n                if (selection.startColumn === 1) {\r\n                    let deleteFromLine = Math.max(1, selection.startLineNumber - 1);\r\n                    let deleteFromColumn = selection.startLineNumber === 1 ? 1 : model.getLineContent(deleteFromLine).length + 1;\r\n                    return new Range(deleteFromLine, deleteFromColumn, selection.startLineNumber, 1);\r\n                }\r\n                else {\r\n                    return new Range(selection.startLineNumber, 1, selection.startLineNumber, selection.startColumn);\r\n                }\r\n            }\r\n            else {\r\n                return new Range(selection.startLineNumber, 1, selection.endLineNumber, selection.endColumn);\r\n            }\r\n        });\r\n        return rangesToDelete;\r\n    }\r\n}\r\nexport class DeleteAllRightAction extends AbstractDeleteAllToBoundaryAction {\r\n    constructor() {\r\n        super({\r\n            id: 'deleteAllRight',\r\n            label: nls.localize('lines.deleteAllRight', \"Delete All Right\"),\r\n            alias: 'Delete All Right',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 41 /* KEY_K */, secondary: [2048 /* CtrlCmd */ | 20 /* Delete */] },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    _getEndCursorState(primaryCursor, rangesToDelete) {\r\n        let endPrimaryCursor = null;\r\n        let endCursorState = [];\r\n        for (let i = 0, len = rangesToDelete.length, offset = 0; i < len; i++) {\r\n            let range = rangesToDelete[i];\r\n            let endCursor = new Selection(range.startLineNumber - offset, range.startColumn, range.startLineNumber - offset, range.startColumn);\r\n            if (range.intersectRanges(primaryCursor)) {\r\n                endPrimaryCursor = endCursor;\r\n            }\r\n            else {\r\n                endCursorState.push(endCursor);\r\n            }\r\n        }\r\n        if (endPrimaryCursor) {\r\n            endCursorState.unshift(endPrimaryCursor);\r\n        }\r\n        return endCursorState;\r\n    }\r\n    _getRangesToDelete(editor) {\r\n        let model = editor.getModel();\r\n        if (model === null) {\r\n            return [];\r\n        }\r\n        let selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return [];\r\n        }\r\n        let rangesToDelete = selections.map((sel) => {\r\n            if (sel.isEmpty()) {\r\n                const maxColumn = model.getLineMaxColumn(sel.startLineNumber);\r\n                if (sel.startColumn === maxColumn) {\r\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber + 1, 1);\r\n                }\r\n                else {\r\n                    return new Range(sel.startLineNumber, sel.startColumn, sel.startLineNumber, maxColumn);\r\n                }\r\n            }\r\n            return sel;\r\n        });\r\n        rangesToDelete.sort(Range.compareRangesUsingStarts);\r\n        return rangesToDelete;\r\n    }\r\n}\r\nexport class JoinLinesAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.joinLines',\r\n            label: nls.localize('lines.joinLines', \"Join Lines\"),\r\n            alias: 'Join Lines',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 40 /* KEY_J */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        let selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        let primaryCursor = editor.getSelection();\r\n        if (primaryCursor === null) {\r\n            return;\r\n        }\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        let reducedSelections = [];\r\n        let lastSelection = selections.reduce((previousValue, currentValue) => {\r\n            if (previousValue.isEmpty()) {\r\n                if (previousValue.endLineNumber === currentValue.startLineNumber) {\r\n                    if (primaryCursor.equalsSelection(previousValue)) {\r\n                        primaryCursor = currentValue;\r\n                    }\r\n                    return currentValue;\r\n                }\r\n                if (currentValue.startLineNumber > previousValue.endLineNumber + 1) {\r\n                    reducedSelections.push(previousValue);\r\n                    return currentValue;\r\n                }\r\n                else {\r\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\r\n                }\r\n            }\r\n            else {\r\n                if (currentValue.startLineNumber > previousValue.endLineNumber) {\r\n                    reducedSelections.push(previousValue);\r\n                    return currentValue;\r\n                }\r\n                else {\r\n                    return new Selection(previousValue.startLineNumber, previousValue.startColumn, currentValue.endLineNumber, currentValue.endColumn);\r\n                }\r\n            }\r\n        });\r\n        reducedSelections.push(lastSelection);\r\n        let model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        let edits = [];\r\n        let endCursorState = [];\r\n        let endPrimaryCursor = primaryCursor;\r\n        let lineOffset = 0;\r\n        for (let i = 0, len = reducedSelections.length; i < len; i++) {\r\n            let selection = reducedSelections[i];\r\n            let startLineNumber = selection.startLineNumber;\r\n            let startColumn = 1;\r\n            let columnDeltaOffset = 0;\r\n            let endLineNumber, endColumn;\r\n            let selectionEndPositionOffset = model.getLineContent(selection.endLineNumber).length - selection.endColumn;\r\n            if (selection.isEmpty() || selection.startLineNumber === selection.endLineNumber) {\r\n                let position = selection.getStartPosition();\r\n                if (position.lineNumber < model.getLineCount()) {\r\n                    endLineNumber = startLineNumber + 1;\r\n                    endColumn = model.getLineMaxColumn(endLineNumber);\r\n                }\r\n                else {\r\n                    endLineNumber = position.lineNumber;\r\n                    endColumn = model.getLineMaxColumn(position.lineNumber);\r\n                }\r\n            }\r\n            else {\r\n                endLineNumber = selection.endLineNumber;\r\n                endColumn = model.getLineMaxColumn(endLineNumber);\r\n            }\r\n            let trimmedLinesContent = model.getLineContent(startLineNumber);\r\n            for (let i = startLineNumber + 1; i <= endLineNumber; i++) {\r\n                let lineText = model.getLineContent(i);\r\n                let firstNonWhitespaceIdx = model.getLineFirstNonWhitespaceColumn(i);\r\n                if (firstNonWhitespaceIdx >= 1) {\r\n                    let insertSpace = true;\r\n                    if (trimmedLinesContent === '') {\r\n                        insertSpace = false;\r\n                    }\r\n                    if (insertSpace && (trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === ' ' ||\r\n                        trimmedLinesContent.charAt(trimmedLinesContent.length - 1) === '\\t')) {\r\n                        insertSpace = false;\r\n                        trimmedLinesContent = trimmedLinesContent.replace(/[\\s\\uFEFF\\xA0]+$/g, ' ');\r\n                    }\r\n                    let lineTextWithoutIndent = lineText.substr(firstNonWhitespaceIdx - 1);\r\n                    trimmedLinesContent += (insertSpace ? ' ' : '') + lineTextWithoutIndent;\r\n                    if (insertSpace) {\r\n                        columnDeltaOffset = lineTextWithoutIndent.length + 1;\r\n                    }\r\n                    else {\r\n                        columnDeltaOffset = lineTextWithoutIndent.length;\r\n                    }\r\n                }\r\n                else {\r\n                    columnDeltaOffset = 0;\r\n                }\r\n            }\r\n            let deleteSelection = new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n            if (!deleteSelection.isEmpty()) {\r\n                let resultSelection;\r\n                if (selection.isEmpty()) {\r\n                    edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                    resultSelection = new Selection(deleteSelection.startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1, startLineNumber - lineOffset, trimmedLinesContent.length - columnDeltaOffset + 1);\r\n                }\r\n                else {\r\n                    if (selection.startLineNumber === selection.endLineNumber) {\r\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.endLineNumber - lineOffset, selection.endColumn);\r\n                    }\r\n                    else {\r\n                        edits.push(EditOperation.replace(deleteSelection, trimmedLinesContent));\r\n                        resultSelection = new Selection(selection.startLineNumber - lineOffset, selection.startColumn, selection.startLineNumber - lineOffset, trimmedLinesContent.length - selectionEndPositionOffset);\r\n                    }\r\n                }\r\n                if (Range.intersectRanges(deleteSelection, primaryCursor) !== null) {\r\n                    endPrimaryCursor = resultSelection;\r\n                }\r\n                else {\r\n                    endCursorState.push(resultSelection);\r\n                }\r\n            }\r\n            lineOffset += deleteSelection.endLineNumber - deleteSelection.startLineNumber;\r\n        }\r\n        endCursorState.unshift(endPrimaryCursor);\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, edits, endCursorState);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nexport class TransposeAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.transpose',\r\n            label: nls.localize('editor.transpose', \"Transpose characters around the cursor\"),\r\n            alias: 'Transpose characters around the cursor',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    run(_accessor, editor) {\r\n        let selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        let model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        let commands = [];\r\n        for (let i = 0, len = selections.length; i < len; i++) {\r\n            let selection = selections[i];\r\n            if (!selection.isEmpty()) {\r\n                continue;\r\n            }\r\n            let cursor = selection.getStartPosition();\r\n            let maxColumn = model.getLineMaxColumn(cursor.lineNumber);\r\n            if (cursor.column >= maxColumn) {\r\n                if (cursor.lineNumber === model.getLineCount()) {\r\n                    continue;\r\n                }\r\n                // The cursor is at the end of current line and current line is not empty\r\n                // then we transpose the character before the cursor and the line break if there is any following line.\r\n                let deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1);\r\n                let chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\r\n                commands.push(new ReplaceCommand(new Selection(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber + 1, 1), chars));\r\n            }\r\n            else {\r\n                let deleteSelection = new Range(cursor.lineNumber, Math.max(1, cursor.column - 1), cursor.lineNumber, cursor.column + 1);\r\n                let chars = model.getValueInRange(deleteSelection).split('').reverse().join('');\r\n                commands.push(new ReplaceCommandThatPreservesSelection(deleteSelection, chars, new Selection(cursor.lineNumber, cursor.column + 1, cursor.lineNumber, cursor.column + 1)));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nexport class AbstractCaseAction extends EditorAction {\r\n    run(_accessor, editor) {\r\n        const selections = editor.getSelections();\r\n        if (selections === null) {\r\n            return;\r\n        }\r\n        const model = editor.getModel();\r\n        if (model === null) {\r\n            return;\r\n        }\r\n        const wordSeparators = editor.getOption(115 /* wordSeparators */);\r\n        const textEdits = [];\r\n        for (const selection of selections) {\r\n            if (selection.isEmpty()) {\r\n                const cursor = selection.getStartPosition();\r\n                const word = editor.getConfiguredWordAtPosition(cursor);\r\n                if (!word) {\r\n                    continue;\r\n                }\r\n                const wordRange = new Range(cursor.lineNumber, word.startColumn, cursor.lineNumber, word.endColumn);\r\n                const text = model.getValueInRange(wordRange);\r\n                textEdits.push(EditOperation.replace(wordRange, this._modifyText(text, wordSeparators)));\r\n            }\r\n            else {\r\n                const text = model.getValueInRange(selection);\r\n                textEdits.push(EditOperation.replace(selection, this._modifyText(text, wordSeparators)));\r\n            }\r\n        }\r\n        editor.pushUndoStop();\r\n        editor.executeEdits(this.id, textEdits);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nexport class UpperCaseAction extends AbstractCaseAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.transformToUppercase',\r\n            label: nls.localize('editor.transformToUppercase', \"Transform to Uppercase\"),\r\n            alias: 'Transform to Uppercase',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    _modifyText(text, wordSeparators) {\r\n        return text.toLocaleUpperCase();\r\n    }\r\n}\r\nexport class LowerCaseAction extends AbstractCaseAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.transformToLowercase',\r\n            label: nls.localize('editor.transformToLowercase', \"Transform to Lowercase\"),\r\n            alias: 'Transform to Lowercase',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    _modifyText(text, wordSeparators) {\r\n        return text.toLocaleLowerCase();\r\n    }\r\n}\r\nexport class TitleCaseAction extends AbstractCaseAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.transformToTitlecase',\r\n            label: nls.localize('editor.transformToTitlecase', \"Transform to Title Case\"),\r\n            alias: 'Transform to Title Case',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    _modifyText(text, wordSeparators) {\r\n        const separators = '\\r\\n\\t ' + wordSeparators;\r\n        const excludedChars = separators.split('');\r\n        let title = '';\r\n        let startUpperCase = true;\r\n        for (let i = 0; i < text.length; i++) {\r\n            let currentChar = text[i];\r\n            if (excludedChars.indexOf(currentChar) >= 0) {\r\n                startUpperCase = true;\r\n                title += currentChar;\r\n            }\r\n            else if (startUpperCase) {\r\n                startUpperCase = false;\r\n                title += currentChar.toLocaleUpperCase();\r\n            }\r\n            else {\r\n                title += currentChar.toLocaleLowerCase();\r\n            }\r\n        }\r\n        return title;\r\n    }\r\n}\r\nclass BackwardsCompatibleRegExp {\r\n    constructor(_pattern, _flags) {\r\n        this._pattern = _pattern;\r\n        this._flags = _flags;\r\n        this._actual = null;\r\n        this._evaluated = false;\r\n    }\r\n    get() {\r\n        if (!this._evaluated) {\r\n            this._evaluated = true;\r\n            try {\r\n                this._actual = new RegExp(this._pattern, this._flags);\r\n            }\r\n            catch (err) {\r\n                // this browser does not support this regular expression\r\n            }\r\n        }\r\n        return this._actual;\r\n    }\r\n    isSupported() {\r\n        return (this.get() !== null);\r\n    }\r\n}\r\nexport class SnakeCaseAction extends AbstractCaseAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.transformToSnakecase',\r\n            label: nls.localize('editor.transformToSnakecase', \"Transform to Snake Case\"),\r\n            alias: 'Transform to Snake Case',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n    _modifyText(text, wordSeparators) {\r\n        const regExp1 = SnakeCaseAction.regExp1.get();\r\n        const regExp2 = SnakeCaseAction.regExp2.get();\r\n        if (!regExp1 || !regExp2) {\r\n            // cannot support this\r\n            return text;\r\n        }\r\n        return (text\r\n            .replace(regExp1, '$1_$2')\r\n            .replace(regExp2, '$1_$2$3')\r\n            .toLocaleLowerCase());\r\n    }\r\n}\r\nSnakeCaseAction.regExp1 = new BackwardsCompatibleRegExp('(\\\\p{Ll})(\\\\p{Lu})', 'gmu');\r\nSnakeCaseAction.regExp2 = new BackwardsCompatibleRegExp('(\\\\p{Lu}|\\\\p{N})(\\\\p{Lu})(\\\\p{Ll})', 'gmu');\r\nregisterEditorAction(CopyLinesUpAction);\r\nregisterEditorAction(CopyLinesDownAction);\r\nregisterEditorAction(DuplicateSelectionAction);\r\nregisterEditorAction(MoveLinesUpAction);\r\nregisterEditorAction(MoveLinesDownAction);\r\nregisterEditorAction(SortLinesAscendingAction);\r\nregisterEditorAction(SortLinesDescendingAction);\r\nregisterEditorAction(TrimTrailingWhitespaceAction);\r\nregisterEditorAction(DeleteLinesAction);\r\nregisterEditorAction(IndentLinesAction);\r\nregisterEditorAction(OutdentLinesAction);\r\nregisterEditorAction(InsertLineBeforeAction);\r\nregisterEditorAction(InsertLineAfterAction);\r\nregisterEditorAction(DeleteAllLeftAction);\r\nregisterEditorAction(DeleteAllRightAction);\r\nregisterEditorAction(JoinLinesAction);\r\nregisterEditorAction(TransposeAction);\r\nregisterEditorAction(UpperCaseAction);\r\nregisterEditorAction(LowerCaseAction);\r\nregisterEditorAction(TitleCaseAction);\r\nif (SnakeCaseAction.regExp1.isSupported() && SnakeCaseAction.regExp2.isSupported()) {\r\n    registerEditorAction(SnakeCaseAction);\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { LinkProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { isDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { coalesce } from '../../../base/common/arrays.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nexport class Link {\r\n    constructor(link, provider) {\r\n        this._link = link;\r\n        this._provider = provider;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            range: this.range,\r\n            url: this.url,\r\n            tooltip: this.tooltip\r\n        };\r\n    }\r\n    get range() {\r\n        return this._link.range;\r\n    }\r\n    get url() {\r\n        return this._link.url;\r\n    }\r\n    get tooltip() {\r\n        return this._link.tooltip;\r\n    }\r\n    resolve(token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this._link.url) {\r\n                return this._link.url;\r\n            }\r\n            if (typeof this._provider.resolveLink === 'function') {\r\n                return Promise.resolve(this._provider.resolveLink(this._link, token)).then(value => {\r\n                    this._link = value || this._link;\r\n                    if (this._link.url) {\r\n                        // recurse\r\n                        return this.resolve(token);\r\n                    }\r\n                    return Promise.reject(new Error('missing'));\r\n                });\r\n            }\r\n            return Promise.reject(new Error('missing'));\r\n        });\r\n    }\r\n}\r\nexport class LinksList {\r\n    constructor(tuples) {\r\n        this._disposables = new DisposableStore();\r\n        let links = [];\r\n        for (const [list, provider] of tuples) {\r\n            // merge all links\r\n            const newLinks = list.links.map(link => new Link(link, provider));\r\n            links = LinksList._union(links, newLinks);\r\n            // register disposables\r\n            if (isDisposable(list)) {\r\n                this._disposables.add(list);\r\n            }\r\n        }\r\n        this.links = links;\r\n    }\r\n    dispose() {\r\n        this._disposables.dispose();\r\n        this.links.length = 0;\r\n    }\r\n    static _union(oldLinks, newLinks) {\r\n        // reunite oldLinks with newLinks and remove duplicates\r\n        let result = [];\r\n        let oldIndex;\r\n        let oldLen;\r\n        let newIndex;\r\n        let newLen;\r\n        for (oldIndex = 0, newIndex = 0, oldLen = oldLinks.length, newLen = newLinks.length; oldIndex < oldLen && newIndex < newLen;) {\r\n            const oldLink = oldLinks[oldIndex];\r\n            const newLink = newLinks[newIndex];\r\n            if (Range.areIntersectingOrTouching(oldLink.range, newLink.range)) {\r\n                // Remove the oldLink\r\n                oldIndex++;\r\n                continue;\r\n            }\r\n            const comparisonResult = Range.compareRangesUsingStarts(oldLink.range, newLink.range);\r\n            if (comparisonResult < 0) {\r\n                // oldLink is before\r\n                result.push(oldLink);\r\n                oldIndex++;\r\n            }\r\n            else {\r\n                // newLink is before\r\n                result.push(newLink);\r\n                newIndex++;\r\n            }\r\n        }\r\n        for (; oldIndex < oldLen; oldIndex++) {\r\n            result.push(oldLinks[oldIndex]);\r\n        }\r\n        for (; newIndex < newLen; newIndex++) {\r\n            result.push(newLinks[newIndex]);\r\n        }\r\n        return result;\r\n    }\r\n}\r\nexport function getLinks(model, token) {\r\n    const lists = [];\r\n    // ask all providers for links in parallel\r\n    const promises = LinkProviderRegistry.ordered(model).reverse().map((provider, i) => {\r\n        return Promise.resolve(provider.provideLinks(model, token)).then(result => {\r\n            if (result) {\r\n                lists[i] = [result, provider];\r\n            }\r\n        }, onUnexpectedExternalError);\r\n    });\r\n    return Promise.all(promises).then(() => {\r\n        const result = new LinksList(coalesce(lists));\r\n        if (!token.isCancellationRequested) {\r\n            return result;\r\n        }\r\n        result.dispose();\r\n        return new LinksList([]);\r\n    });\r\n}\r\nCommandsRegistry.registerCommand('_executeLinkProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\r\n    let [uri, resolveCount] = args;\r\n    assertType(uri instanceof URI);\r\n    if (typeof resolveCount !== 'number') {\r\n        resolveCount = 0;\r\n    }\r\n    const model = accessor.get(IModelService).getModel(uri);\r\n    if (!model) {\r\n        return [];\r\n    }\r\n    const list = yield getLinks(model, CancellationToken.None);\r\n    if (!list) {\r\n        return [];\r\n    }\r\n    // resolve links\r\n    for (let i = 0; i < Math.min(resolveCount, list.links.length); i++) {\r\n        yield list.links[i].resolve(CancellationToken.None);\r\n    }\r\n    const result = list.links.slice(0);\r\n    list.dispose();\r\n    return result;\r\n}));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport './links.css';\r\nimport * as nls from '../../../nls.js';\r\nimport * as async from '../../../base/common/async.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { MarkdownString } from '../../../base/common/htmlContent.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport * as platform from '../../../base/common/platform.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { LinkProviderRegistry } from '../../common/modes.js';\r\nimport { ClickLinkGesture } from '../gotoSymbol/link/clickLinkGesture.js';\r\nimport { getLinks } from './getLinks.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorActiveLinkForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant } from '../../../platform/theme/common/themeService.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { Schemas } from '../../../base/common/network.js';\r\nimport * as resources from '../../../base/common/resources.js';\r\nfunction getHoverMessage(link, useMetaKey) {\r\n    const executeCmd = link.url && /^command:/i.test(link.url.toString());\r\n    const label = link.tooltip\r\n        ? link.tooltip\r\n        : executeCmd\r\n            ? nls.localize('links.navigate.executeCmd', 'Execute command')\r\n            : nls.localize('links.navigate.follow', 'Follow link');\r\n    const kb = useMetaKey\r\n        ? platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.meta.mac', \"cmd + click\")\r\n            : nls.localize('links.navigate.kb.meta', \"ctrl + click\")\r\n        : platform.isMacintosh\r\n            ? nls.localize('links.navigate.kb.alt.mac', \"option + click\")\r\n            : nls.localize('links.navigate.kb.alt', \"alt + click\");\r\n    if (link.url) {\r\n        let nativeLabel = '';\r\n        if (/^command:/i.test(link.url.toString())) {\r\n            // Don't show complete command arguments in the native tooltip\r\n            const match = link.url.toString().match(/^command:([^?#]+)/);\r\n            if (match) {\r\n                const commandId = match[1];\r\n                const nativeLabelText = nls.localize('tooltip.explanation', \"Execute command {0}\", commandId);\r\n                nativeLabel = ` \"${nativeLabelText}\"`;\r\n            }\r\n        }\r\n        const hoverMessage = new MarkdownString('', true).appendMarkdown(`[${label}](${link.url.toString(true)}${nativeLabel}) (${kb})`);\r\n        return hoverMessage;\r\n    }\r\n    else {\r\n        return new MarkdownString().appendText(`${label} (${kb})`);\r\n    }\r\n}\r\nconst decoration = {\r\n    general: ModelDecorationOptions.register({\r\n        description: 'detected-link',\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link'\r\n    }),\r\n    active: ModelDecorationOptions.register({\r\n        description: 'detected-link-active',\r\n        stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n        collapseOnReplaceEdit: true,\r\n        inlineClassName: 'detected-link-active'\r\n    })\r\n};\r\nclass LinkOccurrence {\r\n    constructor(link, decorationId) {\r\n        this.link = link;\r\n        this.decorationId = decorationId;\r\n    }\r\n    static decoration(link, useMetaKey) {\r\n        return {\r\n            range: link.range,\r\n            options: LinkOccurrence._getOptions(link, useMetaKey, false)\r\n        };\r\n    }\r\n    static _getOptions(link, useMetaKey, isActive) {\r\n        const options = Object.assign({}, (isActive ? decoration.active : decoration.general));\r\n        options.hoverMessage = getHoverMessage(link, useMetaKey);\r\n        return options;\r\n    }\r\n    activate(changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, true));\r\n    }\r\n    deactivate(changeAccessor, useMetaKey) {\r\n        changeAccessor.changeDecorationOptions(this.decorationId, LinkOccurrence._getOptions(this.link, useMetaKey, false));\r\n    }\r\n}\r\nlet LinkDetector = class LinkDetector {\r\n    constructor(editor, openerService, notificationService) {\r\n        this.listenersToRemove = new DisposableStore();\r\n        this.editor = editor;\r\n        this.openerService = openerService;\r\n        this.notificationService = notificationService;\r\n        let clickLinkGesture = new ClickLinkGesture(editor);\r\n        this.listenersToRemove.add(clickLinkGesture);\r\n        this.listenersToRemove.add(clickLinkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\r\n            this._onEditorMouseMove(mouseEvent, keyboardEvent);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onExecute((e) => {\r\n            this.onEditorMouseUp(e);\r\n        }));\r\n        this.listenersToRemove.add(clickLinkGesture.onCancel((e) => {\r\n            this.cleanUpActiveLinkDecoration();\r\n        }));\r\n        this.enabled = editor.getOption(61 /* links */);\r\n        this.listenersToRemove.add(editor.onDidChangeConfiguration((e) => {\r\n            const enabled = editor.getOption(61 /* links */);\r\n            if (this.enabled === enabled) {\r\n                // No change in our configuration option\r\n                return;\r\n            }\r\n            this.enabled = enabled;\r\n            // Remove any links (for the getting disabled case)\r\n            this.updateDecorations([]);\r\n            // Stop any computation (for the getting disabled case)\r\n            this.stop();\r\n            // Start computing (for the getting enabled case)\r\n            this.beginCompute();\r\n        }));\r\n        this.listenersToRemove.add(editor.onDidChangeModelContent((e) => this.onChange()));\r\n        this.listenersToRemove.add(editor.onDidChangeModel((e) => this.onModelChanged()));\r\n        this.listenersToRemove.add(editor.onDidChangeModelLanguage((e) => this.onModelModeChanged()));\r\n        this.listenersToRemove.add(LinkProviderRegistry.onDidChange((e) => this.onModelModeChanged()));\r\n        this.timeout = new async.TimeoutTimer();\r\n        this.computePromise = null;\r\n        this.activeLinksList = null;\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.beginCompute();\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(LinkDetector.ID);\r\n    }\r\n    onModelChanged() {\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        this.stop();\r\n        this.beginCompute();\r\n    }\r\n    onModelModeChanged() {\r\n        this.stop();\r\n        this.beginCompute();\r\n    }\r\n    onChange() {\r\n        this.timeout.setIfNotSet(() => this.beginCompute(), LinkDetector.RECOMPUTE_TIME);\r\n    }\r\n    beginCompute() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this.editor.hasModel() || !this.enabled) {\r\n                return;\r\n            }\r\n            const model = this.editor.getModel();\r\n            if (!LinkProviderRegistry.has(model)) {\r\n                return;\r\n            }\r\n            if (this.activeLinksList) {\r\n                this.activeLinksList.dispose();\r\n                this.activeLinksList = null;\r\n            }\r\n            this.computePromise = async.createCancelablePromise(token => getLinks(model, token));\r\n            try {\r\n                this.activeLinksList = yield this.computePromise;\r\n                this.updateDecorations(this.activeLinksList.links);\r\n            }\r\n            catch (err) {\r\n                onUnexpectedError(err);\r\n            }\r\n            finally {\r\n                this.computePromise = null;\r\n            }\r\n        });\r\n    }\r\n    updateDecorations(links) {\r\n        const useMetaKey = (this.editor.getOption(68 /* multiCursorModifier */) === 'altKey');\r\n        let oldDecorations = [];\r\n        let keys = Object.keys(this.currentOccurrences);\r\n        for (let i = 0, len = keys.length; i < len; i++) {\r\n            let decorationId = keys[i];\r\n            let occurance = this.currentOccurrences[decorationId];\r\n            oldDecorations.push(occurance.decorationId);\r\n        }\r\n        let newDecorations = [];\r\n        if (links) {\r\n            // Not sure why this is sometimes null\r\n            for (const link of links) {\r\n                newDecorations.push(LinkOccurrence.decoration(link, useMetaKey));\r\n            }\r\n        }\r\n        let decorations = this.editor.deltaDecorations(oldDecorations, newDecorations);\r\n        this.currentOccurrences = {};\r\n        this.activeLinkDecorationId = null;\r\n        for (let i = 0, len = decorations.length; i < len; i++) {\r\n            let occurance = new LinkOccurrence(links[i], decorations[i]);\r\n            this.currentOccurrences[occurance.decorationId] = occurance;\r\n        }\r\n    }\r\n    _onEditorMouseMove(mouseEvent, withKey) {\r\n        const useMetaKey = (this.editor.getOption(68 /* multiCursorModifier */) === 'altKey');\r\n        if (this.isEnabled(mouseEvent, withKey)) {\r\n            this.cleanUpActiveLinkDecoration(); // always remove previous link decoration as their can only be one\r\n            const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\r\n            if (occurrence) {\r\n                this.editor.changeDecorations((changeAccessor) => {\r\n                    occurrence.activate(changeAccessor, useMetaKey);\r\n                    this.activeLinkDecorationId = occurrence.decorationId;\r\n                });\r\n            }\r\n        }\r\n        else {\r\n            this.cleanUpActiveLinkDecoration();\r\n        }\r\n    }\r\n    cleanUpActiveLinkDecoration() {\r\n        const useMetaKey = (this.editor.getOption(68 /* multiCursorModifier */) === 'altKey');\r\n        if (this.activeLinkDecorationId) {\r\n            const occurrence = this.currentOccurrences[this.activeLinkDecorationId];\r\n            if (occurrence) {\r\n                this.editor.changeDecorations((changeAccessor) => {\r\n                    occurrence.deactivate(changeAccessor, useMetaKey);\r\n                });\r\n            }\r\n            this.activeLinkDecorationId = null;\r\n        }\r\n    }\r\n    onEditorMouseUp(mouseEvent) {\r\n        if (!this.isEnabled(mouseEvent)) {\r\n            return;\r\n        }\r\n        const occurrence = this.getLinkOccurrence(mouseEvent.target.position);\r\n        if (!occurrence) {\r\n            return;\r\n        }\r\n        this.openLinkOccurrence(occurrence, mouseEvent.hasSideBySideModifier, true /* from user gesture */);\r\n    }\r\n    openLinkOccurrence(occurrence, openToSide, fromUserGesture = false) {\r\n        if (!this.openerService) {\r\n            return;\r\n        }\r\n        const { link } = occurrence;\r\n        link.resolve(CancellationToken.None).then(uri => {\r\n            // Support for relative file URIs of the shape file://./relativeFile.txt or file:///./relativeFile.txt\r\n            if (typeof uri === 'string' && this.editor.hasModel()) {\r\n                const modelUri = this.editor.getModel().uri;\r\n                if (modelUri.scheme === Schemas.file && uri.startsWith(`${Schemas.file}:`)) {\r\n                    const parsedUri = URI.parse(uri);\r\n                    if (parsedUri.scheme === Schemas.file) {\r\n                        const fsPath = resources.originalFSPath(parsedUri);\r\n                        let relativePath = null;\r\n                        if (fsPath.startsWith('/./')) {\r\n                            relativePath = `.${fsPath.substr(1)}`;\r\n                        }\r\n                        else if (fsPath.startsWith('//./')) {\r\n                            relativePath = `.${fsPath.substr(2)}`;\r\n                        }\r\n                        if (relativePath) {\r\n                            uri = resources.joinPath(modelUri, relativePath);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return this.openerService.open(uri, { openToSide, fromUserGesture, allowContributedOpeners: true, allowCommands: true });\r\n        }, err => {\r\n            const messageOrError = err instanceof Error ? err.message : err;\r\n            // different error cases\r\n            if (messageOrError === 'invalid') {\r\n                this.notificationService.warn(nls.localize('invalid.url', 'Failed to open this link because it is not well-formed: {0}', link.url.toString()));\r\n            }\r\n            else if (messageOrError === 'missing') {\r\n                this.notificationService.warn(nls.localize('missing.url', 'Failed to open this link because its target is missing.'));\r\n            }\r\n            else {\r\n                onUnexpectedError(err);\r\n            }\r\n        });\r\n    }\r\n    getLinkOccurrence(position) {\r\n        if (!this.editor.hasModel() || !position) {\r\n            return null;\r\n        }\r\n        const decorations = this.editor.getModel().getDecorationsInRange({\r\n            startLineNumber: position.lineNumber,\r\n            startColumn: position.column,\r\n            endLineNumber: position.lineNumber,\r\n            endColumn: position.column\r\n        }, 0, true);\r\n        for (const decoration of decorations) {\r\n            const currentOccurrence = this.currentOccurrences[decoration.id];\r\n            if (currentOccurrence) {\r\n                return currentOccurrence;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    isEnabled(mouseEvent, withKey) {\r\n        return Boolean((mouseEvent.target.type === 6 /* CONTENT_TEXT */)\r\n            && (mouseEvent.hasTriggerModifier || (withKey && withKey.keyCodeIsTriggerKey)));\r\n    }\r\n    stop() {\r\n        var _a;\r\n        this.timeout.cancel();\r\n        if (this.activeLinksList) {\r\n            (_a = this.activeLinksList) === null || _a === void 0 ? void 0 : _a.dispose();\r\n            this.activeLinksList = null;\r\n        }\r\n        if (this.computePromise) {\r\n            this.computePromise.cancel();\r\n            this.computePromise = null;\r\n        }\r\n    }\r\n    dispose() {\r\n        this.listenersToRemove.dispose();\r\n        this.stop();\r\n        this.timeout.dispose();\r\n    }\r\n};\r\nLinkDetector.ID = 'editor.linkDetector';\r\nLinkDetector.RECOMPUTE_TIME = 1000; // ms\r\nLinkDetector = __decorate([\r\n    __param(1, IOpenerService),\r\n    __param(2, INotificationService)\r\n], LinkDetector);\r\nexport { LinkDetector };\r\nclass OpenLinkAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.openLink',\r\n            label: nls.localize('label', \"Open Link\"),\r\n            alias: 'Open Link',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        let linkDetector = LinkDetector.get(editor);\r\n        if (!linkDetector) {\r\n            return;\r\n        }\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        let selections = editor.getSelections();\r\n        for (let sel of selections) {\r\n            let link = linkDetector.getLinkOccurrence(sel.getEndPosition());\r\n            if (link) {\r\n                linkDetector.openLinkOccurrence(link, false);\r\n            }\r\n        }\r\n    }\r\n}\r\nregisterEditorContribution(LinkDetector.ID, LinkDetector);\r\nregisterEditorAction(OpenLinkAction);\r\nregisterThemingParticipant((theme, collector) => {\r\n    const activeLinkForeground = theme.getColor(editorActiveLinkForeground);\r\n    if (activeLinkForeground) {\r\n        collector.addRule(`.monaco-editor .detected-link-active { color: ${activeLinkForeground} !important; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { RunOnceScheduler } from '../../../base/common/async.js';\r\nimport { KeyChord } from '../../../base/common/keyCodes.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { status } from '../../../base/browser/ui/aria/aria.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { CursorMoveCommands } from '../../common/controller/cursorMoveCommands.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { DocumentHighlightProviderRegistry } from '../../common/modes.js';\r\nimport { CommonFindController } from '../find/findController.js';\r\nimport { MenuId } from '../../../platform/actions/common/actions.js';\r\nimport { overviewRulerSelectionHighlightForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nfunction announceCursorChange(previousCursorState, cursorState) {\r\n    const cursorDiff = cursorState.filter(cs => !previousCursorState.find(pcs => pcs.equals(cs)));\r\n    if (cursorDiff.length >= 1) {\r\n        const cursorPositions = cursorDiff.map(cs => `line ${cs.viewState.position.lineNumber} column ${cs.viewState.position.column}`).join(', ');\r\n        const msg = cursorDiff.length === 1 ? nls.localize('cursorAdded', \"Cursor added: {0}\", cursorPositions) : nls.localize('cursorsAdded', \"Cursors added: {0}\", cursorPositions);\r\n        status(msg);\r\n    }\r\n}\r\nexport class InsertCursorAbove extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.insertCursorAbove',\r\n            label: nls.localize('mutlicursor.insertAbove', \"Add Cursor Above\"),\r\n            alias: 'Add Cursor Above',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 16 /* UpArrow */,\r\n                linux: {\r\n                    primary: 1024 /* Shift */ | 512 /* Alt */ | 16 /* UpArrow */,\r\n                    secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 16 /* UpArrow */]\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorAbove', comment: ['&& denotes a mnemonic'] }, \"&&Add Cursor Above\"),\r\n                order: 2\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const useLogicalLine = (args && args.logicalLine === true);\r\n        const viewModel = editor._getViewModel();\r\n        if (viewModel.cursorConfig.readOnly) {\r\n            return;\r\n        }\r\n        viewModel.pushStackElement();\r\n        const previousCursorState = viewModel.getCursorStates();\r\n        viewModel.setCursorStates(args.source, 3 /* Explicit */, CursorMoveCommands.addCursorUp(viewModel, previousCursorState, useLogicalLine));\r\n        viewModel.revealTopMostCursor(args.source);\r\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\r\n    }\r\n}\r\nexport class InsertCursorBelow extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.insertCursorBelow',\r\n            label: nls.localize('mutlicursor.insertBelow', \"Add Cursor Below\"),\r\n            alias: 'Add Cursor Below',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 512 /* Alt */ | 18 /* DownArrow */,\r\n                linux: {\r\n                    primary: 1024 /* Shift */ | 512 /* Alt */ | 18 /* DownArrow */,\r\n                    secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 18 /* DownArrow */]\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorBelow', comment: ['&& denotes a mnemonic'] }, \"A&&dd Cursor Below\"),\r\n                order: 3\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const useLogicalLine = (args && args.logicalLine === true);\r\n        const viewModel = editor._getViewModel();\r\n        if (viewModel.cursorConfig.readOnly) {\r\n            return;\r\n        }\r\n        viewModel.pushStackElement();\r\n        const previousCursorState = viewModel.getCursorStates();\r\n        viewModel.setCursorStates(args.source, 3 /* Explicit */, CursorMoveCommands.addCursorDown(viewModel, previousCursorState, useLogicalLine));\r\n        viewModel.revealBottomMostCursor(args.source);\r\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\r\n    }\r\n}\r\nclass InsertCursorAtEndOfEachLineSelected extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.insertCursorAtEndOfEachLineSelected',\r\n            label: nls.localize('mutlicursor.insertAtEndOfEachLineSelected', \"Add Cursors to Line Ends\"),\r\n            alias: 'Add Cursors to Line Ends',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 39 /* KEY_I */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miInsertCursorAtEndOfEachLineSelected', comment: ['&& denotes a mnemonic'] }, \"Add C&&ursors to Line Ends\"),\r\n                order: 4\r\n            }\r\n        });\r\n    }\r\n    getCursorsForSelection(selection, model, result) {\r\n        if (selection.isEmpty()) {\r\n            return;\r\n        }\r\n        for (let i = selection.startLineNumber; i < selection.endLineNumber; i++) {\r\n            let currentLineMaxColumn = model.getLineMaxColumn(i);\r\n            result.push(new Selection(i, currentLineMaxColumn, i, currentLineMaxColumn));\r\n        }\r\n        if (selection.endColumn > 1) {\r\n            result.push(new Selection(selection.endLineNumber, selection.endColumn, selection.endLineNumber, selection.endColumn));\r\n        }\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = editor.getModel();\r\n        const selections = editor.getSelections();\r\n        const viewModel = editor._getViewModel();\r\n        const previousCursorState = viewModel.getCursorStates();\r\n        let newSelections = [];\r\n        selections.forEach((sel) => this.getCursorsForSelection(sel, model, newSelections));\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\r\n    }\r\n}\r\nclass InsertCursorAtEndOfLineSelected extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.addCursorsToBottom',\r\n            label: nls.localize('mutlicursor.addCursorsToBottom', \"Add Cursors To Bottom\"),\r\n            alias: 'Add Cursors To Bottom',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const selections = editor.getSelections();\r\n        const lineCount = editor.getModel().getLineCount();\r\n        let newSelections = [];\r\n        for (let i = selections[0].startLineNumber; i <= lineCount; i++) {\r\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\r\n        }\r\n        const viewModel = editor._getViewModel();\r\n        const previousCursorState = viewModel.getCursorStates();\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\r\n    }\r\n}\r\nclass InsertCursorAtTopOfLineSelected extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.addCursorsToTop',\r\n            label: nls.localize('mutlicursor.addCursorsToTop', \"Add Cursors To Top\"),\r\n            alias: 'Add Cursors To Top',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const selections = editor.getSelections();\r\n        let newSelections = [];\r\n        for (let i = selections[0].startLineNumber; i >= 1; i--) {\r\n            newSelections.push(new Selection(i, selections[0].startColumn, i, selections[0].endColumn));\r\n        }\r\n        const viewModel = editor._getViewModel();\r\n        const previousCursorState = viewModel.getCursorStates();\r\n        if (newSelections.length > 0) {\r\n            editor.setSelections(newSelections);\r\n        }\r\n        announceCursorChange(previousCursorState, viewModel.getCursorStates());\r\n    }\r\n}\r\nexport class MultiCursorSessionResult {\r\n    constructor(selections, revealRange, revealScrollType) {\r\n        this.selections = selections;\r\n        this.revealRange = revealRange;\r\n        this.revealScrollType = revealScrollType;\r\n    }\r\n}\r\nexport class MultiCursorSession {\r\n    constructor(_editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch) {\r\n        this._editor = _editor;\r\n        this.findController = findController;\r\n        this.isDisconnectedFromFindController = isDisconnectedFromFindController;\r\n        this.searchText = searchText;\r\n        this.wholeWord = wholeWord;\r\n        this.matchCase = matchCase;\r\n        this.currentMatch = currentMatch;\r\n    }\r\n    static create(editor, findController) {\r\n        if (!editor.hasModel()) {\r\n            return null;\r\n        }\r\n        const findState = findController.getState();\r\n        // Find widget owns entirely what we search for if:\r\n        //  - focus is not in the editor (i.e. it is in the find widget)\r\n        //  - and the search widget is visible\r\n        //  - and the search string is non-empty\r\n        if (!editor.hasTextFocus() && findState.isRevealed && findState.searchString.length > 0) {\r\n            // Find widget owns what is searched for\r\n            return new MultiCursorSession(editor, findController, false, findState.searchString, findState.wholeWord, findState.matchCase, null);\r\n        }\r\n        // Otherwise, the selection gives the search text, and the find widget gives the search settings\r\n        // The exception is the find state disassociation case: when beginning with a single, collapsed selection\r\n        let isDisconnectedFromFindController = false;\r\n        let wholeWord;\r\n        let matchCase;\r\n        const selections = editor.getSelections();\r\n        if (selections.length === 1 && selections[0].isEmpty()) {\r\n            isDisconnectedFromFindController = true;\r\n            wholeWord = true;\r\n            matchCase = true;\r\n        }\r\n        else {\r\n            wholeWord = findState.wholeWord;\r\n            matchCase = findState.matchCase;\r\n        }\r\n        // Selection owns what is searched for\r\n        const s = editor.getSelection();\r\n        let searchText;\r\n        let currentMatch = null;\r\n        if (s.isEmpty()) {\r\n            // selection is empty => expand to current word\r\n            const word = editor.getConfiguredWordAtPosition(s.getStartPosition());\r\n            if (!word) {\r\n                return null;\r\n            }\r\n            searchText = word.word;\r\n            currentMatch = new Selection(s.startLineNumber, word.startColumn, s.startLineNumber, word.endColumn);\r\n        }\r\n        else {\r\n            searchText = editor.getModel().getValueInRange(s).replace(/\\r\\n/g, '\\n');\r\n        }\r\n        return new MultiCursorSession(editor, findController, isDisconnectedFromFindController, searchText, wholeWord, matchCase, currentMatch);\r\n    }\r\n    addSelectionToNextFindMatch() {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        const nextMatch = this._getNextMatch();\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        const allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.concat(nextMatch), nextMatch, 0 /* Smooth */);\r\n    }\r\n    moveSelectionToNextFindMatch() {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        const nextMatch = this._getNextMatch();\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        const allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(nextMatch), nextMatch, 0 /* Smooth */);\r\n    }\r\n    _getNextMatch() {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        if (this.currentMatch) {\r\n            const result = this.currentMatch;\r\n            this.currentMatch = null;\r\n            return result;\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        const allSelections = this._editor.getSelections();\r\n        const lastAddedSelection = allSelections[allSelections.length - 1];\r\n        const nextMatch = this._editor.getModel().findNextMatch(this.searchText, lastAddedSelection.getEndPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null, false);\r\n        if (!nextMatch) {\r\n            return null;\r\n        }\r\n        return new Selection(nextMatch.range.startLineNumber, nextMatch.range.startColumn, nextMatch.range.endLineNumber, nextMatch.range.endColumn);\r\n    }\r\n    addSelectionToPreviousFindMatch() {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        const previousMatch = this._getPreviousMatch();\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        const allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.concat(previousMatch), previousMatch, 0 /* Smooth */);\r\n    }\r\n    moveSelectionToPreviousFindMatch() {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        const previousMatch = this._getPreviousMatch();\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        const allSelections = this._editor.getSelections();\r\n        return new MultiCursorSessionResult(allSelections.slice(0, allSelections.length - 1).concat(previousMatch), previousMatch, 0 /* Smooth */);\r\n    }\r\n    _getPreviousMatch() {\r\n        if (!this._editor.hasModel()) {\r\n            return null;\r\n        }\r\n        if (this.currentMatch) {\r\n            const result = this.currentMatch;\r\n            this.currentMatch = null;\r\n            return result;\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        const allSelections = this._editor.getSelections();\r\n        const lastAddedSelection = allSelections[allSelections.length - 1];\r\n        const previousMatch = this._editor.getModel().findPreviousMatch(this.searchText, lastAddedSelection.getStartPosition(), false, this.matchCase, this.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null, false);\r\n        if (!previousMatch) {\r\n            return null;\r\n        }\r\n        return new Selection(previousMatch.range.startLineNumber, previousMatch.range.startColumn, previousMatch.range.endLineNumber, previousMatch.range.endColumn);\r\n    }\r\n    selectAll() {\r\n        if (!this._editor.hasModel()) {\r\n            return [];\r\n        }\r\n        this.findController.highlightFindOptions();\r\n        return this._editor.getModel().findMatches(this.searchText, true, false, this.matchCase, this.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n    }\r\n}\r\nexport class MultiCursorSelectionController extends Disposable {\r\n    constructor(editor) {\r\n        super();\r\n        this._sessionDispose = this._register(new DisposableStore());\r\n        this._editor = editor;\r\n        this._ignoreSelectionChange = false;\r\n        this._session = null;\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(MultiCursorSelectionController.ID);\r\n    }\r\n    dispose() {\r\n        this._endSession();\r\n        super.dispose();\r\n    }\r\n    _beginSessionIfNeeded(findController) {\r\n        if (!this._session) {\r\n            // Create a new session\r\n            const session = MultiCursorSession.create(this._editor, findController);\r\n            if (!session) {\r\n                return;\r\n            }\r\n            this._session = session;\r\n            const newState = { searchString: this._session.searchText };\r\n            if (this._session.isDisconnectedFromFindController) {\r\n                newState.wholeWordOverride = 1 /* True */;\r\n                newState.matchCaseOverride = 1 /* True */;\r\n                newState.isRegexOverride = 2 /* False */;\r\n            }\r\n            findController.getState().change(newState, false);\r\n            this._sessionDispose.add(this._editor.onDidChangeCursorSelection((e) => {\r\n                if (this._ignoreSelectionChange) {\r\n                    return;\r\n                }\r\n                this._endSession();\r\n            }));\r\n            this._sessionDispose.add(this._editor.onDidBlurEditorText(() => {\r\n                this._endSession();\r\n            }));\r\n            this._sessionDispose.add(findController.getState().onFindReplaceStateChange((e) => {\r\n                if (e.matchCase || e.wholeWord) {\r\n                    this._endSession();\r\n                }\r\n            }));\r\n        }\r\n    }\r\n    _endSession() {\r\n        this._sessionDispose.clear();\r\n        if (this._session && this._session.isDisconnectedFromFindController) {\r\n            const newState = {\r\n                wholeWordOverride: 0 /* NotSet */,\r\n                matchCaseOverride: 0 /* NotSet */,\r\n                isRegexOverride: 0 /* NotSet */,\r\n            };\r\n            this._session.findController.getState().change(newState, false);\r\n        }\r\n        this._session = null;\r\n    }\r\n    _setSelections(selections) {\r\n        this._ignoreSelectionChange = true;\r\n        this._editor.setSelections(selections);\r\n        this._ignoreSelectionChange = false;\r\n    }\r\n    _expandEmptyToWord(model, selection) {\r\n        if (!selection.isEmpty()) {\r\n            return selection;\r\n        }\r\n        const word = this._editor.getConfiguredWordAtPosition(selection.getStartPosition());\r\n        if (!word) {\r\n            return selection;\r\n        }\r\n        return new Selection(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\r\n    }\r\n    _applySessionResult(result) {\r\n        if (!result) {\r\n            return;\r\n        }\r\n        this._setSelections(result.selections);\r\n        if (result.revealRange) {\r\n            this._editor.revealRangeInCenterIfOutsideViewport(result.revealRange, result.revealScrollType);\r\n        }\r\n    }\r\n    getSession(findController) {\r\n        return this._session;\r\n    }\r\n    addSelectionToNextFindMatch(findController) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        if (!this._session) {\r\n            // If there are multiple cursors, handle the case where they do not all select the same text.\r\n            const allSelections = this._editor.getSelections();\r\n            if (allSelections.length > 1) {\r\n                const findState = findController.getState();\r\n                const matchCase = findState.matchCase;\r\n                const selectionsContainSameText = modelRangesContainSameText(this._editor.getModel(), allSelections, matchCase);\r\n                if (!selectionsContainSameText) {\r\n                    const model = this._editor.getModel();\r\n                    let resultingSelections = [];\r\n                    for (let i = 0, len = allSelections.length; i < len; i++) {\r\n                        resultingSelections[i] = this._expandEmptyToWord(model, allSelections[i]);\r\n                    }\r\n                    this._editor.setSelections(resultingSelections);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.addSelectionToNextFindMatch());\r\n        }\r\n    }\r\n    addSelectionToPreviousFindMatch(findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.addSelectionToPreviousFindMatch());\r\n        }\r\n    }\r\n    moveSelectionToNextFindMatch(findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.moveSelectionToNextFindMatch());\r\n        }\r\n    }\r\n    moveSelectionToPreviousFindMatch(findController) {\r\n        this._beginSessionIfNeeded(findController);\r\n        if (this._session) {\r\n            this._applySessionResult(this._session.moveSelectionToPreviousFindMatch());\r\n        }\r\n    }\r\n    selectAll(findController) {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        let matches = null;\r\n        const findState = findController.getState();\r\n        // Special case: find widget owns entirely what we search for if:\r\n        // - focus is not in the editor (i.e. it is in the find widget)\r\n        // - and the search widget is visible\r\n        // - and the search string is non-empty\r\n        // - and we're searching for a regex\r\n        if (findState.isRevealed && findState.searchString.length > 0 && findState.isRegex) {\r\n            matches = this._editor.getModel().findMatches(findState.searchString, true, findState.isRegex, findState.matchCase, findState.wholeWord ? this._editor.getOption(115 /* wordSeparators */) : null, false, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\r\n        }\r\n        else {\r\n            this._beginSessionIfNeeded(findController);\r\n            if (!this._session) {\r\n                return;\r\n            }\r\n            matches = this._session.selectAll();\r\n        }\r\n        if (findState.searchScope) {\r\n            const states = findState.searchScope;\r\n            let inSelection = [];\r\n            matches.forEach((match) => {\r\n                states.forEach((state) => {\r\n                    if (match.range.endLineNumber <= state.endLineNumber && match.range.startLineNumber >= state.startLineNumber) {\r\n                        inSelection.push(match);\r\n                    }\r\n                });\r\n            });\r\n            matches = inSelection;\r\n        }\r\n        if (matches.length > 0) {\r\n            const editorSelection = this._editor.getSelection();\r\n            // Have the primary cursor remain the one where the action was invoked\r\n            for (let i = 0, len = matches.length; i < len; i++) {\r\n                const match = matches[i];\r\n                const intersection = match.range.intersectRanges(editorSelection);\r\n                if (intersection) {\r\n                    // bingo!\r\n                    matches[i] = matches[0];\r\n                    matches[0] = match;\r\n                    break;\r\n                }\r\n            }\r\n            this._setSelections(matches.map(m => new Selection(m.range.startLineNumber, m.range.startColumn, m.range.endLineNumber, m.range.endColumn)));\r\n        }\r\n    }\r\n}\r\nMultiCursorSelectionController.ID = 'editor.contrib.multiCursorController';\r\nexport class MultiCursorSelectionControllerAction extends EditorAction {\r\n    run(accessor, editor) {\r\n        const multiCursorController = MultiCursorSelectionController.get(editor);\r\n        if (!multiCursorController) {\r\n            return;\r\n        }\r\n        const findController = CommonFindController.get(editor);\r\n        if (!findController) {\r\n            return;\r\n        }\r\n        const viewModel = editor._getViewModel();\r\n        if (viewModel) {\r\n            const previousCursorState = viewModel.getCursorStates();\r\n            this._run(multiCursorController, findController);\r\n            announceCursorChange(previousCursorState, viewModel.getCursorStates());\r\n        }\r\n    }\r\n}\r\nexport class AddSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.addSelectionToNextFindMatch',\r\n            label: nls.localize('addSelectionToNextFindMatch', \"Add Selection To Next Find Match\"),\r\n            alias: 'Add Selection To Next Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 34 /* KEY_D */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miAddSelectionToNextFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add &&Next Occurrence\"),\r\n                order: 5\r\n            }\r\n        });\r\n    }\r\n    _run(multiCursorController, findController) {\r\n        multiCursorController.addSelectionToNextFindMatch(findController);\r\n    }\r\n}\r\nexport class AddSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.addSelectionToPreviousFindMatch',\r\n            label: nls.localize('addSelectionToPreviousFindMatch', \"Add Selection To Previous Find Match\"),\r\n            alias: 'Add Selection To Previous Find Match',\r\n            precondition: undefined,\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miAddSelectionToPreviousFindMatch', comment: ['&& denotes a mnemonic'] }, \"Add P&&revious Occurrence\"),\r\n                order: 6\r\n            }\r\n        });\r\n    }\r\n    _run(multiCursorController, findController) {\r\n        multiCursorController.addSelectionToPreviousFindMatch(findController);\r\n    }\r\n}\r\nexport class MoveSelectionToNextFindMatchAction extends MultiCursorSelectionControllerAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.moveSelectionToNextFindMatch',\r\n            label: nls.localize('moveSelectionToNextFindMatch', \"Move Last Selection To Next Find Match\"),\r\n            alias: 'Move Last Selection To Next Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KEY_K */, 2048 /* CtrlCmd */ | 34 /* KEY_D */),\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    _run(multiCursorController, findController) {\r\n        multiCursorController.moveSelectionToNextFindMatch(findController);\r\n    }\r\n}\r\nexport class MoveSelectionToPreviousFindMatchAction extends MultiCursorSelectionControllerAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.moveSelectionToPreviousFindMatch',\r\n            label: nls.localize('moveSelectionToPreviousFindMatch', \"Move Last Selection To Previous Find Match\"),\r\n            alias: 'Move Last Selection To Previous Find Match',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    _run(multiCursorController, findController) {\r\n        multiCursorController.moveSelectionToPreviousFindMatch(findController);\r\n    }\r\n}\r\nexport class SelectHighlightsAction extends MultiCursorSelectionControllerAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.selectHighlights',\r\n            label: nls.localize('selectAllOccurrencesOfFindMatch', \"Select All Occurrences of Find Match\"),\r\n            alias: 'Select All Occurrences of Find Match',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.focus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 42 /* KEY_L */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '3_multi',\r\n                title: nls.localize({ key: 'miSelectHighlights', comment: ['&& denotes a mnemonic'] }, \"Select All &&Occurrences\"),\r\n                order: 7\r\n            }\r\n        });\r\n    }\r\n    _run(multiCursorController, findController) {\r\n        multiCursorController.selectAll(findController);\r\n    }\r\n}\r\nexport class CompatChangeAll extends MultiCursorSelectionControllerAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.changeAll',\r\n            label: nls.localize('changeAll.label', \"Change All Occurrences\"),\r\n            alias: 'Change All Occurrences',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.editorTextFocus),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 60 /* F2 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 1.2\r\n            }\r\n        });\r\n    }\r\n    _run(multiCursorController, findController) {\r\n        multiCursorController.selectAll(findController);\r\n    }\r\n}\r\nclass SelectionHighlighterState {\r\n    constructor(searchText, matchCase, wordSeparators, modelVersionId) {\r\n        this.searchText = searchText;\r\n        this.matchCase = matchCase;\r\n        this.wordSeparators = wordSeparators;\r\n        this.modelVersionId = modelVersionId;\r\n    }\r\n    /**\r\n     * Everything equals except for `lastWordUnderCursor`\r\n     */\r\n    static softEquals(a, b) {\r\n        if (!a && !b) {\r\n            return true;\r\n        }\r\n        if (!a || !b) {\r\n            return false;\r\n        }\r\n        return (a.searchText === b.searchText\r\n            && a.matchCase === b.matchCase\r\n            && a.wordSeparators === b.wordSeparators\r\n            && a.modelVersionId === b.modelVersionId);\r\n    }\r\n}\r\nexport class SelectionHighlighter extends Disposable {\r\n    constructor(editor) {\r\n        super();\r\n        this.editor = editor;\r\n        this._isEnabled = editor.getOption(96 /* selectionHighlight */);\r\n        this.decorations = [];\r\n        this.updateSoon = this._register(new RunOnceScheduler(() => this._update(), 300));\r\n        this.state = null;\r\n        this._register(editor.onDidChangeConfiguration((e) => {\r\n            this._isEnabled = editor.getOption(96 /* selectionHighlight */);\r\n        }));\r\n        this._register(editor.onDidChangeCursorSelection((e) => {\r\n            if (!this._isEnabled) {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            if (e.selection.isEmpty()) {\r\n                if (e.reason === 3 /* Explicit */) {\r\n                    if (this.state) {\r\n                        // no longer valid\r\n                        this._setState(null);\r\n                    }\r\n                    this.updateSoon.schedule();\r\n                }\r\n                else {\r\n                    this._setState(null);\r\n                }\r\n            }\r\n            else {\r\n                this._update();\r\n            }\r\n        }));\r\n        this._register(editor.onDidChangeModel((e) => {\r\n            this._setState(null);\r\n        }));\r\n        this._register(editor.onDidChangeModelContent((e) => {\r\n            if (this._isEnabled) {\r\n                this.updateSoon.schedule();\r\n            }\r\n        }));\r\n        this._register(CommonFindController.get(editor).getState().onFindReplaceStateChange((e) => {\r\n            this._update();\r\n        }));\r\n    }\r\n    _update() {\r\n        this._setState(SelectionHighlighter._createState(this._isEnabled, this.editor));\r\n    }\r\n    static _createState(isEnabled, editor) {\r\n        if (!isEnabled) {\r\n            return null;\r\n        }\r\n        if (!editor.hasModel()) {\r\n            return null;\r\n        }\r\n        const s = editor.getSelection();\r\n        if (s.startLineNumber !== s.endLineNumber) {\r\n            // multiline forbidden for perf reasons\r\n            return null;\r\n        }\r\n        const multiCursorController = MultiCursorSelectionController.get(editor);\r\n        if (!multiCursorController) {\r\n            return null;\r\n        }\r\n        const findController = CommonFindController.get(editor);\r\n        if (!findController) {\r\n            return null;\r\n        }\r\n        let r = multiCursorController.getSession(findController);\r\n        if (!r) {\r\n            const allSelections = editor.getSelections();\r\n            if (allSelections.length > 1) {\r\n                const findState = findController.getState();\r\n                const matchCase = findState.matchCase;\r\n                const selectionsContainSameText = modelRangesContainSameText(editor.getModel(), allSelections, matchCase);\r\n                if (!selectionsContainSameText) {\r\n                    return null;\r\n                }\r\n            }\r\n            r = MultiCursorSession.create(editor, findController);\r\n        }\r\n        if (!r) {\r\n            return null;\r\n        }\r\n        if (r.currentMatch) {\r\n            // This is an empty selection\r\n            // Do not interfere with semantic word highlighting in the no selection case\r\n            return null;\r\n        }\r\n        if (/^[ \\t]+$/.test(r.searchText)) {\r\n            // whitespace only selection\r\n            return null;\r\n        }\r\n        if (r.searchText.length > 200) {\r\n            // very long selection\r\n            return null;\r\n        }\r\n        // TODO: better handling of this case\r\n        const findState = findController.getState();\r\n        const caseSensitive = findState.matchCase;\r\n        // Return early if the find widget shows the exact same matches\r\n        if (findState.isRevealed) {\r\n            let findStateSearchString = findState.searchString;\r\n            if (!caseSensitive) {\r\n                findStateSearchString = findStateSearchString.toLowerCase();\r\n            }\r\n            let mySearchString = r.searchText;\r\n            if (!caseSensitive) {\r\n                mySearchString = mySearchString.toLowerCase();\r\n            }\r\n            if (findStateSearchString === mySearchString && r.matchCase === findState.matchCase && r.wholeWord === findState.wholeWord && !findState.isRegex) {\r\n                return null;\r\n            }\r\n        }\r\n        return new SelectionHighlighterState(r.searchText, r.matchCase, r.wholeWord ? editor.getOption(115 /* wordSeparators */) : null, editor.getModel().getVersionId());\r\n    }\r\n    _setState(state) {\r\n        if (SelectionHighlighterState.softEquals(this.state, state)) {\r\n            this.state = state;\r\n            return;\r\n        }\r\n        this.state = state;\r\n        if (!this.state) {\r\n            this.decorations = this.editor.deltaDecorations(this.decorations, []);\r\n            return;\r\n        }\r\n        if (!this.editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = this.editor.getModel();\r\n        if (model.isTooLargeForTokenization()) {\r\n            // the file is too large, so searching word under cursor in the whole document takes is blocking the UI.\r\n            return;\r\n        }\r\n        const hasFindOccurrences = DocumentHighlightProviderRegistry.has(model) && this.editor.getOption(70 /* occurrencesHighlight */);\r\n        let allMatches = model.findMatches(this.state.searchText, true, false, this.state.matchCase, this.state.wordSeparators, false).map(m => m.range);\r\n        allMatches.sort(Range.compareRangesUsingStarts);\r\n        let selections = this.editor.getSelections();\r\n        selections.sort(Range.compareRangesUsingStarts);\r\n        // do not overlap with selection (issue #64 and #512)\r\n        let matches = [];\r\n        for (let i = 0, j = 0, len = allMatches.length, lenJ = selections.length; i < len;) {\r\n            const match = allMatches[i];\r\n            if (j >= lenJ) {\r\n                // finished all editor selections\r\n                matches.push(match);\r\n                i++;\r\n            }\r\n            else {\r\n                const cmp = Range.compareRangesUsingStarts(match, selections[j]);\r\n                if (cmp < 0) {\r\n                    // match is before sel\r\n                    if (selections[j].isEmpty() || !Range.areIntersecting(match, selections[j])) {\r\n                        matches.push(match);\r\n                    }\r\n                    i++;\r\n                }\r\n                else if (cmp > 0) {\r\n                    // sel is before match\r\n                    j++;\r\n                }\r\n                else {\r\n                    // sel is equal to match\r\n                    i++;\r\n                    j++;\r\n                }\r\n            }\r\n        }\r\n        const decorations = matches.map(r => {\r\n            return {\r\n                range: r,\r\n                // Show in overviewRuler only if model has no semantic highlighting\r\n                options: (hasFindOccurrences ? SelectionHighlighter._SELECTION_HIGHLIGHT : SelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW)\r\n            };\r\n        });\r\n        this.decorations = this.editor.deltaDecorations(this.decorations, decorations);\r\n    }\r\n    dispose() {\r\n        this._setState(null);\r\n        super.dispose();\r\n    }\r\n}\r\nSelectionHighlighter.ID = 'editor.contrib.selectionHighlighter';\r\nSelectionHighlighter._SELECTION_HIGHLIGHT_OVERVIEW = ModelDecorationOptions.register({\r\n    description: 'selection-highlight-overview',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'selectionHighlight',\r\n    overviewRuler: {\r\n        color: themeColorFromId(overviewRulerSelectionHighlightForeground),\r\n        position: OverviewRulerLane.Center\r\n    }\r\n});\r\nSelectionHighlighter._SELECTION_HIGHLIGHT = ModelDecorationOptions.register({\r\n    description: 'selection-highlight',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'selectionHighlight',\r\n});\r\nfunction modelRangesContainSameText(model, ranges, matchCase) {\r\n    const selectedText = getValueInRange(model, ranges[0], !matchCase);\r\n    for (let i = 1, len = ranges.length; i < len; i++) {\r\n        const range = ranges[i];\r\n        if (range.isEmpty()) {\r\n            return false;\r\n        }\r\n        const thisSelectedText = getValueInRange(model, range, !matchCase);\r\n        if (selectedText !== thisSelectedText) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction getValueInRange(model, range, toLowerCase) {\r\n    const text = model.getValueInRange(range);\r\n    return (toLowerCase ? text.toLowerCase() : text);\r\n}\r\nregisterEditorContribution(MultiCursorSelectionController.ID, MultiCursorSelectionController);\r\nregisterEditorContribution(SelectionHighlighter.ID, SelectionHighlighter);\r\nregisterEditorAction(InsertCursorAbove);\r\nregisterEditorAction(InsertCursorBelow);\r\nregisterEditorAction(InsertCursorAtEndOfEachLineSelected);\r\nregisterEditorAction(AddSelectionToNextFindMatchAction);\r\nregisterEditorAction(AddSelectionToPreviousFindMatchAction);\r\nregisterEditorAction(MoveSelectionToNextFindMatchAction);\r\nregisterEditorAction(MoveSelectionToPreviousFindMatchAction);\r\nregisterEditorAction(SelectHighlightsAction);\r\nregisterEditorAction(CompatChangeAll);\r\nregisterEditorAction(InsertCursorAtEndOfLineSelected);\r\nregisterEditorAction(InsertCursorAtTopOfLineSelected);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nimport { ITextModelService } from '../../common/services/resolverService.js';\r\nexport const Context = {\r\n    Visible: new RawContextKey('parameterHintsVisible', false),\r\n    MultipleSignatures: new RawContextKey('parameterHintsMultipleSignatures', false),\r\n};\r\nexport function provideSignatureHelp(model, position, context, token) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const supports = modes.SignatureHelpProviderRegistry.ordered(model);\r\n        for (const support of supports) {\r\n            try {\r\n                const result = yield support.provideSignatureHelp(model, position, token, context);\r\n                if (result) {\r\n                    return result;\r\n                }\r\n            }\r\n            catch (err) {\r\n                onUnexpectedExternalError(err);\r\n            }\r\n        }\r\n        return undefined;\r\n    });\r\n}\r\nCommandsRegistry.registerCommand('_executeSignatureHelpProvider', (accessor, ...args) => __awaiter(void 0, void 0, void 0, function* () {\r\n    const [uri, position, triggerCharacter] = args;\r\n    assertType(URI.isUri(uri));\r\n    assertType(Position.isIPosition(position));\r\n    assertType(typeof triggerCharacter === 'string' || !triggerCharacter);\r\n    const ref = yield accessor.get(ITextModelService).createModelReference(uri);\r\n    try {\r\n        const result = yield provideSignatureHelp(ref.object.textEditorModel, Position.lift(position), {\r\n            triggerKind: modes.SignatureHelpTriggerKind.Invoke,\r\n            isRetrigger: false,\r\n            triggerCharacter,\r\n        }, CancellationToken.None);\r\n        if (!result) {\r\n            return undefined;\r\n        }\r\n        setTimeout(() => result.dispose(), 0);\r\n        return result.value;\r\n    }\r\n    finally {\r\n        ref.dispose();\r\n    }\r\n}));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport { createCancelablePromise, Delayer } from '../../../base/common/async.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { Emitter } from '../../../base/common/event.js';\r\nimport { Disposable, MutableDisposable } from '../../../base/common/lifecycle.js';\r\nimport { CharacterSet } from '../../common/core/characterClassifier.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport { provideSignatureHelp } from './provideSignatureHelp.js';\r\nvar ParameterHintState;\r\n(function (ParameterHintState) {\r\n    ParameterHintState.Default = { type: 0 /* Default */ };\r\n    class Pending {\r\n        constructor(request, previouslyActiveHints) {\r\n            this.request = request;\r\n            this.previouslyActiveHints = previouslyActiveHints;\r\n            this.type = 2 /* Pending */;\r\n        }\r\n    }\r\n    ParameterHintState.Pending = Pending;\r\n    class Active {\r\n        constructor(hints) {\r\n            this.hints = hints;\r\n            this.type = 1 /* Active */;\r\n        }\r\n    }\r\n    ParameterHintState.Active = Active;\r\n})(ParameterHintState || (ParameterHintState = {}));\r\nexport class ParameterHintsModel extends Disposable {\r\n    constructor(editor, delay = ParameterHintsModel.DEFAULT_DELAY) {\r\n        super();\r\n        this._onChangedHints = this._register(new Emitter());\r\n        this.onChangedHints = this._onChangedHints.event;\r\n        this.triggerOnType = false;\r\n        this._state = ParameterHintState.Default;\r\n        this._pendingTriggers = [];\r\n        this._lastSignatureHelpResult = this._register(new MutableDisposable());\r\n        this.triggerChars = new CharacterSet();\r\n        this.retriggerChars = new CharacterSet();\r\n        this.triggerId = 0;\r\n        this.editor = editor;\r\n        this.throttledDelayer = new Delayer(delay);\r\n        this._register(this.editor.onDidBlurEditorWidget(() => this.cancel()));\r\n        this._register(this.editor.onDidChangeConfiguration(() => this.onEditorConfigurationChange()));\r\n        this._register(this.editor.onDidChangeModel(e => this.onModelChanged()));\r\n        this._register(this.editor.onDidChangeModelLanguage(_ => this.onModelChanged()));\r\n        this._register(this.editor.onDidChangeCursorSelection(e => this.onCursorChange(e)));\r\n        this._register(this.editor.onDidChangeModelContent(e => this.onModelContentChange()));\r\n        this._register(modes.SignatureHelpProviderRegistry.onDidChange(this.onModelChanged, this));\r\n        this._register(this.editor.onDidType(text => this.onDidType(text)));\r\n        this.onEditorConfigurationChange();\r\n        this.onModelChanged();\r\n    }\r\n    get state() { return this._state; }\r\n    set state(value) {\r\n        if (this._state.type === 2 /* Pending */) {\r\n            this._state.request.cancel();\r\n        }\r\n        this._state = value;\r\n    }\r\n    cancel(silent = false) {\r\n        this.state = ParameterHintState.Default;\r\n        this.throttledDelayer.cancel();\r\n        if (!silent) {\r\n            this._onChangedHints.fire(undefined);\r\n        }\r\n    }\r\n    trigger(context, delay) {\r\n        const model = this.editor.getModel();\r\n        if (!model || !modes.SignatureHelpProviderRegistry.has(model)) {\r\n            return;\r\n        }\r\n        const triggerId = ++this.triggerId;\r\n        this._pendingTriggers.push(context);\r\n        this.throttledDelayer.trigger(() => {\r\n            return this.doTrigger(triggerId);\r\n        }, delay)\r\n            .catch(onUnexpectedError);\r\n    }\r\n    next() {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        const length = this.state.hints.signatures.length;\r\n        const activeSignature = this.state.hints.activeSignature;\r\n        const last = (activeSignature % length) === (length - 1);\r\n        const cycle = this.editor.getOption(74 /* parameterHints */).cycle;\r\n        // If there is only one signature, or we're on last signature of list\r\n        if ((length < 2 || last) && !cycle) {\r\n            this.cancel();\r\n            return;\r\n        }\r\n        this.updateActiveSignature(last && cycle ? 0 : activeSignature + 1);\r\n    }\r\n    previous() {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        const length = this.state.hints.signatures.length;\r\n        const activeSignature = this.state.hints.activeSignature;\r\n        const first = activeSignature === 0;\r\n        const cycle = this.editor.getOption(74 /* parameterHints */).cycle;\r\n        // If there is only one signature, or we're on first signature of list\r\n        if ((length < 2 || first) && !cycle) {\r\n            this.cancel();\r\n            return;\r\n        }\r\n        this.updateActiveSignature(first && cycle ? length - 1 : activeSignature - 1);\r\n    }\r\n    updateActiveSignature(activeSignature) {\r\n        if (this.state.type !== 1 /* Active */) {\r\n            return;\r\n        }\r\n        this.state = new ParameterHintState.Active(Object.assign(Object.assign({}, this.state.hints), { activeSignature }));\r\n        this._onChangedHints.fire(this.state.hints);\r\n    }\r\n    doTrigger(triggerId) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const isRetrigger = this.state.type === 1 /* Active */ || this.state.type === 2 /* Pending */;\r\n            const activeSignatureHelp = this.getLastActiveHints();\r\n            this.cancel(true);\r\n            if (this._pendingTriggers.length === 0) {\r\n                return false;\r\n            }\r\n            const context = this._pendingTriggers.reduce(mergeTriggerContexts);\r\n            this._pendingTriggers = [];\r\n            const triggerContext = {\r\n                triggerKind: context.triggerKind,\r\n                triggerCharacter: context.triggerCharacter,\r\n                isRetrigger: isRetrigger,\r\n                activeSignatureHelp: activeSignatureHelp\r\n            };\r\n            if (!this.editor.hasModel()) {\r\n                return false;\r\n            }\r\n            const model = this.editor.getModel();\r\n            const position = this.editor.getPosition();\r\n            this.state = new ParameterHintState.Pending(createCancelablePromise(token => provideSignatureHelp(model, position, triggerContext, token)), activeSignatureHelp);\r\n            try {\r\n                const result = yield this.state.request;\r\n                // Check that we are still resolving the correct signature help\r\n                if (triggerId !== this.triggerId) {\r\n                    result === null || result === void 0 ? void 0 : result.dispose();\r\n                    return false;\r\n                }\r\n                if (!result || !result.value.signatures || result.value.signatures.length === 0) {\r\n                    result === null || result === void 0 ? void 0 : result.dispose();\r\n                    this._lastSignatureHelpResult.clear();\r\n                    this.cancel();\r\n                    return false;\r\n                }\r\n                else {\r\n                    this.state = new ParameterHintState.Active(result.value);\r\n                    this._lastSignatureHelpResult.value = result;\r\n                    this._onChangedHints.fire(this.state.hints);\r\n                    return true;\r\n                }\r\n            }\r\n            catch (error) {\r\n                if (triggerId === this.triggerId) {\r\n                    this.state = ParameterHintState.Default;\r\n                }\r\n                onUnexpectedError(error);\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n    getLastActiveHints() {\r\n        switch (this.state.type) {\r\n            case 1 /* Active */: return this.state.hints;\r\n            case 2 /* Pending */: return this.state.previouslyActiveHints;\r\n            default: return undefined;\r\n        }\r\n    }\r\n    get isTriggered() {\r\n        return this.state.type === 1 /* Active */\r\n            || this.state.type === 2 /* Pending */\r\n            || this.throttledDelayer.isTriggered();\r\n    }\r\n    onModelChanged() {\r\n        this.cancel();\r\n        // Update trigger characters\r\n        this.triggerChars = new CharacterSet();\r\n        this.retriggerChars = new CharacterSet();\r\n        const model = this.editor.getModel();\r\n        if (!model) {\r\n            return;\r\n        }\r\n        for (const support of modes.SignatureHelpProviderRegistry.ordered(model)) {\r\n            for (const ch of support.signatureHelpTriggerCharacters || []) {\r\n                this.triggerChars.add(ch.charCodeAt(0));\r\n                // All trigger characters are also considered retrigger characters\r\n                this.retriggerChars.add(ch.charCodeAt(0));\r\n            }\r\n            for (const ch of support.signatureHelpRetriggerCharacters || []) {\r\n                this.retriggerChars.add(ch.charCodeAt(0));\r\n            }\r\n        }\r\n    }\r\n    onDidType(text) {\r\n        if (!this.triggerOnType) {\r\n            return;\r\n        }\r\n        const lastCharIndex = text.length - 1;\r\n        const triggerCharCode = text.charCodeAt(lastCharIndex);\r\n        if (this.triggerChars.has(triggerCharCode) || this.isTriggered && this.retriggerChars.has(triggerCharCode)) {\r\n            this.trigger({\r\n                triggerKind: modes.SignatureHelpTriggerKind.TriggerCharacter,\r\n                triggerCharacter: text.charAt(lastCharIndex),\r\n            });\r\n        }\r\n    }\r\n    onCursorChange(e) {\r\n        if (e.source === 'mouse') {\r\n            this.cancel();\r\n        }\r\n        else if (this.isTriggered) {\r\n            this.trigger({ triggerKind: modes.SignatureHelpTriggerKind.ContentChange });\r\n        }\r\n    }\r\n    onModelContentChange() {\r\n        if (this.isTriggered) {\r\n            this.trigger({ triggerKind: modes.SignatureHelpTriggerKind.ContentChange });\r\n        }\r\n    }\r\n    onEditorConfigurationChange() {\r\n        this.triggerOnType = this.editor.getOption(74 /* parameterHints */).enabled;\r\n        if (!this.triggerOnType) {\r\n            this.cancel();\r\n        }\r\n    }\r\n    dispose() {\r\n        this.cancel(true);\r\n        super.dispose();\r\n    }\r\n}\r\nParameterHintsModel.DEFAULT_DELAY = 120; // ms\r\nfunction mergeTriggerContexts(previous, current) {\r\n    switch (current.triggerKind) {\r\n        case modes.SignatureHelpTriggerKind.Invoke:\r\n            // Invoke overrides previous triggers.\r\n            return current;\r\n        case modes.SignatureHelpTriggerKind.ContentChange:\r\n            // Ignore content changes triggers\r\n            return previous;\r\n        case modes.SignatureHelpTriggerKind.TriggerCharacter:\r\n        default:\r\n            return current;\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as dom from '../../../base/browser/dom.js';\r\nimport * as aria from '../../../base/browser/ui/aria/aria.js';\r\nimport { DomScrollableElement } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\r\nimport { Event } from '../../../base/common/event.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport './parameterHints.css';\r\nimport { IModeService } from '../../common/services/modeService.js';\r\nimport { MarkdownRenderer } from '../../browser/core/markdownRenderer.js';\r\nimport { Context } from './provideSignatureHelp.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { IContextKeyService } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IOpenerService } from '../../../platform/opener/common/opener.js';\r\nimport { editorHoverBackground, editorHoverBorder, textCodeBlockBackground, textLinkForeground, editorHoverForeground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant, ThemeIcon } from '../../../platform/theme/common/themeService.js';\r\nimport { ParameterHintsModel } from './parameterHintsModel.js';\r\nimport { escapeRegExpCharacters } from '../../../base/common/strings.js';\r\nimport { Codicon } from '../../../base/common/codicons.js';\r\nimport { assertIsDefined } from '../../../base/common/types.js';\r\nimport { ColorScheme } from '../../../platform/theme/common/theme.js';\r\nimport { registerIcon } from '../../../platform/theme/common/iconRegistry.js';\r\nconst $ = dom.$;\r\nconst parameterHintsNextIcon = registerIcon('parameter-hints-next', Codicon.chevronDown, nls.localize('parameterHintsNextIcon', 'Icon for show next parameter hint.'));\r\nconst parameterHintsPreviousIcon = registerIcon('parameter-hints-previous', Codicon.chevronUp, nls.localize('parameterHintsPreviousIcon', 'Icon for show previous parameter hint.'));\r\nlet ParameterHintsWidget = class ParameterHintsWidget extends Disposable {\r\n    constructor(editor, contextKeyService, openerService, modeService) {\r\n        super();\r\n        this.editor = editor;\r\n        this.renderDisposeables = this._register(new DisposableStore());\r\n        this.visible = false;\r\n        this.announcedLabel = null;\r\n        // Editor.IContentWidget.allowEditorOverflow\r\n        this.allowEditorOverflow = true;\r\n        this.markdownRenderer = this._register(new MarkdownRenderer({ editor }, modeService, openerService));\r\n        this.model = this._register(new ParameterHintsModel(editor));\r\n        this.keyVisible = Context.Visible.bindTo(contextKeyService);\r\n        this.keyMultipleSignatures = Context.MultipleSignatures.bindTo(contextKeyService);\r\n        this._register(this.model.onChangedHints(newParameterHints => {\r\n            if (newParameterHints) {\r\n                this.show();\r\n                this.render(newParameterHints);\r\n            }\r\n            else {\r\n                this.hide();\r\n            }\r\n        }));\r\n    }\r\n    createParameterHintDOMNodes() {\r\n        const element = $('.editor-widget.parameter-hints-widget');\r\n        const wrapper = dom.append(element, $('.phwrapper'));\r\n        wrapper.tabIndex = -1;\r\n        const controls = dom.append(wrapper, $('.controls'));\r\n        const previous = dom.append(controls, $('.button' + ThemeIcon.asCSSSelector(parameterHintsPreviousIcon)));\r\n        const overloads = dom.append(controls, $('.overloads'));\r\n        const next = dom.append(controls, $('.button' + ThemeIcon.asCSSSelector(parameterHintsNextIcon)));\r\n        this._register(dom.addDisposableListener(previous, 'click', e => {\r\n            dom.EventHelper.stop(e);\r\n            this.previous();\r\n        }));\r\n        this._register(dom.addDisposableListener(next, 'click', e => {\r\n            dom.EventHelper.stop(e);\r\n            this.next();\r\n        }));\r\n        const body = $('.body');\r\n        const scrollbar = new DomScrollableElement(body, {});\r\n        this._register(scrollbar);\r\n        wrapper.appendChild(scrollbar.getDomNode());\r\n        const signature = dom.append(body, $('.signature'));\r\n        const docs = dom.append(body, $('.docs'));\r\n        element.style.userSelect = 'text';\r\n        this.domNodes = {\r\n            element,\r\n            signature,\r\n            overloads,\r\n            docs,\r\n            scrollbar,\r\n        };\r\n        this.editor.addContentWidget(this);\r\n        this.hide();\r\n        this._register(this.editor.onDidChangeCursorSelection(e => {\r\n            if (this.visible) {\r\n                this.editor.layoutContentWidget(this);\r\n            }\r\n        }));\r\n        const updateFont = () => {\r\n            if (!this.domNodes) {\r\n                return;\r\n            }\r\n            const fontInfo = this.editor.getOption(41 /* fontInfo */);\r\n            this.domNodes.element.style.fontSize = `${fontInfo.fontSize}px`;\r\n        };\r\n        updateFont();\r\n        this._register(Event.chain(this.editor.onDidChangeConfiguration.bind(this.editor))\r\n            .filter(e => e.hasChanged(41 /* fontInfo */))\r\n            .on(updateFont, null));\r\n        this._register(this.editor.onDidLayoutChange(e => this.updateMaxHeight()));\r\n        this.updateMaxHeight();\r\n    }\r\n    show() {\r\n        if (this.visible) {\r\n            return;\r\n        }\r\n        if (!this.domNodes) {\r\n            this.createParameterHintDOMNodes();\r\n        }\r\n        this.keyVisible.set(true);\r\n        this.visible = true;\r\n        setTimeout(() => {\r\n            if (this.domNodes) {\r\n                this.domNodes.element.classList.add('visible');\r\n            }\r\n        }, 100);\r\n        this.editor.layoutContentWidget(this);\r\n    }\r\n    hide() {\r\n        this.renderDisposeables.clear();\r\n        if (!this.visible) {\r\n            return;\r\n        }\r\n        this.keyVisible.reset();\r\n        this.visible = false;\r\n        this.announcedLabel = null;\r\n        if (this.domNodes) {\r\n            this.domNodes.element.classList.remove('visible');\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n    }\r\n    getPosition() {\r\n        if (this.visible) {\r\n            return {\r\n                position: this.editor.getPosition(),\r\n                preference: [1 /* ABOVE */, 2 /* BELOW */]\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    render(hints) {\r\n        var _a;\r\n        this.renderDisposeables.clear();\r\n        if (!this.domNodes) {\r\n            return;\r\n        }\r\n        const multiple = hints.signatures.length > 1;\r\n        this.domNodes.element.classList.toggle('multiple', multiple);\r\n        this.keyMultipleSignatures.set(multiple);\r\n        this.domNodes.signature.innerText = '';\r\n        this.domNodes.docs.innerText = '';\r\n        const signature = hints.signatures[hints.activeSignature];\r\n        if (!signature) {\r\n            return;\r\n        }\r\n        const code = dom.append(this.domNodes.signature, $('.code'));\r\n        const fontInfo = this.editor.getOption(41 /* fontInfo */);\r\n        code.style.fontSize = `${fontInfo.fontSize}px`;\r\n        code.style.fontFamily = fontInfo.fontFamily;\r\n        const hasParameters = signature.parameters.length > 0;\r\n        const activeParameterIndex = (_a = signature.activeParameter) !== null && _a !== void 0 ? _a : hints.activeParameter;\r\n        if (!hasParameters) {\r\n            const label = dom.append(code, $('span'));\r\n            label.textContent = signature.label;\r\n        }\r\n        else {\r\n            this.renderParameters(code, signature, activeParameterIndex);\r\n        }\r\n        const activeParameter = signature.parameters[activeParameterIndex];\r\n        if (activeParameter === null || activeParameter === void 0 ? void 0 : activeParameter.documentation) {\r\n            const documentation = $('span.documentation');\r\n            if (typeof activeParameter.documentation === 'string') {\r\n                documentation.textContent = activeParameter.documentation;\r\n            }\r\n            else {\r\n                const renderedContents = this.renderMarkdownDocs(activeParameter.documentation);\r\n                documentation.appendChild(renderedContents.element);\r\n            }\r\n            dom.append(this.domNodes.docs, $('p', {}, documentation));\r\n        }\r\n        if (signature.documentation === undefined) {\r\n            /** no op */\r\n        }\r\n        else if (typeof signature.documentation === 'string') {\r\n            dom.append(this.domNodes.docs, $('p', {}, signature.documentation));\r\n        }\r\n        else {\r\n            const renderedContents = this.renderMarkdownDocs(signature.documentation);\r\n            dom.append(this.domNodes.docs, renderedContents.element);\r\n        }\r\n        const hasDocs = this.hasDocs(signature, activeParameter);\r\n        this.domNodes.signature.classList.toggle('has-docs', hasDocs);\r\n        this.domNodes.docs.classList.toggle('empty', !hasDocs);\r\n        this.domNodes.overloads.textContent =\r\n            String(hints.activeSignature + 1).padStart(hints.signatures.length.toString().length, '0') + '/' + hints.signatures.length;\r\n        if (activeParameter) {\r\n            const labelToAnnounce = this.getParameterLabel(signature, activeParameterIndex);\r\n            // Select method gets called on every user type while parameter hints are visible.\r\n            // We do not want to spam the user with same announcements, so we only announce if the current parameter changed.\r\n            if (this.announcedLabel !== labelToAnnounce) {\r\n                aria.alert(nls.localize('hint', \"{0}, hint\", labelToAnnounce));\r\n                this.announcedLabel = labelToAnnounce;\r\n            }\r\n        }\r\n        this.editor.layoutContentWidget(this);\r\n        this.domNodes.scrollbar.scanDomNode();\r\n    }\r\n    renderMarkdownDocs(markdown) {\r\n        const renderedContents = this.renderDisposeables.add(this.markdownRenderer.render(markdown, {\r\n            asyncRenderCallback: () => {\r\n                var _a;\r\n                (_a = this.domNodes) === null || _a === void 0 ? void 0 : _a.scrollbar.scanDomNode();\r\n            }\r\n        }));\r\n        renderedContents.element.classList.add('markdown-docs');\r\n        return renderedContents;\r\n    }\r\n    hasDocs(signature, activeParameter) {\r\n        if (activeParameter && typeof activeParameter.documentation === 'string' && assertIsDefined(activeParameter.documentation).length > 0) {\r\n            return true;\r\n        }\r\n        if (activeParameter && typeof activeParameter.documentation === 'object' && assertIsDefined(activeParameter.documentation).value.length > 0) {\r\n            return true;\r\n        }\r\n        if (signature.documentation && typeof signature.documentation === 'string' && assertIsDefined(signature.documentation).length > 0) {\r\n            return true;\r\n        }\r\n        if (signature.documentation && typeof signature.documentation === 'object' && assertIsDefined(signature.documentation.value).length > 0) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    renderParameters(parent, signature, activeParameterIndex) {\r\n        const [start, end] = this.getParameterLabelOffsets(signature, activeParameterIndex);\r\n        const beforeSpan = document.createElement('span');\r\n        beforeSpan.textContent = signature.label.substring(0, start);\r\n        const paramSpan = document.createElement('span');\r\n        paramSpan.textContent = signature.label.substring(start, end);\r\n        paramSpan.className = 'parameter active';\r\n        const afterSpan = document.createElement('span');\r\n        afterSpan.textContent = signature.label.substring(end);\r\n        dom.append(parent, beforeSpan, paramSpan, afterSpan);\r\n    }\r\n    getParameterLabel(signature, paramIdx) {\r\n        const param = signature.parameters[paramIdx];\r\n        if (Array.isArray(param.label)) {\r\n            return signature.label.substring(param.label[0], param.label[1]);\r\n        }\r\n        else {\r\n            return param.label;\r\n        }\r\n    }\r\n    getParameterLabelOffsets(signature, paramIdx) {\r\n        const param = signature.parameters[paramIdx];\r\n        if (!param) {\r\n            return [0, 0];\r\n        }\r\n        else if (Array.isArray(param.label)) {\r\n            return param.label;\r\n        }\r\n        else if (!param.label.length) {\r\n            return [0, 0];\r\n        }\r\n        else {\r\n            const regex = new RegExp(`(\\\\W|^)${escapeRegExpCharacters(param.label)}(?=\\\\W|$)`, 'g');\r\n            regex.test(signature.label);\r\n            const idx = regex.lastIndex - param.label.length;\r\n            return idx >= 0\r\n                ? [idx, regex.lastIndex]\r\n                : [0, 0];\r\n        }\r\n    }\r\n    next() {\r\n        this.editor.focus();\r\n        this.model.next();\r\n    }\r\n    previous() {\r\n        this.editor.focus();\r\n        this.model.previous();\r\n    }\r\n    cancel() {\r\n        this.model.cancel();\r\n    }\r\n    getDomNode() {\r\n        if (!this.domNodes) {\r\n            this.createParameterHintDOMNodes();\r\n        }\r\n        return this.domNodes.element;\r\n    }\r\n    getId() {\r\n        return ParameterHintsWidget.ID;\r\n    }\r\n    trigger(context) {\r\n        this.model.trigger(context, 0);\r\n    }\r\n    updateMaxHeight() {\r\n        if (!this.domNodes) {\r\n            return;\r\n        }\r\n        const height = Math.max(this.editor.getLayoutInfo().height / 4, 250);\r\n        const maxHeight = `${height}px`;\r\n        this.domNodes.element.style.maxHeight = maxHeight;\r\n        const wrapper = this.domNodes.element.getElementsByClassName('phwrapper');\r\n        if (wrapper.length) {\r\n            wrapper[0].style.maxHeight = maxHeight;\r\n        }\r\n    }\r\n};\r\nParameterHintsWidget.ID = 'editor.widget.parameterHintsWidget';\r\nParameterHintsWidget = __decorate([\r\n    __param(1, IContextKeyService),\r\n    __param(2, IOpenerService),\r\n    __param(3, IModeService)\r\n], ParameterHintsWidget);\r\nexport { ParameterHintsWidget };\r\nregisterThemingParticipant((theme, collector) => {\r\n    const border = theme.getColor(editorHoverBorder);\r\n    if (border) {\r\n        const borderWidth = theme.type === ColorScheme.HIGH_CONTRAST ? 2 : 1;\r\n        collector.addRule(`.monaco-editor .parameter-hints-widget { border: ${borderWidth}px solid ${border}; }`);\r\n        collector.addRule(`.monaco-editor .parameter-hints-widget.multiple .body { border-left: 1px solid ${border.transparent(0.5)}; }`);\r\n        collector.addRule(`.monaco-editor .parameter-hints-widget .signature.has-docs { border-bottom: 1px solid ${border.transparent(0.5)}; }`);\r\n    }\r\n    const background = theme.getColor(editorHoverBackground);\r\n    if (background) {\r\n        collector.addRule(`.monaco-editor .parameter-hints-widget { background-color: ${background}; }`);\r\n    }\r\n    const link = theme.getColor(textLinkForeground);\r\n    if (link) {\r\n        collector.addRule(`.monaco-editor .parameter-hints-widget a { color: ${link}; }`);\r\n    }\r\n    const foreground = theme.getColor(editorHoverForeground);\r\n    if (foreground) {\r\n        collector.addRule(`.monaco-editor .parameter-hints-widget { color: ${foreground}; }`);\r\n    }\r\n    const codeBackground = theme.getColor(textCodeBlockBackground);\r\n    if (codeBackground) {\r\n        collector.addRule(`.monaco-editor .parameter-hints-widget code { background-color: ${codeBackground}; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { ParameterHintsWidget } from './parameterHintsWidget.js';\r\nimport { Context } from './provideSignatureHelp.js';\r\nimport * as modes from '../../common/modes.js';\r\nlet ParameterHintsController = class ParameterHintsController extends Disposable {\r\n    constructor(editor, instantiationService) {\r\n        super();\r\n        this.editor = editor;\r\n        this.widget = this._register(instantiationService.createInstance(ParameterHintsWidget, this.editor));\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(ParameterHintsController.ID);\r\n    }\r\n    cancel() {\r\n        this.widget.cancel();\r\n    }\r\n    previous() {\r\n        this.widget.previous();\r\n    }\r\n    next() {\r\n        this.widget.next();\r\n    }\r\n    trigger(context) {\r\n        this.widget.trigger(context);\r\n    }\r\n};\r\nParameterHintsController.ID = 'editor.controller.parameterHints';\r\nParameterHintsController = __decorate([\r\n    __param(1, IInstantiationService)\r\n], ParameterHintsController);\r\nexport class TriggerParameterHintsAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.triggerParameterHints',\r\n            label: nls.localize('parameterHints.trigger.label', \"Trigger Parameter Hints\"),\r\n            alias: 'Trigger Parameter Hints',\r\n            precondition: EditorContextKeys.hasSignatureHelpProvider,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 10 /* Space */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        const controller = ParameterHintsController.get(editor);\r\n        if (controller) {\r\n            controller.trigger({\r\n                triggerKind: modes.SignatureHelpTriggerKind.Invoke\r\n            });\r\n        }\r\n    }\r\n}\r\nregisterEditorContribution(ParameterHintsController.ID, ParameterHintsController);\r\nregisterEditorAction(TriggerParameterHintsAction);\r\nconst weight = 100 /* EditorContrib */ + 75;\r\nconst ParameterHintsCommand = EditorCommand.bindToContribution(ParameterHintsController.get);\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'closeParameterHints',\r\n    precondition: Context.Visible,\r\n    handler: x => x.cancel(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'showPrevParameterHint',\r\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\r\n    handler: x => x.previous(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 16 /* UpArrow */,\r\n        secondary: [512 /* Alt */ | 16 /* UpArrow */],\r\n        mac: { primary: 16 /* UpArrow */, secondary: [512 /* Alt */ | 16 /* UpArrow */, 256 /* WinCtrl */ | 46 /* KEY_P */] }\r\n    }\r\n}));\r\nregisterEditorCommand(new ParameterHintsCommand({\r\n    id: 'showNextParameterHint',\r\n    precondition: ContextKeyExpr.and(Context.Visible, Context.MultipleSignatures),\r\n    handler: x => x.next(),\r\n    kbOpts: {\r\n        weight: weight,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 18 /* DownArrow */,\r\n        secondary: [512 /* Alt */ | 18 /* DownArrow */],\r\n        mac: { primary: 18 /* DownArrow */, secondary: [512 /* Alt */ | 18 /* DownArrow */, 256 /* WinCtrl */ | 44 /* KEY_N */] }\r\n    }\r\n}));\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport './renameInputField.css';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { localize } from '../../../nls.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { inputBackground, inputBorder, inputForeground, widgetShadow, editorWidgetBackground } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\r\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false, localize('renameInputVisible', \"Whether the rename input widget is visible\"));\r\nlet RenameInputField = class RenameInputField {\r\n    constructor(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService) {\r\n        this._editor = _editor;\r\n        this._acceptKeybindings = _acceptKeybindings;\r\n        this._themeService = _themeService;\r\n        this._keybindingService = _keybindingService;\r\n        this._disposables = new DisposableStore();\r\n        this.allowEditorOverflow = true;\r\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\r\n        this._editor.addContentWidget(this);\r\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\r\n            if (e.hasChanged(41 /* fontInfo */)) {\r\n                this._updateFont();\r\n            }\r\n        }));\r\n        this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\r\n    }\r\n    dispose() {\r\n        this._disposables.dispose();\r\n        this._editor.removeContentWidget(this);\r\n    }\r\n    getId() {\r\n        return '__renameInputWidget';\r\n    }\r\n    getDomNode() {\r\n        if (!this._domNode) {\r\n            this._domNode = document.createElement('div');\r\n            this._domNode.className = 'monaco-editor rename-box';\r\n            this._input = document.createElement('input');\r\n            this._input.className = 'rename-input';\r\n            this._input.type = 'text';\r\n            this._input.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\r\n            this._domNode.appendChild(this._input);\r\n            this._label = document.createElement('div');\r\n            this._label.className = 'rename-label';\r\n            this._domNode.appendChild(this._label);\r\n            const updateLabel = () => {\r\n                var _a, _b;\r\n                const [accept, preview] = this._acceptKeybindings;\r\n                this._keybindingService.lookupKeybinding(accept);\r\n                this._label.innerText = localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"'] }, \"{0} to Rename, {1} to Preview\", (_a = this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\r\n            };\r\n            updateLabel();\r\n            this._disposables.add(this._keybindingService.onDidUpdateKeybindings(updateLabel));\r\n            this._updateFont();\r\n            this._updateStyles(this._themeService.getColorTheme());\r\n        }\r\n        return this._domNode;\r\n    }\r\n    _updateStyles(theme) {\r\n        var _a, _b, _c, _d;\r\n        if (!this._input || !this._domNode) {\r\n            return;\r\n        }\r\n        const widgetShadowColor = theme.getColor(widgetShadow);\r\n        this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\r\n        this._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\r\n        this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\r\n        this._input.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\r\n        // this._input.style.color = String(theme.getColor(inputForeground) ?? '');\r\n        const border = theme.getColor(inputBorder);\r\n        this._input.style.borderWidth = border ? '1px' : '0px';\r\n        this._input.style.borderStyle = border ? 'solid' : 'none';\r\n        this._input.style.borderColor = (_d = border === null || border === void 0 ? void 0 : border.toString()) !== null && _d !== void 0 ? _d : 'none';\r\n    }\r\n    _updateFont() {\r\n        if (!this._input || !this._label) {\r\n            return;\r\n        }\r\n        const fontInfo = this._editor.getOption(41 /* fontInfo */);\r\n        this._input.style.fontFamily = fontInfo.fontFamily;\r\n        this._input.style.fontWeight = fontInfo.fontWeight;\r\n        this._input.style.fontSize = `${fontInfo.fontSize}px`;\r\n        this._label.style.fontSize = `${fontInfo.fontSize * 0.8}px`;\r\n    }\r\n    getPosition() {\r\n        if (!this._visible) {\r\n            return null;\r\n        }\r\n        return {\r\n            position: this._position,\r\n            preference: [2 /* BELOW */, 1 /* ABOVE */]\r\n        };\r\n    }\r\n    afterRender(position) {\r\n        if (!position) {\r\n            // cancel rename when input widget isn't rendered anymore\r\n            this.cancelInput(true);\r\n        }\r\n    }\r\n    acceptInput(wantsPreview) {\r\n        if (this._currentAcceptInput) {\r\n            this._currentAcceptInput(wantsPreview);\r\n        }\r\n    }\r\n    cancelInput(focusEditor) {\r\n        if (this._currentCancelInput) {\r\n            this._currentCancelInput(focusEditor);\r\n        }\r\n    }\r\n    getInput(where, value, selectionStart, selectionEnd, supportPreview, token) {\r\n        this._domNode.classList.toggle('preview', supportPreview);\r\n        this._position = new Position(where.startLineNumber, where.startColumn);\r\n        this._input.value = value;\r\n        this._input.setAttribute('selectionStart', selectionStart.toString());\r\n        this._input.setAttribute('selectionEnd', selectionEnd.toString());\r\n        this._input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\r\n        const disposeOnDone = new DisposableStore();\r\n        return new Promise(resolve => {\r\n            this._currentCancelInput = (focusEditor) => {\r\n                this._currentAcceptInput = undefined;\r\n                this._currentCancelInput = undefined;\r\n                resolve(focusEditor);\r\n                return true;\r\n            };\r\n            this._currentAcceptInput = (wantsPreview) => {\r\n                if (this._input.value.trim().length === 0 || this._input.value === value) {\r\n                    // empty or whitespace only or not changed\r\n                    this.cancelInput(true);\r\n                    return;\r\n                }\r\n                this._currentAcceptInput = undefined;\r\n                this._currentCancelInput = undefined;\r\n                resolve({\r\n                    newName: this._input.value,\r\n                    wantsPreview: supportPreview && wantsPreview\r\n                });\r\n            };\r\n            token.onCancellationRequested(() => this.cancelInput(true));\r\n            disposeOnDone.add(this._editor.onDidBlurEditorWidget(() => this.cancelInput(false)));\r\n            this._show();\r\n        }).finally(() => {\r\n            disposeOnDone.dispose();\r\n            this._hide();\r\n        });\r\n    }\r\n    _show() {\r\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* Smooth */);\r\n        this._visible = true;\r\n        this._visibleContextKey.set(true);\r\n        this._editor.layoutContentWidget(this);\r\n        setTimeout(() => {\r\n            this._input.focus();\r\n            this._input.setSelectionRange(parseInt(this._input.getAttribute('selectionStart')), parseInt(this._input.getAttribute('selectionEnd')));\r\n        }, 100);\r\n    }\r\n    _hide() {\r\n        this._visible = false;\r\n        this._visibleContextKey.reset();\r\n        this._editor.layoutContentWidget(this);\r\n    }\r\n};\r\nRenameInputField = __decorate([\r\n    __param(2, IThemeService),\r\n    __param(3, IKeybindingService),\r\n    __param(4, IContextKeyService)\r\n], RenameInputField);\r\nexport { RenameInputField };\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { onUnexpectedError } from '../../../base/common/errors.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { IEditorProgressService } from '../../../platform/progress/common/progress.js';\r\nimport { registerEditorAction, registerEditorContribution, EditorAction, EditorCommand, registerEditorCommand, registerModelAndPositionCommand } from '../../browser/editorExtensions.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { RenameInputField, CONTEXT_RENAME_INPUT_VISIBLE } from './renameInputField.js';\r\nimport { RenameProviderRegistry } from '../../common/modes.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { MessageController } from '../message/messageController.js';\r\nimport { EditorStateCancellationTokenSource } from '../../browser/core/editorState.js';\r\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\r\nimport { IBulkEditService, ResourceEdit } from '../../browser/services/bulkEditService.js';\r\nimport { URI } from '../../../base/common/uri.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { CancellationToken, CancellationTokenSource } from '../../../base/common/cancellation.js';\r\nimport { DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { IdleValue, raceCancellation } from '../../../base/common/async.js';\r\nimport { ILogService } from '../../../platform/log/common/log.js';\r\nimport { IInstantiationService } from '../../../platform/instantiation/common/instantiation.js';\r\nimport { Registry } from '../../../platform/registry/common/platform.js';\r\nimport { Extensions } from '../../../platform/configuration/common/configurationRegistry.js';\r\nimport { ITextResourceConfigurationService } from '../../common/services/textResourceConfigurationService.js';\r\nimport { assertType } from '../../../base/common/types.js';\r\nclass RenameSkeleton {\r\n    constructor(model, position) {\r\n        this.model = model;\r\n        this.position = position;\r\n        this._providerRenameIdx = 0;\r\n        this._providers = RenameProviderRegistry.ordered(model);\r\n    }\r\n    hasProvider() {\r\n        return this._providers.length > 0;\r\n    }\r\n    resolveRenameLocation(token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const rejects = [];\r\n            for (this._providerRenameIdx = 0; this._providerRenameIdx < this._providers.length; this._providerRenameIdx++) {\r\n                const provider = this._providers[this._providerRenameIdx];\r\n                if (!provider.resolveRenameLocation) {\r\n                    break;\r\n                }\r\n                let res = yield provider.resolveRenameLocation(this.model, this.position, token);\r\n                if (!res) {\r\n                    continue;\r\n                }\r\n                if (res.rejectReason) {\r\n                    rejects.push(res.rejectReason);\r\n                    continue;\r\n                }\r\n                return res;\r\n            }\r\n            const word = this.model.getWordAtPosition(this.position);\r\n            if (!word) {\r\n                return {\r\n                    range: Range.fromPositions(this.position),\r\n                    text: '',\r\n                    rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\r\n                };\r\n            }\r\n            return {\r\n                range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\r\n                text: word.word,\r\n                rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\r\n            };\r\n        });\r\n    }\r\n    provideRenameEdits(newName, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            return this._provideRenameEdits(newName, this._providerRenameIdx, [], token);\r\n        });\r\n    }\r\n    _provideRenameEdits(newName, i, rejects, token) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            const provider = this._providers[i];\r\n            if (!provider) {\r\n                return {\r\n                    edits: [],\r\n                    rejectReason: rejects.join('\\n')\r\n                };\r\n            }\r\n            const result = yield provider.provideRenameEdits(this.model, this.position, newName, token);\r\n            if (!result) {\r\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token);\r\n            }\r\n            else if (result.rejectReason) {\r\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token);\r\n            }\r\n            return result;\r\n        });\r\n    }\r\n}\r\nexport function rename(model, position, newName) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const skeleton = new RenameSkeleton(model, position);\r\n        const loc = yield skeleton.resolveRenameLocation(CancellationToken.None);\r\n        if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\r\n            return { edits: [], rejectReason: loc.rejectReason };\r\n        }\r\n        return skeleton.provideRenameEdits(newName, CancellationToken.None);\r\n    });\r\n}\r\n// ---  register actions and commands\r\nlet RenameController = class RenameController {\r\n    constructor(editor, _instaService, _notificationService, _bulkEditService, _progressService, _logService, _configService) {\r\n        this.editor = editor;\r\n        this._instaService = _instaService;\r\n        this._notificationService = _notificationService;\r\n        this._bulkEditService = _bulkEditService;\r\n        this._progressService = _progressService;\r\n        this._logService = _logService;\r\n        this._configService = _configService;\r\n        this._dispoableStore = new DisposableStore();\r\n        this._cts = new CancellationTokenSource();\r\n        this._renameInputField = this._dispoableStore.add(new IdleValue(() => this._dispoableStore.add(this._instaService.createInstance(RenameInputField, this.editor, ['acceptRenameInput', 'acceptRenameInputWithPreview']))));\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(RenameController.ID);\r\n    }\r\n    dispose() {\r\n        this._dispoableStore.dispose();\r\n        this._cts.dispose(true);\r\n    }\r\n    run() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            this._cts.dispose(true);\r\n            if (!this.editor.hasModel()) {\r\n                return undefined;\r\n            }\r\n            const position = this.editor.getPosition();\r\n            const skeleton = new RenameSkeleton(this.editor.getModel(), position);\r\n            if (!skeleton.hasProvider()) {\r\n                return undefined;\r\n            }\r\n            this._cts = new EditorStateCancellationTokenSource(this.editor, 4 /* Position */ | 1 /* Value */);\r\n            // resolve rename location\r\n            let loc;\r\n            try {\r\n                const resolveLocationOperation = skeleton.resolveRenameLocation(this._cts.token);\r\n                this._progressService.showWhile(resolveLocationOperation, 250);\r\n                loc = yield resolveLocationOperation;\r\n            }\r\n            catch (e) {\r\n                MessageController.get(this.editor).showMessage(e || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\r\n                return undefined;\r\n            }\r\n            if (!loc) {\r\n                return undefined;\r\n            }\r\n            if (loc.rejectReason) {\r\n                MessageController.get(this.editor).showMessage(loc.rejectReason, position);\r\n                return undefined;\r\n            }\r\n            if (this._cts.token.isCancellationRequested) {\r\n                return undefined;\r\n            }\r\n            this._cts.dispose();\r\n            this._cts = new EditorStateCancellationTokenSource(this.editor, 4 /* Position */ | 1 /* Value */, loc.range);\r\n            // do rename at location\r\n            let selection = this.editor.getSelection();\r\n            let selectionStart = 0;\r\n            let selectionEnd = loc.text.length;\r\n            if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(loc.range, selection)) {\r\n                selectionStart = Math.max(0, selection.startColumn - loc.range.startColumn);\r\n                selectionEnd = Math.min(loc.range.endColumn, selection.endColumn) - loc.range.startColumn;\r\n            }\r\n            const supportPreview = this._bulkEditService.hasPreviewHandler() && this._configService.getValue(this.editor.getModel().uri, 'editor.rename.enablePreview');\r\n            const inputFieldResult = yield this._renameInputField.value.getInput(loc.range, loc.text, selectionStart, selectionEnd, supportPreview, this._cts.token);\r\n            // no result, only hint to focus the editor or not\r\n            if (typeof inputFieldResult === 'boolean') {\r\n                if (inputFieldResult) {\r\n                    this.editor.focus();\r\n                }\r\n                return undefined;\r\n            }\r\n            this.editor.focus();\r\n            const renameOperation = raceCancellation(skeleton.provideRenameEdits(inputFieldResult.newName, this._cts.token), this._cts.token).then((renameResult) => __awaiter(this, void 0, void 0, function* () {\r\n                if (!renameResult || !this.editor.hasModel()) {\r\n                    return;\r\n                }\r\n                if (renameResult.rejectReason) {\r\n                    this._notificationService.info(renameResult.rejectReason);\r\n                    return;\r\n                }\r\n                this._bulkEditService.apply(ResourceEdit.convert(renameResult), {\r\n                    editor: this.editor,\r\n                    showPreview: inputFieldResult.wantsPreview,\r\n                    label: nls.localize('label', \"Renaming '{0}'\", loc === null || loc === void 0 ? void 0 : loc.text),\r\n                    quotableLabel: nls.localize('quotableLabel', \"Renaming {0}\", loc === null || loc === void 0 ? void 0 : loc.text),\r\n                }).then(result => {\r\n                    if (result.ariaSummary) {\r\n                        alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, inputFieldResult.newName, result.ariaSummary));\r\n                    }\r\n                }).catch(err => {\r\n                    this._notificationService.error(nls.localize('rename.failedApply', \"Rename failed to apply edits\"));\r\n                    this._logService.error(err);\r\n                });\r\n            }), err => {\r\n                this._notificationService.error(nls.localize('rename.failed', \"Rename failed to compute edits\"));\r\n                this._logService.error(err);\r\n            });\r\n            this._progressService.showWhile(renameOperation, 250);\r\n            return renameOperation;\r\n        });\r\n    }\r\n    acceptRenameInput(wantsPreview) {\r\n        this._renameInputField.value.acceptInput(wantsPreview);\r\n    }\r\n    cancelRenameInput() {\r\n        this._renameInputField.value.cancelInput(true);\r\n    }\r\n};\r\nRenameController.ID = 'editor.contrib.renameController';\r\nRenameController = __decorate([\r\n    __param(1, IInstantiationService),\r\n    __param(2, INotificationService),\r\n    __param(3, IBulkEditService),\r\n    __param(4, IEditorProgressService),\r\n    __param(5, ILogService),\r\n    __param(6, ITextResourceConfigurationService)\r\n], RenameController);\r\n// ---- action implementation\r\nexport class RenameAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.rename',\r\n            label: nls.localize('rename.label', \"Rename Symbol\"),\r\n            alias: 'Rename Symbol',\r\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 60 /* F2 */,\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            contextMenuOpts: {\r\n                group: '1_modification',\r\n                order: 1.1\r\n            }\r\n        });\r\n    }\r\n    runCommand(accessor, args) {\r\n        const editorService = accessor.get(ICodeEditorService);\r\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\r\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\r\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\r\n                if (!editor) {\r\n                    return;\r\n                }\r\n                editor.setPosition(pos);\r\n                editor.invokeWithinContext(accessor => {\r\n                    this.reportTelemetry(accessor, editor);\r\n                    return this.run(accessor, editor);\r\n                });\r\n            }, onUnexpectedError);\r\n        }\r\n        return super.runCommand(accessor, args);\r\n    }\r\n    run(accessor, editor) {\r\n        const controller = RenameController.get(editor);\r\n        if (controller) {\r\n            return controller.run();\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n}\r\nregisterEditorContribution(RenameController.ID, RenameController);\r\nregisterEditorAction(RenameAction);\r\nconst RenameCommand = EditorCommand.bindToContribution(RenameController.get);\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'acceptRenameInput',\r\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\r\n    handler: x => x.acceptRenameInput(false),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'acceptRenameInputWithPreview',\r\n    precondition: ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE, ContextKeyExpr.has('config.editor.rename.enablePreview')),\r\n    handler: x => x.acceptRenameInput(true),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 1024 /* Shift */ + 3 /* Enter */\r\n    }\r\n}));\r\nregisterEditorCommand(new RenameCommand({\r\n    id: 'cancelRenameInput',\r\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\r\n    handler: x => x.cancelRenameInput(),\r\n    kbOpts: {\r\n        weight: 100 /* EditorContrib */ + 99,\r\n        kbExpr: EditorContextKeys.focus,\r\n        primary: 9 /* Escape */,\r\n        secondary: [1024 /* Shift */ | 9 /* Escape */]\r\n    }\r\n}));\r\n// ---- api bridge command\r\nregisterModelAndPositionCommand('_executeDocumentRenameProvider', function (model, position, ...args) {\r\n    const [newName] = args;\r\n    assertType(typeof newName === 'string');\r\n    return rename(model, position, newName);\r\n});\r\n//todo@jrieken use editor options world\r\nRegistry.as(Extensions.Configuration).registerConfiguration({\r\n    id: 'editor',\r\n    properties: {\r\n        'editor.rename.enablePreview': {\r\n            scope: 5 /* LANGUAGE_OVERRIDABLE */,\r\n            description: nls.localize('enablePreview', \"Enable/disable the ability to preview changes before renaming\"),\r\n            default: true,\r\n            type: 'boolean'\r\n        }\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Range } from '../../common/core/range.js';\r\nimport { isUpperAsciiLetter, isLowerAsciiLetter } from '../../../base/common/strings.js';\r\nexport class WordSelectionRangeProvider {\r\n    provideSelectionRanges(model, positions) {\r\n        const result = [];\r\n        for (const position of positions) {\r\n            const bucket = [];\r\n            result.push(bucket);\r\n            this._addInWordRanges(bucket, model, position);\r\n            this._addWordRanges(bucket, model, position);\r\n            this._addWhitespaceLine(bucket, model, position);\r\n            bucket.push({ range: model.getFullModelRange() });\r\n        }\r\n        return result;\r\n    }\r\n    _addInWordRanges(bucket, model, pos) {\r\n        const obj = model.getWordAtPosition(pos);\r\n        if (!obj) {\r\n            return;\r\n        }\r\n        let { word, startColumn } = obj;\r\n        let offset = pos.column - startColumn;\r\n        let start = offset;\r\n        let end = offset;\r\n        let lastCh = 0;\r\n        // LEFT anchor (start)\r\n        for (; start >= 0; start--) {\r\n            let ch = word.charCodeAt(start);\r\n            if ((start !== offset) && (ch === 95 /* Underline */ || ch === 45 /* Dash */)) {\r\n                // foo-bar OR foo_bar\r\n                break;\r\n            }\r\n            else if (isLowerAsciiLetter(ch) && isUpperAsciiLetter(lastCh)) {\r\n                // fooBar\r\n                break;\r\n            }\r\n            lastCh = ch;\r\n        }\r\n        start += 1;\r\n        // RIGHT anchor (end)\r\n        for (; end < word.length; end++) {\r\n            let ch = word.charCodeAt(end);\r\n            if (isUpperAsciiLetter(ch) && isLowerAsciiLetter(lastCh)) {\r\n                // fooBar\r\n                break;\r\n            }\r\n            else if (ch === 95 /* Underline */ || ch === 45 /* Dash */) {\r\n                // foo-bar OR foo_bar\r\n                break;\r\n            }\r\n            lastCh = ch;\r\n        }\r\n        if (start < end) {\r\n            bucket.push({ range: new Range(pos.lineNumber, startColumn + start, pos.lineNumber, startColumn + end) });\r\n        }\r\n    }\r\n    _addWordRanges(bucket, model, pos) {\r\n        const word = model.getWordAtPosition(pos);\r\n        if (word) {\r\n            bucket.push({ range: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn) });\r\n        }\r\n    }\r\n    _addWhitespaceLine(bucket, model, pos) {\r\n        if (model.getLineLength(pos.lineNumber) > 0\r\n            && model.getLineFirstNonWhitespaceColumn(pos.lineNumber) === 0\r\n            && model.getLineLastNonWhitespaceColumn(pos.lineNumber) === 0) {\r\n            bucket.push({ range: new Range(pos.lineNumber, 1, pos.lineNumber, model.getLineMaxColumn(pos.lineNumber)) });\r\n        }\r\n    }\r\n}\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as arrays from '../../../base/common/arrays.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerModelCommand } from '../../browser/editorExtensions.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport * as modes from '../../common/modes.js';\r\nimport * as nls from '../../../nls.js';\r\nimport { MenuId } from '../../../platform/actions/common/actions.js';\r\nimport { WordSelectionRangeProvider } from './wordSelections.js';\r\nimport { BracketSelectionRangeProvider } from './bracketSelections.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nimport { onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nclass SelectionRanges {\r\n    constructor(index, ranges) {\r\n        this.index = index;\r\n        this.ranges = ranges;\r\n    }\r\n    mov(fwd) {\r\n        let index = this.index + (fwd ? 1 : -1);\r\n        if (index < 0 || index >= this.ranges.length) {\r\n            return this;\r\n        }\r\n        const res = new SelectionRanges(index, this.ranges);\r\n        if (res.ranges[index].equalsRange(this.ranges[this.index])) {\r\n            // next range equals this range, retry with next-next\r\n            return res.mov(fwd);\r\n        }\r\n        return res;\r\n    }\r\n}\r\nclass SmartSelectController {\r\n    constructor(_editor) {\r\n        this._editor = _editor;\r\n        this._ignoreSelection = false;\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(SmartSelectController.ID);\r\n    }\r\n    dispose() {\r\n        var _a;\r\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\r\n    }\r\n    run(forward) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (!this._editor.hasModel()) {\r\n                return;\r\n            }\r\n            const selections = this._editor.getSelections();\r\n            const model = this._editor.getModel();\r\n            if (!modes.SelectionRangeRegistry.has(model)) {\r\n                return;\r\n            }\r\n            if (!this._state) {\r\n                yield provideSelectionRanges(model, selections.map(s => s.getPosition()), this._editor.getOption(101 /* smartSelect */), CancellationToken.None).then(ranges => {\r\n                    var _a;\r\n                    if (!arrays.isNonEmptyArray(ranges) || ranges.length !== selections.length) {\r\n                        // invalid result\r\n                        return;\r\n                    }\r\n                    if (!this._editor.hasModel() || !arrays.equals(this._editor.getSelections(), selections, (a, b) => a.equalsSelection(b))) {\r\n                        // invalid editor state\r\n                        return;\r\n                    }\r\n                    for (let i = 0; i < ranges.length; i++) {\r\n                        ranges[i] = ranges[i].filter(range => {\r\n                            // filter ranges inside the selection\r\n                            return range.containsPosition(selections[i].getStartPosition()) && range.containsPosition(selections[i].getEndPosition());\r\n                        });\r\n                        // prepend current selection\r\n                        ranges[i].unshift(selections[i]);\r\n                    }\r\n                    this._state = ranges.map(ranges => new SelectionRanges(0, ranges));\r\n                    // listen to caret move and forget about state\r\n                    (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\r\n                    this._selectionListener = this._editor.onDidChangeCursorPosition(() => {\r\n                        var _a;\r\n                        if (!this._ignoreSelection) {\r\n                            (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\r\n                            this._state = undefined;\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n            if (!this._state) {\r\n                // no state\r\n                return;\r\n            }\r\n            this._state = this._state.map(state => state.mov(forward));\r\n            const newSelections = this._state.map(state => Selection.fromPositions(state.ranges[state.index].getStartPosition(), state.ranges[state.index].getEndPosition()));\r\n            this._ignoreSelection = true;\r\n            try {\r\n                this._editor.setSelections(newSelections);\r\n            }\r\n            finally {\r\n                this._ignoreSelection = false;\r\n            }\r\n        });\r\n    }\r\n}\r\nSmartSelectController.ID = 'editor.contrib.smartSelectController';\r\nclass AbstractSmartSelect extends EditorAction {\r\n    constructor(forward, opts) {\r\n        super(opts);\r\n        this._forward = forward;\r\n    }\r\n    run(_accessor, editor) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            let controller = SmartSelectController.get(editor);\r\n            if (controller) {\r\n                yield controller.run(this._forward);\r\n            }\r\n        });\r\n    }\r\n}\r\nclass GrowSelectionAction extends AbstractSmartSelect {\r\n    constructor() {\r\n        super(true, {\r\n            id: 'editor.action.smartSelect.expand',\r\n            label: nls.localize('smartSelect.expand', \"Expand Selection\"),\r\n            alias: 'Expand Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 17 /* RightArrow */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 256 /* WinCtrl */ | 1024 /* Shift */ | 17 /* RightArrow */,\r\n                    secondary: [256 /* WinCtrl */ | 1024 /* Shift */ | 17 /* RightArrow */],\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '1_basic',\r\n                title: nls.localize({ key: 'miSmartSelectGrow', comment: ['&& denotes a mnemonic'] }, \"&&Expand Selection\"),\r\n                order: 2\r\n            }\r\n        });\r\n    }\r\n}\r\n// renamed command id\r\nCommandsRegistry.registerCommandAlias('editor.action.smartSelect.grow', 'editor.action.smartSelect.expand');\r\nclass ShrinkSelectionAction extends AbstractSmartSelect {\r\n    constructor() {\r\n        super(false, {\r\n            id: 'editor.action.smartSelect.shrink',\r\n            label: nls.localize('smartSelect.shrink', \"Shrink Selection\"),\r\n            alias: 'Shrink Selection',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 512 /* Alt */ | 15 /* LeftArrow */,\r\n                mac: {\r\n                    primary: 2048 /* CtrlCmd */ | 256 /* WinCtrl */ | 1024 /* Shift */ | 15 /* LeftArrow */,\r\n                    secondary: [256 /* WinCtrl */ | 1024 /* Shift */ | 15 /* LeftArrow */],\r\n                },\r\n                weight: 100 /* EditorContrib */\r\n            },\r\n            menuOpts: {\r\n                menuId: MenuId.MenubarSelectionMenu,\r\n                group: '1_basic',\r\n                title: nls.localize({ key: 'miSmartSelectShrink', comment: ['&& denotes a mnemonic'] }, \"&&Shrink Selection\"),\r\n                order: 3\r\n            }\r\n        });\r\n    }\r\n}\r\nregisterEditorContribution(SmartSelectController.ID, SmartSelectController);\r\nregisterEditorAction(GrowSelectionAction);\r\nregisterEditorAction(ShrinkSelectionAction);\r\n// word selection\r\nmodes.SelectionRangeRegistry.register('*', new WordSelectionRangeProvider());\r\nexport function provideSelectionRanges(model, positions, options, token) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const providers = modes.SelectionRangeRegistry.all(model);\r\n        if (providers.length === 1) {\r\n            // add word selection and bracket selection when no provider exists\r\n            providers.unshift(new BracketSelectionRangeProvider());\r\n        }\r\n        let work = [];\r\n        let allRawRanges = [];\r\n        for (const provider of providers) {\r\n            work.push(Promise.resolve(provider.provideSelectionRanges(model, positions, token)).then(allProviderRanges => {\r\n                if (arrays.isNonEmptyArray(allProviderRanges) && allProviderRanges.length === positions.length) {\r\n                    for (let i = 0; i < positions.length; i++) {\r\n                        if (!allRawRanges[i]) {\r\n                            allRawRanges[i] = [];\r\n                        }\r\n                        for (const oneProviderRanges of allProviderRanges[i]) {\r\n                            if (Range.isIRange(oneProviderRanges.range) && Range.containsPosition(oneProviderRanges.range, positions[i])) {\r\n                                allRawRanges[i].push(Range.lift(oneProviderRanges.range));\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }, onUnexpectedExternalError));\r\n        }\r\n        yield Promise.all(work);\r\n        return allRawRanges.map(oneRawRanges => {\r\n            if (oneRawRanges.length === 0) {\r\n                return [];\r\n            }\r\n            // sort all by start/end position\r\n            oneRawRanges.sort((a, b) => {\r\n                if (Position.isBefore(a.getStartPosition(), b.getStartPosition())) {\r\n                    return 1;\r\n                }\r\n                else if (Position.isBefore(b.getStartPosition(), a.getStartPosition())) {\r\n                    return -1;\r\n                }\r\n                else if (Position.isBefore(a.getEndPosition(), b.getEndPosition())) {\r\n                    return -1;\r\n                }\r\n                else if (Position.isBefore(b.getEndPosition(), a.getEndPosition())) {\r\n                    return 1;\r\n                }\r\n                else {\r\n                    return 0;\r\n                }\r\n            });\r\n            // remove ranges that don't contain the former range or that are equal to the\r\n            // former range\r\n            let oneRanges = [];\r\n            let last;\r\n            for (const range of oneRawRanges) {\r\n                if (!last || (Range.containsRange(range, last) && !Range.equalsRange(range, last))) {\r\n                    oneRanges.push(range);\r\n                    last = range;\r\n                }\r\n            }\r\n            if (!options.selectLeadingAndTrailingWhitespace) {\r\n                return oneRanges;\r\n            }\r\n            // add ranges that expand trivia at line starts and ends whenever a range\r\n            // wraps onto the a new line\r\n            let oneRangesWithTrivia = [oneRanges[0]];\r\n            for (let i = 1; i < oneRanges.length; i++) {\r\n                const prev = oneRanges[i - 1];\r\n                const cur = oneRanges[i];\r\n                if (cur.startLineNumber !== prev.startLineNumber || cur.endLineNumber !== prev.endLineNumber) {\r\n                    // add line/block range without leading/failing whitespace\r\n                    const rangeNoWhitespace = new Range(prev.startLineNumber, model.getLineFirstNonWhitespaceColumn(prev.startLineNumber), prev.endLineNumber, model.getLineLastNonWhitespaceColumn(prev.endLineNumber));\r\n                    if (rangeNoWhitespace.containsRange(prev) && !rangeNoWhitespace.equalsRange(prev) && cur.containsRange(rangeNoWhitespace) && !cur.equalsRange(rangeNoWhitespace)) {\r\n                        oneRangesWithTrivia.push(rangeNoWhitespace);\r\n                    }\r\n                    // add line/block range\r\n                    const rangeFull = new Range(prev.startLineNumber, 1, prev.endLineNumber, model.getLineMaxColumn(prev.endLineNumber));\r\n                    if (rangeFull.containsRange(prev) && !rangeFull.equalsRange(rangeNoWhitespace) && cur.containsRange(rangeFull) && !cur.equalsRange(rangeFull)) {\r\n                        oneRangesWithTrivia.push(rangeFull);\r\n                    }\r\n                }\r\n                oneRangesWithTrivia.push(cur);\r\n            }\r\n            return oneRangesWithTrivia;\r\n        });\r\n    });\r\n}\r\nregisterModelCommand('_executeSelectionRangeProvider', function (model, ...args) {\r\n    const [positions] = args;\r\n    return provideSelectionRanges(model, positions, { selectLeadingAndTrailingWhitespace: true }, CancellationToken.None);\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { StopWatch } from '../../../base/common/stopwatch.js';\r\nclass ForceRetokenizeAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.forceRetokenize',\r\n            label: nls.localize('forceRetokenize', \"Developer: Force Retokenize\"),\r\n            alias: 'Developer: Force Retokenize',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = editor.getModel();\r\n        model.resetTokenization();\r\n        const sw = new StopWatch(true);\r\n        model.forceTokenization(model.getLineCount());\r\n        sw.stop();\r\n        console.log(`tokenization took ${sw.elapsed()}`);\r\n    }\r\n}\r\nregisterEditorAction(ForceRetokenizeAction);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nimport { EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { TabFocus } from '../../common/config/commonEditorConfig.js';\r\nexport class ToggleTabFocusModeAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: ToggleTabFocusModeAction.ID,\r\n            label: nls.localize({ key: 'toggle.tabMovesFocus', comment: ['Turn on/off use of tab key for moving focus around VS Code'] }, \"Toggle Tab Key Moves Focus\"),\r\n            alias: 'Toggle Tab Key Moves Focus',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: null,\r\n                primary: 2048 /* CtrlCmd */ | 43 /* KEY_M */,\r\n                mac: { primary: 256 /* WinCtrl */ | 1024 /* Shift */ | 43 /* KEY_M */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor) {\r\n        const oldValue = TabFocus.getTabFocusMode();\r\n        const newValue = !oldValue;\r\n        TabFocus.setTabFocusMode(newValue);\r\n        if (newValue) {\r\n            alert(nls.localize('toggle.tabMovesFocus.on', \"Pressing Tab will now move focus to the next focusable element\"));\r\n        }\r\n        else {\r\n            alert(nls.localize('toggle.tabMovesFocus.off', \"Pressing Tab will now insert the tab character\"));\r\n        }\r\n    }\r\n}\r\nToggleTabFocusModeAction.ID = 'editor.action.toggleTabFocusMode';\r\nregisterEditorAction(ToggleTabFocusModeAction);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { ICodeEditorService } from '../../browser/services/codeEditorService.js';\r\nimport { IDialogService } from '../../../platform/dialogs/common/dialogs.js';\r\nimport { basename } from '../../../base/common/resources.js';\r\nconst ignoreUnusualLineTerminators = 'ignoreUnusualLineTerminators';\r\nfunction writeIgnoreState(codeEditorService, model, state) {\r\n    codeEditorService.setModelProperty(model.uri, ignoreUnusualLineTerminators, state);\r\n}\r\nfunction readIgnoreState(codeEditorService, model) {\r\n    return codeEditorService.getModelProperty(model.uri, ignoreUnusualLineTerminators);\r\n}\r\nlet UnusualLineTerminatorsDetector = class UnusualLineTerminatorsDetector extends Disposable {\r\n    constructor(_editor, _dialogService, _codeEditorService) {\r\n        super();\r\n        this._editor = _editor;\r\n        this._dialogService = _dialogService;\r\n        this._codeEditorService = _codeEditorService;\r\n        this._config = this._editor.getOption(112 /* unusualLineTerminators */);\r\n        this._register(this._editor.onDidChangeConfiguration((e) => {\r\n            if (e.hasChanged(112 /* unusualLineTerminators */)) {\r\n                this._config = this._editor.getOption(112 /* unusualLineTerminators */);\r\n                this._checkForUnusualLineTerminators();\r\n            }\r\n        }));\r\n        this._register(this._editor.onDidChangeModel(() => {\r\n            this._checkForUnusualLineTerminators();\r\n        }));\r\n        this._register(this._editor.onDidChangeModelContent((e) => {\r\n            if (e.isUndoing) {\r\n                // skip checking in case of undoing\r\n                return;\r\n            }\r\n            this._checkForUnusualLineTerminators();\r\n        }));\r\n    }\r\n    _checkForUnusualLineTerminators() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this._config === 'off') {\r\n                return;\r\n            }\r\n            if (!this._editor.hasModel()) {\r\n                return;\r\n            }\r\n            const model = this._editor.getModel();\r\n            if (!model.mightContainUnusualLineTerminators()) {\r\n                return;\r\n            }\r\n            const ignoreState = readIgnoreState(this._codeEditorService, model);\r\n            if (ignoreState === true) {\r\n                // this model should be ignored\r\n                return;\r\n            }\r\n            if (this._editor.getOption(79 /* readOnly */)) {\r\n                // read only editor => sorry!\r\n                return;\r\n            }\r\n            if (this._config === 'auto') {\r\n                // just do it!\r\n                model.removeUnusualLineTerminators(this._editor.getSelections());\r\n                return;\r\n            }\r\n            const result = yield this._dialogService.confirm({\r\n                title: nls.localize('unusualLineTerminators.title', \"Unusual Line Terminators\"),\r\n                message: nls.localize('unusualLineTerminators.message', \"Detected unusual line terminators\"),\r\n                detail: nls.localize('unusualLineTerminators.detail', \"The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\\n\\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.\", basename(model.uri)),\r\n                primaryButton: nls.localize('unusualLineTerminators.fix', \"Remove Unusual Line Terminators\"),\r\n                secondaryButton: nls.localize('unusualLineTerminators.ignore', \"Ignore\")\r\n            });\r\n            if (!result.confirmed) {\r\n                // this model should be ignored\r\n                writeIgnoreState(this._codeEditorService, model, true);\r\n                return;\r\n            }\r\n            model.removeUnusualLineTerminators(this._editor.getSelections());\r\n        });\r\n    }\r\n};\r\nUnusualLineTerminatorsDetector.ID = 'editor.contrib.unusualLineTerminatorsDetector';\r\nUnusualLineTerminatorsDetector = __decorate([\r\n    __param(1, IDialogService),\r\n    __param(2, ICodeEditorService)\r\n], UnusualLineTerminatorsDetector);\r\nexport { UnusualLineTerminatorsDetector };\r\nregisterEditorContribution(UnusualLineTerminatorsDetector.ID, UnusualLineTerminatorsDetector);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport { RunOnceScheduler, createCancelablePromise } from '../../../base/common/async.js';\r\nimport { Disposable } from '../../../base/common/lifecycle.js';\r\nimport { registerEditorContribution } from '../../browser/editorExtensions.js';\r\nimport { DocumentRangeSemanticTokensProviderRegistry } from '../../common/modes.js';\r\nimport { IModelService } from '../../common/services/modelService.js';\r\nimport { toMultilineTokens2 } from '../../common/services/semanticTokensProviderStyling.js';\r\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\r\nimport { IConfigurationService } from '../../../platform/configuration/common/configuration.js';\r\nimport { isSemanticColoringEnabled, SEMANTIC_HIGHLIGHTING_SETTING_ID } from '../../common/services/modelServiceImpl.js';\r\nimport { getDocumentRangeSemanticTokensProvider } from '../../common/services/getSemanticTokens.js';\r\nlet ViewportSemanticTokensContribution = class ViewportSemanticTokensContribution extends Disposable {\r\n    constructor(editor, _modelService, _themeService, _configurationService) {\r\n        super();\r\n        this._modelService = _modelService;\r\n        this._themeService = _themeService;\r\n        this._configurationService = _configurationService;\r\n        this._editor = editor;\r\n        this._tokenizeViewport = new RunOnceScheduler(() => this._tokenizeViewportNow(), 100);\r\n        this._outstandingRequests = [];\r\n        this._register(this._editor.onDidScrollChange(() => {\r\n            this._tokenizeViewport.schedule();\r\n        }));\r\n        this._register(this._editor.onDidChangeModel(() => {\r\n            this._cancelAll();\r\n            this._tokenizeViewport.schedule();\r\n        }));\r\n        this._register(this._editor.onDidChangeModelContent((e) => {\r\n            this._cancelAll();\r\n            this._tokenizeViewport.schedule();\r\n        }));\r\n        this._register(DocumentRangeSemanticTokensProviderRegistry.onDidChange(() => {\r\n            this._cancelAll();\r\n            this._tokenizeViewport.schedule();\r\n        }));\r\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\r\n            if (e.affectsConfiguration(SEMANTIC_HIGHLIGHTING_SETTING_ID)) {\r\n                this._cancelAll();\r\n                this._tokenizeViewport.schedule();\r\n            }\r\n        }));\r\n        this._register(this._themeService.onDidColorThemeChange(() => {\r\n            this._cancelAll();\r\n            this._tokenizeViewport.schedule();\r\n        }));\r\n    }\r\n    _cancelAll() {\r\n        for (const request of this._outstandingRequests) {\r\n            request.cancel();\r\n        }\r\n        this._outstandingRequests = [];\r\n    }\r\n    _removeOutstandingRequest(req) {\r\n        for (let i = 0, len = this._outstandingRequests.length; i < len; i++) {\r\n            if (this._outstandingRequests[i] === req) {\r\n                this._outstandingRequests.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n    _tokenizeViewportNow() {\r\n        if (!this._editor.hasModel()) {\r\n            return;\r\n        }\r\n        const model = this._editor.getModel();\r\n        if (model.hasCompleteSemanticTokens()) {\r\n            return;\r\n        }\r\n        if (!isSemanticColoringEnabled(model, this._themeService, this._configurationService)) {\r\n            if (model.hasSomeSemanticTokens()) {\r\n                model.setSemanticTokens(null, false);\r\n            }\r\n            return;\r\n        }\r\n        const provider = getDocumentRangeSemanticTokensProvider(model);\r\n        if (!provider) {\r\n            if (model.hasSomeSemanticTokens()) {\r\n                model.setSemanticTokens(null, false);\r\n            }\r\n            return;\r\n        }\r\n        const styling = this._modelService.getSemanticTokensProviderStyling(provider);\r\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\r\n        this._outstandingRequests = this._outstandingRequests.concat(visibleRanges.map(range => this._requestRange(model, range, provider, styling)));\r\n    }\r\n    _requestRange(model, range, provider, styling) {\r\n        const requestVersionId = model.getVersionId();\r\n        const request = createCancelablePromise(token => Promise.resolve(provider.provideDocumentRangeSemanticTokens(model, range, token)));\r\n        request.then((r) => {\r\n            if (!r || model.isDisposed() || model.getVersionId() !== requestVersionId) {\r\n                return;\r\n            }\r\n            model.setPartialSemanticTokens(range, toMultilineTokens2(r, styling, model.getLanguageIdentifier()));\r\n        }).then(() => this._removeOutstandingRequest(request), () => this._removeOutstandingRequest(request));\r\n        return request;\r\n    }\r\n};\r\nViewportSemanticTokensContribution.ID = 'editor.contrib.viewportSemanticTokens';\r\nViewportSemanticTokensContribution = __decorate([\r\n    __param(1, IModelService),\r\n    __param(2, IThemeService),\r\n    __param(3, IConfigurationService)\r\n], ViewportSemanticTokensContribution);\r\nregisterEditorContribution(ViewportSemanticTokensContribution.ID, ViewportSemanticTokensContribution);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\nimport * as nls from '../../../nls.js';\r\nimport * as arrays from '../../../base/common/arrays.js';\r\nimport { createCancelablePromise, first, timeout } from '../../../base/common/async.js';\r\nimport { CancellationToken } from '../../../base/common/cancellation.js';\r\nimport { onUnexpectedError, onUnexpectedExternalError } from '../../../base/common/errors.js';\r\nimport { Disposable, DisposableStore } from '../../../base/common/lifecycle.js';\r\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerModelAndPositionCommand } from '../../browser/editorExtensions.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { OverviewRulerLane } from '../../common/model.js';\r\nimport { ModelDecorationOptions } from '../../common/model/textModel.js';\r\nimport { DocumentHighlightKind, DocumentHighlightProviderRegistry } from '../../common/modes.js';\r\nimport { IContextKeyService, RawContextKey } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { activeContrastBorder, editorSelectionHighlight, editorSelectionHighlightBorder, overviewRulerSelectionHighlightForeground, registerColor } from '../../../platform/theme/common/colorRegistry.js';\r\nimport { registerThemingParticipant, themeColorFromId } from '../../../platform/theme/common/themeService.js';\r\nimport { alert } from '../../../base/browser/ui/aria/aria.js';\r\nconst editorWordHighlight = registerColor('editor.wordHighlightBackground', { dark: '#575757B8', light: '#57575740', hc: null }, nls.localize('wordHighlight', 'Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nconst editorWordHighlightStrong = registerColor('editor.wordHighlightStrongBackground', { dark: '#004972B8', light: '#0e639c40', hc: null }, nls.localize('wordHighlightStrong', 'Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nconst editorWordHighlightBorder = registerColor('editor.wordHighlightBorder', { light: null, dark: null, hc: activeContrastBorder }, nls.localize('wordHighlightBorder', 'Border color of a symbol during read-access, like reading a variable.'));\r\nconst editorWordHighlightStrongBorder = registerColor('editor.wordHighlightStrongBorder', { light: null, dark: null, hc: activeContrastBorder }, nls.localize('wordHighlightStrongBorder', 'Border color of a symbol during write-access, like writing to a variable.'));\r\nconst overviewRulerWordHighlightForeground = registerColor('editorOverviewRuler.wordHighlightForeground', { dark: '#A0A0A0CC', light: '#A0A0A0CC', hc: '#A0A0A0CC' }, nls.localize('overviewRulerWordHighlightForeground', 'Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nconst overviewRulerWordHighlightStrongForeground = registerColor('editorOverviewRuler.wordHighlightStrongForeground', { dark: '#C0A0C0CC', light: '#C0A0C0CC', hc: '#C0A0C0CC' }, nls.localize('overviewRulerWordHighlightStrongForeground', 'Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations.'), true);\r\nconst ctxHasWordHighlights = new RawContextKey('hasWordHighlights', false);\r\nexport function getOccurrencesAtPosition(model, position, token) {\r\n    const orderedByScore = DocumentHighlightProviderRegistry.ordered(model);\r\n    // in order of score ask the occurrences provider\r\n    // until someone response with a good result\r\n    // (good = none empty array)\r\n    return first(orderedByScore.map(provider => () => {\r\n        return Promise.resolve(provider.provideDocumentHighlights(model, position, token))\r\n            .then(undefined, onUnexpectedExternalError);\r\n    }), arrays.isNonEmptyArray);\r\n}\r\nclass OccurenceAtPositionRequest {\r\n    constructor(model, selection, wordSeparators) {\r\n        this._wordRange = this._getCurrentWordRange(model, selection);\r\n        this.result = createCancelablePromise(token => this._compute(model, selection, wordSeparators, token));\r\n    }\r\n    _getCurrentWordRange(model, selection) {\r\n        const word = model.getWordAtPosition(selection.getPosition());\r\n        if (word) {\r\n            return new Range(selection.startLineNumber, word.startColumn, selection.startLineNumber, word.endColumn);\r\n        }\r\n        return null;\r\n    }\r\n    isValid(model, selection, decorationIds) {\r\n        const lineNumber = selection.startLineNumber;\r\n        const startColumn = selection.startColumn;\r\n        const endColumn = selection.endColumn;\r\n        const currentWordRange = this._getCurrentWordRange(model, selection);\r\n        let requestIsValid = Boolean(this._wordRange && this._wordRange.equalsRange(currentWordRange));\r\n        // Even if we are on a different word, if that word is in the decorations ranges, the request is still valid\r\n        // (Same symbol)\r\n        for (let i = 0, len = decorationIds.length; !requestIsValid && i < len; i++) {\r\n            let range = model.getDecorationRange(decorationIds[i]);\r\n            if (range && range.startLineNumber === lineNumber) {\r\n                if (range.startColumn <= startColumn && range.endColumn >= endColumn) {\r\n                    requestIsValid = true;\r\n                }\r\n            }\r\n        }\r\n        return requestIsValid;\r\n    }\r\n    cancel() {\r\n        this.result.cancel();\r\n    }\r\n}\r\nclass SemanticOccurenceAtPositionRequest extends OccurenceAtPositionRequest {\r\n    _compute(model, selection, wordSeparators, token) {\r\n        return getOccurrencesAtPosition(model, selection.getPosition(), token).then(value => value || []);\r\n    }\r\n}\r\nclass TextualOccurenceAtPositionRequest extends OccurenceAtPositionRequest {\r\n    constructor(model, selection, wordSeparators) {\r\n        super(model, selection, wordSeparators);\r\n        this._selectionIsEmpty = selection.isEmpty();\r\n    }\r\n    _compute(model, selection, wordSeparators, token) {\r\n        return timeout(250, token).then(() => {\r\n            if (!selection.isEmpty()) {\r\n                return [];\r\n            }\r\n            const word = model.getWordAtPosition(selection.getPosition());\r\n            if (!word || word.word.length > 1000) {\r\n                return [];\r\n            }\r\n            const matches = model.findMatches(word.word, true, false, true, wordSeparators, false);\r\n            return matches.map(m => {\r\n                return {\r\n                    range: m.range,\r\n                    kind: DocumentHighlightKind.Text\r\n                };\r\n            });\r\n        });\r\n    }\r\n    isValid(model, selection, decorationIds) {\r\n        const currentSelectionIsEmpty = selection.isEmpty();\r\n        if (this._selectionIsEmpty !== currentSelectionIsEmpty) {\r\n            return false;\r\n        }\r\n        return super.isValid(model, selection, decorationIds);\r\n    }\r\n}\r\nfunction computeOccurencesAtPosition(model, selection, wordSeparators) {\r\n    if (DocumentHighlightProviderRegistry.has(model)) {\r\n        return new SemanticOccurenceAtPositionRequest(model, selection, wordSeparators);\r\n    }\r\n    return new TextualOccurenceAtPositionRequest(model, selection, wordSeparators);\r\n}\r\nregisterModelAndPositionCommand('_executeDocumentHighlights', (model, position) => getOccurrencesAtPosition(model, position, CancellationToken.None));\r\nclass WordHighlighter {\r\n    constructor(editor, contextKeyService) {\r\n        this.toUnhook = new DisposableStore();\r\n        this.workerRequestTokenId = 0;\r\n        this.workerRequestCompleted = false;\r\n        this.workerRequestValue = [];\r\n        this.lastCursorPositionChangeTime = 0;\r\n        this.renderDecorationsTimer = -1;\r\n        this.editor = editor;\r\n        this._hasWordHighlights = ctxHasWordHighlights.bindTo(contextKeyService);\r\n        this._ignorePositionChangeEvent = false;\r\n        this.occurrencesHighlight = this.editor.getOption(70 /* occurrencesHighlight */);\r\n        this.model = this.editor.getModel();\r\n        this.toUnhook.add(editor.onDidChangeCursorPosition((e) => {\r\n            if (this._ignorePositionChangeEvent) {\r\n                // We are changing the position => ignore this event\r\n                return;\r\n            }\r\n            if (!this.occurrencesHighlight) {\r\n                // Early exit if nothing needs to be done!\r\n                // Leave some form of early exit check here if you wish to continue being a cursor position change listener ;)\r\n                return;\r\n            }\r\n            this._onPositionChanged(e);\r\n        }));\r\n        this.toUnhook.add(editor.onDidChangeModelContent((e) => {\r\n            this._stopAll();\r\n        }));\r\n        this.toUnhook.add(editor.onDidChangeConfiguration((e) => {\r\n            let newValue = this.editor.getOption(70 /* occurrencesHighlight */);\r\n            if (this.occurrencesHighlight !== newValue) {\r\n                this.occurrencesHighlight = newValue;\r\n                this._stopAll();\r\n            }\r\n        }));\r\n        this._decorationIds = [];\r\n        this.workerRequestTokenId = 0;\r\n        this.workerRequest = null;\r\n        this.workerRequestCompleted = false;\r\n        this.lastCursorPositionChangeTime = 0;\r\n        this.renderDecorationsTimer = -1;\r\n    }\r\n    hasDecorations() {\r\n        return (this._decorationIds.length > 0);\r\n    }\r\n    restore() {\r\n        if (!this.occurrencesHighlight) {\r\n            return;\r\n        }\r\n        this._run();\r\n    }\r\n    _getSortedHighlights() {\r\n        return arrays.coalesce(this._decorationIds\r\n            .map((id) => this.model.getDecorationRange(id))\r\n            .sort(Range.compareRangesUsingStarts));\r\n    }\r\n    moveNext() {\r\n        let highlights = this._getSortedHighlights();\r\n        let index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\r\n        let newIndex = ((index + 1) % highlights.length);\r\n        let dest = highlights[newIndex];\r\n        try {\r\n            this._ignorePositionChangeEvent = true;\r\n            this.editor.setPosition(dest.getStartPosition());\r\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\r\n            const word = this._getWord();\r\n            if (word) {\r\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\r\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\r\n            }\r\n        }\r\n        finally {\r\n            this._ignorePositionChangeEvent = false;\r\n        }\r\n    }\r\n    moveBack() {\r\n        let highlights = this._getSortedHighlights();\r\n        let index = highlights.findIndex((range) => range.containsPosition(this.editor.getPosition()));\r\n        let newIndex = ((index - 1 + highlights.length) % highlights.length);\r\n        let dest = highlights[newIndex];\r\n        try {\r\n            this._ignorePositionChangeEvent = true;\r\n            this.editor.setPosition(dest.getStartPosition());\r\n            this.editor.revealRangeInCenterIfOutsideViewport(dest);\r\n            const word = this._getWord();\r\n            if (word) {\r\n                const lineContent = this.editor.getModel().getLineContent(dest.startLineNumber);\r\n                alert(`${lineContent}, ${newIndex + 1} of ${highlights.length} for '${word.word}'`);\r\n            }\r\n        }\r\n        finally {\r\n            this._ignorePositionChangeEvent = false;\r\n        }\r\n    }\r\n    _removeDecorations() {\r\n        if (this._decorationIds.length > 0) {\r\n            // remove decorations\r\n            this._decorationIds = this.editor.deltaDecorations(this._decorationIds, []);\r\n            this._hasWordHighlights.set(false);\r\n        }\r\n    }\r\n    _stopAll() {\r\n        // Remove any existing decorations\r\n        this._removeDecorations();\r\n        // Cancel any renderDecorationsTimer\r\n        if (this.renderDecorationsTimer !== -1) {\r\n            clearTimeout(this.renderDecorationsTimer);\r\n            this.renderDecorationsTimer = -1;\r\n        }\r\n        // Cancel any worker request\r\n        if (this.workerRequest !== null) {\r\n            this.workerRequest.cancel();\r\n            this.workerRequest = null;\r\n        }\r\n        // Invalidate any worker request callback\r\n        if (!this.workerRequestCompleted) {\r\n            this.workerRequestTokenId++;\r\n            this.workerRequestCompleted = true;\r\n        }\r\n    }\r\n    _onPositionChanged(e) {\r\n        // disabled\r\n        if (!this.occurrencesHighlight) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        // ignore typing & other\r\n        if (e.reason !== 3 /* Explicit */) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        this._run();\r\n    }\r\n    _getWord() {\r\n        let editorSelection = this.editor.getSelection();\r\n        let lineNumber = editorSelection.startLineNumber;\r\n        let startColumn = editorSelection.startColumn;\r\n        return this.model.getWordAtPosition({\r\n            lineNumber: lineNumber,\r\n            column: startColumn\r\n        });\r\n    }\r\n    _run() {\r\n        let editorSelection = this.editor.getSelection();\r\n        // ignore multiline selection\r\n        if (editorSelection.startLineNumber !== editorSelection.endLineNumber) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        let startColumn = editorSelection.startColumn;\r\n        let endColumn = editorSelection.endColumn;\r\n        const word = this._getWord();\r\n        // The selection must be inside a word or surround one word at most\r\n        if (!word || word.startColumn > startColumn || word.endColumn < endColumn) {\r\n            this._stopAll();\r\n            return;\r\n        }\r\n        // All the effort below is trying to achieve this:\r\n        // - when cursor is moved to a word, trigger immediately a findOccurrences request\r\n        // - 250ms later after the last cursor move event, render the occurrences\r\n        // - no flickering!\r\n        const workerRequestIsValid = (this.workerRequest && this.workerRequest.isValid(this.model, editorSelection, this._decorationIds));\r\n        // There are 4 cases:\r\n        // a) old workerRequest is valid & completed, renderDecorationsTimer fired\r\n        // b) old workerRequest is valid & completed, renderDecorationsTimer not fired\r\n        // c) old workerRequest is valid, but not completed\r\n        // d) old workerRequest is not valid\r\n        // For a) no action is needed\r\n        // For c), member 'lastCursorPositionChangeTime' will be used when installing the timer so no action is needed\r\n        this.lastCursorPositionChangeTime = (new Date()).getTime();\r\n        if (workerRequestIsValid) {\r\n            if (this.workerRequestCompleted && this.renderDecorationsTimer !== -1) {\r\n                // case b)\r\n                // Delay the firing of renderDecorationsTimer by an extra 250 ms\r\n                clearTimeout(this.renderDecorationsTimer);\r\n                this.renderDecorationsTimer = -1;\r\n                this._beginRenderDecorations();\r\n            }\r\n        }\r\n        else {\r\n            // case d)\r\n            // Stop all previous actions and start fresh\r\n            this._stopAll();\r\n            let myRequestId = ++this.workerRequestTokenId;\r\n            this.workerRequestCompleted = false;\r\n            this.workerRequest = computeOccurencesAtPosition(this.model, this.editor.getSelection(), this.editor.getOption(115 /* wordSeparators */));\r\n            this.workerRequest.result.then(data => {\r\n                if (myRequestId === this.workerRequestTokenId) {\r\n                    this.workerRequestCompleted = true;\r\n                    this.workerRequestValue = data || [];\r\n                    this._beginRenderDecorations();\r\n                }\r\n            }, onUnexpectedError);\r\n        }\r\n    }\r\n    _beginRenderDecorations() {\r\n        let currentTime = (new Date()).getTime();\r\n        let minimumRenderTime = this.lastCursorPositionChangeTime + 250;\r\n        if (currentTime >= minimumRenderTime) {\r\n            // Synchronous\r\n            this.renderDecorationsTimer = -1;\r\n            this.renderDecorations();\r\n        }\r\n        else {\r\n            // Asynchronous\r\n            this.renderDecorationsTimer = setTimeout(() => {\r\n                this.renderDecorations();\r\n            }, (minimumRenderTime - currentTime));\r\n        }\r\n    }\r\n    renderDecorations() {\r\n        this.renderDecorationsTimer = -1;\r\n        let decorations = [];\r\n        for (const info of this.workerRequestValue) {\r\n            if (info.range) {\r\n                decorations.push({\r\n                    range: info.range,\r\n                    options: WordHighlighter._getDecorationOptions(info.kind)\r\n                });\r\n            }\r\n        }\r\n        this._decorationIds = this.editor.deltaDecorations(this._decorationIds, decorations);\r\n        this._hasWordHighlights.set(this.hasDecorations());\r\n    }\r\n    static _getDecorationOptions(kind) {\r\n        if (kind === DocumentHighlightKind.Write) {\r\n            return this._WRITE_OPTIONS;\r\n        }\r\n        else if (kind === DocumentHighlightKind.Text) {\r\n            return this._TEXT_OPTIONS;\r\n        }\r\n        else {\r\n            return this._REGULAR_OPTIONS;\r\n        }\r\n    }\r\n    dispose() {\r\n        this._stopAll();\r\n        this.toUnhook.dispose();\r\n    }\r\n}\r\nWordHighlighter._WRITE_OPTIONS = ModelDecorationOptions.register({\r\n    description: 'word-highlight-strong',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'wordHighlightStrong',\r\n    overviewRuler: {\r\n        color: themeColorFromId(overviewRulerWordHighlightStrongForeground),\r\n        position: OverviewRulerLane.Center\r\n    }\r\n});\r\nWordHighlighter._TEXT_OPTIONS = ModelDecorationOptions.register({\r\n    description: 'selection-highlight',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'selectionHighlight',\r\n    overviewRuler: {\r\n        color: themeColorFromId(overviewRulerSelectionHighlightForeground),\r\n        position: OverviewRulerLane.Center\r\n    }\r\n});\r\nWordHighlighter._REGULAR_OPTIONS = ModelDecorationOptions.register({\r\n    description: 'word-highlight',\r\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\r\n    className: 'wordHighlight',\r\n    overviewRuler: {\r\n        color: themeColorFromId(overviewRulerWordHighlightForeground),\r\n        position: OverviewRulerLane.Center\r\n    }\r\n});\r\nlet WordHighlighterContribution = class WordHighlighterContribution extends Disposable {\r\n    constructor(editor, contextKeyService) {\r\n        super();\r\n        this.wordHighlighter = null;\r\n        const createWordHighlighterIfPossible = () => {\r\n            if (editor.hasModel()) {\r\n                this.wordHighlighter = new WordHighlighter(editor, contextKeyService);\r\n            }\r\n        };\r\n        this._register(editor.onDidChangeModel((e) => {\r\n            if (this.wordHighlighter) {\r\n                this.wordHighlighter.dispose();\r\n                this.wordHighlighter = null;\r\n            }\r\n            createWordHighlighterIfPossible();\r\n        }));\r\n        createWordHighlighterIfPossible();\r\n    }\r\n    static get(editor) {\r\n        return editor.getContribution(WordHighlighterContribution.ID);\r\n    }\r\n    saveViewState() {\r\n        if (this.wordHighlighter && this.wordHighlighter.hasDecorations()) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    moveNext() {\r\n        if (this.wordHighlighter) {\r\n            this.wordHighlighter.moveNext();\r\n        }\r\n    }\r\n    moveBack() {\r\n        if (this.wordHighlighter) {\r\n            this.wordHighlighter.moveBack();\r\n        }\r\n    }\r\n    restoreViewState(state) {\r\n        if (this.wordHighlighter && state) {\r\n            this.wordHighlighter.restore();\r\n        }\r\n    }\r\n    dispose() {\r\n        if (this.wordHighlighter) {\r\n            this.wordHighlighter.dispose();\r\n            this.wordHighlighter = null;\r\n        }\r\n        super.dispose();\r\n    }\r\n};\r\nWordHighlighterContribution.ID = 'editor.contrib.wordHighlighter';\r\nWordHighlighterContribution = __decorate([\r\n    __param(1, IContextKeyService)\r\n], WordHighlighterContribution);\r\nclass WordHighlightNavigationAction extends EditorAction {\r\n    constructor(next, opts) {\r\n        super(opts);\r\n        this._isNext = next;\r\n    }\r\n    run(accessor, editor) {\r\n        const controller = WordHighlighterContribution.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        if (this._isNext) {\r\n            controller.moveNext();\r\n        }\r\n        else {\r\n            controller.moveBack();\r\n        }\r\n    }\r\n}\r\nclass NextWordHighlightAction extends WordHighlightNavigationAction {\r\n    constructor() {\r\n        super(true, {\r\n            id: 'editor.action.wordHighlight.next',\r\n            label: nls.localize('wordHighlight.next.label', \"Go to Next Symbol Highlight\"),\r\n            alias: 'Go to Next Symbol Highlight',\r\n            precondition: ctxHasWordHighlights,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 65 /* F7 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nclass PrevWordHighlightAction extends WordHighlightNavigationAction {\r\n    constructor() {\r\n        super(false, {\r\n            id: 'editor.action.wordHighlight.prev',\r\n            label: nls.localize('wordHighlight.previous.label', \"Go to Previous Symbol Highlight\"),\r\n            alias: 'Go to Previous Symbol Highlight',\r\n            precondition: ctxHasWordHighlights,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 1024 /* Shift */ | 65 /* F7 */,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nclass TriggerWordHighlightAction extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'editor.action.wordHighlight.trigger',\r\n            label: nls.localize('wordHighlight.trigger.label', \"Trigger Symbol Highlight\"),\r\n            alias: 'Trigger Symbol Highlight',\r\n            precondition: ctxHasWordHighlights.toNegated(),\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.editorTextFocus,\r\n                primary: 0,\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    run(accessor, editor, args) {\r\n        const controller = WordHighlighterContribution.get(editor);\r\n        if (!controller) {\r\n            return;\r\n        }\r\n        controller.restoreViewState(true);\r\n    }\r\n}\r\nregisterEditorContribution(WordHighlighterContribution.ID, WordHighlighterContribution);\r\nregisterEditorAction(NextWordHighlightAction);\r\nregisterEditorAction(PrevWordHighlightAction);\r\nregisterEditorAction(TriggerWordHighlightAction);\r\nregisterThemingParticipant((theme, collector) => {\r\n    const selectionHighlight = theme.getColor(editorSelectionHighlight);\r\n    if (selectionHighlight) {\r\n        collector.addRule(`.monaco-editor .focused .selectionHighlight { background-color: ${selectionHighlight}; }`);\r\n        collector.addRule(`.monaco-editor .selectionHighlight { background-color: ${selectionHighlight.transparent(0.5)}; }`);\r\n    }\r\n    const wordHighlight = theme.getColor(editorWordHighlight);\r\n    if (wordHighlight) {\r\n        collector.addRule(`.monaco-editor .wordHighlight { background-color: ${wordHighlight}; }`);\r\n    }\r\n    const wordHighlightStrong = theme.getColor(editorWordHighlightStrong);\r\n    if (wordHighlightStrong) {\r\n        collector.addRule(`.monaco-editor .wordHighlightStrong { background-color: ${wordHighlightStrong}; }`);\r\n    }\r\n    const selectionHighlightBorder = theme.getColor(editorSelectionHighlightBorder);\r\n    if (selectionHighlightBorder) {\r\n        collector.addRule(`.monaco-editor .selectionHighlight { border: 1px ${theme.type === 'hc' ? 'dotted' : 'solid'} ${selectionHighlightBorder}; box-sizing: border-box; }`);\r\n    }\r\n    const wordHighlightBorder = theme.getColor(editorWordHighlightBorder);\r\n    if (wordHighlightBorder) {\r\n        collector.addRule(`.monaco-editor .wordHighlight { border: 1px ${theme.type === 'hc' ? 'dashed' : 'solid'} ${wordHighlightBorder}; box-sizing: border-box; }`);\r\n    }\r\n    const wordHighlightStrongBorder = theme.getColor(editorWordHighlightStrongBorder);\r\n    if (wordHighlightStrongBorder) {\r\n        collector.addRule(`.monaco-editor .wordHighlightStrong { border: 1px ${theme.type === 'hc' ? 'dashed' : 'solid'} ${wordHighlightStrongBorder}; box-sizing: border-box; }`);\r\n    }\r\n});\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from '../../../nls.js';\r\nimport { EditorCommand, registerEditorCommand, EditorAction, registerEditorAction } from '../../browser/editorExtensions.js';\r\nimport { ReplaceCommand } from '../../common/commands/replaceCommand.js';\r\nimport { CursorState } from '../../common/controller/cursorCommon.js';\r\nimport { WordOperations } from '../../common/controller/cursorWordOperations.js';\r\nimport { getMapForWordSeparators } from '../../common/controller/wordCharacterClassifier.js';\r\nimport { Position } from '../../common/core/position.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { Selection } from '../../common/core/selection.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { CONTEXT_ACCESSIBILITY_MODE_ENABLED } from '../../../platform/accessibility/common/accessibility.js';\r\nimport { ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\r\nimport { EditorOptions } from '../../common/config/editorOptions.js';\r\nimport { LanguageConfigurationRegistry } from '../../common/modes/languageConfigurationRegistry.js';\r\nimport { IsWindowsContext } from '../../../platform/contextkey/common/contextkeys.js';\r\nexport class MoveWordCommand extends EditorCommand {\r\n    constructor(opts) {\r\n        super(opts);\r\n        this._inSelectionMode = opts.inSelectionMode;\r\n        this._wordNavigationType = opts.wordNavigationType;\r\n    }\r\n    runEditorCommand(accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const wordSeparators = getMapForWordSeparators(editor.getOption(115 /* wordSeparators */));\r\n        const model = editor.getModel();\r\n        const selections = editor.getSelections();\r\n        const result = selections.map((sel) => {\r\n            const inPosition = new Position(sel.positionLineNumber, sel.positionColumn);\r\n            const outPosition = this._move(wordSeparators, model, inPosition, this._wordNavigationType);\r\n            return this._moveTo(sel, outPosition, this._inSelectionMode);\r\n        });\r\n        model.pushStackElement();\r\n        editor._getViewModel().setCursorStates('moveWordCommand', 3 /* Explicit */, result.map(r => CursorState.fromModelSelection(r)));\r\n        if (result.length === 1) {\r\n            const pos = new Position(result[0].positionLineNumber, result[0].positionColumn);\r\n            editor.revealPosition(pos, 0 /* Smooth */);\r\n        }\r\n    }\r\n    _moveTo(from, to, inSelectionMode) {\r\n        if (inSelectionMode) {\r\n            // move just position\r\n            return new Selection(from.selectionStartLineNumber, from.selectionStartColumn, to.lineNumber, to.column);\r\n        }\r\n        else {\r\n            // move everything\r\n            return new Selection(to.lineNumber, to.column, to.lineNumber, to.column);\r\n        }\r\n    }\r\n}\r\nexport class WordLeftCommand extends MoveWordCommand {\r\n    _move(wordSeparators, model, position, wordNavigationType) {\r\n        return WordOperations.moveWordLeft(wordSeparators, model, position, wordNavigationType);\r\n    }\r\n}\r\nexport class WordRightCommand extends MoveWordCommand {\r\n    _move(wordSeparators, model, position, wordNavigationType) {\r\n        return WordOperations.moveWordRight(wordSeparators, model, position, wordNavigationType);\r\n    }\r\n}\r\nexport class CursorWordStartLeft extends WordLeftCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartLeft',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nexport class CursorWordEndLeft extends WordLeftCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndLeft',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nexport class CursorWordLeft extends WordLeftCommand {\r\n    constructor() {\r\n        var _a;\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 1 /* WordStartFast */,\r\n            id: 'cursorWordLeft',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\r\n                primary: 2048 /* CtrlCmd */ | 15 /* LeftArrow */,\r\n                mac: { primary: 512 /* Alt */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class CursorWordStartLeftSelect extends WordLeftCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartLeftSelect',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nexport class CursorWordEndLeftSelect extends WordLeftCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndLeftSelect',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nexport class CursorWordLeftSelect extends WordLeftCommand {\r\n    constructor() {\r\n        var _a;\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 1 /* WordStartFast */,\r\n            id: 'cursorWordLeftSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 15 /* LeftArrow */,\r\n                mac: { primary: 512 /* Alt */ | 1024 /* Shift */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\n// Accessibility navigation commands should only be enabled on windows since they are tuned to what NVDA expects\r\nexport class CursorWordAccessibilityLeft extends WordLeftCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityLeft',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    _move(_, model, position, wordNavigationType) {\r\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    }\r\n}\r\nexport class CursorWordAccessibilityLeftSelect extends WordLeftCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityLeftSelect',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    _move(_, model, position, wordNavigationType) {\r\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    }\r\n}\r\nexport class CursorWordStartRight extends WordRightCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartRight',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nexport class CursorWordEndRight extends WordRightCommand {\r\n    constructor() {\r\n        var _a;\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndRight',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\r\n                primary: 2048 /* CtrlCmd */ | 17 /* RightArrow */,\r\n                mac: { primary: 512 /* Alt */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class CursorWordRight extends WordRightCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordRight',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nexport class CursorWordStartRightSelect extends WordRightCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordStartRightSelect',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nexport class CursorWordEndRightSelect extends WordRightCommand {\r\n    constructor() {\r\n        var _a;\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordEndRightSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: ContextKeyExpr.and(EditorContextKeys.textInputFocus, (_a = ContextKeyExpr.and(CONTEXT_ACCESSIBILITY_MODE_ENABLED, IsWindowsContext)) === null || _a === void 0 ? void 0 : _a.negate()),\r\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 17 /* RightArrow */,\r\n                mac: { primary: 512 /* Alt */ | 1024 /* Shift */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class CursorWordRightSelect extends WordRightCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordRightSelect',\r\n            precondition: undefined\r\n        });\r\n    }\r\n}\r\nexport class CursorWordAccessibilityRight extends WordRightCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityRight',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    _move(_, model, position, wordNavigationType) {\r\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    }\r\n}\r\nexport class CursorWordAccessibilityRightSelect extends WordRightCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 3 /* WordAccessibility */,\r\n            id: 'cursorWordAccessibilityRightSelect',\r\n            precondition: undefined\r\n        });\r\n    }\r\n    _move(_, model, position, wordNavigationType) {\r\n        return super._move(getMapForWordSeparators(EditorOptions.wordSeparators.defaultValue), model, position, wordNavigationType);\r\n    }\r\n}\r\nexport class DeleteWordCommand extends EditorCommand {\r\n    constructor(opts) {\r\n        super(opts);\r\n        this._whitespaceHeuristics = opts.whitespaceHeuristics;\r\n        this._wordNavigationType = opts.wordNavigationType;\r\n    }\r\n    runEditorCommand(accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const wordSeparators = getMapForWordSeparators(editor.getOption(115 /* wordSeparators */));\r\n        const model = editor.getModel();\r\n        const selections = editor.getSelections();\r\n        const autoClosingBrackets = editor.getOption(5 /* autoClosingBrackets */);\r\n        const autoClosingQuotes = editor.getOption(8 /* autoClosingQuotes */);\r\n        const autoClosingPairs = LanguageConfigurationRegistry.getAutoClosingPairs(model.getLanguageIdentifier().id);\r\n        const viewModel = editor._getViewModel();\r\n        const commands = selections.map((sel) => {\r\n            const deleteRange = this._delete({\r\n                wordSeparators,\r\n                model,\r\n                selection: sel,\r\n                whitespaceHeuristics: this._whitespaceHeuristics,\r\n                autoClosingDelete: editor.getOption(6 /* autoClosingDelete */),\r\n                autoClosingBrackets,\r\n                autoClosingQuotes,\r\n                autoClosingPairs,\r\n                autoClosedCharacters: viewModel.getCursorAutoClosedCharacters()\r\n            }, this._wordNavigationType);\r\n            return new ReplaceCommand(deleteRange, '');\r\n        });\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nexport class DeleteWordLeftCommand extends DeleteWordCommand {\r\n    _delete(ctx, wordNavigationType) {\r\n        let r = WordOperations.deleteWordLeft(ctx, wordNavigationType);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        return new Range(1, 1, 1, 1);\r\n    }\r\n}\r\nexport class DeleteWordRightCommand extends DeleteWordCommand {\r\n    _delete(ctx, wordNavigationType) {\r\n        let r = WordOperations.deleteWordRight(ctx, wordNavigationType);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        const lineCount = ctx.model.getLineCount();\r\n        const maxColumn = ctx.model.getLineMaxColumn(lineCount);\r\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\r\n    }\r\n}\r\nexport class DeleteWordStartLeft extends DeleteWordLeftCommand {\r\n    constructor() {\r\n        super({\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordStartLeft',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n}\r\nexport class DeleteWordEndLeft extends DeleteWordLeftCommand {\r\n    constructor() {\r\n        super({\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordEndLeft',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n}\r\nexport class DeleteWordLeft extends DeleteWordLeftCommand {\r\n    constructor() {\r\n        super({\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordLeft',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 1 /* Backspace */,\r\n                mac: { primary: 512 /* Alt */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class DeleteWordStartRight extends DeleteWordRightCommand {\r\n    constructor() {\r\n        super({\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordStartRight',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n}\r\nexport class DeleteWordEndRight extends DeleteWordRightCommand {\r\n    constructor() {\r\n        super({\r\n            whitespaceHeuristics: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordEndRight',\r\n            precondition: EditorContextKeys.writable\r\n        });\r\n    }\r\n}\r\nexport class DeleteWordRight extends DeleteWordRightCommand {\r\n    constructor() {\r\n        super({\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordRight',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 2048 /* CtrlCmd */ | 20 /* Delete */,\r\n                mac: { primary: 512 /* Alt */ | 20 /* Delete */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class DeleteInsideWord extends EditorAction {\r\n    constructor() {\r\n        super({\r\n            id: 'deleteInsideWord',\r\n            precondition: EditorContextKeys.writable,\r\n            label: nls.localize('deleteInsideWord', \"Delete Word\"),\r\n            alias: 'Delete Word'\r\n        });\r\n    }\r\n    run(accessor, editor, args) {\r\n        if (!editor.hasModel()) {\r\n            return;\r\n        }\r\n        const wordSeparators = getMapForWordSeparators(editor.getOption(115 /* wordSeparators */));\r\n        const model = editor.getModel();\r\n        const selections = editor.getSelections();\r\n        const commands = selections.map((sel) => {\r\n            const deleteRange = WordOperations.deleteInsideWord(wordSeparators, model, sel);\r\n            return new ReplaceCommand(deleteRange, '');\r\n        });\r\n        editor.pushUndoStop();\r\n        editor.executeCommands(this.id, commands);\r\n        editor.pushUndoStop();\r\n    }\r\n}\r\nregisterEditorCommand(new CursorWordStartLeft());\r\nregisterEditorCommand(new CursorWordEndLeft());\r\nregisterEditorCommand(new CursorWordLeft());\r\nregisterEditorCommand(new CursorWordStartLeftSelect());\r\nregisterEditorCommand(new CursorWordEndLeftSelect());\r\nregisterEditorCommand(new CursorWordLeftSelect());\r\nregisterEditorCommand(new CursorWordStartRight());\r\nregisterEditorCommand(new CursorWordEndRight());\r\nregisterEditorCommand(new CursorWordRight());\r\nregisterEditorCommand(new CursorWordStartRightSelect());\r\nregisterEditorCommand(new CursorWordEndRightSelect());\r\nregisterEditorCommand(new CursorWordRightSelect());\r\nregisterEditorCommand(new CursorWordAccessibilityLeft());\r\nregisterEditorCommand(new CursorWordAccessibilityLeftSelect());\r\nregisterEditorCommand(new CursorWordAccessibilityRight());\r\nregisterEditorCommand(new CursorWordAccessibilityRightSelect());\r\nregisterEditorCommand(new DeleteWordStartLeft());\r\nregisterEditorCommand(new DeleteWordEndLeft());\r\nregisterEditorCommand(new DeleteWordLeft());\r\nregisterEditorCommand(new DeleteWordStartRight());\r\nregisterEditorCommand(new DeleteWordEndRight());\r\nregisterEditorCommand(new DeleteWordRight());\r\nregisterEditorAction(DeleteInsideWord);\r\n", "/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { registerEditorCommand } from '../../browser/editorExtensions.js';\r\nimport { WordPartOperations } from '../../common/controller/cursorWordOperations.js';\r\nimport { Range } from '../../common/core/range.js';\r\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\r\nimport { DeleteWordCommand, MoveWordCommand } from '../wordOperations/wordOperations.js';\r\nimport { CommandsRegistry } from '../../../platform/commands/common/commands.js';\r\nexport class DeleteWordPartLeft extends DeleteWordCommand {\r\n    constructor() {\r\n        super({\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'deleteWordPartLeft',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 1 /* Backspace */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    _delete(ctx, wordNavigationType) {\r\n        let r = WordPartOperations.deleteWordPartLeft(ctx);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        return new Range(1, 1, 1, 1);\r\n    }\r\n}\r\nexport class DeleteWordPartRight extends DeleteWordCommand {\r\n    constructor() {\r\n        super({\r\n            whitespaceHeuristics: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'deleteWordPartRight',\r\n            precondition: EditorContextKeys.writable,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 20 /* Delete */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n    _delete(ctx, wordNavigationType) {\r\n        let r = WordPartOperations.deleteWordPartRight(ctx);\r\n        if (r) {\r\n            return r;\r\n        }\r\n        const lineCount = ctx.model.getLineCount();\r\n        const maxColumn = ctx.model.getLineMaxColumn(lineCount);\r\n        return new Range(lineCount, maxColumn, lineCount, maxColumn);\r\n    }\r\n}\r\nexport class WordPartLeftCommand extends MoveWordCommand {\r\n    _move(wordSeparators, model, position, wordNavigationType) {\r\n        return WordPartOperations.moveWordPartLeft(wordSeparators, model, position);\r\n    }\r\n}\r\nexport class CursorWordPartLeft extends WordPartLeftCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordPartLeft',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\n// Register previous id for compatibility purposes\r\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeft', 'cursorWordPartLeft');\r\nexport class CursorWordPartLeftSelect extends WordPartLeftCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 0 /* WordStart */,\r\n            id: 'cursorWordPartLeftSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 1024 /* Shift */ | 15 /* LeftArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\n// Register previous id for compatibility purposes\r\nCommandsRegistry.registerCommandAlias('cursorWordPartStartLeftSelect', 'cursorWordPartLeftSelect');\r\nexport class WordPartRightCommand extends MoveWordCommand {\r\n    _move(wordSeparators, model, position, wordNavigationType) {\r\n        return WordPartOperations.moveWordPartRight(wordSeparators, model, position);\r\n    }\r\n}\r\nexport class CursorWordPartRight extends WordPartRightCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: false,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordPartRight',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nexport class CursorWordPartRightSelect extends WordPartRightCommand {\r\n    constructor() {\r\n        super({\r\n            inSelectionMode: true,\r\n            wordNavigationType: 2 /* WordEnd */,\r\n            id: 'cursorWordPartRightSelect',\r\n            precondition: undefined,\r\n            kbOpts: {\r\n                kbExpr: EditorContextKeys.textInputFocus,\r\n                primary: 0,\r\n                mac: { primary: 256 /* WinCtrl */ | 512 /* Alt */ | 1024 /* Shift */ | 17 /* RightArrow */ },\r\n                weight: 100 /* EditorContrib */\r\n            }\r\n        });\r\n    }\r\n}\r\nregisterEditorCommand(new DeleteWordPartLeft());\r\nregisterEditorCommand(new DeleteWordPartRight());\r\nregisterEditorCommand(new CursorWordPartLeft());\r\nregisterEditorCommand(new CursorWordPartLeftSelect());\r\nregisterEditorCommand(new CursorWordPartRight());\r\nregisterEditorCommand(new CursorWordPartRightSelect());\r\n", "export default {\n  \"inherit\": false,\n  \"base\": \"vs\",\n  \"colors\": {\n    \"focusBorder\": \"#2188ff\",\n    \"foreground\": \"#444d56\",\n    \"descriptionForeground\": \"#6a737d\",\n    \"errorForeground\": \"#cb2431\",\n    \"textLink.foreground\": \"#0366d6\",\n    \"textLink.activeForeground\": \"#005cc5\",\n    \"textBlockQuote.background\": \"#fafbfc\",\n    \"textBlockQuote.border\": \"#e1e4e8\",\n    \"textCodeBlock.background\": \"#f6f8fa\",\n    \"textPreformat.foreground\": \"#586069\",\n    \"textSeparator.foreground\": \"#d1d5da\",\n    \"button.background\": \"#159739\",\n    \"button.foreground\": \"#fff\",\n    \"button.hoverBackground\": \"#138934\",\n    \"button.secondaryBackground\": \"#e1e4e8\",\n    \"button.secondaryForeground\": \"#1b1f23\",\n    \"button.secondaryHoverBackground\": \"#d1d5da\",\n    \"checkbox.background\": \"#fafbfc\",\n    \"checkbox.border\": \"#d1d5da\",\n    \"dropdown.background\": \"#fafbfc\",\n    \"dropdown.border\": \"#e1e4e8\",\n    \"dropdown.foreground\": \"#2f363d\",\n    \"dropdown.listBackground\": \"#fff\",\n    \"input.background\": \"#fafbfc\",\n    \"input.border\": \"#e1e4e8\",\n    \"input.foreground\": \"#2f363d\",\n    \"input.placeholderForeground\": \"#959da5\",\n    \"badge.foreground\": \"#005cc5\",\n    \"badge.background\": \"#dbedff\",\n    \"progressBar.background\": \"#2188ff\",\n    \"titleBar.activeForeground\": \"#2f363d\",\n    \"titleBar.activeBackground\": \"#fff\",\n    \"titleBar.inactiveForeground\": \"#6a737d\",\n    \"titleBar.inactiveBackground\": \"#f6f8fa\",\n    \"titleBar.border\": \"#e1e4e8\",\n    \"activityBar.foreground\": \"#2f363d\",\n    \"activityBar.inactiveForeground\": \"#959da5\",\n    \"activityBar.background\": \"#fff\",\n    \"activityBarBadge.foreground\": \"#fff\",\n    \"activityBarBadge.background\": \"#2188ff\",\n    \"activityBar.activeBorder\": \"#f9826c\",\n    \"activityBar.border\": \"#e1e4e8\",\n    \"sideBar.foreground\": \"#586069\",\n    \"sideBar.background\": \"#f6f8fa\",\n    \"sideBar.border\": \"#e1e4e8\",\n    \"sideBarTitle.foreground\": \"#2f363d\",\n    \"sideBarSectionHeader.foreground\": \"#2f363d\",\n    \"sideBarSectionHeader.background\": \"#f6f8fa\",\n    \"sideBarSectionHeader.border\": \"#e1e4e8\",\n    \"list.hoverForeground\": \"#2f363d\",\n    \"list.inactiveSelectionForeground\": \"#2f363d\",\n    \"list.activeSelectionForeground\": \"#2f363d\",\n    \"list.hoverBackground\": \"#ebf0f4\",\n    \"list.inactiveSelectionBackground\": \"#e8eaed\",\n    \"list.activeSelectionBackground\": \"#e2e5e9\",\n    \"list.inactiveFocusBackground\": \"#dbedff\",\n    \"list.focusBackground\": \"#cce5ff\",\n    \"tree.indentGuidesStroke\": \"#e1e4e8\",\n    \"notificationCenterHeader.foreground\": \"#6a737d\",\n    \"notificationCenterHeader.background\": \"#e1e4e8\",\n    \"notifications.foreground\": \"#2f363d\",\n    \"notifications.background\": \"#fafbfc\",\n    \"notifications.border\": \"#e1e4e8\",\n    \"notificationsErrorIcon.foreground\": \"#d73a49\",\n    \"notificationsWarningIcon.foreground\": \"#e36209\",\n    \"notificationsInfoIcon.foreground\": \"#005cc5\",\n    \"pickerGroup.border\": \"#e1e4e8\",\n    \"pickerGroup.foreground\": \"#2f363d\",\n    \"quickInput.background\": \"#fafbfc\",\n    \"quickInput.foreground\": \"#2f363d\",\n    \"statusBar.foreground\": \"#586069\",\n    \"statusBar.background\": \"#fff\",\n    \"statusBar.border\": \"#e1e4e8\",\n    \"statusBar.noFolderBackground\": \"#fff\",\n    \"statusBar.debuggingBackground\": \"#f9826c\",\n    \"statusBar.debuggingForeground\": \"#fff\",\n    \"statusBarItem.prominentBackground\": \"#e8eaed\",\n    \"editorGroupHeader.tabsBackground\": \"#f6f8fa\",\n    \"editorGroupHeader.tabsBorder\": \"#e1e4e8\",\n    \"editorGroup.border\": \"#e1e4e8\",\n    \"tab.activeForeground\": \"#2f363d\",\n    \"tab.inactiveForeground\": \"#6a737d\",\n    \"tab.inactiveBackground\": \"#f6f8fa\",\n    \"tab.activeBackground\": \"#fff\",\n    \"tab.hoverBackground\": \"#fff\",\n    \"tab.unfocusedHoverBackground\": \"#fff\",\n    \"tab.border\": \"#e1e4e8\",\n    \"tab.unfocusedActiveBorderTop\": \"#e1e4e8\",\n    \"tab.activeBorder\": \"#fff\",\n    \"tab.unfocusedActiveBorder\": \"#fff\",\n    \"tab.activeBorderTop\": \"#f9826c\",\n    \"breadcrumb.foreground\": \"#6a737d\",\n    \"breadcrumb.focusForeground\": \"#2f363d\",\n    \"breadcrumb.activeSelectionForeground\": \"#586069\",\n    \"breadcrumbPicker.background\": \"#fafbfc\",\n    \"editor.foreground\": \"#24292e\",\n    \"editor.background\": \"#fff\",\n    \"editorWidget.background\": \"#f6f8fa\",\n    \"editor.foldBackground\": \"#d1d5da11\",\n    \"editor.lineHighlightBackground\": \"#f6f8fa\",\n    \"editorLineNumber.foreground\": \"#1b1f234d\",\n    \"editorLineNumber.activeForeground\": \"#24292e\",\n    \"editorIndentGuide.background\": \"#eff2f6\",\n    \"editorIndentGuide.activeBackground\": \"#d7dbe0\",\n    \"editorWhitespace.foreground\": \"#d1d5da\",\n    \"editorCursor.foreground\": \"#044289\",\n    \"editor.findMatchBackground\": \"#ffdf5d\",\n    \"editor.findMatchHighlightBackground\": \"#ffdf5d66\",\n    \"editor.linkedEditingBackground\": \"#0366d611\",\n    \"editor.inactiveSelectionBackground\": \"#0366d611\",\n    \"editor.selectionBackground\": \"#0366d625\",\n    \"editor.selectionHighlightBackground\": \"#34d05840\",\n    \"editor.selectionHighlightBorder\": \"#34d05800\",\n    \"editor.wordHighlightBackground\": \"#34d05800\",\n    \"editor.wordHighlightStrongBackground\": \"#34d05800\",\n    \"editor.wordHighlightBorder\": \"#24943e99\",\n    \"editor.wordHighlightStrongBorder\": \"#24943e50\",\n    \"editorBracketMatch.background\": \"#34d05840\",\n    \"editorBracketMatch.border\": \"#34d05800\",\n    \"editorGutter.modifiedBackground\": \"#2188ff\",\n    \"editorGutter.addedBackground\": \"#28a745\",\n    \"editorGutter.deletedBackground\": \"#d73a49\",\n    \"diffEditor.insertedTextBackground\": \"#34d05822\",\n    \"diffEditor.removedTextBackground\": \"#d73a4922\",\n    \"scrollbar.shadow\": \"#6a737d33\",\n    \"scrollbarSlider.background\": \"#959da533\",\n    \"scrollbarSlider.hoverBackground\": \"#959da544\",\n    \"scrollbarSlider.activeBackground\": \"#959da588\",\n    \"editorOverviewRuler.border\": \"#fff\",\n    \"panel.background\": \"#f6f8fa\",\n    \"panel.border\": \"#e1e4e8\",\n    \"panelTitle.activeBorder\": \"#f9826c\",\n    \"panelTitle.activeForeground\": \"#2f363d\",\n    \"panelTitle.inactiveForeground\": \"#6a737d\",\n    \"panelInput.border\": \"#e1e4e8\",\n    \"terminal.foreground\": \"#586069\",\n    \"gitDecoration.addedResourceForeground\": \"#28a745\",\n    \"gitDecoration.modifiedResourceForeground\": \"#005cc5\",\n    \"gitDecoration.deletedResourceForeground\": \"#d73a49\",\n    \"gitDecoration.untrackedResourceForeground\": \"#28a745\",\n    \"gitDecoration.ignoredResourceForeground\": \"#959da5\",\n    \"gitDecoration.conflictingResourceForeground\": \"#e36209\",\n    \"gitDecoration.submoduleResourceForeground\": \"#959da5\",\n    \"debugToolBar.background\": \"#fff\",\n    \"editor.stackFrameHighlightBackground\": \"#ffd33d33\",\n    \"editor.focusedStackFrameHighlightBackground\": \"#28a74525\",\n    \"settings.headerForeground\": \"#2f363d\",\n    \"settings.modifiedItemIndicator\": \"#2188ff\",\n    \"welcomePage.buttonBackground\": \"#f6f8fa\",\n    \"welcomePage.buttonHoverBackground\": \"#e1e4e8\"\n  },\n  rules: [\n    { token: 'comment', foreground: '#6a737d' },\n    { token: 'punctuation.definition.comment', foreground: '#6a737d' },\n    { token: 'string.comment', foreground: '#6a737d' },\n    { token: 'constant', foreground: '#005cc5' },\n    { token: 'entity.name.constant', foreground: '#005cc5' },\n    { token: 'variable.other.constant', foreground: '#005cc5' },\n    { token: 'variable.language', foreground: '#005cc5' },\n    { token: 'entity', foreground: '#6f42c1' },\n    { token: 'entity.name', foreground: '#6f42c1' },\n    { token: 'variable.parameter.function', foreground: '#24292e' },\n    { token: 'entity.name.tag', foreground: '#22863a' },\n    { token: 'keyword', foreground: '#d73a49' },\n    { token: 'storage', foreground: '#d73a49' },\n    { token: 'storage.type', foreground: '#d73a49' },\n    { token: 'storage.modifier.package', foreground: '#24292e' },\n    { token: 'storage.modifier.import', foreground: '#24292e' },\n    { token: 'storage.type.java', foreground: '#24292e' },\n    { token: 'string', foreground: '#032f62' },\n    { token: 'punctuation.definition.string', foreground: '#032f62' },\n    {\n      token: 'string punctuation.section.embedded source',\n      foreground: '#032f62'\n    },\n    { token: 'support', foreground: '#005cc5' },\n    { token: 'meta.property-name', foreground: '#005cc5' },\n    { token: 'variable', foreground: '#e36209' },\n    { token: 'variable.other', foreground: '#24292e' },\n    {\n      token: 'invalid.broken',\n      fontStyle: 'italic',\n      foreground: '#b31d28'\n    },\n    {\n      token: 'invalid.deprecated',\n      fontStyle: 'italic',\n      foreground: '#b31d28'\n    },\n    {\n      token: 'invalid.illegal',\n      fontStyle: 'italic',\n      foreground: '#b31d28'\n    },\n    {\n      token: 'invalid.unimplemented',\n      fontStyle: 'italic',\n      foreground: '#b31d28'\n    },\n    {\n      token: 'carriage-return',\n      fontStyle: 'italic underline',\n      background: '#d73a49',\n      foreground: '#fafbfc',\n      content: '^M'\n    },\n    { token: 'message.error', foreground: '#b31d28' },\n    { token: 'string source', foreground: '#24292e' },\n    { token: 'string variable', foreground: '#005cc5' },\n    { token: 'source.regexp', foreground: '#032f62' },\n    { token: 'string.regexp', foreground: '#032f62' },\n    { token: 'string.regexp.character-class', foreground: '#032f62' },\n    {\n      token: 'string.regexp constant.character.escape',\n      foreground: '#032f62'\n    },\n    {\n      token: 'string.regexp source.ruby.embedded',\n      foreground: '#032f62'\n    },\n    {\n      token: 'string.regexp string.regexp.arbitrary-repitition',\n      foreground: '#032f62'\n    },\n    {\n      token: 'string.regexp constant.character.escape',\n      fontStyle: 'bold',\n      foreground: '#22863a'\n    },\n    { token: 'support.constant', foreground: '#005cc5' },\n    { token: 'support.variable', foreground: '#005cc5' },\n    { token: 'meta.module-reference', foreground: '#005cc5' },\n    {\n      token: 'punctuation.definition.list.begin.markdown',\n      foreground: '#e36209'\n    },\n    {\n      token: 'markup.heading',\n      fontStyle: 'bold',\n      foreground: '#005cc5'\n    },\n    {\n      token: 'markup.heading entity.name',\n      fontStyle: 'bold',\n      foreground: '#005cc5'\n    },\n    { token: 'markup.quote', foreground: '#22863a' },\n    {\n      token: 'markup.italic',\n      fontStyle: 'italic',\n      foreground: '#24292e'\n    },\n    { token: 'markup.bold', fontStyle: 'bold', foreground: '#24292e' },\n    { token: 'markup.raw', foreground: '#005cc5' },\n    {\n      token: 'markup.deleted',\n      background: '#ffeef0',\n      foreground: '#b31d28'\n    },\n    {\n      token: 'meta.diff.header.from-file',\n      background: '#ffeef0',\n      foreground: '#b31d28'\n    },\n    {\n      token: 'punctuation.definition.deleted',\n      background: '#ffeef0',\n      foreground: '#b31d28'\n    },\n    {\n      token: 'markup.inserted',\n      background: '#f0fff4',\n      foreground: '#22863a'\n    },\n    {\n      token: 'meta.diff.header.to-file',\n      background: '#f0fff4',\n      foreground: '#22863a'\n    },\n    {\n      token: 'punctuation.definition.inserted',\n      background: '#f0fff4',\n      foreground: '#22863a'\n    },\n    {\n      token: 'markup.changed',\n      background: '#ffebda',\n      foreground: '#e36209'\n    },\n    {\n      token: 'punctuation.definition.changed',\n      background: '#ffebda',\n      foreground: '#e36209'\n    },\n    {\n      token: 'markup.ignored',\n      foreground: '#f6f8fa',\n      background: '#005cc5'\n    },\n    {\n      token: 'markup.untracked',\n      foreground: '#f6f8fa',\n      background: '#005cc5'\n    },\n    {\n      token: 'meta.diff.range',\n      foreground: '#6f42c1',\n      fontStyle: 'bold'\n    },\n    { token: 'meta.diff.header', foreground: '#005cc5' },\n    {\n      token: 'meta.separator',\n      fontStyle: 'bold',\n      foreground: '#005cc5'\n    },\n    { token: 'meta.output', foreground: '#005cc5' },\n    { token: 'brackethighlighter.tag', foreground: '#586069' },\n    { token: 'brackethighlighter.curly', foreground: '#586069' },\n    { token: 'brackethighlighter.round', foreground: '#586069' },\n    { token: 'brackethighlighter.square', foreground: '#586069' },\n    { token: 'brackethighlighter.angle', foreground: '#586069' },\n    { token: 'brackethighlighter.quote', foreground: '#586069' },\n    { token: 'brackethighlighter.unmatched', foreground: '#b31d28' },\n    {\n      token: 'constant.other.reference.link',\n      foreground: '#032f62',\n      fontStyle: 'underline'\n    },\n    {\n      token: 'string.other.link',\n      foreground: '#032f62',\n      fontStyle: 'underline'\n    }\n  ],\n  \"encodedTokensColors\": []\n};", "export default {\n  name: 'github-dark-dimmed',\n  base: 'vs-dark',\n  inherit: true,\n  rules: [\n    {\n      token: 'comment',\n      foreground: '#6A737D',\n    },\n    {\n      token: 'punctuation.definition.comment',\n      foreground: '#6A737D',\n    },\n    {\n      token: 'string.comment',\n      foreground: '#6A737D',\n    },\n    {\n      token: 'constant',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'entity.name.constant',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'variable.other.constant',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'variable.language',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'entity',\n      foreground: '#B392F0',\n    },\n    {\n      token: 'entity.name',\n      foreground: '#B392F0',\n    },\n    {\n      token: 'variable.parameter.function',\n      foreground: '#E1E4E8',\n    },\n    {\n      token: 'entity.name.tag',\n      foreground: '#85E89D',\n    },\n    {\n      token: 'keyword',\n      foreground: '#F97583',\n    },\n    {\n      token: 'storage',\n      foreground: '#F97583',\n    },\n    {\n      token: 'storage.type',\n      foreground: '#F97583',\n    },\n    {\n      token: 'storage.modifier.package',\n      foreground: '#E1E4E8',\n    },\n    {\n      token: 'storage.modifier.import',\n      foreground: '#E1E4E8',\n    },\n    {\n      token: 'storage.type.java',\n      foreground: '#E1E4E8',\n    },\n    {\n      token: 'string',\n      foreground: '#9ECBFF',\n    },\n    {\n      token: 'punctuation.definition.string',\n      foreground: '#9ECBFF',\n    },\n    {\n      token: 'string punctuation.section.embedded source',\n      foreground: '#9ECBFF',\n    },\n    {\n      token: 'support',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'meta.property-name',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'variable',\n      foreground: '#FFAB70',\n    },\n    {\n      token: 'variable.other',\n      foreground: '#E1E4E8',\n    },\n    {\n      token: 'invalid.broken',\n      foreground: '#FDAEB7',\n      fontStyle: 'italic'\n    },\n    {\n      token: 'invalid.deprecated',\n      foreground: '#FDAEB7',\n      fontStyle: 'italic'\n    },\n    {\n      token: 'invalid.illegal',\n      foreground: '#FDAEB7',\n      fontStyle: 'italic'\n    },\n    {\n      token: 'invalid.unimplemented',\n      foreground: '#FDAEB7',\n      fontStyle: 'italic'\n    },\n    {\n      token: 'carriage-return',\n      foreground: '#24292E',\n      background: '#F97583',\n      fontStyle: 'italic underline'\n    },\n    {\n      token: 'message.error',\n      foreground: '#FDAEB7',\n    },\n    {\n      token: 'string source',\n      foreground: '#E1E4E8',\n    },\n    {\n      token: 'string variable',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'source.regexp',\n      foreground: '#DBEDFF',\n    },\n    {\n      token: 'string.regexp',\n      foreground: '#DBEDFF',\n    },\n    {\n      token: 'string.regexp.character-class',\n      foreground: '#DBEDFF',\n    },\n    {\n      token: 'string.regexp constant.character.escape',\n      foreground: '#DBEDFF',\n    },\n    {\n      token: 'string.regexp source.ruby.embedded',\n      foreground: '#DBEDFF',\n    },\n    {\n      token: 'string.regexp string.regexp.arbitrary-repitition',\n      foreground: '#DBEDFF',\n    },\n    {\n      token: 'string.regexp constant.character.escape',\n      foreground: '#85E89D',\n      fontStyle: 'bold'\n    },\n    {\n      token: 'support.constant',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'support.variable',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'meta.module-reference',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'punctuation.definition.list.begin.markdown',\n      foreground: '#FFAB70',\n    },\n    {\n      token: 'markup.heading',\n      foreground: '#79B8FF',\n      fontStyle: 'bold'\n    },\n    {\n      token: 'markup.heading entity.name',\n      foreground: '#79B8FF',\n      fontStyle: 'bold'\n    },\n    {\n      token: 'markup.quote',\n      foreground: '#85E89D',\n    },\n    {\n      token: 'markup.italic',\n      foreground: '#E1E4E8',\n      fontStyle: 'italic'\n    },\n    {\n      token: 'markup.bold',\n      foreground: '#E1E4E8',\n      fontStyle: 'bold'\n    },\n    {\n      token: 'markup.raw',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'markup.deleted',\n      foreground: '#FDAEB7',\n      background: '#86181D',\n    },\n    {\n      token: 'meta.diff.header.from-file',\n      foreground: '#FDAEB7',\n      background: '#86181D',\n    },\n    {\n      token: 'punctuation.definition.deleted',\n      foreground: '#FDAEB7',\n      background: '#86181D',\n    },\n    {\n      token: 'markup.inserted',\n      foreground: '#85E89D',\n      background: '#144620',\n    },\n    {\n      token: 'meta.diff.header.to-file',\n      foreground: '#85E89D',\n      background: '#144620',\n    },\n    {\n      token: 'punctuation.definition.inserted',\n      foreground: '#85E89D',\n      background: '#144620',\n    },\n    {\n      token: 'markup.changed',\n      foreground: '#FFAB70',\n      background: '#C24E00',\n    },\n    {\n      token: 'punctuation.definition.changed',\n      foreground: '#FFAB70',\n      background: '#C24E00',\n    },\n    {\n      token: 'markup.ignored',\n      foreground: '#2F363D',\n      background: '#79B8FF',\n    },\n    {\n      token: 'markup.untracked',\n      foreground: '#2F363D',\n      background: '#79B8FF',\n    },\n    {\n      token: 'meta.diff.range',\n      foreground: '#B392F0',\n      fontStyle: 'bold'\n    },\n    {\n      token: 'meta.diff.header',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'meta.separator',\n      foreground: '#79B8FF',\n      fontStyle: 'bold'\n    },\n    {\n      token: 'meta.output',\n      foreground: '#79B8FF',\n    },\n    {\n      token: 'brackethighlighter.tag',\n      foreground: '#D1D5DA',\n    },\n    {\n      token: 'brackethighlighter.curly',\n      foreground: '#D1D5DA',\n    },\n    {\n      token: 'brackethighlighter.round',\n      foreground: '#D1D5DA',\n    },\n    {\n      token: 'brackethighlighter.square',\n      foreground: '#D1D5DA',\n    },\n    {\n      token: 'brackethighlighter.angle',\n      foreground: '#D1D5DA',\n    },\n    {\n      token: 'brackethighlighter.quote',\n      foreground: '#D1D5DA',\n    },\n    {\n      token: 'brackethighlighter.unmatched',\n      foreground: '#FDAEB7',\n    },\n    {\n      token: 'constant.other.reference.link',\n      foreground: '#DBEDFF',\n      fontStyle: 'underline'\n    },\n    {\n      token: 'string.other.link',\n      foreground: '#DBEDFF',\n      fontStyle: 'underline'\n    },\n    {\n      token: 'token.info-token',\n      foreground: '#6796E6',\n    },\n    {\n      token: 'token.warn-token',\n      foreground: '#CD9731',\n    },\n    {\n      token: 'token.error-token',\n      foreground: '#F44747',\n    },\n    {\n      token: 'token.debug-token',\n      foreground: '#B267E6',\n    }\n  ],\n  colors: {\n    'activityBar.activeBackground': '#3399FF',\n    'activityBar.activeBorder': '#BF0060',\n    'activityBar.background': '#3399FF',\n    'activityBar.border': '#1B1F23',\n    'activityBar.foreground': '#15202B',\n    'activityBar.inactiveForeground': '#15202B99',\n    'activityBarBadge.background': '#BF0060',\n    'activityBarBadge.foreground': '#E7E7E7',\n    'badge.background': '#044289',\n    'badge.foreground': '#C8E1FF',\n    'breadcrumb.activeSelectionForeground': '#D1D5DA',\n    'breadcrumb.focusForeground': '#E1E4E8',\n    'breadcrumb.foreground': '#959DA5',\n    'breadcrumbPicker.background': '#2B3036',\n    'button.background': '#176F2C',\n    'button.foreground': '#DCFFE4',\n    'button.hoverBackground': '#22863A',\n    'button.secondaryBackground': '#444D56',\n    'button.secondaryForeground': '#FFFFFF',\n    'button.secondaryHoverBackground': '#586069',\n    'checkbox.background': '#444D56',\n    'checkbox.border': '#1B1F23',\n    'debugToolBar.background': '#2B3036',\n    descriptionForeground: '#959DA5',\n    'diffEditor.insertedTextBackground': '#28A74530',\n    'diffEditor.removedTextBackground': '#D73A4930',\n    'dropdown.background': '#2F363D',\n    'dropdown.border': '#1B1F23',\n    'dropdown.foreground': '#E1E4E8',\n    'dropdown.listBackground': '#24292E',\n    'editor.background': '#24292E',\n    'editor.findMatchBackground': '#FFD33D44',\n    'editor.findMatchHighlightBackground': '#FFD33D22',\n    'editor.focusedStackFrameHighlightBackground': '#2B6A3033',\n    'editor.foldBackground': '#58606915',\n    'editor.foreground': '#E1E4E8',\n    'editor.inactiveSelectionBackground': '#3392FF22',\n    'editor.lineHighlightBackground': '#2B3036',\n    'editor.linkedEditingBackground': '#3392FF22',\n    'editor.selectionBackground': '#3392FF44',\n    'editor.selectionHighlightBackground': '#17E5E633',\n    'editor.selectionHighlightBorder': '#17E5E600',\n    'editor.stackFrameHighlightBackground': '#C6902625',\n    'editor.wordHighlightBackground': '#17E5E600',\n    'editor.wordHighlightBorder': '#17E5E699',\n    'editor.wordHighlightStrongBackground': '#17E5E600',\n    'editor.wordHighlightStrongBorder': '#17E5E666',\n    'editorBracketMatch.background': '#17E5E650',\n    'editorBracketMatch.border': '#17E5E600',\n    'editorCursor.foreground': '#C8E1FF',\n    'editorGroup.border': '#1B1F23',\n    'editorGroupHeader.tabsBackground': '#1F2428',\n    'editorGroupHeader.tabsBorder': '#1B1F23',\n    'editorGutter.addedBackground': '#28A745',\n    'editorGutter.deletedBackground': '#EA4A5A',\n    'editorGutter.modifiedBackground': '#2188FF',\n    'editorIndentGuide.activeBackground': '#444D56',\n    'editorIndentGuide.background': '#2F363D',\n    'editorLineNumber.activeForeground': '#E1E4E8',\n    'editorLineNumber.foreground': '#444D56',\n    'editorOverviewRuler.border': '#1B1F23',\n    'editorWhitespace.foreground': '#444D56',\n    'editorWidget.background': '#1F2428',\n    errorForeground: '#F97583',\n    focusBorder: '#005CC5',\n    foreground: '#D1D5DA',\n    'gitDecoration.addedResourceForeground': '#34D058',\n    'gitDecoration.conflictingResourceForeground': '#FFAB70',\n    'gitDecoration.deletedResourceForeground': '#EA4A5A',\n    'gitDecoration.ignoredResourceForeground': '#6A737D',\n    'gitDecoration.modifiedResourceForeground': '#79B8FF',\n    'gitDecoration.submoduleResourceForeground': '#6A737D',\n    'gitDecoration.untrackedResourceForeground': '#34D058',\n    'input.background': '#2F363D',\n    'input.border': '#1B1F23',\n    'input.foreground': '#E1E4E8',\n    'input.placeholderForeground': '#959DA5',\n    'list.activeSelectionBackground': '#39414A',\n    'list.activeSelectionForeground': '#E1E4E8',\n    'list.focusBackground': '#044289',\n    'list.hoverBackground': '#282E34',\n    'list.hoverForeground': '#E1E4E8',\n    'list.inactiveFocusBackground': '#1D2D3E',\n    'list.inactiveSelectionBackground': '#282E34',\n    'list.inactiveSelectionForeground': '#E1E4E8',\n    'notificationCenterHeader.background': '#24292E',\n    'notificationCenterHeader.foreground': '#959DA5',\n    'notifications.background': '#2F363D',\n    'notifications.border': '#1B1F23',\n    'notifications.foreground': '#E1E4E8',\n    'notificationsErrorIcon.foreground': '#EA4A5A',\n    'notificationsInfoIcon.foreground': '#79B8FF',\n    'notificationsWarningIcon.foreground': '#FFAB70',\n    'panel.background': '#1F2428',\n    'panel.border': '#1B1F23',\n    'panelInput.border': '#2F363D',\n    'panelTitle.activeBorder': '#F9826C',\n    'panelTitle.activeForeground': '#E1E4E8',\n    'panelTitle.inactiveForeground': '#959DA5',\n    'peekViewEditor.background': '#1F242888',\n    'peekViewEditor.matchHighlightBackground': '#FFD33D33',\n    'peekViewResult.background': '#1F2428',\n    'peekViewResult.matchHighlightBackground': '#FFD33D33',\n    'pickerGroup.border': '#444D56',\n    'pickerGroup.foreground': '#E1E4E8',\n    'progressBar.background': '#0366D6',\n    'quickInput.background': '#24292E',\n    'quickInput.foreground': '#E1E4E8',\n    'scrollbar.shadow': '#00000088',\n    'scrollbarSlider.activeBackground': '#6A737D88',\n    'scrollbarSlider.background': '#6A737D33',\n    'scrollbarSlider.hoverBackground': '#6A737D44',\n    'settings.headerForeground': '#E1E4E8',\n    'settings.modifiedItemIndicator': '#0366D6',\n    'sideBar.background': '#1F2428',\n    'sideBar.border': '#1B1F23',\n    'sideBar.foreground': '#D1D5DA',\n    'sideBarSectionHeader.background': '#1F2428',\n    'sideBarSectionHeader.border': '#1B1F23',\n    'sideBarSectionHeader.foreground': '#E1E4E8',\n    'sideBarTitle.foreground': '#E1E4E8',\n    'statusBar.background': '#007FFF',\n    'statusBar.border': '#1B1F23',\n    'statusBar.debuggingBackground': '#931C06',\n    'statusBar.debuggingForeground': '#FFFFFF',\n    'statusBar.foreground': '#E7E7E7',\n    'statusBar.noFolderBackground': '#24292E',\n    'statusBarItem.hoverBackground': '#3399FF',\n    'statusBarItem.prominentBackground': '#282E34',\n    'tab.activeBackground': '#24292E',\n    'tab.activeBorder': '#24292E',\n    'tab.activeBorderTop': '#F9826C',\n    'tab.activeForeground': '#E1E4E8',\n    'tab.border': '#1B1F23',\n    'tab.hoverBackground': '#24292E',\n    'tab.inactiveBackground': '#1F2428',\n    'tab.inactiveForeground': '#959DA5',\n    'tab.unfocusedActiveBorder': '#24292E',\n    'tab.unfocusedActiveBorderTop': '#1B1F23',\n    'tab.unfocusedHoverBackground': '#24292E',\n    'terminal.foreground': '#D1D5DA',\n    'textBlockQuote.background': '#24292E',\n    'textBlockQuote.border': '#444D56',\n    'textCodeBlock.background': '#2F363D',\n    'textLink.activeForeground': '#C8E1FF',\n    'textLink.foreground': '#79B8FF',\n    'textPreformat.foreground': '#D1D5DA',\n    'textSeparator.foreground': '#586069',\n    'titleBar.activeBackground': '#007FFF',\n    'titleBar.activeForeground': '#E7E7E7',\n    'titleBar.border': '#1B1F23',\n    'titleBar.inactiveBackground': '#007FFF99',\n    'titleBar.inactiveForeground': '#E7E7E799',\n    'tree.indentGuidesStroke': '#2F363D',\n    'welcomePage.buttonBackground': '#2F363D',\n    'welcomePage.buttonHoverBackground': '#444D56'\n  }\n}", "\n// This file is generated by esbuild to expose the worker script as a class, like Webpack's worker-loader\nexport default \"./js/typescript.worker.js\"", "\n// This file is generated by esbuild to expose the worker script as a class, like Webpack's worker-loader\nexport default \"./js/editor.worker.js\"", "// import { editor as Editor, languages } from \"monaco-editor\";\n\nimport '../../../node_modules/monaco-editor/esm/vs/language/typescript/monaco.contribution.js';\n// import 'monaco-editor/esm/vs/language/css/monaco.contribution';\n// import 'monaco-editor/esm/vs/language/json/monaco.contribution';\n// import 'monaco-editor/esm/vs/language/html/monaco.contribution';\n\n// import 'monaco-editor/esm/vs/basic-languages/monaco.contribution.js';\nimport '../../../node_modules/monaco-editor/esm/vs/basic-languages/typescript/typescript.contribution.js';\n\n// export * from 'monaco-editor/esm/vs/editor/edcore.main';\n\n// import '../../../node_modules/monaco-editor/esm/vs/editor/standalone/browser/accessibilityHelp/accessibilityHelp.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/standalone/browser/iPadShowKeyboard/iPadShowKeyboard.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/standalone/browser/inspectTokens/inspectTokens.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickAccess/standaloneHelpQuickAccess.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickAccess/standaloneGotoLineQuickAccess.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickAccess/standaloneGotoSymbolQuickAccess.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/standalone/browser/quickAccess/standaloneCommandsQuickAccess.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/standalone/browser/referenceSearch/standaloneReferenceSearch.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/standalone/browser/toggleHighContrast/toggleHighContrast.js';\n\nimport '../../../node_modules/monaco-editor/esm/vs/editor/browser/controller/coreCommands.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/browser/widget/codeEditorWidget.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/browser/widget/diffEditorWidget.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/browser/widget/diffNavigator.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/anchorSelect/anchorSelect.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/bracketMatching/bracketMatching.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/caretOperations.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/caretOperations/transpose.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/clipboard/clipboard.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/codeAction/codeActionContributions.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/codelens/codelensController.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/colorPicker/colorContributions.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/comment/comment.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/contextmenu/contextmenu.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/cursorUndo/cursorUndo.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/dnd/dnd.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/find/findController.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/folding/folding.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/fontZoom.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/format/formatActions.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/documentSymbols/documentSymbols.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/ghostTextController.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/goToCommands.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/link/goToDefinitionAtPosition.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/gotoError.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/hover.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/indentation.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/inlayHintsController.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/inPlaceReplace.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/linesOperations/linesOperations.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/linkedEditing/linkedEditing.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/links/links.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/multicursor/multicursor.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/parameterHints/parameterHints.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/rename/rename.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/smartSelect.js';\n// import '../../../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/snippetController2.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/suggest/suggestController.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/tokenization/tokenization.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/toggleTabFocusMode/toggleTabFocusMode.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/unusualLineTerminators/unusualLineTerminators.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/viewportSemanticTokens/viewportSemanticTokens.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/wordHighlighter/wordHighlighter.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/wordOperations/wordOperations.js';\nimport '../../../node_modules/monaco-editor/esm/vs/editor/contrib/wordPartOperations/wordPartOperations.js';\n// Load up these strings even in VSCode, even if they are not used\n// in order to get them translated\n// import '../../../node_modules/monaco-editor/esm/vs/editor/common/standaloneStrings.js';\nimport '../../../node_modules/monaco-editor/esm/vs/base/browser/ui/codicons/codiconStyles.js'; // The codicons are defined here and must be loaded\n\nimport { editor as Editor, languages } from '../../../node_modules/monaco-editor/esm/vs/editor/editor.api.js';\n\nimport GithubLight from \"../util/github-light\";\nimport GithubDark from \"../util/github-dark\";\nimport { themeGet } from \"../scripts/theme\";\n\nimport TYPESCRIPT_WORKER_URL from \"worker:../workers/typescript.ts\";\nimport EDITOR_WORKER_URL from \"worker:../workers/editor.ts\";\n\nimport { compressToURL, decompressFromURL } from '@amoutonbrady/lz-string';\n\n/** \n * Treeshake exports allow for specifing multiple exports per package, through this syntax\n * ```ts\n * \"[x,y,z],[a,b,c]\"\n * ```\n * where the brackets represent seperate packages\n*/\nexport const parseTreeshakeExports = (str: string) => (str ?? \"\").split(/\\],/).map(str => str.replace(/\\[|\\]/g, \"\"));\n\n// Inspired by https://github.com/solidjs/solid-playground\nexport const parseSearchQuery = () => {\n    try {\n        const searchParams = (new URL(String(document.location))).searchParams;\n        let share = searchParams.get(\"share\");\n        if (share) return decompressFromURL(share);\n\n        let query = searchParams.get(\"query\") || searchParams.get(\"q\");\n        let treeshake = searchParams.get(\"treeshake\");\n        if (query) {\n            let queryArr = query.split(\",\");\n            let treeshakeArr = parseTreeshakeExports(treeshake);\n            return \"// Click Run for the Bundled + Minified + Gzipped package size\\n\" + queryArr.map((q, i) => { \n                let treeshakeExports = treeshakeArr[i] && (treeshakeArr[i].trim() !== \"*\") ? `{ ${treeshakeArr[i].trim().split(\",\").join(\", \")} }` : '*';\n                return `export ${treeshakeExports} from ${JSON.stringify(q)};`;\n            }).join(\"\\n\");\n        }\n    } catch (e) { }\n}\n\nexport const initialValue = parseSearchQuery() || `\\\n// Click Run for the Bundled + Minified + Gzipped package size\nexport * from \"@okikio/animate\";`;\n\nexport const debounce = (func: Function, timeout = 300) => {\n    let timer: any;\n    return (...args: any) => {\n        clearTimeout(timer);\n        timer = setTimeout(() => { func.apply(this, args); }, timeout);\n    };\n};\n\nexport const build = () => {\n    let inputEl = document.querySelector(\".app #editor\") as HTMLElement;\n    let outputEl = document.querySelector(\".app#output #editor\") as HTMLElement;\n    inputEl.textContent = \"\";\n    outputEl.textContent = \"\";\n\n    let inputEditor: Editor.IStandaloneCodeEditor;\n    let outputEditor: Editor.IStandaloneCodeEditor;\n\n    languages.typescript.typescriptDefaults.setDiagnosticsOptions({\n        noSemanticValidation: true,\n        noSyntaxValidation: false,\n        noSuggestionDiagnostics: false\n    });\n\n    // Compiler options\n    languages.typescript.typescriptDefaults.setCompilerOptions({\n        \"moduleResolution\": languages.typescript.ModuleResolutionKind.NodeJs,\n        \"target\": languages.typescript.ScriptTarget.ES2020,\n        \"module\": languages.typescript.ModuleKind.ES2015,\n        \"noEmit\": true,\n        \"lib\": [\n            \"ES2021\",\n            \"DOM\",\n            \"DOM.Iterable\",\n            \"WebWorker\",\n            \"ESNEXT\",\n            \"NODE\"\n        ],\n        \"exclude\": [\"node_modules\"],\n        \"resolveJsonModule\": true,\n        \"isolatedModules\": true,\n        \"allowNonTsExtensions\": true,\n        \"esModuleInterop\": true,\n        \"noResolve\": true\n    });\n\n    // Read this on adding autocomplete to monaco:\n    // https://blog.expo.io/building-a-code-editor-with-monaco-f84b3a06deaf\n    // and\n    // https://mono.software/2017/04/11/custom-intellisense-with-monaco-editor/\n    // languages.registerHoverProvider('typescript', {\n    //     provideHover: function (model, position) {\n    //         // return xhr('../playground.html').then(function (res) {\n    //         //     return {\n    //         //         range: new Range(1, 1, model.getLineCount(), model.getLineMaxColumn(model.getLineCount())),\n    //         //         contents: [\n    //         //             { value: '**SOURCE**' },\n    //         //             { value: '```html\\n' + res.responseText.substring(0, 200) + '\\n```' }\n    //         //         ]\n    //         //     }\n    //         // });\n    //     }\n    // });\n\n    // Since packaging is done by you, you need\n    // to instruct the editor how you named the\n    // bundles that contain the web workers.\n    (window as any).MonacoEnvironment = {\n        getWorker: function (moduleId, label) {\n            if (label === \"typescript\" || label === \"javascript\") {\n                let WorkerArgs = { name: `${label}-worker` };\n                let AdvancedWorker = (\"SharedWorker\" in globalThis) && new SharedWorker(TYPESCRIPT_WORKER_URL, WorkerArgs);\n                return AdvancedWorker?.port || new Worker(TYPESCRIPT_WORKER_URL, WorkerArgs);\n            }\n\n            let WorkerArgs = { name: `editor-worker`,};\n            let AdvancedWorker = (\"SharedWorker\" in globalThis) && new SharedWorker(EDITOR_WORKER_URL, WorkerArgs);\n            return AdvancedWorker?.port || new Worker(EDITOR_WORKER_URL, WorkerArgs);\n        },\n    };\n\n    // @ts-ignore\n    Editor.defineTheme(\"dark\", GithubDark);\n\n    // @ts-ignore\n    Editor.defineTheme(\"light\", GithubLight);\n\n    let editorOpts = {\n        value: initialValue,\n        minimap: {\n            enabled: false,\n        },\n        scrollbar: {\n            // Subtle shadows to the left & top. Defaults to true.\n            useShadows: false,\n            vertical: \"auto\",\n        },\n        wordWrap: \"on\",\n        \"roundedSelection\": true,\n        \"scrollBeyondLastLine\": false,\n        smoothScrolling: true,\n        theme: themeGet(),\n        automaticLayout: true,\n        language: \"typescript\",\n\n        lineNumbers: \"on\"\n    };\n\n    inputEditor = Editor.create(inputEl, editorOpts as Editor.IStandaloneEditorConstructionOptions);\n    outputEditor = Editor.create(outputEl, Object.assign({}, editorOpts, {\n        value: `// Output`\n    }, ) as Editor.IStandaloneEditorConstructionOptions);\n\n    document.addEventListener(\"theme-change\", () => {\n        Editor.setTheme(themeGet());\n    });\n\n    return [inputEditor, outputEditor];\n};\n"],
  "mappings": "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",
  "names": []
}
